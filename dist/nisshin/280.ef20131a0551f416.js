"use strict";(self.webpackChunknisshin=self.webpackChunknisshin||[]).push([[280],{8280:(Xt,G,l)=>{l.r(G),l.d(G,{AccountsPayableAggregateModule:()=>po});var h=l(6895),y=l(1690),S=l(727),Z=l(9300),t=l(1571),C=l(8832),J=l(2125);let E=(()=>{class a{constructor(e,n){this.common=e,this.router=n,this.loading=!1,this.subscription=new S.w0,this.breadcrumbList=[],this.menuList=[]}ngOnInit(){this.subscription=this.common.loading$.subscribe(e=>{setTimeout(()=>this.loading=e)}),this.subscription.add(this.router.events.pipe((0,Z.h)(e=>e instanceof y.m2)).subscribe(e=>this.breadcrumbList=this.createBreadcrumbList(e.urlAfterRedirects))),this.breadcrumbList=this.createBreadcrumbList(this.router.url)}ngOnDestroy(){this.subscription?.unsubscribe()}createBreadcrumbList(e){const n=e.replace(/.*\/accounts-payable-aggregate\/?/,"").split("/"),r=[{name:"payment-cutoff",name_jp:"\u652f\u6255\u30c7\u30fc\u30bf",path:"payment-slip"},{name:"payment-slip",name_jp:"\u652f\u6255\u30c7\u30fc\u30bf",path:"payment-slip"},{name:"payment-clearing",name_jp:"\u652f\u6255\u6d88\u8fbc",path:"payment-clearing"},{name:"accounts-payable-balance",name_jp:"\u8cb7\u639b\u6b8b",path:"accounts-payable-balance"}],o=[{path:"/setting/menu",text:"\u8a2d\u5b9a\u4e00\u89a7"}],s=[],u=r.find(m=>m.name===n[0])?.path,p=r.find(m=>m.name===n[0])?.name_jp;if(o.push({path:`/setting/accounts-payable-aggregate/${u}`,text:`${p}\u4e00\u89a7`}),1===n.length)"payment-cutoff"===n[0]?(o.push({text:"\u652f\u6255\u7de0\u3081\u30c7\u30fc\u30bf\u4f5c\u6210"}),s.push(o[2])):(delete o[1].path,s.push(o[1]));else if("list"===(s.push(o[1]),n[1]))delete o[1].path;else{const m=[{name:"slip-list",name_jp:"\u8acb\u6c42\u4f1d\u7968\u4e00\u89a7"},{name:"slip-detail",name_jp:"\u8acb\u6c42\u4f1d\u7968\u8a73\u7d30"},{name:"add",name_jp:"\u652f\u6255\u6d88\u8fbc\u65b0\u898f\u767b\u9332"},{name:"detail-view",name_jp:"\u652f\u6255\u6d88\u8fbc\u95b2\u89a7"},{name:"detail-edit",name_jp:"\u652f\u6255\u6d88\u8fbc\u7de8\u96c6"}].find(d=>d.name===n[1])?.name_jp;o.push({text:`${m}`}),s.push(o[3])}return this.menuList=s,o}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(C.v),t.Y36(y.F0))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-accounts-payable-aggregate"]],decls:2,vars:1,consts:[[3,"isLoading"]],template:function(e,n){1&e&&t._UZ(0,"router-outlet")(1,"app-loading-container",0),2&e&&(t.xp6(1),t.Q6J("isLoading",n.loading))},dependencies:[y.lC,J.o]}),a})();var b=l(529),c=l(4006),O=l(7579),U=l(5698),g=l(262),x=l(9646),v=l(8746),k=l(5450),A=l(8037),_=l(6585),N=l(1609),L=l(8782),dt=l(1269),w=l(2334),W=l(1751),tt=l(2340);let ye=(()=>{class a extends W.O{constructor(){super(...arguments),this.endpoint=tt.pU.paymentDataCreationApi.endpoint}createPayableData(e){const n=this.generateFormData(e);return this.http.post(this.endpoint,n).pipe((0,g.K)(this.setErrorMessage("\u652f\u6255\u7de0\u3081\u30c7\u30fc\u30bf\u306e\u767b\u9332")))}}return a.\u0275fac=function(){let i;return function(n){return(i||(i=t.n5z(a)))(n||a)}}(),a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var R=l(7030),_t=l(1805),I=l(5146);let ht=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-toggle-button"]],decls:9,vars:0,consts:[[1,"mt-8"],["routerLink","../payment-cutoff","routerLinkActive","active"],["routerLink","../payment-slip","routerLinkActive","active"],["routerLink","../payment-clearing","routerLinkActive","active"],["routerLink","../accounts-payable-balance","routerLinkActive","active"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"button",1),t._uU(2," \u652f\u6255\u30c7\u30fc\u30bf\u7de0\u3081 "),t.qZA(),t.TgZ(3,"button",2),t._uU(4," \u652f\u6255\u30c7\u30fc\u30bf\u4e00\u89a7 "),t.qZA(),t.TgZ(5,"button",3),t._uU(6," \u652f\u6255\u6d88\u8fbc\u4e00\u89a7 "),t.qZA(),t.TgZ(7,"button",4),t._uU(8," \u8cb7\u639b\u6b8b\u4e00\u89a7 "),t.qZA()())},dependencies:[y.rH,y.Od],styles:["button[_ngcontent-%COMP%]{border-width:1px;--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity));padding:.25rem 1rem}button[_ngcontent-%COMP%]:first-child{border-top-left-radius:.25rem;border-bottom-left-radius:.25rem}button[_ngcontent-%COMP%]:last-child{border-top-right-radius:.25rem;border-bottom-right-radius:.25rem}.active[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}"]}),a})();var V=l(3148);function Ce(a,i){1&a&&t.GkF(0)}function Te(a,i){1&a&&t.GkF(0,21)}function Ae(a,i){1&a&&t.GkF(0,21)}function xe(a,i){1&a&&(t.TgZ(0,"span",24),t._uU(1,"\u5fc5\u9808"),t.qZA())}function De(a,i){if(1&a&&(t.TgZ(0,"div",22)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,xe,2,0,"span",23),t.qZA()),2&a){const e=i.label,n=i.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",n)}}function Fe(a,i){if(1&a&&(t.TgZ(0,"p",27),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function Ee(a,i){if(1&a&&(t.ynx(0),t.YNc(1,Fe,2,1,"p",26),t.BQk()),2&a){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required)}}function Se(a,i){if(1&a&&t.YNc(0,Ee,2,1,"ng-container",25),2&a){const e=i.ctrl,n=t.oxw();t.Q6J("ngIf",n.formControlStateManager(e))}}function Ze(a,i){if(1&a&&(t.TgZ(0,"p",27),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}const Oe=function(a){return{path:a,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Pe=function(a){return{path:a,text:"\u652f\u6255\u30c7\u30fc\u30bf\u4e00\u89a7"}},we=function(){return{text:"\u652f\u6255\u7de0\u3081\u30c7\u30fc\u30bf\u4f5c\u6210"}},Ue=function(a,i,e){return[a,i,e]},Ie=function(){return{label:"\u4ed5\u5165\u65e5",required:"true"}},Ne=function(a){return{ctrl:a}};let Me=(()=>{class a{constructor(e,n,r,o,s,u,p,m){this.modalService=e,this.flashMessageService=n,this.router=r,this.fb=o,this.authorService=s,this.errorService=u,this.common=p,this.paymentCutoffService=m,this.subscription=new S.w0,this.subject=new O.x,this.topPagePath="/setting",this.listPagePath="../payment-slip",this.mainPagePath="/payment-cutoff",this.errorLoadTitle="\u652f\u6255\u30c7\u30fc\u30bf\u7de0\u3081\u51e6\u7406\u753b\u9762\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.errorModalTitle="\u652f\u6255\u7de0\u3081\u30c7\u30fc\u30bf\u4f5c\u6210\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.errorConst=A.c,this.init_date=this.getInitDate(),this.inputForm=this.fb.group({order_date:this.fb.group({from:["",[c.kI.required]],to:["",[c.kI.required]]},{validators:[k.d.beforeFromDate()]})})}get ctrls(){return this.inputForm.controls}getInitDate(){var e=new Date;return new Date(e.getFullYear(),e.getMonth()-1,1)}getEndDate(){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),0)}ngOnInit(){this.authorService.author?this.author=this.authorService.author:this.subscription.add(this.authorService.author$.subscribe(e=>{this.author=e})),this.setDefaultValue()}setDefaultValue(){this.ctrls.order_date.controls.from.setValue(this.getInitDate()),this.ctrls.order_date.controls.to.setValue(this.getEndDate())}ngOnDestroy(){this.subscription.unsubscribe()}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleError(e,n,r){this.modalService.setModal(n,0===e?r+A.c.GUIDANCE_OF_SUPPORT:`\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9: ${e} \n\u30e1\u30c3\u30bb\u30fc\u30b8: `+r+A.c.GUIDANCE_OF_SUPPORT,"danger",_.yR.BUTTON_TITLE.CLOSE,""),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,U.q)(1),(0,Z.h)(s=>this.modalService.getModalProperties().title===n)).subscribe(s=>{}))}handleClickSaveButton(){this.inputForm.markAsPristine(),this.common.loading=!0;const e=this.inputForm.value;if(!e.order_date?.from||!e.order_date?.to)return this.ctrls.order_date.controls.from.setValue(""),this.ctrls.order_date.controls.to.setValue(""),void(this.common.loading=!1);const n={from_order_date:new Date(e.order_date.from).toLocaleDateString(),to_order_date:new Date(e.order_date.to).toLocaleDateString()};this.subscription.add(this.paymentCutoffService.createPayableData(n).pipe((0,g.K)(r=>(0,x.of)(r)),(0,v.x)(()=>this.common.loading=!1)).subscribe(r=>{r instanceof b.UA?this.handleError(r.status,this.errorModalTitle,r.error.message):(this.flashMessageService.setFlashMessage(r.message,"success",15e3),this.subject.next({}))}))}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(N.Z),t.Y36(L.P),t.Y36(y.F0),t.Y36(c.qu),t.Y36(dt.Y),t.Y36(w.T),t.Y36(C.v),t.Y36(ye))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-payment-cutoff"]],decls:30,vars:26,consts:[[3,"breadcrumbList"],[1,"mb-8"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-end"],[3,"roleTypeName"],[1,"width-limit-break","border-t","border-gray-400"],[3,"formGroup","ngSubmit"],[1,"mt-8","mb-24","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"flex","gap-6","mt-6","mb-6"],[1,"w-2/5"],[1,"flex","justify-center","gap-6"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngIf","ngIfThen"],[1,"width-limit-break","bg-primary-light","flex","flex-row","justify-center","bottom-[40px]","left-0","right-0","p-2","fixed","gap-8"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["labels",""],["errors",""],["beforeFromDate",""],["message",""],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[4,"ngIf"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,n){if(1&e&&(t._UZ(0,"app-breadcrumb-org",0)(1,"app-toggle-button"),t.TgZ(2,"main",1)(3,"div",2)(4,"div")(5,"app-last-updater-org",3),t._uU(6),t.qZA()()(),t._UZ(7,"hr",4),t.TgZ(8,"form",5),t.NdJ("ngSubmit",function(){return n.handleClickSaveButton()}),t.TgZ(9,"div",6)(10,"h2",7),t._uU(11,"\u652f\u6255\u7de0\u3081\u30c7\u30fc\u30bf\u4f5c\u6210"),t.qZA(),t._UZ(12,"hr",8),t.TgZ(13,"div",9),t._UZ(14,"div",10)(15,"div",10),t.qZA(),t.TgZ(16,"div",11)(17,"app-date-term-clear-container",12),t.YNc(18,Ce,1,0,"ng-container",13),t.YNc(19,Te,1,0,"ng-container",14),t.YNc(20,Ae,1,0,"ng-container",15),t.qZA()()(),t.TgZ(21,"div",16)(22,"app-button",17),t._uU(23,"\u652f\u6255\u7de0\u3081\u30c7\u30fc\u30bf\u4f5c\u6210"),t.qZA()()()(),t.YNc(24,De,4,2,"ng-template",null,18,t.W1O),t.YNc(26,Se,1,1,"ng-template",null,19,t.W1O),t.YNc(28,Ze,2,1,"ng-template",null,20,t.W1O)),2&e){const r=t.MAs(25),o=t.MAs(27),s=t.MAs(29);t.Q6J("breadcrumbList",t.kEZ(19,Ue,t.VKq(14,Oe,n.topPagePath),t.VKq(16,Pe,n.listPagePath),t.DdM(18,we))),t.xp6(5),t.Q6J("roleTypeName",n.author&&n.author.role_name?n.author.role_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.xp6(1),t.hij(" \u4f5c\u6210\u8005\uff1a",n.author?n.author.last_name+" "+n.author.first_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."," "),t.xp6(2),t.Q6J("formGroup",n.inputForm),t.xp6(9),t.Q6J("dateFromFormCtrl",n.ctrls.order_date.controls.from)("dateToFormCtrl",n.ctrls.order_date.controls.to)("invalid",!!n.ctrls.order_date.errors),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(23,Ie)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(24,Ne,n.ctrls.order_date.controls.from)),t.xp6(1),t.Q6J("ngIf",null==n.ctrls.order_date.errors?null:n.ctrls.order_date.errors.beforeFromDate)("ngIfThen",s),t.xp6(2),t.Q6J("buttonDisabled",n.inputForm.invalid)}},dependencies:[h.O5,h.tP,R.Z,_t.R,I.r,ht,c._Y,c.JL,c.sg,V.w]}),a})();var D=l(1267);let et=(()=>{class a extends W.O{constructor(){super(...arguments),this.endpoint=tt.pU.accountsPayableAggregateApi.endpoint,this._paymentEventSource=new O.x,this.paymentEvent$=this._paymentEventSource.asObservable()}getAll(e={}){return this.httpOptions.params=e,this.http.get(this.endpoint,this.httpOptions)}find(e){return this.http.get(`${this.endpoint}/${e}`)}getCsv(e){const n={responseType:"text",headers:new b.WM({"X-Download":e})};return this.http.get(this.endpoint,n).pipe((0,g.K)(this.setErrorMessage("\u4e00\u62ec\u767b\u9332\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u53d6\u5f97")))}add(e){const n=this.generateFormData(e);return this.http.post(this.endpoint,n)}aggregate(e){const n=this.generateFormData(e);return this.http.post(this.endpoint,n)}bulkAdd(e){const n=this.generateFormData({file:e});return this.http.put(this.endpoint,n)}update(e,n){const r=this.generateFormData(n);return this.http.patch(`${this.endpoint}/${e}`,r)}remove(e){return this.http.delete(`${this.endpoint}/${e}`,this.httpOptions)}sendPaymentEvent(e){this._paymentEventSource.next(e)}}return a.\u0275fac=function(){let i;return function(n){return(i||(i=t.n5z(a)))(n||a)}}(),a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var gt=l(2640),M=l(4128),$=l(349),Q=l(4562);let nt=(()=>{class a extends W.O{constructor(){super(...arguments),this.endpoint=tt.pU.paymentApi.endpoint}getAll(e={}){return this.httpOptions.params=e,this.http.get(this.endpoint,this.httpOptions).pipe((0,g.K)(this.setErrorMessage("\u652f\u6255\u4f1d\u7968\u4e00\u89a7\u306e\u53d6\u5f97")))}find(e){return this.http.get(`${this.endpoint}/${e}`).pipe((0,g.K)(this.setErrorMessage("\u652f\u6255\u4f1d\u7968\u60c5\u5831\u306e\u53d6\u5f97")))}getCsv(e,n={}){const r={params:n,responseType:"text",headers:new b.WM({"X-Download":e})};return this.http.get(this.endpoint,r).pipe((0,g.K)(this.setErrorMessage("\u4e00\u62ec\u767b\u9332\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u53d6\u5f97")))}add(e){const n=this.generateFormData(e);return this.http.post(this.endpoint,n).pipe((0,g.K)(this.setErrorMessage("\u652f\u6255\u4f1d\u7968\u60c5\u5831\u306e\u767b\u9332")))}update(e,n){const r=this.generateFormData(n);return this.http.patch(`${this.endpoint}/${e}`,r)}remove(e){return this.http.delete(`${this.endpoint}/${e}`).pipe((0,g.K)(this.setErrorMessage("\u652f\u6255\u4f1d\u7968\u306e\u524a\u9664")))}}return a.\u0275fac=function(){let i;return function(n){return(i||(i=t.n5z(a)))(n||a)}}(),a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var B=l(3761),Ot=l(6502),j=l(7540);function Re(a,i){1&a&&t.GkF(0,21)}function Be(a,i){1&a&&t.GkF(0)}function qe(a,i){1&a&&t.GkF(0,21)}function ke(a,i){1&a&&t.GkF(0,21)}function Le(a,i){if(1&a&&(t.TgZ(0,"div",22)(1,"span"),t._uU(2),t.qZA()()),2&a){const e=i.label;t.xp6(2),t.Oqu(e)}}function Ye(a,i){if(1&a&&(t.TgZ(0,"p",25),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MIN_LIMIT," ")}}function Je(a,i){if(1&a&&(t.TgZ(0,"p",25),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function Ve(a,i){if(1&a&&(t.ynx(0),t.YNc(1,Ye,2,1,"p",24),t.YNc(2,Je,2,1,"p",24),t.BQk()),2&a){const e=t.oxw().ctrl,n=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.minlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===n.regExConst.NUMERIC_REG_EX+"")}}function Qe(a,i){if(1&a&&t.YNc(0,Ve,3,2,"ng-container",23),2&a){const e=i.ctrl,n=t.oxw();t.Q6J("ngIf",n.invalid(e))}}function je(a,i){if(1&a&&(t.TgZ(0,"p",26),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}const Wt=function(a){return{ctrl:a}},Ke=function(){return{label:"\u652f\u6255\u5148",required:"false"}};let Ge=(()=>{class a{constructor(e,n,r,o,s){this.fb=e,this.common=n,this.supplierService=r,this.errorService=o,this.paymentService=s,this.event=new t.vpe,this.errorLoadTitle="\u652f\u6255\u30c7\u30fc\u30bf\u4e00\u89a7\u753b\u9762\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.isOpen=!1,this.rotateAnimation="",this.searchForm=this.fb.group({id:"",supplier_id:"",payment_due_date:this.fb.group({from:"",to:""},{validators:[k.d.beforeFromDate()]})}),this.subscription=new S.w0,this.errorConst=A.c,this.regExConst=$.m}get ctrls(){return this.searchForm.controls}ngOnInit(){this.searchForm=this.setSearchClear(),this.initOptions()}searchButtonOnClick(){this.isOpen=!this.isOpen,this.rotateAnimation=this.isOpen?"rotate-animation-180":"rotate-animation-0"}onClickReset(){this.searchForm.reset(),this.searchForm=this.setSearchClear()}onClickSubmit(){const e=(0,D.vP)(this.removeNullsAndBlanks(this.searchForm.value));this.event.emit(e)}invalid(e){return(e.touched||e.dirty)&&e.invalid}removeNullsAndBlanks(e){const n={};for(const[r,o]of Object.entries(e))null!=o&&""!==o&&(n[r]=o);return n}initOptions(){this.subscription.add((0,M.D)([this.supplierService.getAsSelectOptions()]).pipe((0,g.K)(e=>(e.emit(e),(0,x.of)(e.error)))).subscribe(e=>{e instanceof b.UA?this.handleError(e.status,this.errorLoadTitle,e.message):null!=e&&1===e.length?this.supplierSuggests=e[0]:this.handleError(400,this.errorLoadTitle,_.yR.BODY.HAS_ERROR)}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleError(e,n,r){this.errorService.setError({status:e,title:n,message:r})}setSearchClear(){return this.fb.group({id:"",supplier_id:"",payment_due_date:this.fb.group({from:"",to:""},{validators:[k.d.beforeFromDate()]})})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.qu),t.Y36(C.v),t.Y36(Q.p),t.Y36(w.T),t.Y36(nt))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-search"]],outputs:{event:"event"},decls:33,vars:25,consts:[[1,"mt-8","mb-4"],[3,"click"],["icon","filter-2-line",1,"w-6"],[1,"inline-block","ml-1","mr-2"],["icon","arrow-down-s-fill",1,"w-6"],[1,"search","width-limit-break","bg-white",3,"ngClass"],[1,"w-[1280px]","mx-auto","px-4"],[1,"flex","gap-6","mt-6"],[1,"w-1/6",3,"formCtrl"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-2/5"],["nameAttrValue","supplier_id","idAttrValue","supplier-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],[1,"flex","gap-8","mt-10"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[1,"mt-2","text-sm","text-red"],["labels",""],["errors",""],["beforeFromDate",""],["message",""],[1,"flex","items-center","gap-2"],[4,"ngIf"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return n.searchButtonOnClick()}),t._UZ(2,"app-icon",2),t.TgZ(3,"span",3),t._uU(4),t.qZA(),t._UZ(5,"app-icon",4),t.qZA()(),t.TgZ(6,"div",5)(7,"form",6)(8,"div",7)(9,"app-text-clear-container",8),t._uU(10," \u652f\u6255ID "),t.YNc(11,Re,1,0,"ng-container",9),t.qZA(),t.TgZ(12,"div",10)(13,"app-select-suggest-container",11),t.YNc(14,Be,1,0,"ng-container",12),t.YNc(15,qe,1,0,"ng-container",9),t.qZA()()(),t.TgZ(16,"div",7)(17,"app-date-term-clear-container",13),t._uU(18," \u652f\u6255\u4e88\u5b9a\u65e5 "),t.YNc(19,ke,1,0,"ng-container",14),t.qZA()(),t.TgZ(20,"div",15)(21,"app-button",1),t.NdJ("click",function(){return n.onClickReset()}),t._uU(22,"\u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2"),t.qZA(),t.TgZ(23,"app-button",16),t.NdJ("click",function(){return n.onClickSubmit()}),t._uU(24," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA()(),t.TgZ(25,"p",17),t._uU(26," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()(),t.YNc(27,Le,3,1,"ng-template",null,18,t.W1O),t.YNc(29,Qe,1,1,"ng-template",null,19,t.W1O),t.YNc(31,je,2,1,"ng-template",null,20,t.W1O)),2&e){const r=t.MAs(28),o=t.MAs(30),s=t.MAs(32);t.xp6(4),t.hij(" ",n.isOpen?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(n.rotateAnimation),t.xp6(1),t.Q6J("ngClass",n.isOpen?"is-open shadow":""),t.xp6(3),t.Q6J("formCtrl",n.ctrls.id),t.xp6(2),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(20,Wt,n.ctrls.id)),t.xp6(2),t.Q6J("formCtrl",n.ctrls.supplier_id)("suggests",n.supplierSuggests)("invalid",n.formControlStateManager(n.ctrls.supplier_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(22,Ke)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(23,Wt,n.ctrls.supplier_id)),t.xp6(2),t.Q6J("dateFromFormCtrl",n.ctrls.payment_due_date.controls.from)("dateToFormCtrl",n.ctrls.payment_due_date.controls.to)("invalid",!!n.ctrls.payment_due_date.errors),t.xp6(2),t.Q6J("ngIf",null==n.ctrls.payment_due_date.errors?null:n.ctrls.payment_due_date.errors.beforeFromDate)("ngIfThen",s),t.xp6(4),t.Q6J("buttonDisabled",n.searchForm.invalid)}},dependencies:[h.mk,h.O5,h.tP,c._Y,c.JL,V.w,I.r,B.o,Ot.P,j.X],styles:[".search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease;overflow:hidden}.search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0}"]}),a})();const $e=function(a){return{path:a,text:"\u8a2d\u5b9a\u4e00\u89a7"}},He=function(){return{text:"\u652f\u6255\u30c7\u30fc\u30bf\u4e00\u89a7"}},ze=function(a,i){return[a,i]};let te=(()=>{class a{constructor(e,n){this.common=e,this.service=n,this.topPagePath="/setting",this._filter={},this.defaultSort={column:"\u652f\u6255ID",order:"desc"},this._pages={page:1,itemsPerPage:10,sort:this.defaultSort},this.tableParams=new O.x,this.tableNameMapping=[{name:"id",name_jp:"\u652f\u6255ID"},{name:"supplier_name",name_jp:"\u652f\u6255\u5148"},{name:"payment_due_date",name_jp:"\u652f\u6255\u4e88\u5b9a\u65e5"},{name:"scheduled_payment_amount",name_jp:"\u652f\u6255\u4e88\u5b9a\u91d1\u984d"},{name:"supplier_cutoff_date_billing",name_jp:"\u7de0\u65e5"}]}set filter(e){this._filter=e,this._pages.page=1,this.callApi()}set pages(e){this._pages=e,this.callApi()}ngOnInit(){this.callApi()}callApi(){this.common.loading=!0,this.service.getAll(this.createApiParams()).pipe((0,g.K)(this.service.handleErrorModal()),(0,v.x)(()=>this.common.loading=!1)).subscribe(e=>{const n=this.createTableParams(e,this.tableNameMapping,this.modifiedTableBody);console.log(n),this.tableParams.next(n)})}createApiParams(){0===Object.keys(this._pages.sort).length&&(this._pages.sort=this.defaultSort);const e=this.tableNameMapping.find(r=>r.name_jp===this._pages.sort.column)?.name;let n;return n="supplier_name"===e?"supplier_name_kana":e,{...this._filter,limit:this._pages.itemsPerPage,offset:(this._pages.page-1)*this._pages.itemsPerPage,sort:n?`${n}:${this._pages.sort.order}`:""}}createTableParams(e,n,r){const o=n.map(u=>u.name_jp),s=e.data.map(u=>n.map(r?r(u):p=>u[p.name]));return{total:e.totalItems,header:o,body:s}}modifiedTableBody(e){return n=>""===e[n.name]?e[n.name]:"id"===n.name?{href:`./${e.id}`,text:String(e.id)}:"payment_due_date"===n.name?(0,D.vz)(e[n.name]):"scheduled_payment_amount"===n.name?{unit:!1,align:"right",text:Number(e.scheduled_payment_amount)}:e[n.name]}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(C.v),t.Y36(et))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-list"]],decls:5,vars:8,consts:[[3,"breadcrumbList"],[3,"event"],[1,"block","mt-2",3,"params","pageChange"]],template:function(e,n){1&e&&(t._UZ(0,"app-breadcrumb-org",0)(1,"app-toggle-button"),t.TgZ(2,"app-search",1),t.NdJ("event",function(o){return n.filter=o}),t.qZA(),t.TgZ(3,"app-table-with-pagination",2),t.NdJ("pageChange",function(o){return n.pages=o}),t._uU(4," \u652f\u6255\u30c7\u30fc\u30bf\u4e00\u89a7\n"),t.qZA()),2&e&&(t.Q6J("breadcrumbList",t.WLB(5,ze,t.VKq(2,$e,n.topPagePath),t.DdM(4,He))),t.xp6(3),t.Q6J("params",n.tableParams))},dependencies:[gt.i,ht,R.Z,Ge]}),a})();var Pt=l(1903),wt=l(6815),Ut=l(5459),q=l(2352);let H=(()=>{class a extends W.O{constructor(){super(...arguments),this.endpoint=tt.pU.paymentDetailApi.endpoint}getAll(e={}){return this.httpOptions.params=e,this.http.get(this.endpoint,this.httpOptions).pipe((0,g.K)(this.setErrorMessage("\u652f\u6255\u660e\u7d30\u4e00\u89a7\u306e\u53d6\u5f97")))}find(e){return this.http.get(`${this.endpoint}/${e}`).pipe((0,g.K)(this.setErrorMessage("\u652f\u6255\u660e\u7d30\u60c5\u5831\u306e\u53d6\u5f97")))}getCsv(e,n={}){const r={params:n,responseType:"text",headers:new b.WM({"X-Download":e})};return this.http.get(this.endpoint,r).pipe((0,g.K)(this.setErrorMessage("\u4e00\u62ec\u767b\u9332\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u53d6\u5f97")))}add(e){const n=this.generateFormData(e);return this.http.post(this.endpoint,n).pipe((0,g.K)(this.setErrorMessage("\u652f\u6255\u660e\u7d30\u60c5\u5831\u306e\u767b\u9332")))}update(e,n){const r=this.generateFormData(n);return this.http.patch(`${this.endpoint}/${e}`,r).pipe((0,g.K)(this.setErrorMessage("\u652f\u6255\u660e\u7d30\u60c5\u5831\u306e\u66f4\u65b0")))}remove(e){return this.http.delete(`${this.endpoint}/${e}`).pipe((0,g.K)(this.setErrorMessage("\u652f\u6255\u660e\u7d30\u60c5\u5831\u306e\u524a\u9664")))}}return a.\u0275fac=function(){let i;return function(n){return(i||(i=t.n5z(a)))(n||a)}}(),a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),It=(()=>{class a{constructor(e,n,r){this.paymentDetailService=e,this.common=n,this.errorService=r}getTableData(e,n,r,o,s,u){this.common.loading=!0,e.add(this.paymentDetailService.getAll(o).pipe((0,g.K)(p=>(0,x.of)(p)),(0,v.x)(()=>this.common.loading=!1)).subscribe(p=>{if(p instanceof b.UA)return void console.error("Error fetching payment details:",p);const m=this.createTableParams(p,r,this.modifiedTableBody);s(m)}))}modifiedTableBody(e,n="",r=""){return o=>{if(console.log(o),""===e[o.name])return e[o.name];if(""!==r&&o.name===r)return{href:`${n}/${e[o.name]}`,text:e[o.name]+""};if("payment_date"===o.name){let u;return u=""===e.payment_date||"NaT"===e.payment_date?"":new Date(e.payment_date).toLocaleDateString(),u}return"payment_type_division_code"===o.name?[{value:q._.STATUS_CODE.CASH,text:q._.STATUS.CASH},{value:q._.STATUS_CODE.DISCOUNT,text:q._.STATUS.DISCOUNT},{value:q._.STATUS_CODE.TRANSFER,text:q._.STATUS.TRANSFER}].find(p=>p.value===e.payment_type_division_code)?.text:"payment_amount"===o.name?{unit:!1,align:"right",text:Number(e.payment_amount)}:"employee_created_last_name"===o.name?e.employee_created_last_name+""+e.employee_created_first_name:e[o.name]}}createTableParams(e,n,r,o=[]){const s=n.map(p=>p.name_jp),u=e.data.map(p=>n.map(r?r(p):m=>p[m.name]));return{total:e.totalItems,header:s,body:u,footer:o}}handleError(e,n,r){this.errorService.setError({status:e,title:"\u652f\u6255\u4f1d\u7968\u4e00\u89a7\uff1a"+_.yR.TITLE.HAS_ERROR,message:n,redirectPath:r})}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(H),t.LFG(C.v),t.LFG(w.T))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac}),a})(),ee=(()=>{class a{constructor(e,n,r){this.repairService=e,this.common=n,this.errorService=r}getTableData(e,n,r,o,s,u){this.common.loading=!0,e.add(this.repairService.getAll(o).pipe((0,g.K)(p=>(0,x.of)(p)),(0,v.x)(()=>this.common.loading=!1)).subscribe(p=>{if(p instanceof b.UA)return void console.error("Error fetching payment details:",p);const m=this.createTableParams(p,r,u);s(m)}))}modifiedTableBody(e,n="",r=""){return o=>(console.log(o),""===e[o.name]?e[o.name]:""!==r&&o.name===r&&"accounts-payable-aggregate/payment-slip"===n?{href:`../${e.accounts_payable_aggregate_id}/repair/${e[o.name]}`,text:e[o.name]+""}:"supplier_name"===o.name?{href:`/master/supplier/detail/${e.supplier_id}`,text:e.supplier_name}:"arrival_date"===o.name?(0,D.vz)(e[o.name]):e[o.name])}createTableParams(e,n,r){const o=n.map(u=>u.name_jp),s=e.data.map(u=>n.map(r?r(u):p=>u[p.name]));return{total:e.totalItems,header:o,body:s}}handleError(e,n,r){this.errorService.setError({status:e,title:"\u4fee\u7406\u4e00\u89a7\uff1a"+_.yR.TITLE.HAS_ERROR,message:n,redirectPath:r})}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(Ut.Z),t.LFG(C.v),t.LFG(w.T))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac}),a})();var Xe=l(843),ft=l(9586),ne=l(3360),We=l(7499),at=l(4416);function tn(a,i){1&a&&t.GkF(0,15)}function en(a,i){if(1&a&&(t.TgZ(0,"p",18),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MIN_LIMIT," ")}}function nn(a,i){if(1&a&&(t.TgZ(0,"p",18),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function an(a,i){if(1&a&&(t.ynx(0),t.YNc(1,en,2,1,"p",17),t.YNc(2,nn,2,1,"p",17),t.BQk()),2&a){const e=t.oxw().ctrl,n=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.minlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===n.regExConst.NUMERIC_REG_EX+"")}}function rn(a,i){if(1&a&&t.YNc(0,an,3,2,"ng-container",16),2&a){const e=i.ctrl,n=t.oxw();t.Q6J("ngIf",n.invalid(e))}}function on(a,i){if(1&a&&(t.TgZ(0,"p",19),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}let sn=(()=>{class a{constructor(e,n,r,o,s,u,p){this.fb=e,this.common=n,this.deposit=r,this.modalService=o,this.employeeService=s,this.errorService=u,this.flashMessageService=p,this.event=new t.vpe,this.isOpen=!1,this.rotateAnimation="",this.subscription=new S.w0,this.errorConst=A.c,this.regExConst=$.m,this.searchForm=this.fb.group({purchase_date:this.fb.group({from:"",to:""},{validators:[k.d.beforeFromDate()]})})}get ctrls(){return this.searchForm.controls}get fc(){return this.searchForm.controls}ngOnInit(){console.log("")}ngOnDestroy(){this.subscription.unsubscribe()}searchButtonOnClick(){this.isOpen=!this.isOpen,this.rotateAnimation=this.isOpen?"rotate-animation-180":"rotate-animation-0"}onClickReset(){this.searchForm.reset({purchase_date:{from:"",to:""}})}onClickSubmit(){const e=(0,D.vP)(this.removeNullsAndBlanks(this.searchForm.value));this.event.emit(e)}invalid(e){return(e.touched||e.dirty)&&e.invalid}removeNullsAndBlanks(e){const n={};for(const[r,o]of Object.entries(e))null!=o&&""!==o&&(n[r]=o);return n}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getFormControlTypeValue(e,n){return e.get(n)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.qu),t.Y36(C.v),t.Y36(We.s),t.Y36(N.Z),t.Y36(at.G),t.Y36(w.T),t.Y36(L.P))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-sliplist-search"]],outputs:{event:"event"},decls:23,vars:10,consts:[[1,"mt-8","mb-4"],[3,"click"],["icon","filter-2-line",1,"w-6"],[1,"inline-block","ml-1","mr-2"],["icon","arrow-down-s-fill",1,"w-6"],[1,"search","width-limit-break","bg-white",3,"ngClass"],[1,"w-[1280px]","mx-auto","px-4"],[1,"flex","gap-6","mt-6"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],[1,"flex","gap-8","mt-10"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[1,"mt-2","text-sm","text-red"],["errors",""],["beforeFromDate",""],["message",""],[4,"ngIf"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return n.searchButtonOnClick()}),t._UZ(2,"app-icon",2),t.TgZ(3,"span",3),t._uU(4),t.qZA(),t._UZ(5,"app-icon",4),t.qZA()(),t.TgZ(6,"div",5)(7,"form",6)(8,"div",7)(9,"app-date-term-clear-container",8),t._uU(10," \u4ed5\u5165\u65e5 "),t.YNc(11,tn,1,0,"ng-container",9),t.qZA()(),t.TgZ(12,"div",10)(13,"app-button",1),t.NdJ("click",function(){return n.onClickReset()}),t._uU(14,"\u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2"),t.qZA(),t.TgZ(15,"app-button",11),t.NdJ("click",function(){return n.onClickSubmit()}),t._uU(16," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA()(),t.TgZ(17,"p",12),t._uU(18," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()(),t.YNc(19,rn,1,1,"ng-template",null,13,t.W1O),t.YNc(21,on,2,1,"ng-template",null,14,t.W1O)),2&e){const r=t.MAs(22);t.xp6(4),t.hij(" ",n.isOpen?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(n.rotateAnimation),t.xp6(1),t.Q6J("ngClass",n.isOpen?"is-open shadow":""),t.xp6(3),t.Q6J("dateFromFormCtrl",n.ctrls.purchase_date.controls.from)("dateToFormCtrl",n.ctrls.purchase_date.controls.to)("invalid",!!n.ctrls.purchase_date.errors),t.xp6(2),t.Q6J("ngIf",null==n.ctrls.purchase_date.errors?null:n.ctrls.purchase_date.errors.beforeFromDate)("ngIfThen",r),t.xp6(4),t.Q6J("buttonDisabled",n.searchForm.invalid)}},dependencies:[h.mk,h.O5,c._Y,c.JL,V.w,I.r,B.o],styles:[".search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease;overflow:hidden}.search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0}"]}),a})();function ln(a,i){1&a&&t.GkF(0,19)}function un(a,i){1&a&&t.GkF(0)}function pn(a,i){1&a&&t.GkF(0,19)}function cn(a,i){if(1&a&&(t.TgZ(0,"p",22),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MIN_LIMIT," ")}}function mn(a,i){if(1&a&&(t.TgZ(0,"p",22),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function dn(a,i){if(1&a&&(t.ynx(0),t.YNc(1,cn,2,1,"p",21),t.YNc(2,mn,2,1,"p",21),t.BQk()),2&a){const e=t.oxw().ctrl,n=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.minlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===n.regExConst.NUMERIC_REG_EX+"")}}function _n(a,i){if(1&a&&t.YNc(0,dn,3,2,"ng-container",20),2&a){const e=i.ctrl,n=t.oxw();t.Q6J("ngIf",n.invalid(e))}}function hn(a,i){if(1&a&&(t.TgZ(0,"p",23),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}function gn(a,i){if(1&a&&(t.TgZ(0,"div",24)(1,"span"),t._uU(2),t.qZA()()),2&a){const e=i.label;t.xp6(2),t.Oqu(e)}}const fn=function(){return{label:"\u5546\u54c1\u540d",required:"false"}},bn=function(a){return{ctrl:a}};let vn=(()=>{class a{constructor(e){this.fb=e,this.event=new t.vpe,this.isOpen=!1,this.rotateAnimation="",this.subscription=new S.w0,this.errorConst=A.c,this.regExConst=$.m,this.searchForm=this.fb.group({product_name:"",arrival_date:this.fb.group({from:"",to:""},{validators:[k.d.beforeFromDate()]})})}get ctrls(){return this.searchForm.controls}get fc(){return this.searchForm.controls}ngOnInit(){if(console.log("ngOnInit this.repairsOrg:: ",this.repairsOrg),void 0!==this.repairsOrg){const e=this.repairsOrg.forEach(n=>(console.log(n),{value:n[1],text:n[1]}));console.log(e)}}ngOnChanges(e){e.repairsOrg&&e.repairsOrg.currentValue&&this.updateProductSuggests()}updateProductSuggests(){this.productSuggests=this.repairsOrg.map(e=>({value:e[2],text:e[2]})),console.log("Updated productSuggests:: ",this.productSuggests)}ngOnDestroy(){this.subscription.unsubscribe()}searchButtonOnClick(){this.isOpen=!this.isOpen,this.rotateAnimation=this.isOpen?"rotate-animation-180":"rotate-animation-0"}onClickReset(){this.searchForm.reset({arrival_date:{from:"",to:""}})}onClickSubmit(){this.filterRepairs()}filterRepairs(){const e=(0,D.vP)(this.removeNullsAndBlanks(this.searchForm.value));console.log(e);const n=e.from_arrival_date,r=e.to_arrival_date,o=new Date(n),s=new Date(r),u=e.product_name,p=this.repairsOrg.filter(m=>{const d=m[1].replace(/ \u5e74 /,"/").replace(/ \u6708 /,"/").replace(/ \u65e5/,""),f=new Date(d);return!(""!==n&&f<o||""!==r&&f>s||void 0!==u&&m[2]!==u)});this.event.emit(p)}invalid(e){return(e.touched||e.dirty)&&e.invalid}removeNullsAndBlanks(e){const n={};for(const[r,o]of Object.entries(e))null!=o&&""!==o&&(n[r]=o);return n}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getFormControlTypeValue(e,n){return e.get(n)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.qu))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-sliplist-repair-search"]],inputs:{repairsOrg:"repairsOrg"},outputs:{event:"event"},features:[t.TTD],decls:29,vars:20,consts:[[1,"mt-8","mb-4"],[3,"click"],["icon","filter-2-line",1,"w-6"],[1,"inline-block","ml-1","mr-2"],["icon","arrow-down-s-fill",1,"w-6"],[1,"search","width-limit-break","bg-white",3,"ngClass"],[1,"w-[1280px]","mx-auto","px-4"],[1,"flex","gap-6","mt-6"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],["nameAttrValue","product_name","idAttrValue","product-name","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"flex","gap-8","mt-10"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[1,"mt-2","text-sm","text-red"],["errors",""],["beforeFromDate",""],["labels",""],["message",""],[4,"ngIf"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"],[1,"mt-1","pl-1","text-sm","text-red"],[1,"flex","items-center","gap-2"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return n.searchButtonOnClick()}),t._UZ(2,"app-icon",2),t.TgZ(3,"span",3),t._uU(4),t.qZA(),t._UZ(5,"app-icon",4),t.qZA()(),t.TgZ(6,"div",5)(7,"form",6)(8,"div",7)(9,"app-date-term-clear-container",8),t._uU(10," \u5165\u8377\u65e5 "),t.YNc(11,ln,1,0,"ng-container",9),t.qZA()(),t.TgZ(12,"div")(13,"app-select-suggest-container",10),t.YNc(14,un,1,0,"ng-container",11),t.YNc(15,pn,1,0,"ng-container",12),t.qZA()(),t.TgZ(16,"div",13)(17,"app-button",1),t.NdJ("click",function(){return n.onClickReset()}),t._uU(18,"\u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2"),t.qZA(),t.TgZ(19,"app-button",14),t.NdJ("click",function(){return n.onClickSubmit()}),t._uU(20," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA()(),t.TgZ(21,"p",15),t._uU(22," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()(),t.YNc(23,_n,1,1,"ng-template",null,16,t.W1O),t.YNc(25,hn,2,1,"ng-template",null,17,t.W1O),t.YNc(27,gn,3,1,"ng-template",null,18,t.W1O)),2&e){const r=t.MAs(24),o=t.MAs(26),s=t.MAs(28);t.xp6(4),t.hij(" ",n.isOpen?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(n.rotateAnimation),t.xp6(1),t.Q6J("ngClass",n.isOpen?"is-open shadow":""),t.xp6(3),t.Q6J("dateFromFormCtrl",n.ctrls.arrival_date.controls.from)("dateToFormCtrl",n.ctrls.arrival_date.controls.to)("invalid",!!n.ctrls.arrival_date.errors),t.xp6(2),t.Q6J("ngIf",null==n.ctrls.arrival_date.errors?null:n.ctrls.arrival_date.errors.beforeFromDate)("ngIfThen",o),t.xp6(2),t.Q6J("formCtrl",n.ctrls.product_name)("suggests",n.productSuggests)("invalid",n.formControlStateManager(n.ctrls.product_name)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.DdM(17,fn)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(18,bn,n.ctrls.product_name)),t.xp6(4),t.Q6J("buttonDisabled",n.searchForm.invalid)}},dependencies:[h.mk,h.O5,h.tP,c._Y,c.JL,V.w,I.r,B.o,j.X],styles:[".search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease;overflow:hidden}.search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0}"]}),a})();function yn(a,i){1&a&&t.GkF(0,16)}function Cn(a,i){if(1&a&&(t.TgZ(0,"p",19),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MIN_LIMIT," ")}}function Tn(a,i){if(1&a&&(t.TgZ(0,"p",19),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function An(a,i){if(1&a&&(t.ynx(0),t.YNc(1,Cn,2,1,"p",18),t.YNc(2,Tn,2,1,"p",18),t.BQk()),2&a){const e=t.oxw().ctrl,n=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.minlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===n.regExConst.NUMERIC_REG_EX+"")}}function xn(a,i){if(1&a&&t.YNc(0,An,3,2,"ng-container",17),2&a){const e=i.ctrl,n=t.oxw();t.Q6J("ngIf",n.invalid(e))}}function Dn(a,i){if(1&a&&(t.TgZ(0,"p",20),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}function Fn(a,i){if(1&a&&(t.TgZ(0,"div",21)(1,"span"),t._uU(2),t.qZA()()),2&a){const e=i.label;t.xp6(2),t.Oqu(e)}}let En=(()=>{class a{constructor(e){this.fb=e,this.event=new t.vpe,this.isOpen=!1,this.rotateAnimation="",this.subscription=new S.w0,this.errorConst=A.c,this.regExConst=$.m,this.searchForm=this.fb.group({product_name:"",payment_date:this.fb.group({from:"",to:""},{validators:[k.d.beforeFromDate()]})})}get ctrls(){return this.searchForm.controls}get fc(){return this.searchForm.controls}ngOnInit(){if(console.log("ngOnInit this.paymentDetailsOrg:: ",this.paymentDetailsOrg),void 0!==this.paymentDetailsOrg){const e=this.paymentDetailsOrg.forEach(n=>(console.log(n),{value:n[1],text:n[1]}));console.log(e)}}ngOnChanges(e){e.paymentDetailsOrg&&e.paymentDetailsOrg.currentValue&&this.updateProductSuggests()}updateProductSuggests(){this.productSuggests=this.paymentDetailsOrg.map(e=>({value:e[2],text:e[2]})),console.log("Updated productSuggests:: ",this.productSuggests)}ngOnDestroy(){this.subscription.unsubscribe()}searchButtonOnClick(){this.isOpen=!this.isOpen,this.rotateAnimation=this.isOpen?"rotate-animation-180":"rotate-animation-0"}onClickReset(){this.searchForm.reset({payment_date:{from:"",to:""}})}onClickSubmit(){this.filterPaymentDetails()}filterPaymentDetails(){const e=(0,D.vP)(this.removeNullsAndBlanks(this.searchForm.value));console.log(e);const n=e.from_payment_date,r=e.to_payment_date,o=new Date(n),s=new Date(r),u=e.product_name,p=this.paymentDetailsOrg.filter(m=>{const d=m[1].replace(/ \u5e74 /,"/").replace(/ \u6708 /,"/").replace(/ \u65e5/,""),f=new Date(d);return!(""!==n&&f<o||""!==r&&f>s||void 0!==u&&m[2]!==u)});this.event.emit(p)}invalid(e){return(e.touched||e.dirty)&&e.invalid}removeNullsAndBlanks(e){const n={};for(const[r,o]of Object.entries(e))null!=o&&""!==o&&(n[r]=o);return n}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getFormControlTypeValue(e,n){return e.get(n)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.qu))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-payment-detail-search"]],inputs:{paymentDetailsOrg:"paymentDetailsOrg"},outputs:{event:"event"},features:[t.TTD],decls:25,vars:10,consts:[[1,"mt-8","mb-4"],[3,"click"],["icon","filter-2-line",1,"w-6"],[1,"inline-block","ml-1","mr-2"],["icon","arrow-down-s-fill",1,"w-6"],[1,"search","width-limit-break","bg-white",3,"ngClass"],[1,"w-[1280px]","mx-auto","px-4"],[1,"flex","gap-6","mt-6"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],[1,"flex","gap-8","mt-10"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[1,"mt-2","text-sm","text-red"],["errors",""],["beforeFromDate",""],["labels",""],["message",""],[4,"ngIf"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"],[1,"mt-1","pl-1","text-sm","text-red"],[1,"flex","items-center","gap-2"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return n.searchButtonOnClick()}),t._UZ(2,"app-icon",2),t.TgZ(3,"span",3),t._uU(4),t.qZA(),t._UZ(5,"app-icon",4),t.qZA()(),t.TgZ(6,"div",5)(7,"form",6)(8,"div",7)(9,"app-date-term-clear-container",8),t._uU(10," \u652f\u6255\u65e5 "),t.YNc(11,yn,1,0,"ng-container",9),t.qZA()(),t.TgZ(12,"div",10)(13,"app-button",1),t.NdJ("click",function(){return n.onClickReset()}),t._uU(14,"\u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2"),t.qZA(),t.TgZ(15,"app-button",11),t.NdJ("click",function(){return n.onClickSubmit()}),t._uU(16," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA()(),t.TgZ(17,"p",12),t._uU(18," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()(),t.YNc(19,xn,1,1,"ng-template",null,13,t.W1O),t.YNc(21,Dn,2,1,"ng-template",null,14,t.W1O),t.YNc(23,Fn,3,1,"ng-template",null,15,t.W1O)),2&e){const r=t.MAs(22);t.xp6(4),t.hij(" ",n.isOpen?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(n.rotateAnimation),t.xp6(1),t.Q6J("ngClass",n.isOpen?"is-open shadow":""),t.xp6(3),t.Q6J("dateFromFormCtrl",n.ctrls.payment_date.controls.from)("dateToFormCtrl",n.ctrls.payment_date.controls.to)("invalid",!!n.ctrls.payment_date.errors),t.xp6(2),t.Q6J("ngIf",null==n.ctrls.payment_date.errors?null:n.ctrls.payment_date.errors.beforeFromDate)("ngIfThen",r),t.xp6(4),t.Q6J("buttonDisabled",n.searchForm.invalid)}},dependencies:[h.mk,h.O5,c._Y,c.JL,V.w,I.r,B.o],styles:[".search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease;overflow:hidden}.search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0}"]}),a})();function Sn(a,i){if(1&a&&(t.TgZ(0,"tr",15)(1,"td",18),t._uU(2,"\u6d88\u8cbb\u7a0e8%"),t.qZA(),t.TgZ(3,"td",28),t._uU(4),t.ALo(5,"number"),t.qZA(),t.TgZ(6,"td",18),t._uU(7,"\u6d88\u8cbb\u7a0e10%"),t.qZA(),t.TgZ(8,"td",28),t._uU(9),t.ALo(10,"number"),t.qZA()()),2&a){const e=t.oxw();t.xp6(4),t.hij(" ",t.lcZ(5,2,e.accountsPayableAggregate.reduced_tax)," "),t.xp6(5),t.hij(" ",t.lcZ(10,4,e.accountsPayableAggregate.consumption_tax)," ")}}function Zn(a,i){if(1&a&&(t.TgZ(0,"tr",15)(1,"td",29),t._uU(2),t.qZA(),t.TgZ(3,"td",29),t._uU(4),t.qZA(),t.TgZ(5,"td",29),t._uU(6),t.qZA(),t.TgZ(7,"td",30),t._uU(8),t.ALo(9,"number"),t.qZA(),t.TgZ(10,"td",30),t._uU(11),t.ALo(12,"number"),t.qZA()()),2&a){const e=t.oxw();t.xp6(2),t.Oqu(e.accountsPayableAggregate.id),t.xp6(2),t.hij(" ",e.accountsPayableAggregate.supplier_name," "),t.xp6(2),t.hij(" ",e.getDateFormat(e.accountsPayableAggregate.payment_due_date)," "),t.xp6(2),t.hij(" ",t.lcZ(9,5,e.accountsPayableAggregate.scheduled_payment_amount)," "),t.xp6(3),t.hij(" ",t.lcZ(12,7,e.accountsPayableAggregate.balance)," ")}}function On(a,i){if(1&a&&(t.TgZ(0,"tr",15)(1,"td",30),t._uU(2),t.ALo(3,"number"),t.qZA(),t.TgZ(4,"td",30),t._uU(5),t.ALo(6,"number"),t.qZA(),t.TgZ(7,"td",30),t._uU(8),t.ALo(9,"number"),t.qZA(),t.TgZ(10,"td",30),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"td",30),t._uU(14),t.ALo(15,"number"),t.qZA()()),2&a){const e=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,5,e.accountsPayableAggregate.previous_month_balance)," "),t.xp6(3),t.hij(" ",t.lcZ(6,7,e.accountsPayableAggregate.pay_amount)," "),t.xp6(3),t.hij(" ",t.lcZ(9,9,e.accountsPayableAggregate.cf_amount)," "),t.xp6(3),t.hij(" ",t.lcZ(12,11,e.accountsPayableAggregate.purchase_amount)," "),t.xp6(3),t.hij(" ",t.lcZ(15,13,e.accountsPayableAggregate.current_month_balance)," ")}}function Pn(a,i){1&a&&t._UZ(0,"app-new-registration-link-org",31)}const wn=function(a){return{path:a,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Un=function(a){return{path:a,text:"\u652f\u6255\u30c7\u30fc\u30bf\u4e00\u89a7"}},In=function(){return{text:"\u652f\u6255\u4f1d\u7968\u4e00\u89a7"}},Nn=function(a,i,e){return[a,i,e]};let Mn=(()=>{class a{constructor(e,n,r,o,s,u,p,m,d,f,T){this.route=e,this.router=n,this.modalService=r,this.accountsPayableAggregateService=o,this.purchaseService=s,this.purchaseDetailService=u,this.repairService=p,this.errorService=m,this.paymentDetailDomain=d,this.repairDomain=f,this.common=T,this.subscription=new S.w0,this.topPagePath="/setting",this.listPagePath="/setting/accounts-payable-aggregate/payment-slip",this.errorModalTitle="\u652f\u6255\u4f1d\u7968\u4e00\u89a7\uff1a"+_.yR.TITLE.HAS_ERROR,this.totalPrice=0,this._filter={},this._repairFilter={},this._paymentDetailFilter={},this.defaultSort={column:"\u4ed5\u5165ID",order:"desc"},this.defaultRepairSort={column:"\u4fee\u7406ID",order:"desc"},this.defaultPaymentDetailSort={column:"\u652f\u6255ID",order:"desc"},this._pages={page:1,itemsPerPage:10,sort:this.defaultSort},this._repairPages={page:1,itemsPerPage:10,sort:this.defaultRepairSort},this._paymentDetailPages={page:1,itemsPerPage:10,sort:this.defaultPaymentDetailSort},this.tableParams=new O.x,this.repairTableParams=new O.x,this.paymentDetailTableParams=new O.x,this.tableNameMapping=[{name:"is_discount",name_jp:"\u7a2e\u5225"},{name:"id",name_jp:"\u4ed5\u5165ID"},{name:"purchase_date",name_jp:"\u4ed5\u5165\u65e5"},{name:"supplier_name",name_jp:"\u4ed5\u5165\u5148\u540d"},{name:"order_employee_last_name",name_jp:"\u4ed5\u5165\u62c5\u5f53\u8005"},{name:"purchaseDetails",name_jp:"\u91d1\u984d"}],this.repairTableNameMapping=[{name:"id",name_jp:"\u4fee\u7406ID"},{name:"arrival_date",name_jp:"\u5165\u8377\u65e5"},{name:"product_name",name_jp:"\u4fee\u7406\u5546\u54c1\u540d"},{name:"employee_created_last_name",name_jp:"\u767b\u9332\u8005"}],this.paymentDetailTableNameMapping=[{name:"payment_id",name_jp:"\u652f\u6255ID"},{name:"payment_date",name_jp:"\u652f\u6255\u65e5"},{name:"payment_type_division_code",name_jp:"\u652f\u6255\u533a\u5206"},{name:"payment_amount",name_jp:"\u652f\u6255\u984d"},{name:"employee_created_last_name",name_jp:"\u767b\u9332\u8005"}],this.repairsTotalItems=0,this.paymentDetailsTotalItems=0}set filter(e){this._filter=e,this._pages.page=1,this.callApi(!1)}set repairFilter(e){console.log(e),this.repairs=e,this.repairsTotalItems=e.length}set paymentDetailFilter(e){this._paymentDetailPages.page=1,console.log("this._paymentDetailPages:: ",this._paymentDetailPages),console.log(e),this.paymentDetails=e,this.paymentDetailsTotalItems=e.length}set pages(e){this._pages=e,this.callApi(!1)}set repairPages(e){console.log(e),this._repairPages=e}set paymentDetailPages(e){console.log(e),this._paymentDetailPages=e}onRepairPagesChange(e){console.log("Repair pages changed:",e),this._repairPages=e}onPaymentDetailPagesChange(e){console.log("Payment detail pages changed:",e),this._paymentDetailPages=e}ngOnInit(){this.subscription.add(this.modalService.closeEventObservable$.pipe((0,Z.h)(e=>this.modalService.getModalProperties().title===this.errorModalTitle)).subscribe(e=>{e===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.listPagePath)})),this.callApi(!0),this.getRepair(),this.getPaymentDetail()}setPathParams(e){const n=this.route.snapshot.params.id;(0,D.oG)(n)?this.handleError(400,"\u30d1\u30e9\u30e1\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u4e00\u89a7\u753b\u9762\u3078\u623b\u308a\u307e\u3059\u3002",this.listPagePath):(this.selectedId=Number(n),e&&this.getAccountsPayableAggregate(this.selectedId))}callApi(e){const n=this.route.snapshot.params.id;(0,D.oG)(n)?this.handleError(400,"\u30d1\u30e9\u30e1\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u4e00\u89a7\u753b\u9762\u3078\u623b\u308a\u307e\u3059\u3002",this.listPagePath):(this.selectedId=Number(n),e&&this.getAccountsPayableAggregate(this.selectedId),this.getPurchase())}getAccountsPayableAggregate(e){this.common.loading=!0,this.subscription.add(this.accountsPayableAggregateService.find(e).pipe((0,g.K)(n=>(0,x.of)(n)),(0,v.x)(()=>this.common.loading=!1)).subscribe(n=>{n instanceof b.UA?this.handleError(n.status,n.error.message):(0,D.bz)(n)?this.handleError(400,A.c.COULD_NOT_GET_DATA):this.accountsPayableAggregate=n.data[0]}))}getPurchase(){this.common.loading=!0,this.purchaseService.getAll(this.createApiParams()).pipe((0,g.K)(this.purchaseService.handleErrorModal()),(0,v.x)(()=>this.common.loading=!1)).subscribe(e=>{const r=e.data.map(o=>o.id).map(o=>this.purchaseDetailService.getAll({purchase_id:o}).pipe((0,g.K)(this.purchaseDetailService.handleErrorModal())));(0,M.D)(r).subscribe(o=>{const s=new Map;o.forEach(d=>{d.data.forEach(f=>{s.has(f.purchase_id)||s.set(f.purchase_id,[]),s.get(f.purchase_id).push(f)})});const u=e.data.map(d=>({...d,purchaseDetails:s.get(d.id)||[]})),m=(u.forEach(d=>{let f=0;d.purchaseDetails.forEach(F=>{F.is_discount&&(f=1)}),d.is_discount=f}),this.createPurchasesTableParams({...e,data:u},this.tableNameMapping,this.modifiedTableBody));this.tableParams.next(m)})})}getRepair(){const e={...this._repairFilter,accounts_payable_aggregate_id:this.selectedId,sort:"id:desc"};this.repairDomain.getTableData(this.subscription,this._repairFilter,this.repairTableNameMapping,e,n=>{this.repairsOrg=n.body,this.repairs=this.repairsOrg,this.repairsHeaders=n.header,this.repairsTotalItems=n.total},n=>this.repairDomain.modifiedTableBody(n,"accounts-payable-aggregate/payment-slip","id"))}getPaymentDetail(){const e={...this._paymentDetailFilter,accounts_payable_aggregate_id:this.selectedId,sort:"id:desc"};this.paymentDetailDomain.getTableData(this.subscription,this._paymentDetailFilter,this.paymentDetailTableNameMapping,e,n=>{this.paymentDetailsOrg=n.body,this.paymentDetails=this.paymentDetailsOrg,this.paymentDetailsHeaders=n.header,this.paymentDetailsTotalItems=n.total})}createApiParams(){0===Object.keys(this._pages.sort).length&&(this._pages.sort=this.defaultSort);const e=this.tableNameMapping.find(r=>r.name_jp===this._pages.sort.column)?.name;let n;return n="supplier_name"===e?"supplier_name_kana":"order_employee_last_name"===e?"order_employee_last_name_kana":e,{...this._filter,accounts_payable_aggregate_id:this.selectedId,limit:this._pages.itemsPerPage,offset:(this._pages.page-1)*this._pages.itemsPerPage,sort:n?`${n}:${this._pages.sort.order}`:""}}createTableParams(e,n,r){const o=n.map(u=>u.name_jp),s=e.data.map(u=>n.map(r?r(u):p=>u[p.name]));return{total:e.totalItems,header:o,body:s}}createPurchasesTableParams(e,n,r){const o=n.map(F=>F.name_jp),s=e.data.map(F=>n.map(r?r(F):Y=>F[Y.name])),p=e.data.map(F=>{if(F.hasOwnProperty("purchaseDetails"))return F.purchaseDetails}).flatMap(F=>F);p.reduce((F,Y)=>F+Y.total,0);let d=0;p.forEach((F,Y)=>{d+=F.is_discount?-F.total:F.total});const T=this.calculateFooter(d,n);return{total:e.totalItems,header:o,body:s,footer:T}}calculateFooter(e,n){return n.map((o,s)=>3===s?"\u5408\u8a08":s<=2?"":["purchaseDetails"].includes(o.name)?e.toLocaleString():"")}modifiedTableBody(e){let r=!1;return o=>{if("is_discount"===o.name&&e[o.name]&&(r=!0),""===e[o.name])return e[o.name];if("is_discount"===o.name)return e[o.name]?(r=!0,"\u8fd4\u91d1/\u5024\u5f15\u304d"):"\u901a\u5e38";if("id"===o.name)return{href:`../${e.accounts_payable_aggregate_id}/purchase/${e[o.name]}`,text:e[o.name]+""};if("supplier_name"===o.name)return{href:`/master/supplier/detail/${e.supplier_id}`,text:e.supplier_name};if("purchase_date"===o.name)return(0,D.vz)(e[o.name]);if("purchaseDetails"===o.name){const u=e.purchaseDetails?.reduce((p,m)=>p+m.total,0);if(u){let p=u;return r&&(p=-p),{unit:!1,align:"right",text:p}}return""}return e[o.name]}}handleError(e,n,r){this.errorService.setError({status:e,title:"\u652f\u6255\u4f1d\u7968\u4e00\u89a7\uff1a"+_.yR.TITLE.HAS_ERROR,message:n,redirectPath:r})}ngOnDestroy(){this.subscription.unsubscribe()}getDateFormat(e){let n;return n=""===e||"NaT"===e?"":new Date(e).toLocaleDateString(),(0,D.vz)(n)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.gz),t.Y36(y.F0),t.Y36(N.Z),t.Y36(et),t.Y36(Pt.B),t.Y36(wt.p),t.Y36(Ut.Z),t.Y36(w.T),t.Y36(It),t.Y36(ee),t.Y36(C.v))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-slip-list"]],decls:58,vars:25,consts:[[3,"breadcrumbList"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"flex","flex-row","items-center","gap-6"],[3,"path"],[1,"width-limit-break","border-t","border-gray-400"],[1,"mt-8","py-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"flex","justify-end","mt-6"],[1,"w-1/3"],["class","border border-slate-200",4,"ngIf"],[1,"mt-6","flex","flex-row","gap-10"],[1,"grow"],[1,"w-full"],[1,"border","border-slate-200"],[1,"border","bg-slate-100","p-4","min-w-[100px]"],[1,"border","bg-slate-100","p-4","min-w-[410px]"],[1,"border","bg-slate-100","p-4","min-w-[120px]"],[1,"border","bg-slate-100","p-4","min-w-[150px]"],[3,"event"],[1,"flex","justify-end","gap-8","mt-4"],["path","./add",4,"ngIf"],[1,"block","mt-2",3,"params","pageChange"],[3,"repairsOrg","event"],[1,"block","mt-2",3,"tableHeader","tableData","totalItems","sender"],[3,"paymentDetailsOrg","event"],[1,"block","mt-2",3,"instanceId","tableHeader","tableData","totalItems","sender"],[1,"border","text-right","p-4"],[1,"border","p-4"],[1,"border","p-4","text-right"],["path","./add"]],template:function(e,n){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main")(2,"h1",1),t._uU(3,"\u652f\u6255\u4f1d\u7968\u4e00\u89a7"),t.qZA(),t.TgZ(4,"div",2)(5,"div",3)(6,"app-back-to-link-org",4),t._uU(7,"\u4e00\u89a7\u3078\u623b\u308b"),t.qZA()()(),t._UZ(8,"hr",5),t.TgZ(9,"div",6)(10,"h2",7),t._uU(11,"\u8acb\u6c42\u30d8\u30c3\u30c0\u30fc"),t.qZA(),t._UZ(12,"hr",8),t.TgZ(13,"div",9),t._UZ(14,"div"),t.TgZ(15,"div")(16,"table",10),t.YNc(17,Sn,11,6,"tr",11),t.qZA()()(),t.TgZ(18,"div",12)(19,"div",13)(20,"table",14)(21,"tr",15)(22,"td",16),t._uU(23,"\u652f\u6255ID"),t.qZA(),t.TgZ(24,"td",17),t._uU(25,"\u652f\u6255\u5148"),t.qZA(),t.TgZ(26,"td",18),t._uU(27,"\u652f\u6255\u4e88\u5b9a\u65e5"),t.qZA(),t.TgZ(28,"td",19),t._uU(29,"\u652f\u6255\u4e88\u5b9a\u984d"),t.qZA(),t.TgZ(30,"td",19),t._uU(31,"\u6b8b\u9ad8"),t.qZA()(),t.YNc(32,Zn,13,9,"tr",11),t.qZA(),t.TgZ(33,"table",14)(34,"tr",15)(35,"td",19),t._uU(36,"\u524d\u6708\u6b8b\u9ad8"),t.qZA(),t.TgZ(37,"td",19),t._uU(38,"\u652f\u6255\u91d1\u984d"),t.qZA(),t.TgZ(39,"td",19),t._uU(40,"\u7e70\u8d8a\u91d1\u984d"),t.qZA(),t.TgZ(41,"td",19),t._uU(42,"\u4ed5\u5165\u91d1\u984d"),t.qZA(),t.TgZ(43,"td",19),t._uU(44,"\u5f53\u6708\u6b8b\u9ad8"),t.qZA()(),t.YNc(45,On,16,15,"tr",11),t.qZA()()()(),t.TgZ(46,"app-sliplist-search",20),t.NdJ("event",function(o){return n.filter=o}),t.qZA(),t.TgZ(47,"div",21),t._UZ(48,"div"),t.YNc(49,Pn,1,0,"app-new-registration-link-org",22),t.qZA(),t.TgZ(50,"app-table-with-pagination",23),t.NdJ("pageChange",function(o){return n.pages=o}),t._uU(51," \u652f\u6255\u4f1d\u7968\u4e00\u89a7 "),t.qZA(),t.TgZ(52,"app-sliplist-repair-search",24),t.NdJ("event",function(o){return n.repairFilter=o}),t.qZA(),t.TgZ(53,"app-table-container",25),t.NdJ("sender",function(o){return n.repairPages=o}),t._uU(54," \u4fee\u7406\u4e00\u89a7 "),t.qZA(),t.TgZ(55,"app-payment-detail-search",26),t.NdJ("event",function(o){return n.paymentDetailFilter=o}),t.qZA(),t.TgZ(56,"app-table-container",27),t.NdJ("sender",function(o){return n.paymentDetailPages=o}),t._uU(57," \u652f\u6255\u660e\u7d30\u4e00\u89a7 "),t.qZA()()),2&e&&(t.Q6J("breadcrumbList",t.kEZ(21,Nn,t.VKq(16,wn,n.topPagePath),t.VKq(18,Un,n.listPagePath),t.DdM(20,In))),t.xp6(6),t.s9C("path",n.listPagePath),t.xp6(11),t.Q6J("ngIf",n.accountsPayableAggregate),t.xp6(15),t.Q6J("ngIf",n.accountsPayableAggregate),t.xp6(13),t.Q6J("ngIf",n.accountsPayableAggregate),t.xp6(4),t.Q6J("ngIf",n.accountsPayableAggregate),t.xp6(1),t.Q6J("params",n.tableParams),t.xp6(2),t.Q6J("repairsOrg",n.repairsOrg),t.xp6(1),t.Q6J("tableHeader",n.repairsHeaders)("tableData",n.repairs)("totalItems",n.repairsTotalItems),t.xp6(2),t.Q6J("paymentDetailsOrg",n.paymentDetailsOrg),t.xp6(1),t.Q6J("instanceId","paymentDetails")("tableHeader",n.paymentDetailsHeaders)("tableData",n.paymentDetails)("totalItems",n.paymentDetailsTotalItems))},dependencies:[h.O5,gt.i,Xe.t,ft.i,ne.S,R.Z,sn,vn,En,h.JJ]}),a})();var Nt=l(6082),bt=l(6232),Rn=l(8501),Bn=l(1043),qn=l(5142),ae=l(1914),Mt=l(4333),re=l(9612),vt=l(2195);function kn(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"div")(1,"app-select",19),t.NdJ("change",function(r){t.CHM(e);const o=t.oxw();return t.KtG(o.setLimit(r))}),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("formCtrl",e.frmPageLimit)("options",e.pageLimits)}}function Ln(a,i){1&a&&(t.TgZ(0,"th",20),t._uU(1," \u4ed5\u5165\u5148\u6d88\u8cbb\u7a0e\u533a\u5206 "),t.qZA())}function Yn(a,i){1&a&&(t.ynx(0),t.TgZ(1,"tr")(2,"td",21),t._uU(3," \u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093 "),t.qZA()(),t.BQk())}const yt=function(a){return{"bg-gray-100":a}};function Jn(a,i){if(1&a&&(t.ynx(0),t.TgZ(1,"tr",22)(2,"td",23),t._uU(3),t.qZA(),t.TgZ(4,"td",24),t._uU(5),t.qZA(),t.TgZ(6,"td",25),t._uU(7),t.qZA(),t.TgZ(8,"td",26),t._uU(9),t.qZA(),t.TgZ(10,"td",26),t._uU(11),t.qZA(),t.TgZ(12,"td",26),t._uU(13),t.qZA(),t.TgZ(14,"td",23),t._uU(15),t.qZA(),t.TgZ(16,"td",23),t._uU(17),t.qZA(),t.TgZ(18,"td",27),t._uU(19),t.qZA(),t.TgZ(20,"td",27),t._uU(21),t.qZA(),t.TgZ(22,"td",26),t._uU(23),t.qZA(),t._UZ(24,"td",26),t.qZA(),t.TgZ(25,"tr",22)(26,"td",23),t._uU(27),t.qZA(),t.TgZ(28,"td",23),t._uU(29),t.qZA(),t.TgZ(30,"td",23),t._uU(31),t.qZA(),t.TgZ(32,"td",23),t._uU(33),t.qZA(),t.TgZ(34,"td",23),t._uU(35),t.qZA(),t.TgZ(36,"td",23),t._uU(37,"\u3070\u3089\u7dcf\u6570"),t.qZA()(),t.BQk()),2&a){const e=i.$implicit,n=i.odd,r=t.oxw();t.xp6(1),t.Q6J("ngClass",t.VKq(20,yt,n)),t.xp6(2),t.hij(" ",e.product_id," "),t.xp6(2),t.hij(" ",e.product_barcode," "),t.xp6(2),t.hij(" ",e.product_name," "),t.xp6(2),t.hij(" ",e.receiving_quantity," "),t.xp6(2),t.hij(" ",e.order_quantity," "),t.xp6(2),t.hij(" ",e.unit_value," "),t.xp6(2),t.hij(" ",e.product_regulated_stock_num," "),t.xp6(2),t.hij(" ",e.product_quantity," "),t.xp6(2),t.hij(" ",e.order_price?e.order_price.toLocaleString():""," "),t.xp6(2),t.AsE(" ",r.isDiscount?"-":""," ",e.total?e.total.toLocaleString():""," "),t.xp6(2),t.hij(" ",e.supplier_sales_tax_division_value," "),t.xp6(2),t.Q6J("ngClass",t.VKq(22,yt,n)),t.xp6(2),t.hij(" ",e.product_supplier_product_cd," "),t.xp6(2),t.AsE(" ",e.shelf_value,"-",e.shelf_col_value," "),t.xp6(2),t.hij(" ",e.price_tag_value," "),t.xp6(2),t.hij(" ",e.seal_print_value," "),t.xp6(2),t.hij(" ",e.product_minimum_order_quantity," ")}}function Vn(a,i){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw().$implicit,n=t.oxw(3);t.xp6(1),t.hij(" ",n.getViewFormControlTypeValue(e,"api_product_name")," ")}}function Qn(a,i){1&a&&t.GkF(0)}const jn=function(){return{label:"\u54c1\u540d\u3092\u5546\u54c1\u30de\u30b9\u30bf\u304b\u3089\u9078\u629e",required:!1}};function Kn(a,i){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-real-time-suggest-container",41),t.NdJ("selectedData",function(r){t.CHM(e);const o=t.oxw().$implicit,s=t.oxw(3);return t.KtG(s.handleSelectedProductData(o,r))}),t.YNc(2,Qn,1,0,"ng-container",36),t.qZA(),t.BQk()}if(2&a){const e=t.oxw().$implicit,n=t.oxw(3),r=t.MAs(60);t.xp6(1),t.Tol("w-1/6"),t.Q6J("idCtrl",n.getFormControlTypeValue(e,"product_id"))("nameCtrl",n.getFormControlTypeValue(e,"api_product_name"))("apiInput",n.getProduct(e))("invalid",n.formControlStateManager(n.getFormControlTypeValue(e,"api_product_name"))),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(8,jn))}}function Gn(a,i){1&a&&t.GkF(0)}function $n(a,i){1&a&&t.GkF(0)}function Hn(a,i){1&a&&t.GkF(0)}const Rt=function(){return{label:"",required:!1}};function zn(a,i){if(1&a){const e=t.EpF();t.ynx(0,32),t.TgZ(1,"tr",22)(2,"td",23),t._uU(3),t.qZA(),t.TgZ(4,"td",24),t._uU(5),t.qZA(),t.TgZ(6,"td",33),t.YNc(7,Vn,2,1,"ng-container",2),t.YNc(8,Kn,3,9,"ng-container",2),t.qZA(),t.TgZ(9,"td",34)(10,"app-text-container",35),t.YNc(11,Gn,1,0,"ng-container",36),t.qZA()(),t.TgZ(12,"td",34)(13,"app-text-container",37),t.NdJ("change",function(){const o=t.CHM(e).$implicit,s=t.oxw(3);return t.KtG(s.changeLine(o))}),t.YNc(14,$n,1,0,"ng-container",36),t.qZA()(),t.TgZ(15,"td",26),t._uU(16),t.qZA(),t.TgZ(17,"td",23),t._uU(18),t.qZA(),t.TgZ(19,"td",23),t._uU(20),t.qZA(),t.TgZ(21,"td",34)(22,"app-text-container",38),t.NdJ("change",function(){const o=t.CHM(e).$implicit,s=t.oxw(3);return t.KtG(s.changeLine(o))}),t.YNc(23,Hn,1,0,"ng-container",36),t.qZA()(),t.TgZ(24,"td",27),t._uU(25),t._UZ(26,"br"),t._uU(27),t.qZA(),t.TgZ(28,"td",26),t.ynx(29),t.TgZ(30,"div",39)(31,"app-icon-container",40),t.NdJ("click",function(){const o=t.CHM(e).index,s=t.oxw(3);return t.KtG(s.removeDetail(o))}),t.qZA()(),t.BQk(),t.qZA()(),t.TgZ(32,"tr",22)(33,"td",23),t._uU(34),t.qZA(),t.TgZ(35,"td",23),t._uU(36),t.qZA(),t.TgZ(37,"td",23),t._uU(38),t.qZA(),t.TgZ(39,"td",23),t._uU(40),t.qZA(),t.TgZ(41,"td",23),t._uU(42),t.qZA(),t._UZ(43,"td",23),t.qZA(),t.BQk()}if(2&a){const e=i.$implicit,n=i.index,r=i.odd,o=t.oxw(3),s=t.MAs(60);t.Q6J("formGroupName",n),t.xp6(1),t.Q6J("ngClass",t.VKq(31,yt,r)),t.xp6(2),t.hij(" ",o.getViewFormControlTypeValue(e,"product_id")," "),t.xp6(2),t.hij(" ",o.getViewFormControlTypeValue(e,"view_barcode")," "),t.xp6(2),t.Q6J("ngIf",""!==o.getViewFormControlTypeValue(e,"id")),t.xp6(1),t.Q6J("ngIf",!o.getViewFormControlTypeValue(e,"id")),t.xp6(2),t.Q6J("textRight",!0)("formCtrl",o.getFormControlTypeValue(e,"receiving_quantity")),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.DdM(33,Rt)),t.xp6(2),t.Q6J("textRight",!0)("formCtrl",o.getFormControlTypeValue(e,"order_quantity")),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.DdM(34,Rt)),t.xp6(2),t.hij(" ",o.getViewFormControlTypeValue(e,"view_division_unit_value")," "),t.xp6(2),t.hij(" ",o.getViewFormControlTypeValue(e,"view_regulated_stock_num")," "),t.xp6(2),t.hij(" ",o.getViewFormControlTypeValue(e,"view_quantity")," "),t.xp6(2),t.Q6J("textRight",!0)("formCtrl",o.getFormControlTypeValue(e,"order_price")),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.DdM(35,Rt)),t.xp6(2),t.AsE(" ",o.isDiscount?"-":""," ",o.getViewFormControlTypeValue(e,"string_view_total")," "),t.xp6(2),t.hij(" ",o.getViewFormControlTypeValue(e,"is_discount")," "),t.xp6(5),t.Q6J("ngClass",t.VKq(36,yt,r)),t.xp6(2),t.hij(" ",o.getViewFormControlTypeValue(e,"view_supplier_product_cd")," "),t.xp6(2),t.AsE(" ",o.getViewFormControlTypeValue(e,"view_division_shelf_value"),"- ",o.getViewFormControlTypeValue(e,"view_division_shelf_col_value")," "),t.xp6(2),t.hij(" ",o.getViewFormControlTypeValue(e,"view_division_price_tag_value")," "),t.xp6(2),t.hij(" ",o.getViewFormControlTypeValue(e,"view_division_seal_print_value")," "),t.xp6(2),t.hij(" ",o.getViewFormControlTypeValue(e,"view_minimum_order_quantity")," ")}}function Xn(a,i){if(1&a&&(t.ynx(0,29)(1,30),t.YNc(2,zn,44,38,"ng-container",31),t.BQk()()),2&a){const e=t.oxw(2);t.Q6J("formGroup",e.purchaseDetailForms),t.xp6(2),t.Q6J("ngForOf",e.purchaseDetailArrayControls)}}function Wn(a,i){if(1&a&&(t.TgZ(0,"tbody"),t.YNc(1,Xn,3,2,"ng-container",28),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.purchaseDetailArrayControls.length>0)}}function ta(a,i){if(1&a&&(t.TgZ(0,"tfoot")(1,"tr"),t._UZ(2,"td",42),t.TgZ(3,"td",43),t._uU(4,"\u5408\u8a08"),t.qZA(),t.TgZ(5,"td",44),t._uU(6),t.qZA(),t._UZ(7,"td"),t.qZA()()),2&a){const e=t.oxw();t.xp6(6),t.AsE(" ",e.isDiscount?"-":""," ",e.total_cost.toLocaleString()," ")}}function ea(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"div"),t._UZ(1,"hr",45),t.TgZ(2,"div",46)(3,"div",47)(4,"app-button",48),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.addDetail())}),t._uU(5,"\u660e\u7d30\u8ffd\u52a0"),t.qZA()()()()}}function na(a,i){1&a&&t.GkF(0)}function aa(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"app-icon",62),t.NdJ("click",function(){t.CHM(e),t.oxw();const r=t.MAs(1);return t.KtG(r.setCurrent(1))}),t.qZA()}}function ra(a,i){1&a&&t._UZ(0,"app-icon",63)}function ia(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"app-icon",64),t.NdJ("click",function(){t.CHM(e),t.oxw();const r=t.MAs(1);return t.KtG(r.previous())}),t.qZA()}}function oa(a,i){1&a&&t._UZ(0,"app-icon",65)}function sa(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"span",48),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().$implicit;t.oxw();const o=t.MAs(1);return t.KtG(o.setCurrent(r.value))}),t._uU(1),t.qZA()}if(2&a){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.label)}}function la(a,i){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.label)}}function ua(a,i){if(1&a&&(t.TgZ(0,"div",66),t.YNc(1,sa,2,1,"span",67),t.YNc(2,la,2,1,"span",2),t.qZA()),2&a){const e=i.$implicit;t.oxw();const n=t.MAs(1);t.Q6J("ngClass",n.getCurrent()===e.value?"cursor-auto bg-primary text-white":"hover:text-slate-400"),t.xp6(1),t.Q6J("ngIf",n.getCurrent()!==e.value),t.xp6(1),t.Q6J("ngIf",n.getCurrent()===e.value)}}function pa(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"app-icon",68),t.NdJ("click",function(){t.CHM(e),t.oxw();const r=t.MAs(1);return t.KtG(r.next())}),t.qZA()}}function ca(a,i){1&a&&t._UZ(0,"app-icon",69)}function ma(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"app-icon",70),t.NdJ("click",function(){t.CHM(e),t.oxw();const r=t.MAs(1);return t.KtG(r.setCurrent(r.getLastPage()))}),t.qZA()}}function da(a,i){1&a&&t._UZ(0,"app-icon",71)}function _a(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"pagination-template",49,50),t.NdJ("pageChange",function(r){t.CHM(e);const o=t.oxw();return t.KtG(o.updatePage(r))}),t.TgZ(2,"p",51),t._uU(3),t.ALo(4,"number"),t.ALo(5,"number"),t.ALo(6,"number"),t.qZA(),t.TgZ(7,"div",52),t.YNc(8,aa,1,0,"app-icon",53),t.YNc(9,ra,1,0,"app-icon",54),t.YNc(10,ia,1,0,"app-icon",55),t.YNc(11,oa,1,0,"app-icon",56),t.YNc(12,ua,3,3,"div",57),t.YNc(13,pa,1,0,"app-icon",58),t.YNc(14,ca,1,0,"app-icon",59),t.YNc(15,ma,1,0,"app-icon",60),t.YNc(16,da,1,0,"app-icon",61),t.qZA(),t._UZ(17,"div",51),t.qZA()}if(2&a){const e=t.MAs(1),n=t.oxw();t.xp6(3),t.lnq(" ",t.lcZ(4,12,n.total)," \u4ef6\u4e2d ",t.lcZ(5,14,n.counts.start)," \uff5e ",t.lcZ(6,16,n.counts.end)," \u4ef6 \u8868\u793a\u4e2d "),t.xp6(5),t.Q6J("ngIf",!e.isFirstPage()),t.xp6(1),t.Q6J("ngIf",e.isFirstPage()),t.xp6(1),t.Q6J("ngIf",!e.isFirstPage()),t.xp6(1),t.Q6J("ngIf",e.isFirstPage()),t.xp6(1),t.Q6J("ngForOf",e.pages),t.xp6(1),t.Q6J("ngIf",!e.isLastPage()),t.xp6(1),t.Q6J("ngIf",e.isLastPage()),t.xp6(1),t.Q6J("ngIf",!e.isLastPage()),t.xp6(1),t.Q6J("ngIf",e.isLastPage())}}function ha(a,i){1&a&&(t.TgZ(0,"span",73),t._uU(1,"\u5fc5\u9808"),t.qZA())}function ga(a,i){if(1&a&&(t.TgZ(0,"div",52)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,ha,2,0,"span",72),t.qZA()),2&a){const e=i.label,n=i.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",n)}}const fa=function(a,i,e){return{currentPage:a,itemsPerPage:i,totalItems:e}};let ie=(()=>{class a{constructor(e,n,r){this.router=e,this.productService=n,this.fb=r,this.loading=!1,this.showTaxColumn=!1,this.pageChange=new t.vpe,this.isDiscount=!1,this.total_cost=0,this.subscription=new S.w0,this.pageLimits=[{value:10,text:"1\u30da\u30fc\u30b8\u306b10\u30ec\u30b3\u30fc\u30c9\u8868\u793a"},{value:25,text:"1\u30da\u30fc\u30b8\u306b25\u30ec\u30b3\u30fc\u30c9\u8868\u793a"}],this.frmPageLimit=new c.NI(this.pageLimits[0].value),this.data=[],this.total=0,this.meals=[],this.counts={start:0,end:0},this.itemsPerPage=Number(this.pageLimits[0].value),this.page=1,this.sort={}}ngOnInit(){this.loadParams(),this.frmPageLimit.valueChanges.subscribe(e=>{this.changeSelect(Number(e))})}loadParams(){void 0!==this.params&&this.params.subscribe(e=>{this.data=e.data,this.total=e.total,this.updateCounts()})}setLimit(e){}changeSelect(e){this.page=Math.ceil(this.counts.start/e),this.page=this.page>0?this.page:1,this.itemsPerPage=e,this.updatePage(this.page)}updatePage(e){this.page=e,this.pageChange.emit({page:this.page,itemsPerPage:this.itemsPerPage,sort:this.sort})}getFormControlTypeValue(e,n){return e.get(n)}getViewFormControlTypeValue(e,n){const r=this.getFormControlTypeValue(e,n);return null==r?"":r.value}get purchaseDetailForm(){return this.fb.group({id:[""],view_barcode:[""],view_total:[""],view_supplier_product_cd:[""],view_division_unit_value:[""],view_division_seal_print_value:[""],view_division_shelf_value:[""],view_division_shelf_col_value:[""],view_division_price_tag_value:[""],view_minimum_order_quantity:[""],view_quantity:[""],view_regulated_stock_num:[""],api_product_name:[""],purchase_order_id:[""],product_id:[""],order_quantity:[""],order_price:[""],receiving_date:[""],receiving_quantity:[""],string_view_total:[""],is_discount:[""]})}updateCounts(){const e=(this.page-1)*this.itemsPerPage+1;this.counts.start=e<this.total?e:this.total;const n=e+this.itemsPerPage-1;this.counts.end=n<this.total?n:this.total}handleSelectedProductData(e,n){void 0!==n&&(e.controls.view_barcode.patchValue(n.barcode),e.controls.view_supplier_product_cd.patchValue(n.supplier_product_cd),e.controls.view_division_unit_value.patchValue(n.division_unit_value),e.controls.view_division_seal_print_value.patchValue(n.division_seal_print_value),e.controls.view_division_shelf_value.patchValue(n.division_shelf_value),e.controls.view_division_shelf_col_value.patchValue(n.division_shelf_col_value),e.controls.view_division_price_tag_value.patchValue(n.division_price_tag_value),e.controls.view_minimum_order_quantity.patchValue(n.minimum_order_quantity),e.controls.view_quantity.patchValue(n.quantity),e.controls.view_regulated_stock_num.patchValue(n.regulated_stock_num))}handleCostChanges(e,n){console.log("handleCostChanges");let o=Number(n.quantity.value)*Number(e);n.total.patchValue(String(o)),n.string_view_total.patchValue(o.toLocaleString()),this.setTotalCost()}handleQuantityChanges(e,n){console.log("handleQuantityChanges");const r=n.order_price.value;let o=Number(e)*Number(r);n.total.patchValue(String(o)),n.string_view_total.patchValue(o.toLocaleString()),this.setTotalCost()}setTotalCost(){let e=0;this.purchaseDetailArray.value.forEach(n=>{console.log(n.order_price+n.order_quantity),e+=Number(n.order_price)*Number(n.order_quantity)}),this.total_cost=e}changeLine(e){const n=Number(e.value.order_price)*Number(e.value.order_quantity),r=n.toLocaleString(),o=this.getFormControlTypeValue(e,"view_total"),s=this.getFormControlTypeValue(e,"string_view_total");o.patchValue(n),s.patchValue(r),this.setTotalCost()}getProduct(e){return{observable:this.productService.getAll({name:e.controls.api_product_name.value}),idField:"id",nameField:"name"}}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}addDetail(){const e=this.purchaseDetailForm,n={order_price:e.controls.order_price,quantity:e.controls.order_quantity,total:e.controls.view_total,string_view_total:e.controls.string_view_total};e.controls.order_price.valueChanges.subscribe(r=>{this.handleCostChanges(r,n)}),e.controls.order_quantity.valueChanges.subscribe(r=>{this.handleQuantityChanges(r,n)}),this.purchaseDetailArray.push(e),console.log(this.purchaseDetailArray)}removeDetail(e){const n=this.purchaseDetailArray.controls[e];""!==n.controls.id.value&&this.purchaseDetailRemoveArray.push(n),this.purchaseDetailArray.removeAt(e)}get purchaseDetailArray(){return this.purchaseDetailForms.get("forms")}get purchaseDetailArrayControls(){return this.purchaseDetailArray.controls}get purchaseDetailRemoveArray(){return this.purchaseDetailRemoveForms.get("forms")}get shouldShowTaxHeader(){return this.showTaxColumn}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.F0),t.Y36(Nt.M),t.Y36(c.qu))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-purchase-detail-table"]],inputs:{loading:"loading",showTaxColumn:"showTaxColumn",params:"params",purchaseDetailForms:"purchaseDetailForms",purchaseDetailRemoveForms:"purchaseDetailRemoveForms",isDiscount:"isDiscount",total_cost:"total_cost"},outputs:{pageChange:"pageChange"},decls:61,vars:18,consts:[[1,"bg-white","border-t-4","border-t-primary-light","border","border-slate-50","shadow"],[1,"flex","justify-between","items-center","px-4","py-2"],[4,"ngIf"],[1,"whitespace-nowrap","border-separate","border-spacing-0","w-full","purchase-detail"],[1,"min-w-[100px]"],["colspan","2",1,"min-w-[270px]"],["rowspan","2",1,"min-w-[80px]"],["rowspan","2",1,"min-w-[70px]"],[1,"p-1","min-w-[100px]"],["class","min-w-[100px]","rowspan","2",4,"ngIf"],["rowspan","2",1,"duration-300"],[1,"duration-300"],[1,"p-1","duration-300"],[1,"p-4","duration-300"],[4,"ngFor","ngForOf"],[1,"border-y","border-t-slate-400","py-4"],[1,"text-xs"],["class","flex items-center justify-between gap-2 px-4 py-10",3,"pageChange",4,"ngIf"],["labels",""],[3,"formCtrl","options","change"],["rowspan","2",1,"min-w-[100px]"],["colspan","13",1,"border-b","border-iron-blue-300","p-4"],[3,"ngClass"],[1,"sticky"],[1,"sticky","p-1"],["colspan","2",1,"sticky"],["rowspan","2",1,"sticky"],["rowspan","2",1,"sticky","text-right"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["formArrayName","forms"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["colspan","2",1,"p-1"],["rowspan","2",1,"sticky","p-1"],["nameAttrValue","receiving_quantity","idAttrValue","receiving-quantity","inputType","number","min","0",3,"textRight","formCtrl"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["nameAttrValue","order_quantity","idAttrValue","order-quantity","inputType","number","min","0",3,"textRight","formCtrl","change"],["nameAttrValue","order_price","idAttrValue","order-price","inputType","number",3,"textRight","formCtrl","change"],[1,"cursor-pointer"],["icon","delete-bin-line","appendClassForIcon","cursor-pointer fill-danger group-hover:fill-danger-hover",3,"click"],["nameAttrValue","api_product_name","idAttrValue","product-name",3,"idCtrl","nameCtrl","apiInput","invalid","selectedData"],["colspan","9",1,"sticky","border","p-4"],[1,"sticky","border","p-4"],[1,"sticky","border","p-4","text-right"],[1,"mt-4"],[1,"flex","gap-6","justify-end","mx-4","pb-2"],[1,"pt-7"],[3,"click"],[1,"flex","items-center","justify-between","gap-2","px-4","py-10",3,"pageChange"],["p","paginationApi"],[1,"w-1/3"],[1,"flex","items-center","gap-2"],["class","w-6 cursor-pointer hover:opacity-60","icon","skip-back-line",3,"click",4,"ngIf"],["class","w-6 fill-iron-blue-400","icon","skip-back-line",4,"ngIf"],["class","w-6 rotate-180 cursor-pointer hover:opacity-60","icon","back-line",3,"click",4,"ngIf"],["class","w-6 rotate-180 fill-iron-blue-400","icon","back-line",4,"ngIf"],["class","min-w-[1.75rem] rounded text-center cursor-pointer p-1",3,"ngClass",4,"ngFor","ngForOf"],["class","w-6 cursor-pointer hover:opacity-60","icon","back-line",3,"click",4,"ngIf"],["class","w-6 fill-iron-blue-400","icon","back-line",4,"ngIf"],["class","w-6 cursor-pointer hover:opacity-60","icon","skip-forward-line",3,"click",4,"ngIf"],["class","w-6 fill-iron-blue-400","icon","skip-forward-line",4,"ngIf"],["icon","skip-back-line",1,"w-6","cursor-pointer","hover:opacity-60",3,"click"],["icon","skip-back-line",1,"w-6","fill-iron-blue-400"],["icon","back-line",1,"w-6","rotate-180","cursor-pointer","hover:opacity-60",3,"click"],["icon","back-line",1,"w-6","rotate-180","fill-iron-blue-400"],[1,"min-w-[1.75rem]","rounded","text-center","cursor-pointer","p-1",3,"ngClass"],[3,"click",4,"ngIf"],["icon","back-line",1,"w-6","cursor-pointer","hover:opacity-60",3,"click"],["icon","back-line",1,"w-6","fill-iron-blue-400"],["icon","skip-forward-line",1,"w-6","cursor-pointer","hover:opacity-60",3,"click"],["icon","skip-forward-line",1,"w-6","fill-iron-blue-400"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"app-title"),t._uU(4," \u652f\u6255\u4f1d\u7968\u8a73\u7d30 \u4e00\u89a7 "),t.qZA()(),t.YNc(5,kn,2,2,"div",2),t.qZA(),t.TgZ(6,"div")(7,"table",3)(8,"thead")(9,"tr")(10,"th",4),t._uU(11,"\u81ea\u30b3\u30fc\u30c9"),t.qZA(),t.TgZ(12,"th",4),t._uU(13,"JAN\u30b3\u30fc\u30c9"),t.qZA(),t.TgZ(14,"th",5),t._uU(15,"\u5546\u54c1\u540d"),t.qZA(),t.TgZ(16,"th",6),t._uU(17,"\u8ca9\u58f2"),t._UZ(18,"br"),t._uU(19,"\u6570\u91cf"),t.qZA(),t.TgZ(20,"th",6),t._uU(21,"\u6570\u91cf"),t.qZA(),t.TgZ(22,"th",7),t._uU(23,"\u5358\u4f4d"),t.qZA(),t.TgZ(24,"th",4),t._uU(25,"\u898f\u5b9a\u5728\u5eab"),t.qZA(),t.TgZ(26,"th",8),t._uU(27,"\u30b1\u30fc\u30b9\u5165\u6570"),t.qZA(),t.TgZ(28,"th",6),t._uU(29,"\u5358\u4fa1"),t.qZA(),t.TgZ(30,"th",6),t._uU(31,"\u91d1\u984d"),t.qZA(),t.YNc(32,Ln,2,0,"th",9),t.TgZ(33,"th",10),t._uU(34,"\u64cd\u4f5c"),t.qZA()(),t.TgZ(35,"tr")(36,"th",11),t._uU(37,"\u76f8\u30b3\u30fc\u30c9"),t.qZA(),t.TgZ(38,"th",11),t._uU(39,"\u68da\u756a"),t.qZA(),t.TgZ(40,"th",12),t._uU(41,"\u30dd\u30c3\u30d7\u30b7\u30fc\u30eb\u533a\u5206"),t.qZA(),t.TgZ(42,"th",12),t._uU(43,"\u5024\u672d\u30b7\u30fc\u30eb\u5370\u5237\u53ef\u5426"),t.qZA(),t.TgZ(44,"th",13),t._uU(45,"\u6700\u5c0f\u767a\u6ce8\u6570"),t.qZA(),t.TgZ(46,"th",11),t._uU(47,"\u30d0\u30e9\u7dcf\u6570"),t.qZA()()(),t.TgZ(48,"tbody"),t.YNc(49,Yn,4,0,"ng-container",2),t.YNc(50,Jn,38,24,"ng-container",14),t.qZA(),t.YNc(51,Wn,2,1,"tbody",2),t.YNc(52,ta,8,2,"tfoot",2),t.qZA(),t.YNc(53,ea,6,0,"div",2),t.TgZ(54,"div",15),t._UZ(55,"app-spinner",16),t.qZA()(),t.YNc(56,na,1,0,"ng-container",14),t.ALo(57,"paginate"),t.YNc(58,_a,18,18,"pagination-template",17),t.qZA(),t.YNc(59,ga,4,2,"ng-template",null,18,t.W1O)),2&e&&(t.xp6(5),t.Q6J("ngIf",n.params),t.xp6(27),t.Q6J("ngIf",n.showTaxColumn),t.xp6(17),t.Q6J("ngIf",n.params&&0===n.data.length),t.xp6(1),t.Q6J("ngForOf",n.data),t.xp6(1),t.Q6J("ngIf",n.purchaseDetailForms),t.xp6(1),t.Q6J("ngIf",0!==n.total_cost),t.xp6(1),t.Q6J("ngIf",n.purchaseDetailForms),t.xp6(1),t.ekj("hidden",!n.loading),t.xp6(2),t.Q6J("ngForOf",t.xi3(57,11,n.meals,t.kEZ(14,fa,n.page,n.itemsPerPage,n.total))),t.xp6(2),t.Q6J("ngIf",n.params))},dependencies:[h.mk,h.sg,h.O5,h.tP,c.JL,c.sg,c.x0,c.CE,I.r,Rn.r,Bn.H,qn.O,B.o,ae.J,Mt.tk,re.Y,vt.O,h.JJ,Mt._s],styles:[".purchase-detail[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.purchase-detail[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(241 245 249 / var(--tw-bg-opacity))}.purchase-detail[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;border-width:1px;--tw-border-opacity: 1;border-color:rgb(148 163 184 / var(--tw-border-opacity));--tw-bg-opacity: 1;background-color:rgb(241 245 249 / var(--tw-bg-opacity));padding:.25rem;text-align:left}.purchase-detail[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{top:0;border-width:1px;--tw-border-opacity: 1;border-color:rgb(148 163 184 / var(--tw-border-opacity));padding:.25rem;transition-duration:.3s}"]}),a})();var oe=l(4720);function ba(a,i){1&a&&t.GkF(0)}function va(a,i){1&a&&(t.TgZ(0,"app-button",20),t._uU(1," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA())}function ya(a,i){1&a&&(t.TgZ(0,"app-button",21),t._uU(1," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA())}function Ca(a,i){1&a&&(t.TgZ(0,"span",24),t._uU(1,"\u5fc5\u9808"),t.qZA())}function Ta(a,i){if(1&a&&(t.TgZ(0,"div",22)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,Ca,2,0,"span",23),t.qZA()),2&a){const e=i.label,n=i.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",n)}}const Aa=function(){return{label:"\u5546\u54c1",required:!1}};let xa=(()=>{class a{constructor(e,n){this.fb=e,this.productService=n,this.subscription=new S.w0,this.event=new t.vpe,this.errorEvent=new t.vpe,this.errorConst=A.c,this.hasSearchPanelOpened=!1,this.rotateAnimation="",this.searchForm=this.fb.group({barcode:"",product_id:"",product_name:""})}get ctrls(){return this.searchForm.controls}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getProductSuggests(){return{observable:this.productService.getAll({name:this.ctrls.product_name.value}),idField:"id",nameField:"name"}}handleClickSearchPaneToggleButton(){this.hasSearchPanelOpened?(this.hasSearchPanelOpened=!1,this.rotateAnimation="rotate-animation-0",this.searchForm.reset({product_id:""})):(this.hasSearchPanelOpened=!0,this.rotateAnimation="rotate-animation-180")}handleClickSearchClearButton(){this.searchForm.reset(),this.searchForm=this.setSearchClear()}handleClickSearchSubmitButton(){const e=(0,D.vP)((0,D.g3)(this.searchForm.value));this.event.emit(e)}ngOnDestroy(){this.subscription.unsubscribe()}setSearchClear(){return this.fb.group({barcode:"",product_id:"",product_name:""})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.qu),t.Y36(Nt.M))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-slipdetail-search"]],outputs:{event:"event",errorEvent:"errorEvent"},decls:27,vars:18,consts:[[1,"mt-8"],["btnType","button",3,"click"],[1,"w-6"],["icon","filter-2-line"],[1,"inline-block","ml-1","mr-2"],[1,"inline-block","w-6"],["icon","arrow-down-s-fill"],[1,"mt-6"],[1,"inventory-search","width-limit-break","bg-white"],["autocomplete","off",1,"w-[1280px]","mx-auto","px-4",3,"formGroup","ngSubmit"],[1,"flex","gap-4"],[1,"w-1/6",3,"formCtrl"],[1,"w-1/3"],["nameAttrValue","product_name","idAttrValue","product-name",3,"idCtrl","nameCtrl","apiInput","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"flex","gap-8","mt-10"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",4,"ngIf","ngIfElse"],[1,"mt-2","text-sm","text-red"],["disable",""],["labels",""],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover"],["btnFillColor","text-white bg-slate-300 hover:bg-slate-300"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return n.handleClickSearchPaneToggleButton()}),t.TgZ(2,"span",2),t._UZ(3,"app-icon",3),t.qZA(),t.TgZ(4,"span",4),t._uU(5),t.qZA(),t.TgZ(6,"span",5),t._UZ(7,"app-icon",6),t.qZA()(),t.TgZ(8,"div",7)(9,"div",8)(10,"form",9),t.NdJ("ngSubmit",function(){return n.handleClickSearchSubmitButton()}),t.TgZ(11,"div",10)(12,"app-text-clear-container",11),t._uU(13," JAN "),t.qZA(),t.TgZ(14,"div",12)(15,"app-real-time-suggest-container",13),t.YNc(16,ba,1,0,"ng-container",14),t.qZA()()(),t.TgZ(17,"div",15)(18,"app-button",1),t.NdJ("click",function(){return n.handleClickSearchClearButton()}),t._uU(19," \u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2 "),t.qZA(),t.YNc(20,va,2,0,"app-button",16),t.qZA(),t.TgZ(21,"p",17),t._uU(22," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()()()(),t.YNc(23,ya,2,0,"ng-template",null,18,t.W1O),t.YNc(25,Ta,4,2,"ng-template",null,19,t.W1O)),2&e){const r=t.MAs(24),o=t.MAs(26);t.xp6(5),t.hij(" ",n.hasSearchPanelOpened?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(n.rotateAnimation),t.xp6(3),t.ekj("is-open",n.hasSearchPanelOpened)("shadow",n.hasSearchPanelOpened),t.xp6(1),t.Q6J("formGroup",n.searchForm),t.xp6(2),t.Q6J("formCtrl",n.ctrls.barcode),t.xp6(3),t.Q6J("idCtrl",n.ctrls.product_id)("nameCtrl",n.ctrls.product_name)("apiInput",n.getProductSuggests())("invalid",n.formControlStateManager(n.ctrls.product_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.DdM(17,Aa)),t.xp6(4),t.Q6J("ngIf",n.searchForm.valid)("ngIfElse",r)}},dependencies:[h.O5,h.tP,c._Y,c.JL,c.sg,I.r,B.o,Ot.P,re.Y],styles:[".inventory-search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease-in;overflow:hidden}.inventory-search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0;overflow:visible}"]}),a})();function Da(a,i){if(1&a&&(t.TgZ(0,"tr",12)(1,"td",22),t._uU(2),t.qZA(),t.TgZ(3,"td",23),t._uU(4),t.qZA(),t.TgZ(5,"td",23),t._uU(6),t.ALo(7,"date"),t.qZA(),t.TgZ(8,"td",23),t._uU(9),t.qZA(),t.TgZ(10,"td",23),t._uU(11),t.qZA()()),2&a){const e=t.oxw();t.xp6(2),t.hij(" ",e.isDiscount?"\u8fd4\u91d1\u30fb\u5272\u5f15":"\u901a\u5e38"," "),t.xp6(2),t.Oqu(e.purchase.id),t.xp6(2),t.hij(" ",t.xi3(7,6,e.purchase.purchase_date,"yyyy\u5e74MM\u6708dd\u65e5")," "),t.xp6(3),t.Oqu(e.purchase.supplier_name),t.xp6(2),t.AsE(" ",e.purchase.order_employee_last_name," ",e.purchase.order_employee_first_name," ")}}const Fa=function(a){return{path:a,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Ea=function(a){return{path:a,text:"\u652f\u6255\u30c7\u30fc\u30bf\u4e00\u89a7"}},Sa=function(a){return{path:a,text:"\u652f\u6255\u4f1d\u7968\u4e00\u89a7"}},Za=function(){return{text:"\u652f\u6255\u4f1d\u7968\u8a73\u7d30"}},Oa=function(a,i,e,n){return[a,i,e,n]};let Pa=(()=>{class a{constructor(e,n,r,o,s,u,p,m,d,f){this.route=e,this.router=n,this.modalService=r,this.purchaseService=o,this.purchaseDetailService=s,this.errorService=u,this.flashMessageService=p,this.common=m,this.productService=d,this.divisionService=f,this.subscription=new S.w0,this.id=this.route.snapshot.params.id,this.topPagePath="/setting",this.listPagePath=`${this.topPagePath}/accounts-payable-aggregate/payment-slip`,this.slipListPagePath=this.listPagePath+"/"+this.id,this.errorModalTitle="\u652f\u6255\u4f1d\u7968\u8a73\u7d30\uff1a"+_.yR.TITLE.HAS_ERROR,this.isDiscount=!1,this.tortal_cost=0,this._filter={},this._pages={page:1,itemsPerPage:10,sort:{}},this.data=[],this.tableParams=new O.x,this.pageChange=new t.vpe,this.counts={start:0,end:0},this.tableNameMapping=[{name:"id",name_jp:"\u81ea\u30b3\u30fc\u30c9"},{name:"product_name",name_jp:"JAN"},{name:"product_name_alias",name_jp:"\u5546\u54c1\u540d"},{name:"product_id",name_jp:"\u8ca9\u58f2\u6570\u91cf"},{name:"order_quantity",name_jp:"\u6570\u91cf"},{name:"order_price",name_jp:"\u5358\u4f4d"},{name:"receiving_date",name_jp:"\u898f\u5b9a\u5728\u5eab"},{name:"receiving_quantity",name_jp:"\u30b1\u30fc\u30b9\u5165\u6570"},{name:"receiving_employee_id",name_jp:"\u5358\u4fa1"},{name:"order_status_division_id",name_jp:"\u91d1\u984d"},{name:"supplier_sales_tax_division_value",name_jp:"\u4ed5\u5165\u5148\u6d88\u8cbb\u7a0e\u533a\u5206"}]}set filter(e){this._filter=e,this._pages.page=1,this.callApi(!1)}set pages(e){this._pages=e,this.callApi(!1)}ngOnInit(){console.log("slip-detail"),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,Z.h)(e=>this.modalService.getModalProperties().title===this.errorModalTitle)).subscribe(e=>{e===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.listPagePath)})),this.callApi(!0)}callApi(e){const n=this.route.snapshot.params.purchase_id;(0,D.oG)(n)?this.handleError(400,"\u30d1\u30e9\u30e1\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u4e00\u89a7\u753b\u9762\u3078\u623b\u308a\u307e\u3059\u3002",this.listPagePath):(this.selectedId=Number(n),this.salesPurchaseId=this.route.snapshot.params.purchase_id,e&&this.getPurchase(this.salesPurchaseId),this.getPurchaseDetail())}getPurchase(e){this.common.loading=!0,this.subscription.add(this.purchaseService.find(e).pipe((0,g.K)(n=>(0,x.of)(n)),(0,v.x)(()=>this.common.loading=!1)).subscribe(n=>{n instanceof b.UA?this.handleError(n.status,n.error.message):(0,D.bz)(n)?this.handleError(400,A.c.COULD_NOT_GET_DATA):this.purchase=n.data[0]}))}initializeEmptyTaxInfo(e){return e.map(n=>(n.supplier_sales_tax_division_value="",n))}getPurchaseDetail(){this.common.loading=!0,this.purchaseDetailService.getAll(this.createApiParams()).pipe((0,g.K)(this.purchaseDetailService.handleErrorModal())).subscribe(e=>{e.data.forEach(o=>{if(o.order_price&&o.order_quantity){let s=Number(o.order_price)*Number(o.order_quantity);this.tortal_cost+=s}1===o.is_discount&&(this.isDiscount=!0)}),this.data=this.initializeEmptyTaxInfo(e.data);const n=e.totalItems;if(0===this.data.length)return this.tableParams.next({total:n,data:this.data}),void(this.common.loading=!1);const r=this.data.map(o=>o.product_id).filter(Boolean).join(",");if(!r)return this.tableParams.next({total:n,data:this.data}),void(this.common.loading=!1);this.productService.getAll({id:r}).subscribe({next:o=>{const s={};o.data.forEach(u=>{u&&u.id&&(s[u.id]=u.supplier_sales_tax_division_id)}),this.divisionService.getAsSelectOptions({name:"\u4ed5\u5165\u5148\u6d88\u8cbb\u7a0e\u533a\u5206"}).subscribe({next:u=>{const p=u.\u4ed5\u5165\u5148\u6d88\u8cbb\u7a0e\u533a\u5206||[];this.data.forEach(m=>{const d=s[m.product_id];if(d){const f=p.find(T=>T.value==d);m.supplier_sales_tax_division_id=d,m.supplier_sales_tax_division_value=f?f.text:""}}),this.tableParams.next({total:n,data:this.data}),this.common.loading=!1},error:u=>{console.error("\u6d88\u8cbb\u7a0e\u533a\u5206\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f",u),this.tableParams.next({total:n,data:this.data}),this.common.loading=!1}})},error:o=>{console.error("\u5546\u54c1\u60c5\u5831\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f",o),this.tableParams.next({total:n,data:this.data}),this.common.loading=!1}})})}createApiParams(){const e=this.tableNameMapping.find(n=>n.name_jp===this._pages.sort.column)?.name;return{...this._filter,purchase_id:this.selectedId,limit:this._pages.itemsPerPage,offset:(this._pages.page-1)*this._pages.itemsPerPage,sort:e?`${e}:${this._pages.sort.order}`:""}}createTableParams(e,n,r){const o=n.map(u=>u.name_jp),s=e.data.map(u=>n.map(r?r(u):p=>u[p.name]));return{total:e.totalItems,header:o,body:s}}modifiedTableBody(e){return n=>""===e[n.name]?e[n.name]:void 0===e[n.name]?"":"product_name"===n.name?{href:`/master/product/detail/${String(e.product_id)}`,text:e.product_name}:e[n.name]}handleError(e,n,r){this.errorService.setError({status:e,title:"\u652f\u6255\u4f1d\u7968\u4e00\u89a7\uff1a"+_.yR.TITLE.HAS_ERROR,message:n,redirectPath:r})}ngOnDestroy(){this.subscription.unsubscribe()}shouldShowTaxColumn(){const e=this.router.url;return!e.includes("/edit")&&!e.includes("/add")}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.gz),t.Y36(y.F0),t.Y36(N.Z),t.Y36(Pt.B),t.Y36(wt.p),t.Y36(w.T),t.Y36(L.P),t.Y36(C.v),t.Y36(Nt.M),t.Y36(bt.E))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-slip-detail"]],outputs:{pageChange:"pageChange"},decls:37,vars:21,consts:[[3,"breadcrumbList"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"flex","flex-row","items-center","gap-6"],[3,"path"],[1,"width-limit-break","border-t","border-gray-400"],[1,"mt-8","py-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"mt-6","flex","flex-row","gap-10"],[1,"grow"],[1,"w-full"],[1,"border","border-slate-200"],[1,"border","bg-slate-100","p-4","min-w-[50px]"],[1,"text-xm"],[1,"border","bg-slate-100","p-4","min-w-[150px]"],[1,"border","bg-slate-100","p-4","min-w-[120px]"],[1,"border","bg-slate-100","p-4","min-w-[360px]"],["class","border border-slate-200",4,"ngIf"],[3,"event"],[1,"flex","justify-end","gap-8","mt-4"],[3,"params","loading","showTaxColumn","isDiscount","total_cost","pageChange"],[1,"p-4"],[1,"border","p-4"]],template:function(e,n){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main")(2,"h1",1),t._uU(3,"\u652f\u6255\u4f1d\u7968\u8a73\u7d30"),t.qZA(),t.TgZ(4,"div",2)(5,"div",3)(6,"app-back-to-link-org",4),t._uU(7,"\u4e00\u89a7\u3078\u623b\u308b"),t.qZA(),t.ynx(8),t._UZ(9,"app-edit-link-org",4),t.BQk(),t.qZA()(),t._UZ(10,"hr",5),t.TgZ(11,"div",6)(12,"h2",7),t._uU(13,"\u4f1d\u7968\u30d8\u30c3\u30c0\u30fc"),t.qZA(),t._UZ(14,"hr",8),t.TgZ(15,"div",9)(16,"div",10)(17,"table",11)(18,"tr",12)(19,"td",13)(20,"p",14),t._uU(21,"\u8fd4\u54c1"),t._UZ(22,"br"),t._uU(23,"\u5024\u5f15"),t.qZA()(),t.TgZ(24,"td",15),t._uU(25,"\u4ed5\u5165ID"),t.qZA(),t.TgZ(26,"td",16),t._uU(27,"\u4ed5\u5165\u65e5"),t.qZA(),t.TgZ(28,"td",17),t._uU(29,"\u4ed5\u5165\u5148\u540d"),t.qZA(),t.TgZ(30,"td",17),t._uU(31,"\u767a\u6ce8\u62c5\u5f53\u8005"),t.qZA()(),t.YNc(32,Da,12,9,"tr",18),t.qZA()()()(),t.TgZ(33,"app-slipdetail-search",19),t.NdJ("event",function(o){return n.filter=o}),t.qZA(),t.TgZ(34,"div",20),t._UZ(35,"div"),t.qZA(),t.TgZ(36,"app-purchase-detail-table",21),t.NdJ("pageChange",function(o){return n.pages=o}),t.qZA()()),2&e&&(t.Q6J("breadcrumbList",t.l5B(16,Oa,t.VKq(9,Fa,n.topPagePath),t.VKq(11,Ea,n.listPagePath),t.VKq(13,Sa,n.slipListPagePath),t.DdM(15,Za))),t.xp6(6),t.s9C("path",n.slipListPagePath),t.xp6(3),t.Q6J("path","./edit"),t.xp6(23),t.Q6J("ngIf",n.purchase),t.xp6(4),t.Q6J("params",n.tableParams)("loading",n.common.loading)("showTaxColumn",n.shouldShowTaxColumn())("isDiscount",n.isDiscount)("total_cost",n.tortal_cost))},dependencies:[h.O5,ft.i,R.Z,ie,oe._,xa,h.uU]}),a})();var wa=l(5470);function Ua(a,i){if(1&a&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2,"\u6545\u969c\u72b6\u6cc1"),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.qZA(),t.TgZ(5,"p",20),t._uU(6,"\u6a5f\u7a2e"),t.qZA(),t.TgZ(7,"p",19),t._uU(8),t.qZA(),t.TgZ(9,"p",20),t._uU(10,"\u30e1\u30fc\u30ab\u30fc\u540d"),t.qZA(),t.TgZ(11,"p",19),t._uU(12),t.qZA(),t.TgZ(13,"p",20),t._uU(14,"\u4f5c\u696d\u5de5\u8cc3\u539f\u4fa1"),t.qZA(),t.TgZ(15,"p",19),t._uU(16),t.qZA(),t.TgZ(17,"p",20),t._uU(18,"\u4f5c\u696d\u5de5\u8cc3\u58f2\u4fa1"),t.qZA(),t.TgZ(19,"p",19),t._uU(20),t.qZA(),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(e.failure_status),t.xp6(4),t.Oqu(e.product_name),t.xp6(4),t.Oqu(e.maker_name),t.xp6(4),t.hij(" ",e.quote_cost.toLocaleString()," "),t.xp6(4),t.hij(" ",e.quote_selling_price.toLocaleString()," ")}}function Ia(a,i){if(1&a&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(2),t.AsE(" \u7814\u78e8\uff1a",e.polishing_number," \u679a\uff08",e.product_name,"\uff09 ")}}function Na(a,i){if(1&a&&(t.ynx(0,null,14),t.TgZ(2,"tr")(3,"td",15)(4,"div")(5,"p"),t._uU(6),t.ALo(7,"date"),t.ALo(8,"date"),t.qZA(),t._UZ(9,"hr",16),t.YNc(10,Ua,21,5,"ng-container",9),t.YNc(11,Ia,3,2,"ng-container",9),t.TgZ(12,"div",17)(13,"p",18),t._uU(14,"\u5099\u8003\u53ca\u3073\u30a2\u30c9\u30d0\u30a4\u30b9"),t.qZA(),t._UZ(15,"hr"),t.TgZ(16,"p",19),t._uU(17),t.qZA()()()()(),t.BQk()),2&a){const e=i.$implicit,n=t.oxw(3);t.xp6(6),t.Ywz(" \u4fee\u7406\u500b\u7968\u756a\u53f7\uff1a",e.id,"\u3000\u304a\u5ba2\u69d8\u3054\u4e88\u7b97\uff1a",null==e.customer_budget?null:e.customer_budget.toLocaleString()," \u5186\u3000\u767b\u9332\u65e5\uff1a",t.xi3(7,11,e.created_at,"YYYY/MM/dd HH:mm")," \u767b\u9332\u8005\uff1a",e.employee_created_last_name," ",e.employee_created_first_name," \u66f4\u65b0\u65e5\uff1a",t.xi3(8,14,e.updated_at,"YYYY/MM/dd HH:mm")," \u66f4\u65b0\u8005\uff1a",e.employee_updated_last_name," ",e.employee_updated_first_name," "),t.xp6(4),t.Q6J("ngIf",e.division_repair_type_code===n.repairConst.REPAIR_TYPE_CODE.REPAIR),t.xp6(1),t.Q6J("ngIf",e.division_repair_type_code===n.repairConst.REPAIR_TYPE_CODE.POLISHING),t.xp6(6),t.hij(" ",e.remarks?e.remarks:"\u306a\u3057"," ")}}function Ma(a,i){if(1&a&&(t.ynx(0),t.YNc(1,Na,18,17,"ng-container",13),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.repairs)}}function Ra(a,i){if(1&a&&(t.ynx(0),t.TgZ(1,"table",10)(2,"thead",11)(3,"th",12),t._uU(4,"\u9069\u7528"),t.qZA()(),t.TgZ(5,"tbody",11),t.YNc(6,Ma,2,1,"ng-container",9),t.qZA()(),t.BQk()),2&a){const e=t.oxw();t.xp6(6),t.Q6J("ngIf",e.repairs.length>0)}}const Ba=function(a){return{path:a,text:"\u8a2d\u5b9a\u4e00\u89a7"}},qa=function(a){return{path:a,text:"\u652f\u6255\u30c7\u30fc\u30bf\u4e00\u89a7"}},ka=function(a){return{path:a,text:"\u652f\u6255\u4f1d\u7968\u4e00\u89a7"}},La=function(){return{text:"\u4fee\u7406\u54c1\u8a73\u7d30"}},Ya=function(a,i,e,n){return[a,i,e,n]};let Ja=(()=>{class a{constructor(e,n,r,o,s,u){this.route=e,this.router=n,this.modalService=r,this.errorService=o,this.repairService=s,this.common=u,this.subscription=new S.w0,this.id=this.route.snapshot.params.id,this.topPagePath="/setting",this.listPagePath=`${this.topPagePath}/accounts-payable-aggregate/payment-slip`,this.slipListPagePath=this.listPagePath+"/"+this.id,this.errorModalTitle="\u652f\u6255\u4f1d\u7968\u8a73\u7d30\uff1a"+_.yR.TITLE.HAS_ERROR,this.repairConst=wa.N,this.counts={start:0,end:0}}ngOnInit(){const e=this.route.snapshot.params.repair_id;this.common.loading=!0,console.log("repair-slip-detail id: ",e),this.subscription.add((0,M.D)([this.repairService.find(e)]).pipe((0,v.x)(()=>this.common.loading=!1),(0,g.K)(n=>(0,x.of)(n))).subscribe(n=>{console.log(n),n instanceof b.UA?this.handleError(n.status,n.error?n.error.title:"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002",this.listPagePath):this.repairs=n[0].data}))}handleError(e,n,r){this.errorService.setError({status:e,title:"\u652f\u6255\u4f1d\u7968\u4e00\u89a7\uff1a"+_.yR.TITLE.HAS_ERROR,message:n,redirectPath:r})}ngOnDestroy(){this.subscription.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.gz),t.Y36(y.F0),t.Y36(N.Z),t.Y36(w.T),t.Y36(Ut.Z),t.Y36(C.v))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-repair-slip-detail"]],decls:15,vars:15,consts:[[3,"breadcrumbList"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"flex","flex-row","items-center","gap-6"],[3,"path"],[1,"width-limit-break","border-t","border-gray-400"],[1,"mt-8","py-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[4,"ngIf"],[1,"mt-2","w-[100%]","table-fixed","border-collapse","border","border-slate-500"],[1,"text-sm"],[1,"border","border-slate-500"],[4,"ngFor","ngForOf"],["tempTop",""],[1,"border","border-slate-500","p-2"],[1,"my-2","border-slate-200"],[1,"mt-2","px-3","py-2","bg-slate-100","rounded-md"],[1,"text-xs"],[1,"mt-1"],[1,"mt-2"]],template:function(e,n){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main")(2,"h1",1),t._uU(3,"\u4fee\u7406\u54c1\u8a73\u7d30"),t.qZA(),t.TgZ(4,"div",2)(5,"div",3)(6,"app-back-to-link-org",4),t._uU(7,"\u4e00\u89a7\u3078\u623b\u308b"),t.qZA()()(),t._UZ(8,"hr",5),t.TgZ(9,"div",6)(10,"h2",7),t._uU(11,"\u4fee\u7406\u54c1"),t.qZA(),t._UZ(12,"hr",8),t.TgZ(13,"div"),t.YNc(14,Ra,7,1,"ng-container",9),t.qZA()()()),2&e&&(t.Q6J("breadcrumbList",t.l5B(10,Ya,t.VKq(3,Ba,n.topPagePath),t.VKq(5,qa,n.listPagePath),t.VKq(7,ka,n.slipListPagePath),t.DdM(9,La))),t.xp6(6),t.s9C("path",n.slipListPagePath),t.xp6(8),t.Q6J("ngIf",n.repairs))},dependencies:[h.sg,h.O5,ft.i,R.Z,h.uU]}),a})();var rt=l(4181),se=l(8505),Va=l(3900);let le=(()=>{class a{constructor(e){this.modal=e,this.exportFileExtension="csv",this.text="\u30a8\u30af\u30b9\u30dd\u30fc\u30c8",this.statusChange=new t.vpe}ngOnDestroy(){this.modal.requestCloseModal("cancel")}onClick(){const e="\u30c7\u30fc\u30bf\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u304b\uff1f",n=(0,D.Yc)(this.fileNamePrefix,this.exportFileExtension);this.modal.closeEventObservable$.pipe((0,U.q)(1),(0,Z.h)(()=>this.modal.getModalProperties().title===e),(0,Z.h)(r=>"continue"===r),(0,se.b)(()=>this.statusChange.emit(rt.U.START)),(0,Va.w)(()=>this.export$),(0,se.b)(()=>this.statusChange.emit(rt.U.FETCHED)),(0,Z.h)(r=>!!r),(0,v.x)(()=>this.statusChange.emit(rt.U.END))).subscribe(r=>{this.isJson(r)?(JSON.parse(r),this.modal.setModal("\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f","\u4ef6\u6570\u304c\u591a\u3044\u305f\u3081\u3001\u3054\u767b\u9332\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30ea\u30f3\u30af\u304c\u8a18\u8f09\u3055\u308c\u305f\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002\n\u30e1\u30fc\u30eb\u672c\u6587\u306e\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u203b \u30e1\u30fc\u30eb\u304c\u8ff7\u60d1\u30e1\u30fc\u30eb\u306b\u632f\u308a\u5206\u3051\u3089\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u203b \u30e1\u30fc\u30eb\u304c\u9001\u4fe1\u3055\u308c\u308b\u307e\u3067\u6570\u5206\u304b\u304b\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002","success","\u9589\u3058\u308b","\u9589\u3058\u308b",!1)):(0,D.LR)((0,D.lJ)(r),n)}),this.modal.setModal(e,"\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3068CSV\u30d5\u30a1\u30a4\u30eb\u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u307e\u3059\u3002\n\u7d5e\u308a\u8fbc\u307f\u3092\u884c\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u7d5e\u308a\u8fbc\u307e\u308c\u305f\u30c7\u30fc\u30bf\u304c\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u5bfe\u8c61\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u203b \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u51e6\u7406\u306b\u6570\u5206\u304b\u304b\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002","warning")}isJson(e){try{return JSON.parse(e),!0}catch{return!1}}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(N.Z))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-export-link"]],inputs:{export$:"export$",fileNamePrefix:"fileNamePrefix",exportFileExtension:"exportFileExtension",text:"text"},outputs:{statusChange:"statusChange"},decls:4,vars:1,consts:[["icon","download-cloud-2-fill","appendClassForIcon","fill-primary-light",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div")(1,"app-icon-container",0),t.NdJ("click",function(){return n.onClick()}),t.TgZ(2,"span"),t._uU(3),t.qZA()()()),2&e&&(t.xp6(3),t.Oqu(n.text))},dependencies:[ae.J],styles:['div[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:relative;cursor:pointer}div[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:after{position:absolute;left:0;bottom:-4px;height:1px;width:100%;--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity));--tw-content: "";transform-origin:top left;--tw-scale-x: 0;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));content:var(--tw-content);transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}div[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:hover:after{content:var(--tw-content);--tw-scale-x: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}']}),a})();var Qa=l(8656);function ja(a,i){1&a&&t.GkF(0,23)}function Ka(a,i){1&a&&t.GkF(0)}function Ga(a,i){1&a&&t.GkF(0,23)}function $a(a,i){1&a&&t.GkF(0)}function Ha(a,i){1&a&&t.GkF(0,23)}function za(a,i){1&a&&t.GkF(0,23)}function Xa(a,i){if(1&a&&(t.TgZ(0,"div",24)(1,"span"),t._uU(2),t.qZA()()),2&a){const e=i.label;t.xp6(2),t.Oqu(e)}}function Wa(a,i){if(1&a&&(t.TgZ(0,"p",27),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MIN_LIMIT," ")}}function tr(a,i){if(1&a&&(t.TgZ(0,"p",27),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function er(a,i){if(1&a&&(t.ynx(0),t.YNc(1,Wa,2,1,"p",26),t.YNc(2,tr,2,1,"p",26),t.BQk()),2&a){const e=t.oxw().ctrl,n=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.minlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===n.regExConst.NUMERIC_REG_EX+"")}}function nr(a,i){if(1&a&&t.YNc(0,er,3,2,"ng-container",25),2&a){const e=i.ctrl,n=t.oxw();t.Q6J("ngIf",n.invalid(e))}}function ar(a,i){if(1&a&&(t.TgZ(0,"p",28),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}const Bt=function(a){return{ctrl:a}},rr=function(){return{label:"\u652f\u6255\u5148",required:"false"}},ir=function(){return{label:"\u767b\u9332\u8005",required:"false"}};let or=(()=>{class a{constructor(e,n,r,o,s,u,p,m){this.fb=e,this.common=n,this.paymentService=r,this.modalService=o,this.supplierService=s,this.employeeService=u,this.errorService=p,this.flashMessageService=m,this.event=new t.vpe,this.isOpen=!1,this.rotateAnimation="",this.subscription=new S.w0,this.errorConst=A.c,this.regExConst=$.m,this.listPagePath="/setting",this.errorModalTitle="\u652f\u6255\u6d88\u8fbc\u4e00\u89a7\u53d6\u5f97\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.localStorageKey="filterParams-payment-clearing",this.options={cutoff_date_billing:[]},this.searchForm=this.fb.group({payment_id:"",supplier_id:"",cutoff_date_billing:"",created_id:"",payment_date:this.fb.group({from:"",to:""},{validators:[k.d.beforeFromDate()]})})}get ctrls(){return this.searchForm.controls}ngOnInit(){this.searchForm=this.setSearchClear(),this.initOptions()}ngOnDestroy(){this.subscription.unsubscribe()}searchButtonOnClick(){this.isOpen=!this.isOpen,this.rotateAnimation=this.isOpen?"rotate-animation-180":"rotate-animation-0"}onClickReset(){this.searchForm.reset(),this.searchForm=this.setSearchClear(),this.clearFilterParams()}onClickSubmit(){const e=(0,D.vP)(this.removeNullsAndBlanks(this.searchForm.value));this.event.emit(e)}invalid(e){return(e.touched||e.dirty)&&e.invalid}removeNullsAndBlanks(e){const n={};for(const[r,o]of Object.entries(e))null!=o&&""!==o&&(n[r]=o);return n}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getFormControlTypeValue(e,n){return e.get(n)}initOptions(){this.common.loading=!0;const e=this.loadFilterParams();for(let n=1;n<31;n++)this.options.cutoff_date_billing.push({value:n,text:n+"\u65e5"});if(this.options.cutoff_date_billing.push({value:99,text:"\u672b\u65e5"},{value:98,text:"\u7121\u3057"}),e){if("from_payment_date"in e){let n=this.convertStringToDate(e.from_payment_date);isNaN(n.getTime())?this.ctrls.payment_date.controls.from.setValue(""):this.ctrls.payment_date.controls.from.setValue(n.toISOString())}if("to_payment_date"in e){let n=this.convertStringToDate(e.to_payment_date);isNaN(n.getTime())?this.ctrls.payment_date.controls.to.setValue(""):this.ctrls.payment_date.controls.to.setValue(n.toISOString())}this.setSearchArgs(e)}this.subscription.add((0,M.D)([this.supplierService.getAsSelectOptions(),this.employeeService.getAsSelectOptions()]).pipe((0,v.x)(()=>this.common.loading=!1),(0,g.K)(n=>(0,x.of)(n))).subscribe(n=>{n instanceof b.UA?this.handleError(n.status,this.errorModalTitle,n.message):null!=n&&2===n.length?(this.supplierSuggests=n[0],this.employeeSuggests=n[1],e&&Object.entries(e).forEach(([r,o])=>{if("created_id"===r){const s=this.employeeSuggests.find(u=>Number(u.value)===Number(e.created_id));this.ctrls.created_id.patchValue(String(s?.value))}if("supplier_id"===r){const s=this.supplierSuggests.find(u=>Number(u.value)===Number(e.supplier_id));this.ctrls.supplier_id.patchValue(String(s?.value))}})):this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR)}))}handleError(e,n,r){this.errorService.setError({status:e,title:n,message:r,redirectPath:this.listPagePath})}setSearchClear(){return this.fb.group({payment_id:"",supplier_id:"",cutoff_date_billing:"",created_id:"",payment_date:this.fb.group({from:"",to:""},{validators:[k.d.beforeFromDate()]})})}saveFilterParams(e){localStorage.setItem(this.localStorageKey,JSON.stringify(e))}loadFilterParams(){const e=localStorage.getItem(this.localStorageKey);return e?JSON.parse(e):null}clearFilterParams(){localStorage.removeItem(this.localStorageKey)}convertStringToDate(e){return new Date(Date.parse(e))}setSearchArgs(e){Object.entries(e).forEach(([n,r])=>{"from_payment_date"===n||"to_payment_date"===n||"created_id"===n||"supplier_id"===n||n in this.searchForm.controls&&this.searchForm.controls[n].setValue(r)}),this.searchForm.patchValue(e)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.qu),t.Y36(C.v),t.Y36(nt),t.Y36(N.Z),t.Y36(Q.p),t.Y36(at.G),t.Y36(w.T),t.Y36(L.P))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-search"]],outputs:{event:"event"},decls:40,vars:38,consts:[[1,"mt-8","mb-4"],[3,"click"],["icon","filter-2-line",1,"w-6"],[1,"inline-block","ml-1","mr-2"],["icon","arrow-down-s-fill",1,"w-6"],[1,"search","width-limit-break","bg-white",3,"ngClass"],[1,"w-[1280px]","mx-auto","px-4"],[1,"flex","gap-6","mt-6"],[1,"w-1/6",3,"formCtrl"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-2/5"],["nameAttrValue","supplier_id","idAttrValue","supplier-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-1/6",3,"formCtrl","options","useClear"],["nameAttrValue","created_id","idAttrValue","created-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],[1,"flex","gap-8","mt-10"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[1,"mt-2","text-sm","text-red"],["labels",""],["errors",""],["beforeFromDate",""],["message",""],[1,"flex","items-center","gap-2"],[4,"ngIf"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return n.searchButtonOnClick()}),t._UZ(2,"app-icon",2),t.TgZ(3,"span",3),t._uU(4),t.qZA(),t._UZ(5,"app-icon",4),t.qZA()(),t.TgZ(6,"div",5)(7,"form",6)(8,"div",7)(9,"app-text-clear-container",8),t._uU(10," \u652f\u6255ID "),t.YNc(11,ja,1,0,"ng-container",9),t.qZA(),t.TgZ(12,"div",10)(13,"app-select-suggest-container",11),t.YNc(14,Ka,1,0,"ng-container",12),t.YNc(15,Ga,1,0,"ng-container",9),t.qZA()()(),t.TgZ(16,"div",7)(17,"app-select",13),t._uU(18," \u7de0\u65e5 "),t.qZA(),t.TgZ(19,"div",10)(20,"app-select-suggest-container",14),t.YNc(21,$a,1,0,"ng-container",12),t.YNc(22,Ha,1,0,"ng-container",9),t.qZA()()(),t.TgZ(23,"div",7)(24,"app-date-term-clear-container",15),t._uU(25," \u652f\u6255\u65e5 "),t.YNc(26,za,1,0,"ng-container",16),t.qZA()(),t.TgZ(27,"div",17)(28,"app-button",1),t.NdJ("click",function(){return n.onClickReset()}),t._uU(29,"\u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2"),t.qZA(),t.TgZ(30,"app-button",18),t.NdJ("click",function(){return n.onClickSubmit()}),t._uU(31," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA()(),t.TgZ(32,"p",19),t._uU(33," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()(),t.YNc(34,Xa,3,1,"ng-template",null,20,t.W1O),t.YNc(36,nr,1,1,"ng-template",null,21,t.W1O),t.YNc(38,ar,2,1,"ng-template",null,22,t.W1O)),2&e){const r=t.MAs(35),o=t.MAs(37),s=t.MAs(39);t.xp6(4),t.hij(" ",n.isOpen?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(n.rotateAnimation),t.xp6(1),t.Q6J("ngClass",n.isOpen?"is-open shadow":""),t.xp6(3),t.Q6J("formCtrl",n.ctrls.payment_id),t.xp6(2),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(30,Bt,n.ctrls.payment_id)),t.xp6(2),t.Q6J("formCtrl",n.ctrls.supplier_id)("suggests",n.supplierSuggests)("invalid",n.formControlStateManager(n.ctrls.supplier_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(32,rr)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(33,Bt,n.ctrls.supplier_id)),t.xp6(2),t.Q6J("formCtrl",n.ctrls.cutoff_date_billing)("options",n.options.cutoff_date_billing)("useClear",!0),t.xp6(3),t.Q6J("formCtrl",n.ctrls.created_id)("suggests",n.employeeSuggests)("invalid",n.formControlStateManager(n.ctrls.created_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(35,ir)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(36,Bt,n.ctrls.created_id)),t.xp6(2),t.Q6J("dateFromFormCtrl",n.ctrls.payment_date.controls.from)("dateToFormCtrl",n.ctrls.payment_date.controls.to)("invalid",!!n.ctrls.payment_date.errors),t.xp6(2),t.Q6J("ngIf",null==n.ctrls.payment_date.errors?null:n.ctrls.payment_date.errors.beforeFromDate)("ngIfThen",s),t.xp6(4),t.Q6J("buttonDisabled",n.searchForm.invalid)}},dependencies:[h.mk,h.O5,h.tP,c._Y,c.JL,Qa.H,V.w,I.r,B.o,Ot.P,j.X],styles:[".search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease;overflow:hidden}.search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0}"]}),a})();const sr=function(a){return{path:a,text:"\u8a2d\u5b9a\u4e00\u89a7"}},lr=function(){return{text:"\u652f\u6255\u6d88\u8fbc\u4e00\u89a7"}},ur=function(a,i){return[a,i]};let ue=(()=>{class a{constructor(e,n,r,o){this.fb=e,this.common=n,this.service=r,this.paymentDetailDomain=o,this.topPagePath="/setting",this.localStorageKey="filterParams-payment-clearing",this._filter={},this.defaultSort={column:"\u652f\u6255ID",order:"desc"},this._pages={page:1,itemsPerPage:10,sort:this.defaultSort},this.tableParams=new O.x,this.tableNameMapping=[{name:"payment_id",name_jp:"\u652f\u6255ID"},{name:"payment_supplier_name",name_jp:"\u652f\u6255\u5148"},{name:"payment_date",name_jp:"\u652f\u6255\u65e5"},{name:"payment_type_division_code",name_jp:"\u652f\u6255\u533a\u5206"},{name:"payment_amount",name_jp:"\u652f\u6255\u984d"},{name:"employee_created_last_name",name_jp:"\u767b\u9332\u8005"}],this.fileNamePrefix="\u652f\u6255\u6d88\u8fbc\u4e00\u89a7",this.errorConst=A.c}set filter(e){this.saveFilterParams(e),this._filter=e,this._pages.page=1,this.callApi()}set pages(e){this._pages=e,this.callApi()}get export$(){return this.service.getCsv("csv",{...this._filter}).pipe((0,g.K)(this.service.handleErrorModal("")),(0,v.x)(()=>this.common.loading=!1))}ngOnInit(){const e=this.loadFilterParams();e&&(this._filter=e),this.callApi()}onExportStatusChange(e){e===rt.U.START&&(this.common.loading=!0)}callApi(){this.common.loading=!0;let e=this.createApiParams();this.service.getAll(e).pipe((0,g.K)(this.service.handleErrorModal()),(0,v.x)(()=>this.common.loading=!1)).subscribe(n=>{console.log(e),delete e.limit,console.log(e);let r=0;this.service.getAll(e).pipe((0,g.K)(this.service.handleErrorModal()),(0,v.x)(()=>this.common.loading=!1)).subscribe(o=>{console.log(o),r=o.data.map(m=>({payment_amount:Number(m.payment_amount),payment_type_division_code:m.payment_type_division_code})).reduce((m,d)=>d.payment_type_division_code===q._.STATUS_CODE.CASH||d.payment_type_division_code===q._.STATUS_CODE.TRANSFER?m+d.payment_amount:d.payment_type_division_code===q._.STATUS_CODE.DISCOUNT?m-d.payment_amount:m,0);const u=["","","","\u5408\u8a08",r.toLocaleString(),""],p=this.paymentDetailDomain.createTableParams(n,this.tableNameMapping,m=>this.paymentDetailDomain.modifiedTableBody(m,"./detail-view","payment_id"),u);this.tableParams.next(p)})})}createApiParams(){0===Object.keys(this._pages.sort).length&&(this._pages.sort=this.defaultSort);const e=this.tableNameMapping.find(r=>r.name_jp===this._pages.sort.column)?.name;let n;return n="payment_supplier_name"===e?"payment_supplier_name_kana":"employee_created_last_name"===e?"employee_created_last_name_kana":e,{...this._filter,limit:this._pages.itemsPerPage,offset:(this._pages.page-1)*this._pages.itemsPerPage,sort:n?`${n}:${this._pages.sort.order}`:""}}saveFilterParams(e){localStorage.setItem(this.localStorageKey,JSON.stringify(e))}loadFilterParams(){const e=localStorage.getItem(this.localStorageKey);return e?JSON.parse(e):null}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.qu),t.Y36(C.v),t.Y36(H),t.Y36(It))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-list"]],decls:9,vars:10,consts:[[3,"breadcrumbList"],[3,"event"],[1,"flex","justify-end","gap-8","mt-4"],["path","../payment-clearing/add"],["text","\u652f\u6255\u6d88\u8fbc\u4e00\u89a7CSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3000",3,"export$","fileNamePrefix","statusChange"],[1,"block","mt-2",3,"params","pageChange"]],template:function(e,n){1&e&&(t._UZ(0,"app-breadcrumb-org",0)(1,"app-toggle-button"),t.TgZ(2,"app-search",1),t.NdJ("event",function(o){return n.filter=o}),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"div")(5,"app-new-registration-link-org",3),t.TgZ(6,"app-export-link",4),t.NdJ("statusChange",function(o){return n.onExportStatusChange(o)}),t.qZA()(),t.TgZ(7,"app-table-with-pagination",5),t.NdJ("pageChange",function(o){return n.pages=o}),t._uU(8," \u652f\u6255\u6d88\u8fbc\u4e00\u89a7\n"),t.qZA()),2&e&&(t.Q6J("breadcrumbList",t.WLB(7,ur,t.VKq(4,sr,n.topPagePath),t.DdM(6,lr))),t.xp6(6),t.Q6J("export$",n.export$)("fileNamePrefix",n.fileNamePrefix),t.xp6(1),t.Q6J("params",n.tableParams))},dependencies:[gt.i,ht,ne.S,le,R.Z,or]}),a})();function pr(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"app-input-pair",6),t.NdJ("add",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.addTagForm())})("remove",function(){const o=t.CHM(e).index,s=t.oxw();return t.KtG(s.removeTagForm(o))}),t.qZA()}if(2&a){const e=i.$implicit,n=i.index,r=t.oxw();t.Q6J("formGroup",e)("paymentDetail",r.paymentDetail)("index",n)}}let pe=(()=>{class a{constructor(e,n){this.fb=e,this.paymentDetailService=n,this.err=new t.vpe,this.paymentDetail=[],this.template={id:"",payment_id:"",payment_type_division_code:"",payment_amount:"",scheduled_payment_amount:"",payment_date:"",remarks_1:""},this.subscription=new S.w0}ngOnInit(){console.log(this.paymentDetail),this.delArray.removeAt(0),this.subscription.add(this.paymentDetailService.getAll({id:this.itemsId}).pipe((0,g.K)(this.handleError())).subscribe(e=>{console.log(this.itemsId),this.paymentDetail=e.data,console.log(e.data)}))}addTagForm(){this.formArray.push(this.fb.group(this.template))}removeTagForm(e){this.delArray.push(this.formArray.at(e)),this.formArray.removeAt(e),console.log(this.formArray)}handleError(){return e=>(this.err.emit(e),(0,x.of)({}))}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.qu),t.Y36(H))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-payment-clearing-detail"]],inputs:{itemsId:"itemsId",formArray:"formArray",delArray:"delArray"},outputs:{err:"err"},decls:15,vars:1,consts:[[1,""],[1,"flex","flex-row","items-center","bg-slate-100"],[1,"py-3","px-3","border-l-gray-200","bg-slate-100","w-44"],["_ngcontent-vao-c201","",1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[1,"py-3","px-3","border-l-gray-200","bg-slate-100","min-w-[200px]"],[3,"formGroup","paymentDetail","index","add","remove",4,"ngFor","ngForOf"],[3,"formGroup","paymentDetail","index","add","remove"]],template:function(e,n){1&e&&(t.TgZ(0,"ul",0)(1,"li",1)(2,"div",2),t._uU(3," \u652f\u6255\u533a\u5206"),t.TgZ(4,"span",3),t._uU(5," \u5fc5\u9808 "),t.qZA()(),t.TgZ(6,"div",2),t._uU(7,"\u91d1\u984d"),t.qZA(),t.TgZ(8,"div",2),t._uU(9,"\u652f\u6255\u4e88\u5b9a\u984d"),t.qZA(),t.TgZ(10,"div",2),t._uU(11,"\u652f\u6255\u65e5"),t.qZA(),t.TgZ(12,"div",4),t._uU(13," \u5099\u8003 "),t.qZA()()(),t.YNc(14,pr,1,3,"app-input-pair",5)),2&e&&(t.xp6(14),t.Q6J("ngForOf",n.formArray.controls))}}),a})();var qt=l(387),ce=l(228);function cr(a,i){1&a&&t.GkF(0)}function mr(a,i){1&a&&t.GkF(0,29)}function dr(a,i){1&a&&t.GkF(0)}function _r(a,i){1&a&&t.GkF(0,29)}function hr(a,i){1&a&&t.GkF(0)}function gr(a,i){1&a&&t.GkF(0,29)}function fr(a,i){if(1&a&&(t.TgZ(0,"p",30),t._uU(1),t.qZA()),2&a){const e=i.message;t.xp6(1),t.hij(" ",e," ")}}function br(a,i){1&a&&(t.TgZ(0,"span",33),t._uU(1,"\u5fc5\u9808"),t.qZA())}function vr(a,i){if(1&a&&(t.TgZ(0,"div",31)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,br,2,0,"span",32),t.qZA()),2&a){const e=i.label,n=i.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",n)}}function yr(a,i){if(1&a&&(t.TgZ(0,"p",36),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function Cr(a,i){if(1&a&&(t.ynx(0),t.YNc(1,yr,2,1,"p",35),t.BQk()),2&a){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required)}}function Tr(a,i){if(1&a&&t.YNc(0,Cr,2,1,"ng-container",34),2&a){const e=i.ctrl,n=t.oxw();t.Q6J("ngIf",n.formControlStateManager(e))}}function Ar(a,i){if(1&a&&(t.ynx(0),t.TgZ(1,"p",36),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.errorConst.FORM_ERROR.DATE_SPECIFICATION_VIOLATION," ")}}function xr(a,i){if(1&a&&t.YNc(0,Ar,3,1,"ng-container",34),2&a){const e=i.ctrls;t.Q6J("ngIf",null==e.errors?null:e.errors.endingDateIsSmaller)}}const Dr=function(){return{label:"\u4ed5\u5165\u5148",required:"true"}},kt=function(a){return{ctrl:a}},Fr=function(){return{label:"\u767b\u9332\u8005",required:"true"}},Er=function(){return{label:"\u5099\u8003",required:!1}};let Sr=(()=>{class a{constructor(e,n,r,o,s,u,p,m,d,f,T,F){this.route=e,this.router=n,this.modalService=r,this.flashMessageService=o,this.fb=s,this.authorService=u,this.supplierService=p,this.employeeService=m,this.errorService=d,this.paymentService=f,this.paymentDetailService=T,this.common=F,this.subscription=new S.w0,this.breadcrumbList=[],this.id=this.route.snapshot.params.id,this.url=this.router.url,this.detailUrl=this.url.replace("detail-edit","detail-view"),this.listlUrl=this.id?"../../":this.url.replace("/add",""),this.prevUrl=this.id?`${this.detailUrl}`:`${this.listlUrl}`,this.pageTitle=this.id?"\u652f\u6255\u6d88\u8fbc\u7de8\u96c6":"\u652f\u6255\u6d88\u8fbc\u65b0\u898f\u767b\u9332",this.detailPagePath=this.prevUrl,this.authorTitle=this.id?"\u66f4\u65b0\u8005":"\u767b\u9332\u8005",this.paymentIdValue=this.id?"\u3000\u652f\u6255ID\uff1a"+this.id:"",this.updater="\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...",this.authorname="\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...",this.topPagePath="/setting",this.listPagePath="/setting/accounts-payable-aggregate/payment-clearing",this.cancelModalTitle=this.pageTitle+"\u30ad\u30e3\u30f3\u30bb\u30eb\uff1a"+_.yR.TITLE.CANCEL,this.errorModalTitle=this.pageTitle+"\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.redirectPath=this.prevUrl,this.errorConst=A.c,this.form=this.fb.group({supplier_id:["",[c.kI.required]],created_id:["",[c.kI.required]],remarks_1:[""],payment_detail:this.fb.array([this.fb.group({id:[""],payment_id:[""],payment_type_division_code:[""],payment_amount:[""],scheduled_payment_amount:[""],payment_date:[""],remarks_1:[""]})]),payment_detail_del:this.fb.array([this.fb.group({id:[""],payment_id:[""],payment_type_division_code:[""],payment_amount:[""],scheduled_payment_amount:[""],payment_date:[""],remarks_1:[""]})])}),this.paymentDetailAny=[],this.paymentAddForms=this.fb.group({forms:this.fb.array([])})}get ctrls(){return this.form.controls}get paymentAddFormsArray(){return this.paymentAddForms.get("forms")}get paymentAddFormsArrayControls(){return this.paymentAddFormsArray.controls}ngOnInit(){if(this.breadcrumbList=this.createBreadcrumbList(this.router.url),this.authorService.author?(this.author=this.authorService.author,this.ctrls.created_id.patchValue(String(this.author.id)),this.initOptions()):this.subscription.add(this.authorService.author$.subscribe(n=>{this.author=n,this.ctrls.created_id.patchValue(String(this.author.id)),this.initOptions()})),this.id||(this.detailPagePath=this.listPagePath),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,Z.h)(n=>this.modalService.getModalProperties().title===this.cancelModalTitle)).subscribe(n=>{n===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.detailPagePath)})),this.handleSelectSupplier(),!this.id)return;const e=this.id?"\u652f\u6255\u6d88\u8fbc\u95b2\u89a7":"\u652f\u6255\u6d88\u8fbc\u65b0\u898f\u767b\u9332";this.subscription.add(this.paymentService.find(this.id).pipe((0,g.K)(n=>(0,x.of)(n)),(0,v.x)(()=>this.common.loading=!1)).subscribe(n=>{if(n instanceof b.UA)return void this.handleError(n.status,e+_.yR.TITLE.HAS_ERROR,n.error.message);if((0,D.bz)(n))return void this.handleError(400,e+_.yR.TITLE.HAS_ERROR,A.c.COULD_NOT_GET_DATA);const o=n.data[0];this.form.controls.supplier_id.patchValue(String(o.supplier_id)),this.form.controls.created_id.patchValue(String(o.created_id)),this.form.controls.remarks_1.patchValue(String(o.remarks_1))})),this.subscription.add(this.paymentDetailService.getAll({payment_id:this.id}).pipe((0,g.K)(this.paymentDetailService.handleErrorModal()),(0,v.x)(()=>this.common.loading=!1)).subscribe(n=>{if(n instanceof b.UA)return void this.handleError(n.status,e+_.yR.TITLE.HAS_ERROR,n.error.message);if((0,D.bz)(n))return void this.handleError(400,e+_.yR.TITLE.HAS_ERROR,A.c.COULD_NOT_GET_DATA);const o=n.data;o.length&&this.form.controls.payment_detail.clear(),o.map(s=>this.form.controls.payment_detail.push(this.fb.group({id:s.id+"",payment_id:s.payment_id+"",payment_type_division_code:s.payment_type_division_code+"",payment_amount:s.payment_amount+"",scheduled_payment_amount:s.scheduled_payment_amount?s.scheduled_payment_amount+"":"",payment_date:s.payment_date+"",remarks_1:s.remarks_1})))}))}ngOnDestroy(){this.subscription.unsubscribe()}initOptions(){this.common.loading=!0,this.subscription.add((0,M.D)([this.supplierService.getAsSelectOptions(),this.employeeService.getAsSelectOptions()]).pipe((0,v.x)(()=>this.common.loading=!1),(0,g.K)(e=>(0,x.of)(e))).subscribe(e=>{e instanceof b.UA?this.handleError(e.status,this.errorModalTitle,e.message):null!=e&&2===e.length?(this.supplierSuggests=e[0],this.employeeSuggests=e[1]):this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR)}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleClickCancel(){this.form.pristine?this.router.navigateByUrl(this.detailPagePath):this.modalService.setModal(this.cancelModalTitle,_.yR.BODY.CANCEL,"warning",_.yR.BUTTON_TITLE.EXECUTION,_.yR.BUTTON_TITLE.CANCEL)}handleClickSaveButton(){this.form.markAsPristine(),this.common.loading=!0;const e=this.form.value;if(!this.employeeSuggests.some(d=>Number(d.value)===Number(e.created_id)))return this.ctrls.created_id.setValue(""),void(this.common.loading=!1);if(!this.supplierSuggests.some(d=>Number(d.value)===Number(e.supplier_id)))return this.ctrls.supplier_id.setValue(""),void(this.common.loading=!1);this.id&&this.ctrls.payment_detail_del.getRawValue().forEach(f=>{f.id&&this.paymentDetailService.remove(f.id).pipe((0,g.K)(T=>(0,x.of)(T)),(0,v.x)(()=>this.common.loading=!1)).subscribe(T=>{T instanceof b.UA&&this.handleError(T.status,this.errorModalTitle,T.error.message)})}),this.paymentDetailAny=[],this.ctrls.payment_detail.getRawValue().forEach(d=>{const f={id:"",payment_id:d.payment_id,payment_type_division_code:d.payment_type_division_code,payment_amount:d.payment_amount,scheduled_payment_amount:d.scheduled_payment_amount,payment_date:d.payment_date?new Date(String(d.payment_date)).toLocaleString():"",remarks_1:d.remarks_1};d.id&&(f.id=d.id),this.paymentDetailAny.push(f)});const s={supplier_id:Number(e.supplier_id),created_id:Number(e.created_id),remarks_1:String(e.remarks_1),payment_detail:[...this.paymentDetailAny]};console.log(s);let u=this.paymentService.add(s);this.id&&(u=this.paymentService.update(this.id,s)),u.pipe((0,g.K)(d=>(0,x.of)(d)),(0,v.x)(()=>this.common.loading=!1)).subscribe(d=>{d instanceof b.UA?this.handleError(d.status,this.errorModalTitle,d.error.message):(this.flashMessageService.setFlashMessage(d.message,"success",15e3),this.router.navigateByUrl(this.prevUrl))})}handleError(e,n,r){this.errorService.setError({status:e,title:n,message:r});const o="danger";console.log(e),400!==e?(console.log(e),this.modalService.setModal(n,`\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9: ${e} \n\u30e1\u30c3\u30bb\u30fc\u30b8: `+r+A.c.GUIDANCE_OF_SUPPORT,o,_.yR.BUTTON_TITLE.CLOSE,""),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,U.q)(1),(0,Z.h)(s=>this.modalService.getModalProperties().title===n)).subscribe(s=>{this.redirectPath&&this.router.navigateByUrl(this.redirectPath)}))):this.modalService.setModal(n,r+A.c.GUIDANCE_OF_SUPPORT,o,_.yR.BUTTON_TITLE.CLOSE,"")}calc(){let e=0;return this.ctrls.payment_detail.getRawValue().forEach(r=>{e+=Number(r.payment_amount)}),Math.floor(e)}createBreadcrumbList(e){e.replace(/.*\/accounts-payable-aggregate\/?/,"").split("/");const u=[{path:"/setting",text:"\u8a2d\u5b9a\u4e00\u89a7"},{path:this.listlUrl,text:"\u652f\u6255\u6d88\u8fbc\u4e00\u89a7"},{path:this.id?`${this.detailUrl}`:"",text:this.id?"\u652f\u6255\u6d88\u8fbc\u8a73\u7d30\u95b2\u89a7":"\u652f\u6255\u6d88\u8fbc\u65b0\u898f\u767b\u9332"}];return!!this.id&&u.push({text:"\u652f\u6255\u6d88\u8fbc\u7de8\u96c6"}),u}handleSelectSupplier(){console.log("handleSelectSupplier"),this.ctrls.supplier_id.valueChanges.subscribe(e=>{null!==e&&""!==e&&void 0!==e?this.supplierService.find(Number(e)).pipe((0,g.K)(this.supplierService.handleErrorModal())).subscribe(n=>{n instanceof b.UA?this.handleError(n.status,this.errorModalTitle,n.error.message):(0,D.bz)(n)?this.handleError(400,this.errorModalTitle,A.c.COULD_NOT_GET_DATA):this.supplier=n.data[0]}):this.supplier=this.initSupplier})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.gz),t.Y36(y.F0),t.Y36(N.Z),t.Y36(L.P),t.Y36(c.qu),t.Y36(dt.Y),t.Y36(Q.p),t.Y36(at.G),t.Y36(w.T),t.Y36(nt),t.Y36(H),t.Y36(C.v))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-add-edit"]],decls:53,vars:41,consts:[[3,"breadcrumbList"],[1,"mb-8"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"cursor-pointer",3,"click"],[3,"roleTypeName"],[1,"width-limit-break","border-t","border-gray-400"],[3,"formGroup","ngSubmit"],[1,"mt-8","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"flex","gap-6","mt-6","mb-6"],[1,"w-2/5"],["nameAttrValue","supplier_id","idAttrValue","supplier-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060xx\u3055\u3044",3,"formCtrl","suggests","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],["nameAttrValue","created_id","idAttrValue","created-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[1,"w-1/2"],["nameAttrValue","remarks_1","idAttrValue","remarks-1",3,"formCtrl","invalid"],[1,"mt-6","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-100"],[1,"block","mt-6",3,"itemsId","formArray","delArray"],[1,"mt-6","mb-24","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-100"],[1,"flex","justify-end","gap-8","mt-4"],[1,"width-limit-break","bg-primary-light","flex","flex-row","justify-center","bottom-[40px]","left-0","right-0","p-2","fixed","gap-8"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["em",""],["labels",""],["errors",""],["dateErrors",""],["message",""],[1,"text-sm","text-red"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[4,"ngIf"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,n){if(1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main",1)(2,"h1",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3)(5,"div",4),t.NdJ("click",function(){return n.handleClickCancel()}),t._UZ(6,"app-cancel-link-org"),t.qZA(),t.TgZ(7,"div")(8,"app-last-updater-org",5),t._uU(9),t.qZA()()(),t._UZ(10,"hr",6),t.TgZ(11,"form",7),t.NdJ("ngSubmit",function(){return n.handleClickSaveButton()}),t.TgZ(12,"div",8)(13,"h2",9),t._uU(14),t.qZA(),t._UZ(15,"hr",10),t.TgZ(16,"div",11)(17,"div",12)(18,"app-select-suggest-container",13),t.YNc(19,cr,1,0,"ng-container",14),t.YNc(20,mr,1,0,"ng-container",15),t.qZA()(),t.TgZ(21,"div",12)(22,"app-select-suggest-container",16),t.YNc(23,dr,1,0,"ng-container",14),t.YNc(24,_r,1,0,"ng-container",15),t.qZA()()(),t.TgZ(25,"div",11)(26,"div",17)(27,"app-textarea-container",18),t.YNc(28,hr,1,0,"ng-container",14),t.YNc(29,gr,1,0,"ng-container",15),t.qZA()()()(),t.TgZ(30,"div",19)(31,"h2",9),t._uU(32,"\u5165\u91d1\u660e\u7d30"),t.qZA(),t._UZ(33,"hr",10)(34,"app-payment-clearing-detail",20),t.qZA(),t.TgZ(35,"div",21)(36,"h2",9),t._uU(37,"\u652f\u6255\u6b8b\u9ad8"),t.qZA(),t._UZ(38,"hr",10),t.TgZ(39,"div",22)(40,"h2",9),t._uU(41),t.qZA()()(),t.TgZ(42,"div",23)(43,"app-button",24),t._uU(44,"\u4fdd\u5b58"),t.qZA()()()(),t.YNc(45,fr,2,1,"ng-template",null,25,t.W1O),t.YNc(47,vr,4,2,"ng-template",null,26,t.W1O),t.YNc(49,Tr,1,1,"ng-template",null,27,t.W1O),t.YNc(51,xr,1,1,"ng-template",null,28,t.W1O)),2&e){const r=t.MAs(48),o=t.MAs(50);t.Q6J("breadcrumbList",n.breadcrumbList),t.xp6(3),t.Oqu(n.pageTitle),t.xp6(5),t.Q6J("roleTypeName",n.author&&n.author.role_name?n.author.role_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.xp6(1),t.AsE(" ",n.authorTitle,"\uff1a",n.author?n.author.last_name+" "+n.author.first_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."," "),t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(3),t.hij("\u652f\u6255\u6d88\u8fbc\u60c5\u5831\u5165\u529b",n.paymentIdValue,""),t.xp6(4),t.Q6J("formCtrl",n.ctrls.supplier_id)("suggests",n.supplierSuggests)("invalid",n.formControlStateManager(n.ctrls.supplier_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(32,Dr)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(33,kt,n.ctrls.supplier_id)),t.xp6(2),t.Q6J("formCtrl",n.ctrls.created_id)("suggests",n.employeeSuggests)("invalid",n.formControlStateManager(n.ctrls.created_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(35,Fr)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(36,kt,n.ctrls.created_id)),t.xp6(3),t.Q6J("formCtrl",n.ctrls.remarks_1)("invalid",n.formControlStateManager(n.ctrls.remarks_1)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(38,Er)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(39,kt,n.ctrls.remarks_1)),t.xp6(5),t.Q6J("itemsId",n.id)("formArray",n.ctrls.payment_detail)("delArray",n.ctrls.payment_detail_del),t.xp6(7),t.hij("",n.calc(),"\u5186"),t.xp6(2),t.Q6J("buttonDisabled",n.form.invalid||n.form.pristine)}},dependencies:[h.O5,h.tP,pe,c._Y,c.JL,c.sg,qt.K,I.r,ce.t,R.Z,j.X,_t.R]}),a})();function Zr(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"app-input-pair",8),t.NdJ("add",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.addTagForm())})("remove",function(){const o=t.CHM(e).index,s=t.oxw();return t.KtG(s.removeTagForm(o))}),t.qZA()}if(2&a){const e=i.$implicit,n=i.index,r=t.oxw();t.Q6J("formGroup",e)("index",n)("paymentDate",r.paymentDate)}}let me=(()=>{class a{constructor(e){this.fb=e,this.err=new t.vpe,this.paymentDetail=[],this.template={id:"",payment_id:"",payment_supplier_id:"",payment_supplier_name:"",scheduled_payment_amount:"",payment_type_division_code:"",payment_amount:"",payment_date:"",remarks_1:""}}ngOnInit(){this.delArray.removeAt(0)}addTagForm(){this.formArray.push(this.fb.group(this.template))}removeTagForm(e){this.delArray.push(this.formArray.at(e)),this.formArray.removeAt(e)}handleError(){return e=>(this.err.emit(e),(0,x.of)({}))}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.qu))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-payment-clearing-add-detail"]],inputs:{itemsId:"itemsId",paymentDate:"paymentDate",formArray:"formArray",delArray:"delArray"},outputs:{err:"err"},decls:19,vars:1,consts:[[1,""],[1,"flex","flex-row","items-center","bg-slate-100"],[1,"py-3","px-3","border-l-gray-200","bg-slate-100","w-40"],[1,"py-3","px-3","border-l-gray-200","bg-slate-100","w-48"],["_ngcontent-vao-c201","",1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[1,"py-3","px-3","border-l-gray-200","bg-slate-100","w-44"],[1,"py-3","px-3","border-l-gray-200","bg-slate-100","min-w-[200px]"],[3,"formGroup","index","paymentDate","add","remove",4,"ngFor","ngForOf"],[3,"formGroup","index","paymentDate","add","remove"]],template:function(e,n){1&e&&(t.TgZ(0,"ul",0)(1,"li",1)(2,"div",2),t._uU(3,"\u652f\u6255\u5148ID"),t.qZA(),t.TgZ(4,"div",3),t._uU(5," \u652f\u6255\u5148 "),t.TgZ(6,"span",4),t._uU(7," \u5fc5\u9808 "),t.qZA()(),t.TgZ(8,"div",5),t._uU(9," \u652f\u6255\u533a\u5206 "),t.TgZ(10,"span",4),t._uU(11," \u5fc5\u9808 "),t.qZA()(),t.TgZ(12,"div",3),t._uU(13,"\u91d1\u984d"),t.qZA(),t.TgZ(14,"div",5),t._uU(15,"\u652f\u6255\u4e88\u5b9a\u984d"),t.qZA(),t.TgZ(16,"div",6),t._uU(17," \u5099\u8003 "),t.qZA()()(),t.YNc(18,Zr,1,3,"app-input-pair",7)),2&e&&(t.xp6(18),t.Q6J("ngForOf",n.formArray.controls))}}),a})();var de=l(6863);function Or(a,i){1&a&&t.GkF(0)}function Pr(a,i){1&a&&t.GkF(0)}function wr(a,i){1&a&&t.GkF(0,26)}function Ur(a,i){if(1&a&&(t.TgZ(0,"p",27),t._uU(1),t.qZA()),2&a){const e=i.message;t.xp6(1),t.hij(" ",e," ")}}function Ir(a,i){1&a&&(t.TgZ(0,"span",30),t._uU(1,"\u5fc5\u9808"),t.qZA())}function Nr(a,i){if(1&a&&(t.TgZ(0,"div",28)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,Ir,2,0,"span",29),t.qZA()),2&a){const e=i.label,n=i.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",n)}}function Mr(a,i){if(1&a&&(t.TgZ(0,"p",33),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function Rr(a,i){if(1&a&&(t.ynx(0),t.YNc(1,Mr,2,1,"p",32),t.BQk()),2&a){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required)}}function Br(a,i){if(1&a&&t.YNc(0,Rr,2,1,"ng-container",31),2&a){const e=i.ctrl,n=t.oxw();t.Q6J("ngIf",n.formControlStateManager(e))}}function qr(a,i){if(1&a&&(t.ynx(0),t.TgZ(1,"p",33),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.errorConst.FORM_ERROR.DATE_SPECIFICATION_VIOLATION," ")}}function kr(a,i){if(1&a&&t.YNc(0,qr,3,1,"ng-container",31),2&a){const e=i.ctrls;t.Q6J("ngIf",null==e.errors?null:e.errors.endingDateIsSmaller)}}const Lr=function(){return{label:"\u652f\u6255\u65e5"}},Yr=function(){return{label:"\u5099\u8003",required:!1}},Jr=function(a){return{ctrl:a}};let Vr=(()=>{class a{constructor(e,n,r,o,s,u,p,m,d,f,T,F){this.route=e,this.router=n,this.modalService=r,this.flashMessageService=o,this.fb=s,this.authorService=u,this.employeeService=p,this.supplierService=m,this.errorService=d,this.paymentService=f,this.paymentDetailService=T,this.common=F,this.subscription=new S.w0,this.breadcrumbList=[],this.id=this.route.snapshot.params.id,this.url=this.router.url,this.detailUrl=this.url.replace("detail-edit","detail-view"),this.listlUrl=this.id?"../../":this.url.replace("/add",""),this.prevUrl=this.id?`${this.detailUrl}`:`${this.listlUrl}`,this.pageTitle=this.id?"\u652f\u6255\u6d88\u8fbc\u7de8\u96c6":"\u652f\u6255\u6d88\u8fbc\u65b0\u898f\u767b\u9332",this.detailPagePath=this.prevUrl,this.authorTitle=this.id?"\u66f4\u65b0\u8005":"\u767b\u9332\u8005",this.paymentIdValue=this.id?"\u3000\u652f\u6255ID\uff1a"+this.id:"",this.updater="\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...",this.authorname="\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...",this.response=[],this.topPagePath="/setting",this.listPagePath="/setting/accounts-payable-aggregate/payment-clearing",this.cancelModalTitle=this.pageTitle+"\u30ad\u30e3\u30f3\u30bb\u30eb\uff1a"+_.yR.TITLE.CANCEL,this.errorModalTitle=this.pageTitle+"\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.redirectPath=this.prevUrl,this.errorConst=A.c,this.payment_date="",this.form=this.fb.group({created_id:["",[c.kI.required]],payment_date:["",[c.kI.required]],remarks_1:[""],payment_detail:this.fb.array([this.fb.group({id:[""],payment_id:[""],payment_supplier_id:["",[c.kI.required]],payment_supplier_name:[""],scheduled_payment_amount:[""],payment_type_division_code:["",[c.kI.required]],payment_amount:[""],payment_date:[""],remarks_1:[""]})]),payment_detail_del:this.fb.array([this.fb.group({id:[""],payment_id:[""],payment_supplier_id:[""],payment_supplier_name:[""],scheduled_payment_amount:[""],payment_type_division_code:[""],payment_amount:[""],payment_date:[""],remarks_1:[""]})])}),this.paymentDetailAny=[],this.paymentAddForms=this.fb.group({forms:this.fb.array([])})}get ctrls(){return this.form.controls}get paymentAddFormsArray(){return this.paymentAddForms.get("forms")}get paymentAddFormsArrayControls(){return this.paymentAddFormsArray.controls}ngOnInit(){this.breadcrumbList=this.createBreadcrumbList(this.router.url),this.authorService.author?(this.author=this.authorService.author,this.ctrls.created_id.patchValue(String(this.author.id)),this.initOptions()):this.subscription.add(this.authorService.author$.subscribe(e=>{this.author=e,this.ctrls.created_id.patchValue(String(this.author.id)),this.initOptions()})),this.id||(this.detailPagePath=this.listPagePath),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,Z.h)(e=>this.modalService.getModalProperties().title===this.cancelModalTitle)).subscribe(e=>{e===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.detailPagePath)}))}ngOnDestroy(){this.subscription.unsubscribe()}initOptions(){this.common.loading=!0,this.ctrls.payment_date.valueChanges.subscribe(()=>{this.payment_date=this.ctrls.payment_date.value?new Date(this.ctrls.payment_date.value).toLocaleDateString():""}),this.subscription.add((0,M.D)([this.supplierService.getAsSelectOptions(),this.employeeService.getAsSelectOptions()]).pipe((0,v.x)(()=>this.common.loading=!1),(0,g.K)(e=>(0,x.of)(e))).subscribe(e=>{e instanceof b.UA?this.handleError(e.status,this.errorModalTitle,e.message):null!=e&&2===e.length?(this.supplierSuggests=e[0],this.employeeSuggests=e[1]):this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR)})),this.subscription.add(this.errorService.getError().subscribe(e=>{this._handleError(e)}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleClickCancel(){this.form.pristine?this.router.navigateByUrl(this.detailPagePath):this.modalService.setModal(this.cancelModalTitle,_.yR.BODY.CANCEL,"warning",_.yR.BUTTON_TITLE.EXECUTION,_.yR.BUTTON_TITLE.CANCEL)}handleClickSaveButton(){this.paymentDetailAny=[],this.form.markAsPristine(),this.common.loading=!0;const e=this.form.value;if(!this.employeeSuggests.some(m=>Number(m.value)===Number(this.author.id)))return this.ctrls.created_id.setValue(""),void(this.common.loading=!1);this.id&&this.ctrls.payment_detail_del.getRawValue().forEach(d=>{d.id&&this.paymentDetailService.remove(d.id).pipe((0,g.K)(f=>(0,x.of)(f)),(0,v.x)(()=>this.common.loading=!1)).subscribe(f=>{f instanceof b.UA&&this.handleError(f.status,this.errorModalTitle,f.error.message)})});const o=this.ctrls.payment_detail.getRawValue();let s=[];o.forEach(m=>{const d={id:"",payment_id:m.payment_id,payment_supplier_id:Number(m.payment_supplier_id),payment_supplier_name:m.payment_supplier_name,payment_type_division_code:m.payment_type_division_code,payment_amount:m.payment_amount,payment_date:this.payment_date,remarks_1:m.remarks_1};m.id&&(d.id=m.id),this.paymentDetailAny.push(d),s.push(Number(m.payment_supplier_id))});let u=this.uniq(s),p=[];for(let m in u){const d=this.paymentDetailAny.filter(T=>u[m]==T.payment_supplier_id),f={supplier_id:Number(d[0].payment_supplier_id),created_id:Number(this.author.id),remarks_1:e.remarks_1||"",payment_detail:[...d]};p.push(this.paymentService.add(f))}(0,M.D)(p).pipe((0,g.K)(m=>(0,x.of)(m)),(0,v.x)(()=>{this.common.loading=!1})).subscribe(m=>{if(m instanceof b.UA)return this.handleError(m.status,this.errorModalTitle,m.error?m.error.message:this.errorModalTitle),void(this.common.loading=!1);this.response=m}).add(()=>{if(this.response.length>0){const m="success";this.common.loading=!1,this.flashMessageService.setFlashMessage("\u4f5c\u6210\u3057\u307e\u3057\u305f",m,15e3),this.router.navigateByUrl(this.prevUrl)}})}uniq(e){return Array.from(new Set(e))}handleError(e,n,r){this.errorService.setError({status:e,title:n,message:r});this.modalService.setModal(n,0===e?r+A.c.GUIDANCE_OF_SUPPORT:`\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9: ${e} \n\u30e1\u30c3\u30bb\u30fc\u30b8: `+r+A.c.GUIDANCE_OF_SUPPORT,"danger",_.yR.BUTTON_TITLE.CLOSE,""),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,U.q)(1),(0,Z.h)(s=>this.modalService.getModalProperties().title===n)).subscribe(s=>{}))}calc(){let e=0;return this.ctrls.payment_detail.getRawValue().forEach(r=>{e+=Number(r.payment_amount)}),void 0===this.supplier?"":this.supplier.account_payable}createBreadcrumbList(e){e.replace(/.*\/accounts-payable-aggregate\/?/,"").split("/");const u=[{path:"/setting",text:"\u8a2d\u5b9a\u4e00\u89a7"},{path:this.listlUrl,text:"\u652f\u6255\u6d88\u8fbc\u4e00\u89a7"},{path:this.id?`${this.detailUrl}`:"",text:this.id?"\u652f\u6255\u6d88\u8fbc\u8a73\u7d30\u95b2\u89a7":"\u652f\u6255\u6d88\u8fbc\u65b0\u898f\u767b\u9332"}];return!!this.id&&u.push({text:"\u652f\u6255\u6d88\u8fbc\u7de8\u96c6"}),u}_handleError(e){e.redirectPath&&(this.redirectPath=e.redirectPath),this.modalService.setModal(e.title,0===e.status?e.message+A.c.GUIDANCE_OF_SUPPORT:`\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9: ${e.status} \n\u30e1\u30c3\u30bb\u30fc\u30b8: `+e.message+A.c.GUIDANCE_OF_SUPPORT,"danger",_.yR.BUTTON_TITLE.CLOSE,""),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,U.q)(1),(0,Z.h)(r=>this.modalService.getModalProperties().title===e.title)).subscribe(r=>{}))}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.gz),t.Y36(y.F0),t.Y36(N.Z),t.Y36(L.P),t.Y36(c.qu),t.Y36(dt.Y),t.Y36(at.G),t.Y36(Q.p),t.Y36(w.T),t.Y36(nt),t.Y36(H),t.Y36(C.v))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-add"]],decls:41,vars:25,consts:[[3,"breadcrumbList"],[1,"mb-8"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"cursor-pointer",3,"click"],[3,"roleTypeName"],[1,"width-limit-break","border-t","border-gray-400"],[3,"formGroup","ngSubmit"],[1,"mt-8","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"flex","gap-6","mt-6","mb-6"],[1,"w-2/5"],["nameAttrValue","payment_date","idAttrValue","payment-date",1,"w-1/6",3,"formCtrl"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-1/2"],["nameAttrValue","remarks_1","idAttrValue","remarks-1",3,"formCtrl","invalid"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mt-6","mb-24","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-100"],[1,"block","mt-6",3,"itemsId","paymentDate","formArray","delArray"],[1,"width-limit-break","bg-primary-light","flex","flex-row","justify-center","bottom-[40px]","left-0","right-0","p-2","fixed","gap-8"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["em",""],["labels",""],["errors",""],["dateErrors",""],["message",""],[1,"text-sm","text-red"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[4,"ngIf"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,n){if(1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main",1)(2,"h1",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3)(5,"div",4),t.NdJ("click",function(){return n.handleClickCancel()}),t._UZ(6,"app-cancel-link-org"),t.qZA(),t.TgZ(7,"div")(8,"app-last-updater-org",5),t._uU(9),t.qZA()()(),t._UZ(10,"hr",6),t.TgZ(11,"form",7),t.NdJ("ngSubmit",function(){return n.handleClickSaveButton()}),t.TgZ(12,"div",8)(13,"h2",9),t._uU(14),t.qZA(),t._UZ(15,"hr",10),t.TgZ(16,"div",11)(17,"div",12)(18,"app-date-term",13),t.YNc(19,Or,1,0,"ng-container",14),t.qZA()()(),t.TgZ(20,"div",11)(21,"div",15)(22,"app-textarea-container",16),t.YNc(23,Pr,1,0,"ng-container",14),t.YNc(24,wr,1,0,"ng-container",17),t.qZA()()()(),t.TgZ(25,"div",18)(26,"h2",9),t._uU(27,"\u5165\u91d1\u660e\u7d30"),t.qZA(),t._UZ(28,"hr",10)(29,"app-payment-clearing-add-detail",19),t.qZA(),t.TgZ(30,"div",20)(31,"app-button",21),t._uU(32,"\u4fdd\u5b58"),t.qZA()()()(),t.YNc(33,Ur,2,1,"ng-template",null,22,t.W1O),t.YNc(35,Nr,4,2,"ng-template",null,23,t.W1O),t.YNc(37,Br,1,1,"ng-template",null,24,t.W1O),t.YNc(39,kr,1,1,"ng-template",null,25,t.W1O)),2&e){const r=t.MAs(36),o=t.MAs(38);t.Q6J("breadcrumbList",n.breadcrumbList),t.xp6(3),t.Oqu(n.pageTitle),t.xp6(5),t.Q6J("roleTypeName",n.author&&n.author.role_name?n.author.role_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.xp6(1),t.AsE(" ",n.authorTitle,"\uff1a",n.author?n.author.last_name+" "+n.author.first_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."," "),t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(3),t.hij("\u652f\u6255\u6d88\u8fbc\u60c5\u5831\u5165\u529b",n.paymentIdValue,""),t.xp6(4),t.Q6J("formCtrl",n.ctrls.payment_date),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(21,Lr)),t.xp6(3),t.Q6J("formCtrl",n.ctrls.remarks_1)("invalid",n.formControlStateManager(n.ctrls.remarks_1)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(22,Yr)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(23,Jr,n.ctrls.remarks_1)),t.xp6(5),t.Q6J("itemsId",n.id)("paymentDate",n.ctrls.payment_date)("formArray",n.ctrls.payment_detail)("delArray",n.ctrls.payment_detail_del),t.xp6(2),t.Q6J("buttonDisabled",n.form.invalid||n.form.pristine)}},dependencies:[h.O5,h.tP,me,c._Y,c.JL,c.sg,de.a,qt.K,I.r,ce.t,R.Z,_t.R]}),a})();Array(15).fill(null).map((a,i)=>({id:i+1,status_division_id:i+1,billing_date:"2023-05-01",payment_due_date:"2023-06-01",supplier_id:i+1,billing_amount:1e3*(i+1),payment_date:`2023-05-${String(i+1).padStart(2,"0")}`,scheduled_payment_amount:1e3*(i+1)-200,balance:200,data_entry_employee_id:i+1,data_entry_date:`2023-05-${String(i+1).padStart(2,"0")}`,incident_division_id:i+1,created_at:`2023-05-${String(i+1).padStart(2,"0")}T00:00:00`,created_id:i+1,previous_month_balance:1111,pay_amount:1111,cf_amount:1111,purchase_amount:1111,consumption_tax:1111,reduced_tax:1111,current_month_balance:1111,division_status_code:i+1,division_status_name:`Status ${i+1}`,division_status_value:`status_${i+1}`,supplier_name:`Supplier ${i+1}`,supplier_cutoff_date_billing:1,supplier_scheduled_payment_date:11,supplier_account_payable:123,supplier_payment_site_name:"\u652f\u6255\u3044\u30b5\u30a4\u30c8",supplier_payment_site_code:1,supplier_payment_site_value:"\u7fcc\u6708",employee_data_entry_last_name:`LastName${i+1}`,employee_data_entry_first_name:`FirstName${i+1}`,division_incident_code:i+1,division_incident_name:`Incident ${i+1}`,division_incident_value:`incident_${i+1}`,employee_created_last_name:`CreatedLastName${i+1}`,employee_created_first_name:`CreatedFirstName${i+1}`}));var Qr=l(2e3),jr=l(6303),Kr=l(7362);const Gr=["*",[["","message",""]]],$r=["*","[message]"];let Hr=(()=>{class a{constructor(){this.inputType="text",this.invalid=!1,this.labelSize="base"}onClear(){this.formCtrl.setValue("")}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-date-clear-container"]],inputs:{inputType:"inputType",nameAttrValue:"nameAttrValue",idAttrValue:"idAttrValue",formCtrl:"formCtrl",placeholder:"placeholder",invalid:"invalid",labelSize:"labelSize"},ngContentSelectors:$r,decls:8,vars:7,consts:[[1,"block","mb-1","pl-1",3,"labelSize","forAttrValue"],[1,"flex","flex-row","items-center"],[1,"grow"],[3,"nameAttrValue","idAttrValue","formCtrl","placeholder","invalid"],[1,"flex-none"],["icon","close-circle-fill",1,"w-6","ml-1","fill-slate-500","cursor-pointer",3,"click"]],template:function(e,n){1&e&&(t.F$t(Gr),t.TgZ(0,"app-label",0),t.Hsn(1),t.qZA(),t.TgZ(2,"div",1)(3,"div",2),t._UZ(4,"app-datepicker",3),t.qZA(),t.TgZ(5,"div",4)(6,"app-icon",5),t.NdJ("click",function(){return n.onClear()}),t.qZA()()(),t.Hsn(7,1)),2&e&&(t.Q6J("labelSize",n.labelSize)("forAttrValue",n.idAttrValue),t.xp6(4),t.Q6J("nameAttrValue",n.nameAttrValue)("idAttrValue",n.idAttrValue)("formCtrl",n.formCtrl)("placeholder",n.placeholder)("invalid",n.invalid))},dependencies:[B.o,jr._,Kr.Q]}),a})();var zr=l(1208);function Xr(a,i){1&a&&t.GkF(0)}function Wr(a,i){1&a&&t.GkF(0,38)}function ti(a,i){1&a&&t.GkF(0)}function ei(a,i){1&a&&t.GkF(0,38)}function ni(a,i){1&a&&t.GkF(0)}function ai(a,i){1&a&&t.GkF(0,38)}function ri(a,i){1&a&&t.GkF(0)}function ii(a,i){1&a&&t.GkF(0,38)}function oi(a,i){1&a&&t.GkF(0)}function si(a,i){1&a&&t.GkF(0,38)}const it=function(){return{label:"",required:"true"}},ot=function(a){return{ctrl:a}};function li(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"tr",14)(1,"td",29)(2,"app-checkbox",30),t.NdJ("change",function(r){t.CHM(e);const o=t.oxw();return t.KtG(o.check(r))}),t.qZA()(),t.TgZ(3,"td",29)(4,"app-date-clear-container",31),t.YNc(5,Xr,1,0,"ng-container",32),t.YNc(6,Wr,1,0,"ng-container",33),t.qZA()(),t.TgZ(7,"td",29)(8,"app-date-clear-container",34),t.YNc(9,ti,1,0,"ng-container",32),t.YNc(10,ei,1,0,"ng-container",33),t.qZA()(),t.TgZ(11,"td",29)(12,"app-date-clear-container",35),t.YNc(13,ni,1,0,"ng-container",32),t.YNc(14,ai,1,0,"ng-container",33),t.qZA()(),t.TgZ(15,"td",29),t._uU(16),t.qZA(),t.TgZ(17,"td",29)(18,"app-select-suggest-container",36),t.YNc(19,ri,1,0,"ng-container",32),t.YNc(20,ii,1,0,"ng-container",33),t.qZA()(),t.TgZ(21,"td",29)(22,"app-select-suggest-container",37),t.YNc(23,oi,1,0,"ng-container",32),t.YNc(24,si,1,0,"ng-container",33),t.qZA()()()}if(2&a){const e=t.oxw(),n=t.MAs(51),r=t.MAs(53);t.xp6(2),t.Q6J("formCtrl",e.checkflg.minusflug),t.xp6(2),t.Q6J("formCtrl",e.ctrls.order_date)("invalid",e.formControlStateManager(e.ctrls.order_date)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(34,it)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(35,ot,e.ctrls.order_date)),t.xp6(2),t.Q6J("formCtrl",e.ctrls.purchase_date)("invalid",e.formControlStateManager(e.ctrls.purchase_date)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(37,it)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(38,ot,e.ctrls.purchase_date)),t.xp6(2),t.Q6J("formCtrl",e.ctrls.preferred_delivery_date)("invalid",e.formControlStateManager(e.ctrls.preferred_delivery_date)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(40,it)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(41,ot,e.ctrls.preferred_delivery_date)),t.xp6(2),t.hij(" ",e.accountsPayableAggregate.supplier_name," "),t.xp6(2),t.Q6J("formCtrl",e.ctrls.store_id)("suggests",e.storeSuggests)("invalid",e.formControlStateManager(e.ctrls.store_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(43,it)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(44,ot,e.ctrls.store_id)),t.xp6(2),t.Q6J("formCtrl",e.ctrls.order_employee_id)("suggests",e.employeeSuggests)("invalid",e.formControlStateManager(e.ctrls.order_employee_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(46,it)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(47,ot,e.ctrls.order_employee_id))}}function ui(a,i){if(1&a&&(t.TgZ(0,"p",39),t._uU(1),t.qZA()),2&a){const e=i.message;t.xp6(1),t.hij(" ",e," ")}}function pi(a,i){1&a&&(t.TgZ(0,"span",42),t._uU(1,"\u5fc5\u9808"),t.qZA())}function ci(a,i){if(1&a&&(t.TgZ(0,"div",40)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,pi,2,0,"span",41),t.qZA()),2&a){const e=i.label,n=i.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",n)}}function mi(a,i){if(1&a&&(t.TgZ(0,"p",45),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function di(a,i){if(1&a&&(t.ynx(0),t.YNc(1,mi,2,1,"p",44),t.BQk()),2&a){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required)}}function _i(a,i){if(1&a&&t.YNc(0,di,2,1,"ng-container",43),2&a){const e=i.ctrl,n=t.oxw();t.Q6J("ngIf",n.formControlStateManager(e))}}function hi(a,i){if(1&a&&(t.ynx(0),t.TgZ(1,"p",45),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.errorConst.FORM_ERROR.DATE_SPECIFICATION_VIOLATION," ")}}function gi(a,i){if(1&a&&t.YNc(0,hi,3,1,"ng-container",43),2&a){const e=i.ctrls;t.Q6J("ngIf",null==e.errors?null:e.errors.endingDateIsSmaller)}}let _e=(()=>{class a{constructor(e,n,r,o,s,u,p,m,d,f,T,F,Y,zt){this.route=e,this.router=n,this.modalService=r,this.flashMessageService=o,this.fb=s,this.authorService=u,this.supplierService=p,this.employeeService=m,this.storeService=d,this.errorService=f,this.purchaseService=T,this.purchaseDetailService=F,this.accountsPayableAggregateService=Y,this.common=zt,this.subscription=new S.w0,this.breadcrumbList=[],this.accounts_payable_aggregate_id=this.route.snapshot.params.accounts_payable_aggregate_id,this.url=this.router.url,this.currentUrl=this.url,this.detailUrl=this.url.replace("/edit",""),this.listlUrl="/setting/accounts-payable-aggregate/payment-slip",this.prevUrl=this.currentUrl.replace("/add","").replace("/edit",""),this.slipListUrl=`${this.listlUrl}/${this.accounts_payable_aggregate_id}`,this.pageTitle=this.accounts_payable_aggregate_id?"\u652f\u6255\u4f1d\u7968\u65b0\u898f\u767b\u9332":"\u652f\u6255\u6d88\u8fbc\u65b0\u898f\u767b\u9332",this.detailPagePath=this.prevUrl,this.authorTitle=this.accounts_payable_aggregate_id?"\u66f4\u65b0\u8005":"\u767b\u9332\u8005",this.purchase_id=this.route.snapshot.params.purchase_id,this.updater="\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...",this.authorname="\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...",this.topPagePath="/setting",this.listPagePath="/setting/accounts-payable-aggregate/payment-slip",this.cancelModalTitle=this.pageTitle+"\u30ad\u30e3\u30f3\u30bb\u30eb\uff1a"+_.yR.TITLE.CANCEL,this.errorModalTitle=this.pageTitle+"\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.errorConst=A.c,this.checkbox=this.fb.group({minusflug:[!1]}),this.isDiscount=!1,this.tortal_cost=0,this.form=this.fb.group({order_date:["",[c.kI.required]],preferred_delivery_date:["",[c.kI.required]],store_id:["",[c.kI.required]],supplier_id:["",[c.kI.required]],order_employee_id:["",[c.kI.required]],remarks:[""],purchase_date:["",[c.kI.required]],accounts_payable_aggregate_id:["",[c.kI.required]],purchase_detail:this.fb.array([this.fb.group({id:[""],api_product_name:[""],purchase_order_id:[""],product_id:[""],order_quantity:[""],order_price:[""],receiving_date:[""],receiving_quantity:[""],receiving_employee_id:[""],is_discount:[""]})]),purchase_detail_del:this.fb.array([this.fb.group({id:[""],purchase_order_id:[""],product_id:[""],order_quantity:[""],order_price:[""],receiving_date:[""],receiving_quantity:[""],receiving_employee_id:[""]})])}),this.purchaseDetailAny=[],this.purchaseDetailRemoveForms=this.fb.group({forms:this.fb.array([])}),this.purchaseDetailForms=this.fb.group({forms:this.fb.array([])})}get ctrls(){return this.form.controls}get checkflg(){return this.checkbox.controls}get purchaseDetailArray(){return this.purchaseDetailForms.get("forms")}get purchaseDetailArrayControls(){return this.purchaseDetailArray.controls}get purchaseDetailForm(){return this.fb.group({id:[""],view_barcode:[""],view_total:[""],view_supplier_product_cd:[""],view_division_unit_value:[""],view_division_seal_print_value:[""],view_division_shelf_value:[""],view_division_shelf_col_value:[""],view_division_price_tag_value:[""],view_minimum_order_quantity:[""],view_quantity:[""],view_regulated_stock_num:[""],api_product_name:[""],purchase_id:[""],product_id:[""],order_quantity:[""],order_price:[""],receiving_date:[""],receiving_quantity:[""],string_view_total:[""],is_discoount:[""]})}check(e){const n=e.target;n&&(this.isDiscount=n.checked)}ngOnInit(){if(this.breadcrumbList=this.createBreadcrumbList(this.router.url),this.initAuthor(),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,Z.h)(n=>this.modalService.getModalProperties().title===this.cancelModalTitle)).subscribe(n=>{n===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.detailPagePath)})),!this.purchase_id){this.detailPagePath=this.listPagePath;const r=(new Date).toISOString().split("T")[0];return this.ctrls.order_date.patchValue(r),void this.ctrls.purchase_date.patchValue(r)}this.setEditData(),this.setEditDetailData()}setEditData(){this.subscription.add(this.purchaseService.find(this.purchase_id).pipe((0,g.K)(e=>(0,x.of)(e)),(0,v.x)(()=>this.common.loading=!1)).subscribe(e=>{if(e instanceof b.UA)return void this.handleError(e.status,_.yR.TITLE.HAS_ERROR,e.error.message);if((0,D.bz)(e))return void this.handleError(400,_.yR.TITLE.HAS_ERROR,A.c.COULD_NOT_GET_DATA);const r=e.data[0];this.form.controls.supplier_id.patchValue(String(r.supplier_id)),this.form.controls.order_date.patchValue(String(r.order_date)),this.form.controls.preferred_delivery_date.patchValue(String(r.preferred_delivery_date)),this.form.controls.store_id.patchValue(String(r.store_id)),this.form.controls.order_employee_id.patchValue(String(r.order_employee_id)),this.form.controls.purchase_date.patchValue(String(r.purchase_date)),this.form.controls.accounts_payable_aggregate_id.patchValue(String(r.accounts_payable_aggregate_id))}))}setEditDetailData(){this.subscription.add(this.purchaseDetailService.getAll({purchase_id:this.purchase_id}).pipe((0,g.K)(this.purchaseDetailService.handleErrorModal()),(0,v.x)(()=>this.common.loading=!1)).subscribe(e=>{if(e instanceof b.UA)return void this.handleError(e.status,_.yR.TITLE.HAS_ERROR,e.error.message);if((0,D.bz)(e))return void this.handleError(400,_.yR.TITLE.HAS_ERROR,A.c.COULD_NOT_GET_DATA);const r=e.data;e.data.forEach(o=>{if(o.order_price&&o.order_quantity){let s=Number(o.order_price)*Number(o.order_quantity);this.tortal_cost+=s}1===o.is_discount&&(this.isDiscount=!0,this.checkflg.minusflug.setValue(!0),console.log(this.isDiscount))}),r.length&&this.purchaseDetailArray.clear(),r.map(o=>{const s=this.purchaseDetailForm;s.controls.view_barcode.patchValue(o.product_barcode),s.controls.view_supplier_product_cd.patchValue(o.product_supplier_product_cd),s.controls.view_division_unit_value.patchValue(o.unit_value),s.controls.view_division_seal_print_value.patchValue(o.seal_print_value),s.controls.view_division_shelf_value.patchValue(o.shelf_value),s.controls.view_division_shelf_col_value.patchValue(o.shelf_col_value),s.controls.view_division_price_tag_value.patchValue(o.price_tag_value),s.controls.view_minimum_order_quantity.patchValue(o.product_minimum_order_quantity),s.controls.view_quantity.patchValue(o.product_quantity),s.controls.view_regulated_stock_num.patchValue(o.product_regulated_stock_num),s.controls.receiving_quantity.patchValue(o.receiving_quantity),s.controls.order_quantity.patchValue(o.order_quantity),s.controls.order_price.patchValue(o.order_price),s.controls.product_id.patchValue(o.product_id),s.controls.purchase_id.patchValue(o.purchase_id),s.controls.api_product_name.patchValue(o.product_name),s.controls.id.patchValue(o.id),s.controls.string_view_total.patchValue((Number(o.order_quantity)*Number(o.order_price)).toLocaleString()),this.purchaseDetailArray.push(s)})}))}initAuthor(){if(this.authorService.author)return this.author=this.authorService.author,void this.initOptions();this.subscription.add(this.authorService.author$.subscribe(e=>{this.author=e,this.initOptions()}))}ngOnDestroy(){this.subscription.unsubscribe()}initOptions(){this.common.loading=!0,this.subscription.add((0,M.D)([this.supplierService.getAsSelectOptions(),this.employeeService.getAsSelectOptions(),this.storeService.getAsSelectOptions()]).pipe((0,v.x)(()=>this.common.loading=!1),(0,g.K)(e=>(0,x.of)(e))).subscribe(e=>{e instanceof b.UA?this.handleError(e.status,this.errorModalTitle,e.message):null!=e&&3===e.length?(this.supplierSuggests=e[0],this.employeeSuggests=e[1],this.storeSuggests=e[2]):this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR)})),this.callApi(!0)}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleClickCancel(){this.form.pristine?this.router.navigateByUrl(this.prevUrl):this.modalService.setModal(this.cancelModalTitle,_.yR.BODY.CANCEL,"warning",_.yR.BUTTON_TITLE.EXECUTION,_.yR.BUTTON_TITLE.CANCEL)}handleClickSaveButton(){this.common.loading=!0;const e=this.form.value;this.purchaseDetailForms.getRawValue().forms.forEach(p=>{let m={id:void 0,product_id:p.product_id,order_quantity:p.order_quantity,order_price:p.order_price,receiving_quantity:p.receiving_quantity,is_discount:this.isDiscount?1:0};p.id?m.id=p.id:delete m.id,this.purchaseDetailAny.push(m)});const r={accounts_payable_aggregate_id:Number(this.accounts_payable_aggregate_id),purchase_date:new Date(String(e.purchase_date)).toLocaleString(),order_date:new Date(String(e.order_date)).toLocaleString(),preferred_delivery_date:new Date(String(e.preferred_delivery_date)).toLocaleString(),supplier_id:Number(this.accountsPayableAggregate.supplier_id),order_employee_id:Number(e.order_employee_id),store_id:Number(e.store_id),remarks:String(e.remarks),purchase_detail:[...this.purchaseDetailAny]};this.removeDetail();let o=this.purchaseService.add(r);this.purchase_id&&(o=this.purchaseService.update(this.purchase_id,r)),o.pipe((0,g.K)(p=>(0,x.of)(p)),(0,v.x)(()=>this.common.loading=!1)).subscribe(p=>{p instanceof b.UA?this.handleError(p.status,this.errorModalTitle,p.message):(this.flashMessageService.setFlashMessage(p.message,"success",15e3),this.router.navigateByUrl(this.prevUrl))})}removeDetail(){this.purchaseDetailRemoveForms.getRawValue().forms.forEach(n=>{this.purchaseDetailService.remove(n.id).pipe((0,g.K)(r=>(0,x.of)(r)),(0,v.x)(()=>this.common.loading=!1)).subscribe(r=>{r instanceof b.UA&&this.handleError(r.status,this.errorModalTitle,r.error.message)})})}handleError(e,n,r){this.errorService.setError({status:e,title:n,message:r})}calc(){return this.ctrls.purchase_detail.getRawValue(),Math.floor(0)}createBreadcrumbList(e){e.replace(/.*\/accounts-payable-aggregate\/?/,"").split("/");const u=[{path:"/setting",text:"\u8a2d\u5b9a\u4e00\u89a7"},{path:this.listlUrl,text:"\u652f\u6255\u30c7\u30fc\u30bf\u4e00\u89a7"},{path:this.slipListUrl,text:"\u652f\u6255\u4f1d\u7968\u4e00\u89a7"},{path:this.purchase_id?`${this.detailUrl}`:"",text:this.purchase_id?"\u652f\u6255\u4f1d\u7968\u8a73\u7d30\u95b2\u89a7":"\u652f\u6255\u4f1d\u7968\u65b0\u898f\u767b\u9332"}];return!!this.purchase_id&&u.push({text:"\u652f\u6255\u4f1d\u7968\u7de8\u96c6"}),u}callApi(e){e&&this.getAccountsPayableAggregate(this.accounts_payable_aggregate_id)}getAccountsPayableAggregate(e){this.common.loading=!0,this.subscription.add(this.accountsPayableAggregateService.find(e).pipe((0,g.K)(n=>(0,x.of)(n)),(0,v.x)(()=>this.common.loading=!1)).subscribe(n=>{n instanceof b.UA?this.handleError(n.status,"\u30c7\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc",n.error.message):(0,D.bz)(n)?this.handleError(400,"\u30c7\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc",A.c.COULD_NOT_GET_DATA):(this.accountsPayableAggregate=n.data[0],this.ctrls.supplier_id.patchValue(String(this.accountsPayableAggregate.supplier_id)),this.ctrls.accounts_payable_aggregate_id.patchValue(String(e)))}))}tmpInvalid(){}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.gz),t.Y36(y.F0),t.Y36(N.Z),t.Y36(L.P),t.Y36(c.qu),t.Y36(dt.Y),t.Y36(Q.p),t.Y36(at.G),t.Y36(Qr.d),t.Y36(w.T),t.Y36(Pt.B),t.Y36(wt.p),t.Y36(et),t.Y36(C.v))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-add-edit"]],decls:56,vars:12,consts:[[3,"breadcrumbList"],[1,"mb-8"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"cursor-pointer",3,"click"],[3,"roleTypeName"],[1,"width-limit-break","border-t","border-gray-400"],[3,"formGroup","ngSubmit"],[1,"mt-8","py-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"mt-6","flex","flex-row","gap-10"],[1,"grow"],[1,"w-full"],[1,"border","border-slate-200"],[1,"border","bg-slate-100","p-4","min-w-[50px]"],[1,"text-xm"],[1,"border","bg-slate-100","p-4","min-w-[150px]"],[1,"border","bg-slate-100","p-4","min-w-[200px]"],[1,"border","bg-slate-100","p-4","min-w-[160px]"],["class","border border-slate-200",4,"ngIf"],[1,"flex","justify-end","gap-8","mt-4"],[3,"purchaseDetailForms","purchaseDetailRemoveForms","isDiscount","total_cost"],[1,"width-limit-break","bg-primary-light","flex","flex-row","justify-center","bottom-[40px]","left-0","right-0","p-2","fixed","gap-8"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["em",""],["labels",""],["errors",""],["dateErrors",""],[1,"border","p-4"],["nameAttrValue","minusflug","idAttrValue","minusflug","type","checkbox",2,"transform","scale(1.5)","margin-left","0.5em",3,"formCtrl","change"],["nameAttrValue","order_date","idAttrValue","order-date",3,"formCtrl","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],["nameAttrValue","purchase_date","idAttrValue","purchase-date",3,"formCtrl","invalid"],["nameAttrValue","preferred_delivery_date","idAttrValue","preferred-delivery-date",3,"formCtrl","invalid"],["nameAttrValue","store_id","idAttrValue","store-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],["nameAttrValue","order_employee_id","idAttrValue","order-employee-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],["message",""],[1,"text-sm","text-red"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[4,"ngIf"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,n){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main",1)(2,"h1",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3)(5,"div",4),t.NdJ("click",function(){return n.handleClickCancel()}),t._UZ(6,"app-cancel-link-org"),t.qZA(),t.TgZ(7,"div")(8,"app-last-updater-org",5),t._uU(9),t.qZA()()(),t._UZ(10,"hr",6),t.TgZ(11,"form",7),t.NdJ("ngSubmit",function(){return n.handleClickSaveButton()}),t.TgZ(12,"div",8)(13,"h2",9),t._uU(14,"\u4f1d\u7968\u30d8\u30c3\u30c0\u30fc"),t.qZA(),t._UZ(15,"hr",10),t.TgZ(16,"div",11)(17,"div",12)(18,"table",13)(19,"tr",14)(20,"td",15)(21,"p",16),t._uU(22,"\u8fd4\u54c1"),t._UZ(23,"br"),t._uU(24,"\u5024\u5f15"),t.qZA()(),t.TgZ(25,"td",17),t._uU(26,"\u767a\u6ce8\u65e5"),t.qZA(),t.TgZ(27,"td",17),t._uU(28,"\u4ed5\u5165\u65e5"),t.qZA(),t.TgZ(29,"td",17),t._uU(30,"\u5e0c\u671b\u7d0d\u5165\u65e5"),t.qZA(),t.TgZ(31,"td",18),t._uU(32,"\u4ed5\u5165\u5148\u540d"),t.qZA(),t.TgZ(33,"td",19),t._uU(34,"\u5c4a\u3051\u5148\u5e97\u8217"),t.qZA(),t.TgZ(35,"td",19),t._uU(36,"\u767a\u6ce8\u62c5\u5f53\u8005"),t.qZA()(),t.YNc(37,li,25,49,"tr",20),t.qZA()()()(),t.TgZ(38,"div",21),t._UZ(39,"div"),t.qZA(),t._UZ(40,"app-purchase-detail-table",22),t.TgZ(41,"div",21),t._UZ(42,"div"),t.qZA(),t.TgZ(43,"div",23)(44,"app-button",24),t._uU(45,"\u4fdd\u5b58"),t.qZA()()(),t.TgZ(46,"div",21),t._UZ(47,"div"),t.qZA()(),t.YNc(48,ui,2,1,"ng-template",null,25,t.W1O),t.YNc(50,ci,4,2,"ng-template",null,26,t.W1O),t.YNc(52,_i,1,1,"ng-template",null,27,t.W1O),t.YNc(54,gi,1,1,"ng-template",null,28,t.W1O)),2&e&&(t.Q6J("breadcrumbList",n.breadcrumbList),t.xp6(3),t.Oqu(n.pageTitle),t.xp6(5),t.Q6J("roleTypeName",n.author&&n.author.role_name?n.author.role_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.xp6(1),t.AsE(" ",n.authorTitle,"\uff1a",n.author?n.author.last_name+" "+n.author.first_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."," "),t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(26),t.Q6J("ngIf",n.accountsPayableAggregate),t.xp6(3),t.Q6J("purchaseDetailForms",n.purchaseDetailForms)("purchaseDetailRemoveForms",n.purchaseDetailRemoveForms)("isDiscount",n.isDiscount)("total_cost",n.tortal_cost),t.xp6(4),t.Q6J("buttonDisabled",n.form.invalid))},dependencies:[h.O5,h.tP,c._Y,c.JL,c.sg,Hr,I.r,_t.R,R.Z,j.X,ie,qt.K,zr.b]}),a})();var z=l(9042),fi=l(956);function bi(a,i){if(1&a&&(t.TgZ(0,"div",17)(1,"h2",9),t._uU(2,"\u652f\u6255\u6d88\u8fbc\u30d8\u30c3\u30c0\u30fc"),t.qZA(),t._UZ(3,"hr",10),t.TgZ(4,"div",18)(5,"div",19)(6,"table",20)(7,"tr",12)(8,"td",21),t._uU(9,"\u652f\u6255ID"),t.qZA(),t.TgZ(10,"td",22),t._uU(11,"\u652f\u6255\u5148"),t.qZA(),t.TgZ(12,"td",23),t._uU(13,"\u767b\u9332\u8005"),t.qZA(),t.TgZ(14,"td",24),t._uU(15,"\u5099\u8003"),t.qZA()(),t.TgZ(16,"tr",12)(17,"td",25),t._uU(18),t.qZA(),t.TgZ(19,"td",25),t._uU(20),t.qZA(),t.TgZ(21,"td",25),t._uU(22),t.qZA(),t.TgZ(23,"td",25),t._uU(24),t.qZA()()()()()()),2&a){const e=t.oxw();t.xp6(18),t.Oqu(e.payment.id),t.xp6(2),t.Oqu(e.payment.supplier_name),t.xp6(2),t.hij(" ",e.payment.employee_created_last_name&&e.payment.employee_created_first_name," "),t.xp6(2),t.Oqu(e.payment.remarks_1)}}function vi(a,i){if(1&a&&(t.TgZ(0,"tr",12)(1,"td",25),t._uU(2),t.qZA(),t.TgZ(3,"td",26),t._uU(4),t.qZA(),t.TgZ(5,"td",26),t._uU(6),t.qZA(),t.TgZ(7,"td",25),t._uU(8),t.qZA(),t.TgZ(9,"td",25),t._uU(10),t.qZA()()),2&a){const e=i.$implicit,n=t.oxw();t.xp6(2),t.hij(" ",n.getPaymentClass(e.payment_type_division_code)," "),t.xp6(2),t.hij(" ",e.payment_amount?e.payment_amount.toLocaleString():""," "),t.xp6(2),t.hij(" ",e.scheduled_payment_amount?e.scheduled_payment_amount.toLocaleString():""," "),t.xp6(2),t.Oqu(n.getDateFormat(e.payment_date)),t.xp6(2),t.Oqu(e.remarks_1)}}const yi=function(a){return{path:a,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Ci=function(a){return{path:a,text:"\u652f\u6255\u6d88\u8fbc\u4e00\u89a7"}},Ti=function(){return{text:"\u652f\u6255\u6d88\u8fbc\u95b2\u89a7"}},Ai=function(a,i,e){return[a,i,e]};let xi=(()=>{class a{constructor(e,n,r,o,s,u,p,m,d){this.route=e,this.router=n,this.modalService=r,this.paymentService=o,this.paymentDetailService=s,this.errorService=u,this.flashMessageService=p,this.common=m,this.divisionService=d,this.subscription=new S.w0,this.topPagePath="/setting",this.listPagePath="../../../payment-clearing",this.editPagePath="../../../payment-clearing/detail-edit/{{ depositId }}",this.paymentId="",this.errorModalTitle="\u652f\u6255\u6d88\u8fbc\u4e00\u89a7\uff1a"+_.yR.TITLE.HAS_ERROR,this.paymentDetail=[],this.paymentClassficationOption=[]}ngOnInit(){this.common.loading=!0,this.subscription.add(this.modalService.closeEventObservable$.pipe((0,Z.h)(n=>this.modalService.getModalProperties().title===this.errorModalTitle)).subscribe(n=>{n===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.listPagePath)})),this.common.loading=!0,this.subscription.add((0,M.D)([this.divisionService.getAsSelectOptions({name:z.z.DEPOSIT_CLASSIFICATION})]).pipe((0,v.x)(()=>this.common.loading=!1)).subscribe(n=>{n[0][z.z.DEPOSIT_CLASSIFICATION].filter(o=>{this.paymentClassficationOption.push({value:o.code,text:o.text})}),this.common.loading=!1}));const e=this.route.snapshot.paramMap.get("id");null!==e?isNaN(Number(e))?this.modalService.setModal(this.errorModalTitle,_.yR.BODY.CANCEL,"danger",_.yR.BUTTON_TITLE.CLOSE):(this.selectedId=Number(e),this.editPath="../../detail-edit/"+this.selectedId,this.getPayment(this.selectedId),this.getPaymentDetail(this.selectedId)):this.modalService.setModal(this.errorModalTitle,_.yR.BODY.CANCEL,"danger",_.yR.BUTTON_TITLE.CLOSE)}getPaymentClass(e){const n=this.paymentClassficationOption.find(r=>r.value===e);return void 0===n?"":n.text}getPayment(e){this.subscription.add(this.paymentService.find(e).pipe((0,g.K)(n=>(0,x.of)(n)),(0,v.x)(()=>this.common.loading=!1)).subscribe(n=>{n instanceof b.UA?this.handleError(n.status,n.error.message):(0,D.bz)(n)?this.handleError(400,A.c.COULD_NOT_GET_DATA):this.payment=n.data[0]}))}getPaymentDetail(e){this.subscription.add(this.paymentDetailService.getAll({payment_id:e}).pipe((0,g.K)(this.paymentDetailService.handleErrorModal()),(0,v.x)(()=>this.common.loading=!1)).subscribe(n=>{n instanceof b.UA?this.handleError(n.status,n.error.message):(0,D.bz)(n)?this.handleError(400,A.c.COULD_NOT_GET_DATA):this.paymentDetail=n.data}))}handleError(e,n,r){this.errorService.setError({status:e,title:"\u652f\u6255\u6d88\u8fbc\u4e00\u89a7\uff1a"+_.yR.TITLE.HAS_ERROR,message:n,redirectPath:r})}ngOnDestroy(){this.subscription.unsubscribe()}calc(){let e=0;return this.paymentDetail.forEach(n=>{e+=Number(n.payment_amount)}),Math.floor(e)}getDivisionName(e){return[{value:1,text:"\u58f2\u639b"},{value:2,text:"\u73fe\u91d1"}].find(r=>r.value===e)?.text}getDateFormat(e){let n;return n=""===e||"NaT"===e?"":new Date(e).toLocaleDateString(),n}handleClickDelete(){const e="\u652f\u6255"+_.yR.TITLE.DELETE;this.modalService.setModal(e,_.yR.BODY.DELETE,"danger",_.yR.BUTTON_TITLE.DELETE,_.yR.BUTTON_TITLE.CANCEL),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,U.q)(1),(0,Z.h)(r=>this.modalService.getModalProperties().title===e)).subscribe(r=>{r===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&(this.common.loading=!0,this.paymentService.remove(this.selectedId).pipe((0,g.K)(o=>(0,x.of)(o)),(0,v.x)(()=>this.common.loading=!1)).subscribe(o=>{o instanceof b.UA?this.handleError(o.status,o.error?o.error.title:"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002",o.message):(this.paymentDetail&&this.paymentDetail.forEach(u=>{u.id&&this.deletePaymentDetailItem(u.id)}),this.flashMessageService.setFlashMessage(o.message,"success",15e3),this.router.navigateByUrl(this.listPagePath))}))}))}deletePaymentDetailItem(e){this.paymentDetailService.remove(e.toString()).pipe((0,v.x)(()=>this.common.loading=!1),(0,g.K)(n=>(0,x.of)(n))).subscribe(n=>{n instanceof b.UA&&this.handleError(n.status,n.error?n.error.title:"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002",n.message)})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.gz),t.Y36(y.F0),t.Y36(N.Z),t.Y36(nt),t.Y36(H),t.Y36(w.T),t.Y36(L.P),t.Y36(C.v),t.Y36(bt.E))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-detail-view"]],decls:38,vars:15,consts:[[3,"breadcrumbList"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"flex","flex-row","items-center","gap-6"],[3,"path"],[1,"cursor-pointer",3,"click"],[1,"width-limit-break","border-t","border-gray-400"],["class","mt-8 py-8 px-6 bg-white shadow border border-gray-300",4,"ngIf"],[1,"mt-6","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-100"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"mt-6","w-full","shadow"],[1,"border","border-slate-200"],[1,"border","bg-slate-100","p-4"],["class","border border-slate-200",4,"ngFor","ngForOf"],[1,"mt-6","mb-24","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-100"],[1,"flex","justify-end","gap-8","mt-4"],[1,"mt-8","py-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"mt-6","flex","flex-row","gap-10"],[1,"grow"],[1,"w-full"],[1,"border","bg-slate-100","p-4","min-w-[100px]"],[1,"border","bg-slate-100","p-4","min-w-[410px]"],[1,"border","bg-slate-100","p-4","min-w-[220px]"],[1,"border","bg-slate-100","p-4","min-w-[470px]"],[1,"border","p-4"],[1,"border","p-4","text-right"]],template:function(e,n){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main")(2,"h1",1),t._uU(3,"\u652f\u6255\u6d88\u8fbc\u95b2\u89a7"),t.qZA(),t.TgZ(4,"div",2)(5,"div",3)(6,"app-back-to-link-org",4),t._uU(7,"\u4e00\u89a7\u3078\u623b\u308b"),t.qZA(),t.TgZ(8,"app-edit-link-org",4),t._uU(9,"\u7de8\u96c6"),t.qZA(),t.TgZ(10,"div",5),t.NdJ("click",function(){return n.handleClickDelete()}),t._UZ(11,"app-delete-link-org"),t.qZA()()(),t._UZ(12,"hr",6),t.YNc(13,bi,25,4,"div",7),t.TgZ(14,"div",8)(15,"h2",9),t._uU(16,"\u652f\u6255\u6d88\u8fbc\u660e\u7d30"),t.qZA(),t._UZ(17,"hr",10),t.TgZ(18,"table",11)(19,"tr",12)(20,"td",13),t._uU(21,"\u652f\u6255\u533a\u5206"),t.qZA(),t.TgZ(22,"td",13),t._uU(23,"\u652f\u6255\u91d1\u984d"),t.qZA(),t.TgZ(24,"td",13),t._uU(25,"\u652f\u6255\u4e88\u5b9a\u91d1\u984d"),t.qZA(),t.TgZ(26,"td",13),t._uU(27,"\u652f\u6255\u65e5"),t.qZA(),t.TgZ(28,"td",13),t._uU(29,"\u5099\u8003"),t.qZA()(),t.YNc(30,vi,11,5,"tr",14),t.qZA()(),t.TgZ(31,"div",15)(32,"h2",9),t._uU(33,"\u652f\u6255\u6b8b\u9ad8"),t.qZA(),t._UZ(34,"hr",10),t.TgZ(35,"div",16)(36,"h2",9),t._uU(37),t.qZA()()()()),2&e&&(t.Q6J("breadcrumbList",t.kEZ(11,Ai,t.VKq(6,yi,n.topPagePath),t.VKq(8,Ci,n.listPagePath),t.DdM(10,Ti))),t.xp6(6),t.s9C("path",n.listPagePath),t.xp6(2),t.Q6J("path",n.editPath),t.xp6(5),t.Q6J("ngIf",n.payment),t.xp6(17),t.Q6J("ngForOf",n.paymentDetail),t.xp6(7),t.Oqu(n.calc().toLocaleString()))},dependencies:[h.sg,h.O5,ft.i,oe._,R.Z,fi.$]}),a})(),he=(()=>{class a extends W.O{constructor(){super(...arguments),this.endpoint=tt.pU.accountsPayableBalanceApi.endpoint}getAll(e={}){return this.httpOptions.params=e,this.http.get(this.endpoint,this.httpOptions).pipe((0,g.K)(this.setErrorMessage("\u8cb7\u639b\u6b8b\u9ad8\u4e00\u89a7\u306e\u53d6\u5f97")))}getCsv(e,n={}){const r={params:n,responseType:"text",headers:new b.WM({"X-Download":e})};return this.http.get(this.endpoint,r).pipe((0,g.K)(this.setErrorMessage("\u4e00\u62ec\u767b\u9332\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u53d6\u5f97")))}aggregate(e){const n=this.generateFormData(e);return this.http.post(`${this.endpoint}/aggregate`,n)}}return a.\u0275fac=function(){let i;return function(n){return(i||(i=t.n5z(a)))(n||a)}}(),a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();function Di(a,i){1&a&&t.GkF(0,20)}function Fi(a,i){1&a&&t.GkF(0)}function Ei(a,i){1&a&&t.GkF(0,20)}function Si(a,i){if(1&a&&(t.TgZ(0,"div",21)(1,"span"),t._uU(2),t.qZA()()),2&a){const e=i.label;t.xp6(2),t.Oqu(e)}}function Zi(a,i){if(1&a&&(t.TgZ(0,"p",24),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MIN_LIMIT," ")}}function Oi(a,i){if(1&a&&(t.TgZ(0,"p",24),t._uU(1),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function Pi(a,i){if(1&a&&(t.ynx(0),t.YNc(1,Zi,2,1,"p",23),t.YNc(2,Oi,2,1,"p",23),t.BQk()),2&a){const e=t.oxw().ctrl,n=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.minlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===n.regExConst.NUMERIC_REG_EX+"")}}function wi(a,i){if(1&a&&t.YNc(0,Pi,3,2,"ng-container",22),2&a){const e=i.ctrl,n=t.oxw();t.Q6J("ngIf",n.invalid(e))}}function Ui(a,i){if(1&a&&(t.TgZ(0,"p",25),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}const Ii=function(){return{label:"\u4ed5\u5165\u5148",required:"false"}},Ni=function(a){return{ctrl:a}};let Mi=(()=>{class a{constructor(e,n,r,o,s){this.fb=e,this.common=n,this.supplierService=r,this.errorService=o,this.accountsPayableBalanceService=s,this.event=new t.vpe,this.errorLoadTitle="\u8cb7\u639b\u6b8b\u4e00\u89a7\u753b\u9762\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.isOpen=!1,this.rotateAnimation="",this.searchForm=this.fb.group({supplier_id:"",created_at:this.fb.group({from:"",to:""},{validators:[k.d.beforeFromDate()]})}),this.subscription=new S.w0,this.errorConst=A.c,this.regExConst=$.m}get ctrls(){return this.searchForm.controls}ngOnInit(){this.searchForm=this.setSearchClear(),this.initOptions()}searchButtonOnClick(){this.isOpen=!this.isOpen,this.rotateAnimation=this.isOpen?"rotate-animation-180":"rotate-animation-0"}onClickReset(){this.searchForm.reset(),this.searchForm=this.setSearchClear()}onClickSubmit(){const e=(0,D.vP)(this.removeNullsAndBlanks(this.searchForm.value));this.event.emit(e)}invalid(e){return(e.touched||e.dirty)&&e.invalid}removeNullsAndBlanks(e){const n={};for(const[r,o]of Object.entries(e))null!=o&&""!==o&&(n[r]=o);return n}initOptions(){this.subscription.add((0,M.D)([this.supplierService.getAsSelectOptions()]).pipe((0,g.K)(e=>(e.emit(e),(0,x.of)(e.error)))).subscribe(e=>{e instanceof b.UA?this.handleError(e.status,this.errorLoadTitle,e.message):null!=e&&1===e.length?this.supplierSuggests=e[0]:this.handleError(400,this.errorLoadTitle,_.yR.BODY.HAS_ERROR)}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleError(e,n,r){this.errorService.setError({status:e,title:n,message:r})}setSearchClear(){return this.fb.group({supplier_id:"",created_at:this.fb.group({from:"",to:""},{validators:[k.d.beforeFromDate()]})})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.qu),t.Y36(C.v),t.Y36(Q.p),t.Y36(w.T),t.Y36(he))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-search"]],outputs:{event:"event"},decls:29,vars:20,consts:[[1,"mt-8","mb-4"],[3,"click"],["icon","filter-2-line",1,"w-6"],[1,"inline-block","ml-1","mr-2"],["icon","arrow-down-s-fill",1,"w-6"],[1,"search","width-limit-break","bg-white",3,"ngClass"],[1,"w-[1280px]","mx-auto","px-4"],[1,"flex","gap-6","mt-6"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],[1,"w-1/3"],["nameAttrValue","supplier_id","idAttrValue","supplier-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"flex","gap-8","mt-10"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[1,"mt-2","text-sm","text-red"],["labels",""],["errors",""],["beforeFromDate",""],["message",""],[1,"flex","items-center","gap-2"],[4,"ngIf"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return n.searchButtonOnClick()}),t._UZ(2,"app-icon",2),t.TgZ(3,"span",3),t._uU(4),t.qZA(),t._UZ(5,"app-icon",4),t.qZA()(),t.TgZ(6,"div",5)(7,"form",6)(8,"div",7)(9,"app-date-term-clear-container",8),t._uU(10," \u5e74\u6708\u5ea6 "),t.YNc(11,Di,1,0,"ng-container",9),t.qZA(),t.TgZ(12,"div",10)(13,"app-select-suggest-container",11),t.YNc(14,Fi,1,0,"ng-container",12),t.YNc(15,Ei,1,0,"ng-container",13),t.qZA()()(),t.TgZ(16,"div",14)(17,"app-button",1),t.NdJ("click",function(){return n.onClickReset()}),t._uU(18,"\u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2"),t.qZA(),t.TgZ(19,"app-button",15),t.NdJ("click",function(){return n.onClickSubmit()}),t._uU(20," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA()(),t.TgZ(21,"p",16),t._uU(22," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()(),t.YNc(23,Si,3,1,"ng-template",null,17,t.W1O),t.YNc(25,wi,1,1,"ng-template",null,18,t.W1O),t.YNc(27,Ui,2,1,"ng-template",null,19,t.W1O)),2&e){const r=t.MAs(24),o=t.MAs(26),s=t.MAs(28);t.xp6(4),t.hij(" ",n.isOpen?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(n.rotateAnimation),t.xp6(1),t.Q6J("ngClass",n.isOpen?"is-open shadow":""),t.xp6(3),t.Q6J("dateFromFormCtrl",n.ctrls.created_at.controls.from)("dateToFormCtrl",n.ctrls.created_at.controls.to)("invalid",!!n.ctrls.created_at.errors),t.xp6(2),t.Q6J("ngIf",null==n.ctrls.created_at.errors?null:n.ctrls.created_at.errors.beforeFromDate)("ngIfThen",s),t.xp6(2),t.Q6J("formCtrl",n.ctrls.supplier_id)("suggests",n.supplierSuggests)("invalid",n.formControlStateManager(n.ctrls.supplier_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(17,Ii)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(18,Ni,n.ctrls.supplier_id)),t.xp6(4),t.Q6J("buttonDisabled",n.searchForm.invalid)}},dependencies:[h.mk,h.O5,h.tP,V.w,I.r,B.o,j.X],styles:[".search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease;overflow:hidden}.search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0}"]}),a})();const Ri=function(a){return{path:a,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Bi=function(){return{text:"\u8cb7\u639b\u6b8b\u4e00\u89a7"}},qi=function(a,i){return[a,i]},ki=[{path:"",redirectTo:"payment-slip",pathMatch:"full"},{path:"payment-cutoff",component:E,children:[{path:"",component:Me,pathMatch:"full"}]},{path:"payment-slip",component:E,children:[{path:"",component:te,pathMatch:"full"},{path:"list",component:te},{path:":accounts_payable_aggregate_id/add",component:_e},{path:":accounts_payable_aggregate_id/purchase/:purchase_id/edit",component:_e},{path:":id/purchase/:purchase_id",component:Pa},{path:":id/repair/:repair_id",component:Ja},{path:":id",component:Mn}]},{path:"payment-clearing",component:E,children:[{path:"",component:ue,pathMatch:"full"},{path:"list",component:ue},{path:"add",component:Vr},{path:"detail-view/:id",component:xi},{path:"detail-edit/:id",component:Sr}]},{path:"accounts-payable-balance",component:E,children:[{path:"",component:(()=>{class a{constructor(e,n,r,o,s,u,p,m){this.common=e,this.service=n,this.fb=r,this.flashMessageService=o,this.accountsPayableAggregateService=s,this.errorService=u,this.router=p,this.modalService=m,this.topPagePath="/setting",this.listPagePath=this.topPagePath+"/accounts-payable-aggregate/accounts-payable-balance",this._filter={},this.defaultSort={column:"\u8acb\u6c42ID",order:"desc"},this._pages={page:1,itemsPerPage:10,sort:this.defaultSort},this.tableParams=new O.x,this.tableNameMapping=[{name:"id",name_jp:"\u8acb\u6c42ID"},{name:"supplier_id",name_jp:"\u4ed5\u5165\u5148ID"},{name:"supplier_name",name_jp:"\u4ed5\u5165\u5148\u540d"},{name:"previous_month_balance",name_jp:"\u524d\u6708\u6b8b\u9ad8"},{name:"payment_amount",name_jp:"\u652f\u6255\u91d1\u984d"},{name:"carryforward_amount",name_jp:"\u7e70\u8d8a\u91d1\u984d"},{name:"purchase_amount",name_jp:"\u4ed5\u5165\u91d1\u984d"},{name:"consumption_tax",name_jp:"\u6d88\u8cbb\u7a0e\u984d(10%)"},{name:"reduced_tax",name_jp:"\u6d88\u8cbb\u7a0e\u984d(8%)"},{name:"total_price",name_jp:"\u5408\u8a08"},{name:"current_month_balance",name_jp:"\u5f53\u6708\u6b8b\u9ad8"},{name:"blank_discount_amount",name_jp:"\u5024\u5f15\u304d"},{name:"blank_payment_amount",name_jp:"\u652f\u6255\u984d"}],this.fileNamePrefix="\u8cb7\u639b\u6b8b\u9ad8",this.form=this.fb.group({payment_date_picker:[""],payment_date:["",[c.kI.required]]}),this.errorModalTitle="\u96c6\u8a08\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR}set filter(e){this._filter=e,this._pages.page=1,this.callApi()}set pages(e){this._pages=e,this.callApi()}get export$(){return this.service.getCsv("csv",{...this._filter}).pipe((0,g.K)(this.service.handleErrorModal("")),(0,v.x)(()=>this.common.loading=!1))}get ctrls(){return this.form.controls}ngOnInit(){this.callApi(),this.ctrls.payment_date_picker.valueChanges.subscribe(()=>{let e=this.ctrls.payment_date_picker.value;if(e){const n=new Date(e);let r=String(n.getFullYear())+"/"+String(n.getMonth()+1);this.ctrls.payment_date.setValue(r)}})}onClickSubmit(){if(this.common.loading=!0,this.ctrls.payment_date_picker.value){const e=new Date(this.ctrls.payment_date_picker.value);console.log(e);const r={to_order_date:new Date(e).toLocaleDateString()};console.log(r),this.service.aggregate(r).pipe((0,v.x)(()=>this.common.loading=!1),(0,g.K)(o=>(0,x.of)(o))).subscribe(o=>{if(o instanceof b.UA)return void this.handleError(o.status,this.errorModalTitle,o.message);let u="\u96c6\u8a08\u5b8c\u4e86\u5f8c\u3001\u3054\u767b\u9332\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3044\u305f\u3057\u307e\u3059\u3002\n";u+="\u203b \u30e1\u30fc\u30eb\u304c\u8ff7\u60d1\u30e1\u30fc\u30eb\u306b\u632f\u308a\u5206\u3051\u3089\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n",u+="\u203b \u30e1\u30fc\u30eb\u304c\u9001\u4fe1\u3055\u308c\u308b\u307e\u3067\u6570\u5206\u304b\u304b\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002",this.modalService.setModal("\u96c6\u8a08\u304c\u5b9f\u65bd\u3055\u308c\u307e\u3057\u305f","\u96c6\u8a08\u5b8c\u4e86\u5f8c\u3001\u3054\u767b\u9332\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3044\u305f\u3057\u307e\u3059\u3002\n\u203b \u30e1\u30fc\u30eb\u304c\u8ff7\u60d1\u30e1\u30fc\u30eb\u306b\u632f\u308a\u5206\u3051\u3089\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u203b \u30e1\u30fc\u30eb\u304c\u9001\u4fe1\u3055\u308c\u308b\u307e\u3067\u6570\u5206\u304b\u304b\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002","success","\u9589\u3058\u308b","\u9589\u3058\u308b",!1),this.router.navigateByUrl(this.listPagePath)})}else this.common.loading=!1}invalid(e){return(e.touched||e.dirty)&&e.invalid}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}onExportStatusChange(e){e===rt.U.START&&(this.common.loading=!0)}sum_totals(e,n){return e.reduce((o,s)=>o+Number(s[n]),0)}callApi(){this.common.loading=!0;let e=this.createApiParams();this.service.getAll(e).pipe((0,g.K)(this.service.handleErrorModal()),(0,v.x)(()=>this.common.loading=!1)).subscribe(n=>{console.log(e),delete e.limit,console.log(e),this.service.getAll(e).pipe((0,g.K)(this.service.handleErrorModal()),(0,v.x)(()=>this.common.loading=!1)).subscribe(r=>{console.log(r);const o=r.data.map(P=>({previous_month_balance:Number(P.previous_month_balance)?Number(P.previous_month_balance):0,payment_amount:Number(P.payment_amount)?Number(P.payment_amount):0,carryforward_amount:Number(P.carryforward_amount)?Number(P.carryforward_amount):0,purchase_amount:Number(P.purchase_amount)?Number(P.purchase_amount):0,consumption_tax:Number(P.consumption_tax)?Number(P.consumption_tax):0,reduced_tax:Number(P.reduced_tax)?Number(P.reduced_tax):0,total_price:Number(P.total_price)?Number(P.total_price):0,current_month_balance:Number(P.current_month_balance)?Number(P.current_month_balance):0,blank_discount_amount:Number(P.blank_discount_amount)?Number(P.blank_discount_amount):0,blank_payment_amount:Number(P.blank_payment_amount)?Number(P.blank_payment_amount):0}));let s=this.sum_totals(o,"previous_month_balance"),u=this.sum_totals(o,"payment_amount"),p=this.sum_totals(o,"carryforward_amount"),m=this.sum_totals(o,"purchase_amount"),d=this.sum_totals(o,"consumption_tax"),f=this.sum_totals(o,"reduced_tax"),T=this.sum_totals(o,"total_price"),F=this.sum_totals(o,"current_month_balance"),Y=this.sum_totals(o,"blank_discount_amount"),zt=this.sum_totals(o,"blank_payment_amount");const co=["\u5408\u8a08","","",s.toLocaleString(),u.toLocaleString(),p.toLocaleString(),m.toLocaleString(),d.toLocaleString(),f.toLocaleString(),T.toLocaleString(),F.toLocaleString(),Y.toLocaleString(),zt.toLocaleString()],mo=this.createTableParams(n,this.tableNameMapping,this.modifiedTableBody,co);this.tableParams.next(mo)})})}createApiParams(){0===Object.keys(this._pages.sort).length&&(this._pages.sort=this.defaultSort);const e=this.tableNameMapping.find(r=>r.name_jp===this._pages.sort.column)?.name;let n;return n="supplier_name"===e?"supplier_name_kana":e,{...this._filter,limit:this._pages.itemsPerPage,offset:(this._pages.page-1)*this._pages.itemsPerPage,sort:n?`${n}:${this._pages.sort.order}`:""}}createTableParams(e,n,r,o=[]){const s=n.map(p=>p.name_jp),u=e.data.map(p=>(p.carryforward_amount=p.previous_month_balance-p.payment_amount,p.total_price=p.purchase_amount+p.consumption_tax+p.reduced_tax,n.map(r?r(p):m=>p[m.name])));return console.log(u),{total:e.totalItems,header:s,body:u,footer:o}}modifiedTableBody(e){return n=>""===e[n.name]?e[n.name]:["previous_month_balance","payment_amount","carryforward_amount","purchase_amount","consumption_tax","reduced_tax","total_price","current_month_balance","blank_discount_amount","blank_payment_amount"].includes(n.name)?{unit:!1,align:"right",text:Number(e[n.name]||0)}:e[n.name]}handleError(e,n,r){this.errorService.setError({status:e,title:n,message:r,redirectPath:this.listPagePath})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(C.v),t.Y36(he),t.Y36(c.qu),t.Y36(L.P),t.Y36(et),t.Y36(w.T),t.Y36(y.F0),t.Y36(N.Z))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-accounts-payable-balance"]],decls:20,vars:14,consts:[[3,"breadcrumbList"],[1,"mt-6","pt-3","pb-3","px-3","bg-white","shadow","border","border-gray-300"],[1,"pb-3","text-base","font-bold","ng-star-inserted"],[1,"flex","gap-6","mt-3","mb-3"],[1,"w-1/5"],["nameAttrValue","payment_date","idAttrValue","payment-date",1,"w-40",3,"formCtrl","invalid"],["nameAttrValue","payment_date_picker","idAttrValue","payment-date-picker",3,"formCtrl"],[1,"w-1/5","mt-1"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[3,"event"],[1,"flex","justify-between","mt-4"],["text","\u8cb7\u639b\u6b8bCSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3000",3,"export$","fileNamePrefix","statusChange"],[1,"app-table","block","mt-2",3,"params","pageChange"]],template:function(e,n){1&e&&(t._UZ(0,"app-breadcrumb-org",0)(1,"app-toggle-button"),t.TgZ(2,"div",1)(3,"div",2),t._uU(4,"\u96c6\u8a08"),t.qZA(),t.TgZ(5,"form")(6,"div",3)(7,"div",4),t._UZ(8,"app-text-container",5),t.qZA(),t.TgZ(9,"div",4),t._UZ(10,"app-date-term",6),t.qZA(),t.TgZ(11,"div",7)(12,"app-button",8),t.NdJ("click",function(){return n.onClickSubmit()}),t._uU(13," \u96c6\u8a08 "),t.qZA()()()()(),t.TgZ(14,"app-search",9),t.NdJ("event",function(o){return n.filter=o}),t.qZA(),t.TgZ(15,"div",10),t._UZ(16,"div"),t.TgZ(17,"app-export-link",11),t.NdJ("statusChange",function(o){return n.onExportStatusChange(o)}),t.qZA()(),t.TgZ(18,"app-table-with-pagination",12),t.NdJ("pageChange",function(o){return n.pages=o}),t._uU(19," \u8cb7\u639b\u6b8b\u9ad8\u4e00\u89a7\n"),t.qZA()),2&e&&(t.Q6J("breadcrumbList",t.WLB(11,qi,t.VKq(8,Ri,n.topPagePath),t.DdM(10,Bi))),t.xp6(8),t.Q6J("formCtrl",n.ctrls.payment_date)("invalid",n.formControlStateManager(n.ctrls.payment_date)),t.xp6(2),t.Q6J("formCtrl",n.ctrls.payment_date_picker),t.xp6(2),t.Q6J("buttonDisabled",n.form.invalid),t.xp6(5),t.Q6J("export$",n.export$)("fileNamePrefix",n.fileNamePrefix),t.xp6(1),t.Q6J("params",n.tableParams))},dependencies:[de.a,gt.i,I.r,ht,le,R.Z,vt.O,Mi],styles:["app-table tfoot tr td:first-child{text-align:left!important}  app-table tfoot tr td{text-align:right!important}"]}),a})(),pathMatch:"full"}]}];let ge=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[y.Bz.forChild(ki),y.Bz]}),a})();var st=l(9307),Lt=l(4933),Li=l(9823),Yi=l(7088),Ct=l(3042),Tt=l(2923),Yt=l(4470),lt=l(9104),Jt=l(9434),ut=l(3894);let At=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[h.ez,ge]}),a})();var xt=l(3560),Dt=l(855),Vt=l(3962),Qt=l(3415),K=l(5274),jt=l(3183),pt=l(1326),Ji=l(973),fe=l(1819),Kt=l(4854),ct=l(7090);let Vi=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({providers:[C.v],imports:[h.ez,st.u,Lt.M,Li.U,Yi.t,Ct.C,Tt.D,Yt.x,lt.u,Jt.H,ut.h,At,xt.r,c.UX,Dt.W,Vt.J,Qt.x,K.s,jt.F,pt.z,Ji.Y,fe.l,Kt.C,ct.G]}),a})();var Gt=l(7766),$t=l(3257),Ft=l(4787),Et=l(4560),Qi=l(6843),X=l(8511),mt=l(8367),ji=l(6021),Ki=l(589),Ht=l(3718),St=l(5773),Gi=l(8460);let $i=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[h.ez,Et.Z,c.UX,ut.h,xt.r,St.i,Gi.A,jt.F,X.Q,pt.z,Mt.JX,Kt.C,K.s]}),a})();var Hi=l(8593);let zi=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({providers:[It,ee],imports:[h.ez,c.UX,Gt.X,$t.Z,pt.z,Ft.N,Dt.W,h.ez,lt.u,Et.Z,Qi.y,At,ut.h,X.Q,mt.a,Ct.C,Lt.M,Yt.x,ji.v,Ki.P,Ht.z,st.u,Tt.D,ct.G,Kt.C,jt.F,Jt.H,St.i,$i,K.s,xt.r,Vt.J,Hi.n]}),a})();var Zt=l(67),Xi=l(8187),be=l(7610);function Wi(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"app-icon",9),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.remove.emit(r.index))}),t.qZA()}}function to(a,i){1&a&&t._UZ(0,"div",10)}let eo=(()=>{class a{constructor(e,n){this.divisionService=e,this.common=n,this.add=new t.vpe,this.remove=new t.vpe,this._PaymentDetails=[],this.valueSuggests=[],this.statusDivisionOptions=[{value:"",text:Zt.s.PLEASE_SELECT},{value:1,text:"\u639b"},{value:2,text:"\u73fe\u91d1"}],this.pageConst=q._,this.subscription=new S.w0,this.paymentClassficationOption=[{value:"",text:Zt.s.PLEASE_SELECT}]}get ctrls(){return this.formGroup.controls}set paymentDetail(e){this._PaymentDetails=e}ngOnInit(){this.subscription.add((0,M.D)([this.divisionService.getAsSelectOptions({name:z.z.DEPOSIT_CLASSIFICATION})]).pipe((0,v.x)(()=>this.common.loading=!1),(0,g.K)(e=>(0,x.of)(e))).subscribe(e=>{e[0][z.z.DEPOSIT_CLASSIFICATION].filter(r=>{this.paymentClassficationOption.push({value:r.code,text:r.text})}),this.common.loading=!1}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(bt.E),t.Y36(C.v))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-input-pair"]],inputs:{formGroup:"formGroup",index:"index",paymentDetail:"paymentDetail"},outputs:{add:"add",remove:"remove"},decls:11,vars:12,consts:[["idAttrValue","payment-type-division-code","nameAttrValue","payment_type_division_code","labelSize","sm",1,"w-40",3,"formCtrl","options"],["inputType","number",1,"w-40","text-right",3,"formCtrl","textRight","idAttrValue"],[1,"w-40","text-right"],["nameAttrValue","payment_date",1,"w-40",3,"formCtrl","idAttrValue"],[1,"w-1/3",3,"formCtrl","idAttrValue"],[1,"flex","items-center","gap-4"],["icon","add-line",1,"cursor-pointer","w-6",3,"click"],["icon","delete-bin-line","class","cursor-pointer w-6 fill-red-500",3,"click",4,"ngIf","ngIfElse"],["falseContent",""],["icon","delete-bin-line",1,"cursor-pointer","w-6","fill-red-500",3,"click"],[1,"w-6","width:24px;"]],template:function(e,n){if(1&e&&(t._UZ(0,"app-select-clear-container",0)(1,"app-text-container",1),t.TgZ(2,"span",2),t._uU(3),t.qZA(),t._UZ(4,"app-date-term",3)(5,"app-text-container",4),t.TgZ(6,"div",5)(7,"app-icon",6),t.NdJ("click",function(){return n.add.emit()}),t.qZA(),t.YNc(8,Wi,1,0,"app-icon",7),t.YNc(9,to,1,0,"ng-template",null,8,t.W1O),t.qZA()),2&e){const r=t.MAs(10);t.Q6J("formCtrl",n.ctrls.payment_type_division_code)("options",n.paymentClassficationOption),t.xp6(1),t.MGl("idAttrValue","deposit-detail-",n.index,"-payment_amount"),t.Q6J("formCtrl",n.ctrls.payment_amount)("textRight",!0),t.xp6(2),t.Oqu(n.ctrls.scheduled_payment_amount.value),t.xp6(1),t.MGl("idAttrValue","deposit-detail-",n.index,"-payment_date"),t.Q6J("formCtrl",n.ctrls.payment_date),t.xp6(1),t.MGl("idAttrValue","deposit-detail-",n.index,"-remarks"),t.Q6J("formCtrl",n.ctrls.remarks_1),t.xp6(3),t.Q6J("ngIf",n.index)("ngIfElse",r)}},dependencies:[h.O5,vt.O,B.o,Xi.a,be.I],styles:["[_nghost-%COMP%]{margin-bottom:1rem;display:flex;align-items:center;gap:1.5rem}"]}),a})(),no=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[h.ez,c.UX,St.i,K.s,X.Q,Qt.x,Ft.N,mt.a]}),a})();t.B6R(pe,[h.sg,c.JL,c.sg,eo],[]);let ao=(()=>{class a{getScheduledPaymentAmount(e,n){if(0===e.length||null==n||""===n)return;const r=new Date(n).toLocaleDateString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit"});return this._getScheduledPaymentAmount(e,r)}_getScheduledPaymentAmount(e,n){const r=e[0].supplier_payment_site_code,o=new Date(n);o.setMonth(o.getMonth()-1);const s=o.toLocaleDateString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit"});let u=0;return e.forEach(p=>{const m=new Date(p.payment_due_date).toLocaleDateString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit"});if(4==r){if(m<s)return;u=(p.balance||0)+(p.scheduled_payment_amount||0)}m<n||(u=(p.balance||0)+(p.scheduled_payment_amount||0))}),u}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();function ro(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"app-icon",10),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.remove.emit(r.index))}),t.qZA()}}function io(a,i){1&a&&t._UZ(0,"div",11)}let oo=(()=>{class a{constructor(e,n,r,o,s){this.supplierService=e,this.divisionService=n,this.common=r,this.service=o,this.domain=s,this.add=new t.vpe,this.remove=new t.vpe,this.subscription=new S.w0,this.accounts_payable_aggregate=[],this.pageConst=q._,this.paymentClassficationOption=[{value:"",text:Zt.s.PLEASE_SELECT}],this.statusDivisionOptions=[{value:"",text:Zt.s.PLEASE_SELECT},{value:1,text:"\u639b"},{value:2,text:"\u73fe\u91d1"}]}get ctrls(){return this.formGroup.controls}ngOnInit(){void 0!==this.paymentDate&&this.paymentDate.valueChanges.subscribe(e=>{void 0!==e&&this.setScheduledPaymentAmount()}),this.ctrls.payment_supplier_id.valueChanges.subscribe(e=>{null!=e&&this.callApi(e)}),this.subscription.add(this.supplierService.getAsSelectOptions().subscribe(e=>{this.supplierSuggests=e})),this.subscription.add((0,M.D)([this.supplierService.getAsSelectOptions(),this.divisionService.getAsSelectOptions({name:z.z.DEPOSIT_CLASSIFICATION})]).pipe((0,v.x)(()=>this.common.loading=!1),(0,g.K)(e=>(0,x.of)(e))).subscribe(e=>{this.supplierSuggests=e[0],e[1][z.z.DEPOSIT_CLASSIFICATION].filter(r=>{this.paymentClassficationOption.push({value:r.code,text:r.text})})}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}callApi(e){this.common.loading=!0,this.service.getAll(this.createApiParams(e)).pipe((0,g.K)(this.service.handleErrorModal()),(0,v.x)(()=>this.common.loading=!1)).subscribe(n=>{console.log(n),this.accounts_payable_aggregate=n.data,this.setScheduledPaymentAmount()})}createApiParams(e){return{supplier_id:e,limit:10,sort:"id:desc"}}setScheduledPaymentAmount(){console.log("setScheduledPaymentAmount");const e=this.paymentDate?.value,n=this.domain.getScheduledPaymentAmount(this.accounts_payable_aggregate,e);this.ctrls.scheduled_payment_amount.setValue(null),void 0!==n&&this.ctrls.scheduled_payment_amount.setValue(n)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Q.p),t.Y36(bt.E),t.Y36(C.v),t.Y36(et),t.Y36(ao))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-input-pair"]],inputs:{formGroup:"formGroup",paymentDate:"paymentDate",index:"index"},outputs:{add:"add",remove:"remove"},decls:12,vars:14,consts:[[1,"w-40",3,"formCtrl","idAttrValue"],["nameAttrValue","payment_supplier_id","idAttrValue","payment-supplier-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",1,"w-48",3,"formCtrl","suggests"],["idAttrValue","payment-type-division-code","nameAttrValue","payment_type_division_code","labelSize","sm",1,"w-40",3,"formCtrl","options"],["inputType","number",1,"w-40",3,"textRight","formCtrl","idAttrValue"],[1,"w-40","text-right"],[1,"w-52",3,"formCtrl","idAttrValue"],[1,"flex","items-center","gap-4"],["icon","add-line",1,"cursor-pointer","w-6",3,"click"],["icon","delete-bin-line","class","cursor-pointer w-6 fill-red-500",3,"click",4,"ngIf","ngIfElse"],["falseContent",""],["icon","delete-bin-line",1,"cursor-pointer","w-6","fill-red-500",3,"click"],[1,"w-6","width:24px;"]],template:function(e,n){if(1&e&&(t._UZ(0,"app-text-container",0)(1,"app-select-suggest-container",1)(2,"app-select-clear-container",2)(3,"app-text-container",3),t.TgZ(4,"span",4),t._uU(5),t.qZA(),t._UZ(6,"app-text-container",5),t.TgZ(7,"div",6)(8,"app-icon",7),t.NdJ("click",function(){return n.add.emit()}),t.qZA(),t.YNc(9,ro,1,0,"app-icon",8),t.YNc(10,io,1,0,"ng-template",null,9,t.W1O),t.qZA()),2&e){const r=t.MAs(11);t.MGl("idAttrValue","deposit-detail-",n.index,"-payment_supplier_id"),t.Q6J("formCtrl",n.ctrls.payment_supplier_id),t.xp6(1),t.Q6J("formCtrl",n.ctrls.payment_supplier_id)("suggests",n.supplierSuggests),t.xp6(1),t.Q6J("formCtrl",n.ctrls.payment_type_division_code)("options",n.paymentClassficationOption),t.xp6(1),t.MGl("idAttrValue","deposit-detail-",n.index,"-payment_amount"),t.Q6J("textRight",!0)("formCtrl",n.ctrls.payment_amount),t.xp6(2),t.Oqu(n.ctrls.scheduled_payment_amount.value),t.xp6(1),t.MGl("idAttrValue","deposit-detail-",n.index,"-remarks"),t.Q6J("formCtrl",n.ctrls.remarks_1),t.xp6(3),t.Q6J("ngIf",n.index)("ngIfElse",r)}},dependencies:[h.O5,vt.O,B.o,be.I,j.X],styles:["[_nghost-%COMP%]{margin-bottom:1rem;display:flex;align-items:center;gap:1.5rem}"]}),a})(),so=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[h.ez,c.UX,St.i,K.s,X.Q,Qt.x,Ft.N,mt.a,ct.G]}),a})();t.B6R(me,[h.sg,c.JL,c.sg,oo],[]);let ve=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[h.ez,pt.z]}),a})(),lo=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[h.ez,no,so,c.UX,Gt.X,$t.Z,pt.z,Ft.N,Dt.W,xt.r,h.ez,lt.u,Et.Z,ut.h,At,X.Q,mt.a,Ct.C,Vt.J,Lt.M,ve,K.s,fe.l,Ht.z,st.u,Tt.D,Jt.H,ct.G,Yt.x]}),a})(),uo=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[h.ez,Gt.X,$t.Z,Dt.W,h.ez,lt.u,Et.Z,ut.h,At,X.Q,mt.a,Ct.C,ve,Ht.z,st.u,Tt.D,ct.G,K.s]}),a})(),po=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({providers:[C.v],imports:[h.ez,ge,Vi,zi,lo,uo,st.u,lt.u]}),a})()},2e3:(Xt,G,l)=>{l.d(G,{d:()=>t});var h=l(2340),y=l(4004),S=l(1751),Z=l(1571);let t=(()=>{class C extends S.O{constructor(){super(...arguments),this.storeEndpoint=h.pU.storeApi.endpoint}getAll(E={}){return this.httpOptions.params=E,this.http.get(this.storeEndpoint,this.httpOptions)}find(E){return this.http.get(`${this.storeEndpoint}/${E}`)}add(E){const b=this.generateFormData(E);return this.http.post(this.storeEndpoint,b)}update(E,b){const c=this.generateFormData(b);return this.http.patch(`${this.storeEndpoint}/${E}`,c)}remove(E){return this.http.delete(`${this.storeEndpoint}/${E}`)}getAsSelectOptions(){return this.getAll().pipe((0,y.U)(E=>E.data.map(c=>({value:c.id,text:c.name}))))}}return C.\u0275fac=function(){let J;return function(b){return(J||(J=Z.n5z(C)))(b||C)}}(),C.\u0275prov=Z.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()},4562:(Xt,G,l)=>{l.d(G,{p:()=>J});var h=l(2340),y=l(262),S=l(4004),Z=l(1751),t=l(529),C=l(1571);let J=(()=>{class E extends Z.O{constructor(){super(...arguments),this.endpoint=h.pU.supplierApi.endpoint}getAll(c={}){return this.httpOptions.params=c,this.http.get(this.endpoint,this.httpOptions).pipe((0,y.K)(this.setErrorMessage("\u4ed5\u5165\u5148\u4e00\u89a7\u306e\u53d6\u5f97")))}find(c){return this.http.get(`${this.endpoint}/${c}`).pipe((0,y.K)(this.setErrorMessage("\u4ed5\u5165\u5148\u60c5\u5831\u306e\u53d6\u5f97")))}getCsv(c,O){const U={params:O,responseType:"text",headers:new t.WM({"X-Download":c})};return this.http.get(this.endpoint,U).pipe((0,y.K)(this.setErrorMessage("\u4e00\u62ec\u767b\u9332\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u53d6\u5f97")))}add(c){const O=this.generateFormData(c);return this.http.post(this.endpoint,O).pipe((0,y.K)(this.setErrorMessage("\u4ed5\u5165\u5148\u60c5\u5831\u306e\u767b\u9332")))}bulkAdd(c){const O=this.generateFormData({file:c});return this.http.put(this.endpoint,O).pipe((0,y.K)(this.setErrorMessage("\u4ed5\u5165\u5148\u60c5\u5831\u306e\u4e00\u62ec\u767b\u9332")))}update(c,O){const U=this.generateFormData(O);return this.http.patch(`${this.endpoint}/${c}`,U).pipe((0,y.K)(this.setErrorMessage("\u4ed5\u5165\u5148\u60c5\u5831\u306e\u66f4\u65b0")))}remove(c){return this.http.delete(`${this.endpoint}/${c}`).pipe((0,y.K)(this.setErrorMessage("\u4ed5\u5165\u5148\u60c5\u5831\u306e\u524a\u9664")))}getAsSelectOptions(){return this.getAll({$select:"id,name"}).pipe((0,S.U)(c=>c.data.map(U=>({value:U.id,text:U.name}))))}}return E.\u0275fac=function(){let b;return function(O){return(b||(b=C.n5z(E)))(O||E)}}(),E.\u0275prov=C.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})()}}]);