"use strict";(self.webpackChunknisshin=self.webpackChunknisshin||[]).push([[826],{8187:(D,Z,a)=>{a.d(Z,{a:()=>m});var l=a(1571),_=a(6303),C=a(7362);const T=["*",[["","message",""]]],v=["*","[message]"];let m=(()=>{class p{constructor(){this.inputType="text",this.invalid=!1}}return p.\u0275fac=function(P){return new(P||p)},p.\u0275cmp=l.Xpm({type:p,selectors:[["app-date-term"]],inputs:{inputType:"inputType",nameAttrValue:"nameAttrValue",idAttrValue:"idAttrValue",formCtrl:"formCtrl",placeholder:"placeholder",invalid:"invalid",labelSize:"labelSize"},ngContentSelectors:v,decls:4,vars:7,consts:[[1,"block","ml-1","mb-1",3,"labelSize","forAttrValue"],[3,"nameAttrValue","idAttrValue","formCtrl","placeholder","invalid"]],template:function(P,g){1&P&&(l.F$t(T),l.TgZ(0,"app-label",0),l.Hsn(1),l.qZA(),l._UZ(2,"app-datepicker",1),l.Hsn(3,1)),2&P&&(l.Q6J("labelSize",g.labelSize)("forAttrValue",g.idAttrValue),l.xp6(2),l.Q6J("nameAttrValue",g.nameAttrValue)("idAttrValue",g.idAttrValue)("formCtrl",g.formCtrl)("placeholder",g.placeholder)("invalid",g.invalid))},dependencies:[_._,C.Q]}),p})()},3415:(D,Z,a)=>{a.d(Z,{x:()=>v});var l=a(6895),_=a(6320),C=a(1924),T=a(1571);let v=(()=>{class m{}return m.\u0275fac=function(t){return new(t||m)},m.\u0275mod=T.oAB({type:m}),m.\u0275inj=T.cJS({imports:[l.ez,_.r,C.Z]}),m})()},9434:(D,Z,a)=>{a.d(Z,{H:()=>v});var l=a(6895),_=a(6320),C=a(8460),T=a(1571);let v=(()=>{class m{}return m.\u0275fac=function(t){return new(t||m)},m.\u0275mod=T.oAB({type:m}),m.\u0275inj=T.cJS({imports:[l.ez,_.r,C.A]}),m})()},956:(D,Z,a)=>{a.d(Z,{$:()=>C});var l=a(1571),_=a(1914);let C=(()=>{class T{constructor(){}}return T.\u0275fac=function(m){return new(m||T)},T.\u0275cmp=l.Xpm({type:T,selectors:[["app-delete-link-org"]],decls:4,vars:0,consts:[[1,"cursor-pointer"],["icon","delete-bin-line","appendClassForIcon","fill-danger group-hover:fill-danger-hover"],[1,"text-gray-900","group-hover:text-danger-hover"]],template:function(m,p){1&m&&(l.TgZ(0,"div",0)(1,"app-icon-container",1)(2,"p",2),l._uU(3,"\u524a\u9664"),l.qZA()()())},dependencies:[_.J]}),T})()},2923:(D,Z,a)=>{a.d(Z,{D:()=>T});var l=a(6895),_=a(1326),C=a(1571);let T=(()=>{class v{}return v.\u0275fac=function(p){return new(p||v)},v.\u0275mod=C.oAB({type:v}),v.\u0275inj=C.cJS({imports:[l.ez,_.z]}),v})()},9826:(D,Z,a)=>{a.r(Z),a.d(Z,{PriceChangeModule:()=>mi});var l=a(6895),_=a(1690),C=a(727),T=a(5698),v=a(9300),m=a(8037),p=a(6585),t=a(1571),P=a(1609),g=a(2334),x=a(8832),O=a(2125);let y=(()=>{class i{constructor(e,n,o,s){this.modalService=e,this.router=n,this.errorService=o,this.common=s,this.isLoading=!1,this.subscription=new C.w0}ngOnInit(){this.subscription.add(this.errorService.getError().subscribe(e=>{this.handleError(e)})),this.subscription.add(this.common.loading$.subscribe(e=>{setTimeout(()=>this.isLoading=e)}))}handleError(e){e.redirectPath&&(this.redirectPath=e.redirectPath),this.modalService.setModal(e.title,0===e.status?e.message+m.c.GUIDANCE_OF_SUPPORT:`\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9: ${e.status} \n\u30e1\u30c3\u30bb\u30fc\u30b8: `+e.message+m.c.GUIDANCE_OF_SUPPORT,"danger",p.yR.BUTTON_TITLE.CLOSE,""),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,T.q)(1),(0,v.h)(o=>this.modalService.getModalProperties().title===e.title)).subscribe(o=>{this.redirectPath&&this.router.navigateByUrl(this.redirectPath)}))}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(P.Z),t.Y36(_.F0),t.Y36(g.T),t.Y36(x.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-price-change"]],decls:2,vars:1,consts:[[3,"isLoading"]],template:function(e,n){1&e&&t._UZ(0,"router-outlet")(1,"app-loading-container",0),2&e&&(t.xp6(1),t.Q6J("isLoading",n.isLoading))},dependencies:[_.lC,O.o]}),i})();var h=a(7579),f=a(529),E=a(8505),R=a(3900),b=a(262),S=a(9646);Array(15).fill(null).map((i,r)=>({id:r+1,product_id:r+1,product_name:`Product ${r+1}`,product_name_kana:`Product ${r+1}`,supplier_sales_tax_division_id:r+1,sales_tax_division_id:r+1,gross_profit_rate:10*(r+1),b_gross_profit_rate:10*(r+1)+1,c_gross_profit_rate:10*(r+1)+2,cost_price:1e3*(r+1),b_cost_price:1e3*(r+1)+100,c_cost_price:1e3*(r+1)+200,selling_price:2e3*(r+1),b_selling_price:2e3*(r+1)+200,c_selling_price:2e3*(r+1)+400,scheduled_price_change_date:`2023-06-${String(r+1).padStart(2,"0")}T00:00:00`,price_change_completion_date:`2023-06-${String(r+2).padStart(2,"0")}T00:00:00`,created_at:`2023-06-${String(r+1).padStart(2,"0")}T00:00:00`,created_id:r+1,updated_at:`2023-06-${String(r+2).padStart(2,"0")}T00:00:00`,updated_id:r+2,deleted_at:`2023-06-${String(r+3).padStart(2,"0")}T00:00:00`,deleted_id:r+3,employee_created_last_name:`CreatedLastName${r+1}`,employee_created_first_name:`CreatedFirstName${r+1}`,employee_updated_last_name:`UpdatedLastName${r+1}`,employee_updated_first_name:`UpdatedFirstName${r+1}`}));var ot=a(2340),at=a(1751);let B=(()=>{class i extends at.O{constructor(){super(...arguments),this.endpoint=ot.pU.priceChangeApi.endpoint}getAll(e={}){return this.httpOptions.params=e,this.http.get(this.endpoint,this.httpOptions).pipe((0,b.K)(this.setErrorMessage("\u4fa1\u683c\u5909\u66f4\u4e00\u89a7\u306e\u53d6\u5f97")))}find(e){return this.http.get(`${this.endpoint}/${e}`).pipe((0,b.K)(this.setErrorMessage("\u4fa1\u683c\u5909\u66f4\u60c5\u5831\u306e\u53d6\u5f97")))}getCsv(e){const n={responseType:"text",headers:new f.WM({"X-Download":e})};return this.http.get(this.endpoint,n).pipe((0,b.K)(this.setErrorMessage("\u4e00\u62ec\u767b\u9332\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u53d6\u5f97")))}add(e){const n=this.generateFormData(e);return this.http.post(this.endpoint,n).pipe((0,b.K)(this.setErrorMessage("\u4fa1\u683c\u5909\u66f4\u306e\u767b\u9332")))}bulkAdd(e){const n=this.generateFormData({file:e});return this.http.put(this.endpoint,n).pipe((0,b.K)(this.setErrorMessage("\u4fa1\u683c\u5909\u66f4\u60c5\u5831\u306e\u4e00\u62ec\u767b\u9332")))}update(e,n){const o=this.generateFormData(n);return this.http.patch(`${this.endpoint}/${e}`,o).pipe((0,b.K)(this.setErrorMessage("\u4fa1\u683c\u5909\u66f4\u60c5\u5831\u306e\u66f4\u65b0")))}remove(e){return this.http.delete(`${this.endpoint}/${e}`).pipe((0,b.K)(this.setErrorMessage("\u4fa1\u683c\u5909\u66f4\u60c5\u5831\u306e\u524a\u9664")))}}return i.\u0275fac=function(){let r;return function(n){return(r||(r=t.n5z(i)))(n||i)}}(),i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var st=a(2640);let ct=(()=>{class i{constructor(e,n){this.priceChangeService=e,this.common=n,this.subscription=new C.w0,this.errorEvent=new t.vpe,this.filter={},this.pages={page:1,itemsPerPage:10,sort:{column:"\u4fa1\u683c\u5909\u66f4ID",order:"desc"}},this.tableParams=new h.x,this.tableNameMapping=[{name:"id",name_jp:"\u4fa1\u683c\u5909\u66f4ID"},{name:"product_id",name_jp:"\u5546\u54c1ID"},{name:"product_name",name_jp:"\u5546\u54c1\u540d"},{name:"scheduled_price_change_date",name_jp:"\u4fa1\u683c\u5909\u66f4\u4e88\u5b9a\u65e5\u6642"},{name:"price_change_completion_date",name_jp:"\u4fa1\u683c\u5909\u66f4\u5b8c\u4e86\u65e5\u6642"}]}ngOnInit(){this.getTableData(),this.tableEvent.next(this.pages)}getTableData(){this.subscription.add(this.tableEvent.pipe((0,E.b)(e=>this.common.loading=!0),(0,R.w)(e=>this.priceChangeService.getAll(this.createApiParams(e))),(0,b.K)(e=>(0,S.of)(e))).subscribe({next:e=>{this.common.loading=!1,e instanceof f.UA?this.handleError(e.status,e.error.message):(console.log(e),this.tableParams.next(this.createTableParams(e)))},complete:()=>this.getTableData()}))}createApiParams(e){this.isTableWithPaginationEvent(e)?this.pages=e:(this.filter=e,this.pages.page=1);const o=this.tableNameMapping.find(d=>d.name_jp===this.pages.sort.column)?.name;let s;return s="product_name"===o?"product_name_kana":o,{...this.filter,limit:this.pages.itemsPerPage,offset:(this.pages.page-1)*this.pages.itemsPerPage,sort:s?`${s}:${this.pages.sort.order}`:""}}isTableWithPaginationEvent(e){const{page:n,itemsPerPage:o,sort:s}=e;return"number"==typeof n&&"number"==typeof o&&"object"==typeof s}createTableParams(e){const n=this.tableNameMapping.map(s=>s.name_jp),o=e.data.map(s=>this.tableNameMapping.map(d=>s[d.name]));return o.forEach((s,d)=>{let u=-1;u=n.indexOf("\u4fa1\u683c\u5909\u66f4ID"),s[u]={href:`./detail/${s[u]}`,text:s[u]+""},u=n.indexOf("\u5546\u54c1ID"),s[u]={href:`/master/product/detail/${s[u]}`,text:s[u]+""},u=n.indexOf("\u4fa1\u683c\u5909\u66f4\u4e88\u5b9a\u65e5\u6642"),s[u]=null==s[u]||""===s[u]||"NaT"===s[u]?"":new Date(String(s[u])).toLocaleString(),u=n.indexOf("\u4fa1\u683c\u5909\u66f4\u5b8c\u4e86\u65e5\u6642"),s[u]=null==s[u]||""===s[u]||"NaT"===s[u]?"":new Date(String(s[u])).toLocaleString()}),{total:e.totalItems,header:n,body:o}}handleError(e,n){this.errorEvent.emit({status:e,title:"\u4fa1\u683c\u5909\u66f4\u4e00\u89a7\uff1a"+p.yR.TITLE.HAS_ERROR,message:n})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(B),t.Y36(x.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-table"]],inputs:{tableEvent:"tableEvent"},outputs:{errorEvent:"errorEvent"},decls:2,vars:2,consts:[[3,"params","loading","pageChange"]],template:function(e,n){1&e&&(t.TgZ(0,"app-table-with-pagination",0),t.NdJ("pageChange",function(s){return n.tableEvent.next(s)}),t._uU(1," \u4fa1\u683c\u5909\u66f4\u4e00\u89a7\n"),t.qZA()),2&e&&t.Q6J("params",n.tableParams)("loading",n.common.loading)},dependencies:[st.i]}),i})();var $=a(5450),F=a(1267),c=a(4006),V=a(6082),W=a(9612),k=a(5146),X=a(3761),ut=a(3148);function lt(i,r){1&i&&t.GkF(0)}function pt(i,r){1&i&&t.GkF(0)}function _t(i,r){1&i&&t.GkF(0,25)}function dt(i,r){1&i&&t.GkF(0)}function gt(i,r){1&i&&t.GkF(0,25)}function mt(i,r){1&i&&(t.TgZ(0,"app-button",26),t._uU(1," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA())}function ht(i,r){1&i&&(t.TgZ(0,"app-button",27),t._uU(1," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA())}function ft(i,r){1&i&&(t.TgZ(0,"span",30),t._uU(1,"\u5fc5\u9808"),t.qZA())}function Ct(i,r){if(1&i&&(t.TgZ(0,"div",28)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,ft,2,0,"span",29),t.qZA()),2&i){const e=r.label,n=r.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",n)}}function vt(i,r){if(1&i&&(t.TgZ(0,"p",31),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}const Tt=function(){return{label:"\u5546\u54c1",required:!1}},xt=function(){return{label:"\u4fa1\u683c\u5909\u66f4\u4e88\u5b9a\u65e5",required:!1}},bt=function(){return{label:"\u4fa1\u683c\u5909\u66f4\u5b8c\u4e86\u65e5",required:!1}};let At=(()=>{class i{constructor(e,n){this.fb=e,this.productService=n,this.searchEvent=new t.vpe,this.hasSearchPanelOpened=!1,this.rotateAnimation="",this.filteredOptions=[],this.isSearchLoading=!1,this.errorConst=m.c,this.searchForm=this.fb.group({product_id:"",product_name:"",scheduled_price_change_date:this.fb.group({from:"",to:""},{validators:[$.d.beforeFromDate()]}),price_change_completion_date:this.fb.group({from:"",to:""},{validators:[$.d.beforeFromDate()]})})}get sfc(){return this.searchForm.controls}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getProductSuggests(){return{observable:this.productService.getAll({name:this.sfc.product_name.value}),idField:"id",nameField:"name"}}handleClickSearchPaneToggleButton(){this.hasSearchPanelOpened?(this.hasSearchPanelOpened=!1,this.rotateAnimation="rotate-animation-0",this.searchForm.reset({product_id:"",product_name:"",scheduled_price_change_date:{from:"",to:""},price_change_completion_date:{from:"",to:""}})):(this.hasSearchPanelOpened=!0,this.rotateAnimation="rotate-animation-180")}handleClickSearchClearButton(){this.searchForm.reset({product_id:"",product_name:"",scheduled_price_change_date:{from:"",to:""},price_change_completion_date:{from:"",to:""}})}handleClickSearchSubmitButton(){const e=this.searchForm.value,o=(0,F.vP)({product_id:e.product_id,scheduled_price_change_date:e.scheduled_price_change_date,price_change_completion_date:e.price_change_completion_date});this.searchEvent.emit((0,F.g3)(o))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.qu),t.Y36(V.M))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-search"]],outputs:{searchEvent:"searchEvent"},decls:39,vars:33,consts:[[1,"mt-8"],["btnType","button",3,"click"],[1,"w-6"],["icon","filter-2-line"],[1,"inline-block","ml-1","mr-2"],[1,"inline-block","w-6"],["icon","arrow-down-s-fill"],[1,"mt-6"],[1,"price-change-search","width-limit-break","bg-white"],["autocomplete","off",1,"w-[1280px]","mx-auto","px-4",3,"formGroup","ngSubmit"],[1,"flex","gap-4"],[1,"w-1/4"],["nameAttrValue","product_name","idAttrValue","product-name",3,"idCtrl","nameCtrl","apiInput","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"flex","gap-4","mt-6"],[1,"w-1/2"],["nameAttrValue","scheduled_price_change_date_from","idAttrValue","scheduled-price-change-date-from","toNameAttrValue","scheduled_price_change_date_to","toIdAttrValue","scheduled-price-change-date-to",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],["nameAttrValue","price_change_completion_date_from","idAttrValue","price-change-completion-date-from","toNameAttrValue","price_change_completion_date_to","toIdAttrValue","price-change-completion-date-to",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],[1,"flex","gap-8","mt-10"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",4,"ngIf","ngIfElse"],[1,"mt-2","text-sm","text-red"],["disable",""],["labels",""],["beforeFromDate",""],["message",""],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover"],["btnFillColor","text-white bg-slate-300 hover:bg-slate-300"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return n.handleClickSearchPaneToggleButton()}),t.TgZ(2,"span",2),t._UZ(3,"app-icon",3),t.qZA(),t.TgZ(4,"span",4),t._uU(5),t.qZA(),t.TgZ(6,"span",5),t._UZ(7,"app-icon",6),t.qZA()(),t.TgZ(8,"div",7)(9,"div",8)(10,"form",9),t.NdJ("ngSubmit",function(){return n.handleClickSearchSubmitButton()}),t.TgZ(11,"div",10)(12,"div",11)(13,"app-real-time-suggest-container",12),t.YNc(14,lt,1,0,"ng-container",13),t.qZA()(),t._UZ(15,"div",11)(16,"div",11)(17,"div",11),t.qZA(),t.TgZ(18,"div",14)(19,"div",15)(20,"app-date-term-clear-container",16),t.YNc(21,pt,1,0,"ng-container",13),t.YNc(22,_t,1,0,"ng-container",17),t.qZA()(),t.TgZ(23,"div",15)(24,"app-date-term-clear-container",18),t.YNc(25,dt,1,0,"ng-container",13),t.YNc(26,gt,1,0,"ng-container",17),t.qZA()()(),t.TgZ(27,"div",19)(28,"app-button",1),t.NdJ("click",function(){return n.handleClickSearchClearButton()}),t._uU(29," \u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2 "),t.qZA(),t.YNc(30,mt,2,0,"app-button",20),t.qZA(),t.TgZ(31,"p",21),t._uU(32," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()()()(),t.YNc(33,ht,2,0,"ng-template",null,22,t.W1O),t.YNc(35,Ct,4,2,"ng-template",null,23,t.W1O),t.YNc(37,vt,2,1,"ng-template",null,24,t.W1O)),2&e){const o=t.MAs(34),s=t.MAs(36),d=t.MAs(38);t.xp6(5),t.hij(" ",n.hasSearchPanelOpened?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(n.rotateAnimation),t.xp6(3),t.ekj("is-open",n.hasSearchPanelOpened)("shadow",n.hasSearchPanelOpened),t.xp6(1),t.Q6J("formGroup",n.searchForm),t.xp6(3),t.Q6J("idCtrl",n.sfc.product_id)("nameCtrl",n.sfc.product_name)("apiInput",n.getProductSuggests())("invalid",n.formControlStateManager(n.sfc.product_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.DdM(30,Tt)),t.xp6(6),t.Q6J("dateFromFormCtrl",n.sfc.scheduled_price_change_date.controls.from)("dateToFormCtrl",n.sfc.scheduled_price_change_date.controls.to)("invalid",!!n.sfc.scheduled_price_change_date.errors),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.DdM(31,xt)),t.xp6(1),t.Q6J("ngIf",null==n.sfc.scheduled_price_change_date.errors?null:n.sfc.scheduled_price_change_date.errors.beforeFromDate)("ngIfThen",d),t.xp6(2),t.Q6J("dateFromFormCtrl",n.sfc.price_change_completion_date.controls.from)("dateToFormCtrl",n.sfc.price_change_completion_date.controls.to)("invalid",!!n.sfc.price_change_completion_date.errors),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.DdM(32,bt)),t.xp6(1),t.Q6J("ngIf",null==n.sfc.price_change_completion_date.errors?null:n.sfc.price_change_completion_date.errors.beforeFromDate)("ngIfThen",d),t.xp6(4),t.Q6J("ngIf",n.searchForm.valid)("ngIfElse",o)}},dependencies:[l.O5,l.tP,c._Y,c.JL,c.sg,W.Y,k.r,X.o,ut.w],styles:[".price-change-search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease-in;overflow:hidden}.price-change-search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0;overflow:visible}"]}),i})();var q=a(7030),Et=a(3360),Ft=a(2167);const Zt=function(i){return{path:i,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Pt=function(){return{text:"\u4fa1\u683c\u5909\u66f4\u4e00\u89a7"}},Ot=function(i,r){return[i,r]};let Mt=(()=>{class i{constructor(e){this.errorService=e,this.settingMenuPath="/setting",this.subscription=new C.w0,this.searchEvent=new h.x,this.tableEvent=new h.x,this.isDuringAcquisition=!1}ngOnInit(){this.subscription.add(this.searchEvent.subscribe(e=>{this.tableEvent.next(e)}))}handleError(e,n){this.errorService.setError({status:e.status,title:e.title?e.title:"\u30a8\u30e9\u30fc",message:e.message?e.message:"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002",redirectPath:n||void 0})}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(g.T))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-list"]],decls:9,vars:8,consts:[[3,"breadcrumbList"],[3,"searchEvent"],[1,"flex","justify-end","gap-8","mt-6"],["path","./add"],["path","./bulk-add"],[1,"mt-2"],[3,"tableEvent","errorEvent"]],template:function(e,n){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main")(2,"div")(3,"app-search",1),t.NdJ("searchEvent",function(s){return n.searchEvent.next(s)}),t.qZA()(),t.TgZ(4,"div",2),t._UZ(5,"app-new-registration-link-org",3)(6,"app-bulk-registration-link-org",4),t.qZA(),t.TgZ(7,"div",5)(8,"app-table",6),t.NdJ("errorEvent",function(s){return n.handleError(s)}),t.qZA()()()),2&e&&(t.Q6J("breadcrumbList",t.WLB(5,Ot,t.VKq(2,Zt,n.settingMenuPath),t.DdM(4,Pt))),t.xp6(8),t.Q6J("tableEvent",n.tableEvent))},dependencies:[ct,At,q.Z,Et.S,Ft.p]}),i})();var Y=a(1269),L=a(8782),Q=a(1805),St=a(9586),Ut=a(956),It=a(4720);function Rt(i,r){if(1&i&&(t.TgZ(0,"div",11),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.priceChange.cost_price,"1.0-0")," ")}}function Dt(i,r){if(1&i&&(t.TgZ(0,"div",11),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.priceChange.b_cost_price,"1.0-0")," ")}}function Nt(i,r){if(1&i&&(t.TgZ(0,"div",11),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.priceChange.c_cost_price,"1.0-0")," ")}}function yt(i,r){if(1&i&&(t.TgZ(0,"div",11),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.priceChange.gross_profit_rate,"1.0-0")," % ")}}function Bt(i,r){if(1&i&&(t.TgZ(0,"div",11),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.priceChange.b_gross_profit_rate,"1.0-0")," % ")}}function qt(i,r){if(1&i&&(t.TgZ(0,"div",11),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.priceChange.c_gross_profit_rate,"1.0-0")," % ")}}function Jt(i,r){if(1&i&&(t.TgZ(0,"div",11),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.priceChange.selling_price,"1.0-0")," ")}}function kt(i,r){if(1&i&&(t.TgZ(0,"div",11),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.priceChange.b_selling_price,"1.0-0")," ")}}function Yt(i,r){if(1&i&&(t.TgZ(0,"div",11),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.priceChange.c_selling_price,"1.0-0")," ")}}function Lt(i,r){if(1&i&&(t.TgZ(0,"div",11),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.priceChange.employee_created_last_name+" "+e.priceChange.employee_created_first_name," ")}}function Qt(i,r){if(1&i&&(t.TgZ(0,"div",11),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.priceChange.employee_updated_last_name+" "+e.priceChange.employee_updated_first_name," ")}}const Vt=function(i){return{path:i,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Kt=function(i){return{path:i,text:"\u4fa1\u683c\u5909\u66f4\u4e00\u89a7"}},Gt=function(){return{text:"\u4fa1\u683c\u5909\u66f4\u8a73\u7d30"}},wt=function(i,r,e){return[i,r,e]};let jt=(()=>{class i{constructor(e,n,o,s,d,u,M,J){this.route=e,this.errorService=n,this.authorService=o,this.priceChangeService=s,this.modalService=d,this.flashMessageService=u,this.router=M,this.common=J,this.subscription=new C.w0,this.listPagePath="/setting/price-change",this.settingMenuPath="/setting",this.priceChange={}}ngOnInit(){if(this.authorService.author){const o=this.authorService.author;this.updater=o.last_name+" "+o.first_name}else this.subscription.add(this.authorService.author$.subscribe(o=>{this.updater=o.last_name+" "+o.first_name}));const e=this.route.snapshot.params.id;(0,F.oG)(e)?this.handleError(400,"\u30d1\u30e9\u30e1\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u4e00\u89a7\u753b\u9762\u3078\u623b\u308a\u307e\u3059\u3002",this.listPagePath):(this.selectedId=Number(e),this.editPagePath=this.listPagePath+"/edit/"+this.selectedId,this.getPriceChange(this.selectedId))}getPriceChange(e){this.common.loading=!0,this.priceChangeService.find(e).pipe((0,b.K)(n=>(this.common.loading=!1,(0,S.of)(n)))).subscribe(n=>{n instanceof f.UA?this.handleError(n.status,n.error?n.error.message:n.message):(this.priceChange=n.data[0],this.common.loading=!1)})}handleDeleteLinkClick(){const e="\u4fa1\u683c\u5909\u66f4"+p.yR.TITLE.DELETE;this.modalService.setModal(e,p.yR.BODY.DELETE,"danger",p.yR.BUTTON_TITLE.DELETE,p.yR.BUTTON_TITLE.CANCEL),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,T.q)(1),(0,v.h)(o=>this.modalService.getModalProperties().title===e)).subscribe(o=>{o===p.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&(this.common.loading=!0,this.priceChangeService.remove(this.selectedId).pipe((0,b.K)(s=>(0,S.of)(s))).subscribe(s=>{this.common.loading=!1,s instanceof f.UA?this.errorService.setError({status:s.status,title:e,message:s.error?s.error.message:s.message,redirectPath:this.listPagePath}):(this.flashMessageService.setFlashMessage(s.message,"success",15e3),this.router.navigateByUrl(this.listPagePath))}))}))}handleError(e,n,o){this.errorService.setError({status:e,title:"\u4fa1\u683c\u5909\u66f4\u8a73\u7d30\uff1a"+p.yR.TITLE.HAS_ERROR,message:n,redirectPath:o})}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(_.gz),t.Y36(g.T),t.Y36(Y.Y),t.Y36(B),t.Y36(P.Z),t.Y36(L.P),t.Y36(_.F0),t.Y36(x.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-detail"]],decls:94,vars:42,consts:[[3,"breadcrumbList"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"flex","flex-row","items-center","gap-6"],[3,"path"],[3,"click"],[1,"width-limit-break","border-t","border-gray-400"],[1,"mt-8","bg-white","border-t","border-y","border-gray-200","shadow"],[1,""],[1,"flex","flex-row","items-center","border-b","border-b-gray-200"],[1,"px-2","py-3","bg-slate-100","min-w-[200px]"],[1,"px-2","py-3","border-l","border-l-gray-200","grow"],["class","px-2 py-3 border-l border-l-gray-200 grow",4,"ngIf"]],template:function(e,n){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main")(2,"h1",1),t._uU(3,"\u4fa1\u683c\u5909\u66f4\u8a73\u7d30"),t.qZA(),t.TgZ(4,"div",2)(5,"div",3)(6,"app-back-to-link-org",4),t._uU(7,"\u4e00\u89a7\u3078\u623b\u308b"),t.qZA(),t.TgZ(8,"app-edit-link-org",4),t._uU(9,"\u7de8\u96c6"),t.qZA(),t.TgZ(10,"app-delete-link-org",5),t.NdJ("click",function(){return n.handleDeleteLinkClick()}),t.qZA()(),t.TgZ(11,"app-last-updater-org"),t._uU(12),t.qZA()(),t._UZ(13,"hr",6),t.TgZ(14,"div",7)(15,"ul",8)(16,"li",9)(17,"div",10),t._uU(18,"\u5546\u54c1ID"),t.qZA(),t.TgZ(19,"div",11),t._uU(20),t.qZA()(),t.TgZ(21,"li",9)(22,"div",10),t._uU(23,"\u5546\u54c1\u540d"),t.qZA(),t.TgZ(24,"div",11),t._uU(25),t.qZA()(),t.TgZ(26,"li",9)(27,"div",10),t._uU(28,"\u4fa1\u683c\u5909\u66f4\u4e88\u5b9a\u65e5"),t.qZA(),t.TgZ(29,"div",11),t._uU(30),t.ALo(31,"date"),t.qZA()(),t.TgZ(32,"li",9)(33,"div",10),t._uU(34,"\u4fa1\u683c\u5909\u66f4\u5b8c\u4e86\u65e5\u6642"),t.qZA(),t.TgZ(35,"div",11),t._uU(36),t.ALo(37,"date"),t.qZA()(),t.TgZ(38,"li",9)(39,"div",10),t._uU(40,"\u30d0\u30e9\u4ed5\u5165\u5358\u4fa1"),t.qZA(),t.YNc(41,Rt,3,4,"div",12),t.qZA(),t.TgZ(42,"li",9)(43,"div",10),t._uU(44,"\u5c0f\u5206\u3051\u4ed5\u5165\u5358\u4fa1"),t.qZA(),t.YNc(45,Dt,3,4,"div",12),t.qZA(),t.TgZ(46,"li",9)(47,"div",10),t._uU(48,"\u30b1\u30fc\u30b9\u4ed5\u5165\u5358\u4fa1"),t.qZA(),t.YNc(49,Nt,3,4,"div",12),t.qZA(),t.TgZ(50,"li",9)(51,"div",10),t._uU(52,"\u30d0\u30e9\u7c97\u5229\u7387"),t.qZA(),t.YNc(53,yt,3,4,"div",12),t.qZA(),t.TgZ(54,"li",9)(55,"div",10),t._uU(56,"\u5c0f\u5206\u3051\u7c97\u5229\u7387"),t.qZA(),t.YNc(57,Bt,3,4,"div",12),t.qZA(),t.TgZ(58,"li",9)(59,"div",10),t._uU(60,"\u30b1\u30fc\u30b9\u7c97\u5229\u7387"),t.qZA(),t.YNc(61,qt,3,4,"div",12),t.qZA(),t.TgZ(62,"li",9)(63,"div",10),t._uU(64,"\u30d0\u30e9\u58f2\u4fa1"),t.qZA(),t.YNc(65,Jt,3,4,"div",12),t.qZA(),t.TgZ(66,"li",9)(67,"div",10),t._uU(68,"\u5c0f\u5206\u3051\u58f2\u4fa1"),t.qZA(),t.YNc(69,kt,3,4,"div",12),t.qZA(),t.TgZ(70,"li",9)(71,"div",10),t._uU(72,"\u30b1\u30fc\u30b9\u58f2\u4fa1"),t.qZA(),t.YNc(73,Yt,3,4,"div",12),t.qZA(),t.TgZ(74,"li",9)(75,"div",10),t._uU(76,"\u767b\u9332\u8005"),t.qZA(),t.YNc(77,Lt,2,1,"div",12),t.qZA(),t.TgZ(78,"li",9)(79,"div",10),t._uU(80,"\u767b\u9332\u65e5\u6642"),t.qZA(),t.TgZ(81,"div",11),t._uU(82),t.ALo(83,"date"),t.qZA()(),t.TgZ(84,"li",9)(85,"div",10),t._uU(86,"\u6700\u7d42\u66f4\u65b0\u8005"),t.qZA(),t.YNc(87,Qt,2,1,"div",12),t.qZA(),t.TgZ(88,"li",9)(89,"div",10),t._uU(90,"\u6700\u7d42\u66f4\u65b0\u65e5\u6642"),t.qZA(),t.TgZ(91,"div",11),t._uU(92),t.ALo(93,"date"),t.qZA()()()()()),2&e&&(t.Q6J("breadcrumbList",t.kEZ(38,wt,t.VKq(33,Vt,n.settingMenuPath),t.VKq(35,Kt,n.listPagePath),t.DdM(37,Gt))),t.xp6(6),t.Q6J("path",n.listPagePath),t.xp6(2),t.Q6J("path",n.editPagePath),t.xp6(4),t.hij(" \u6700\u7d42\u66f4\u65b0\u8005\uff1a",n.updater?n.updater:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...",""),t.xp6(8),t.hij(" ",n.priceChange.product_id," "),t.xp6(5),t.hij(" ",n.priceChange.product_name," "),t.xp6(5),t.hij(" ",t.xi3(31,21,n.priceChange.scheduled_price_change_date,"yyyy/MM/dd")," "),t.xp6(6),t.hij(" ",t.xi3(37,24,n.priceChange.price_change_completion_date,"yyyy/MM/dd HH:mm:ss")," "),t.xp6(5),t.Q6J("ngIf",n.priceChange.cost_price&&0!==n.priceChange.cost_price),t.xp6(4),t.Q6J("ngIf",n.priceChange.b_cost_price&&0!==n.priceChange.b_cost_price),t.xp6(4),t.Q6J("ngIf",n.priceChange.c_cost_price&&0!==n.priceChange.c_cost_price),t.xp6(4),t.Q6J("ngIf",n.priceChange.gross_profit_rate&&0!==n.priceChange.gross_profit_rate),t.xp6(4),t.Q6J("ngIf",n.priceChange.b_gross_profit_rate&&0!==n.priceChange.b_gross_profit_rate),t.xp6(4),t.Q6J("ngIf",n.priceChange.c_gross_profit_rate&&0!==n.priceChange.c_gross_profit_rate),t.xp6(4),t.Q6J("ngIf",n.priceChange.selling_price&&0!==n.priceChange.selling_price),t.xp6(4),t.Q6J("ngIf",n.priceChange.b_selling_price&&0!==n.priceChange.b_selling_price),t.xp6(4),t.Q6J("ngIf",n.priceChange.c_selling_price&&0!==n.priceChange.c_selling_price),t.xp6(4),t.Q6J("ngIf",n.priceChange.employee_created_last_name&&n.priceChange.employee_created_first_name),t.xp6(5),t.hij(" ",t.xi3(83,27,n.priceChange.created_at,"yyyy/MM/dd HH:mm:ss")," "),t.xp6(5),t.Q6J("ngIf",n.priceChange.employee_updated_last_name&&n.priceChange.employee_updated_first_name),t.xp6(5),t.hij(" ",t.xi3(93,30,n.priceChange.updated_at,"yyyy/MM/dd HH:mm:ss")," "))},dependencies:[l.O5,q.Z,Q.R,St.i,Ut.$,It._,l.JJ,l.uU]}),i})();var H=a(4004),N=a(1884),A=a(349),z=a(2519),K=a(387),tt=a(2195),et=a(8187);function $t(i,r){if(1&i&&(t.TgZ(0,"app-last-updater-org"),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" \u767b\u9332\u8005\uff1a",e.updater," ")}}function Wt(i,r){1&i&&t.GkF(0)}function Xt(i,r){1&i&&t.GkF(0,37)}function Ht(i,r){1&i&&t.GkF(0)}function zt(i,r){1&i&&t.GkF(0,37)}function te(i,r){1&i&&t.GkF(0)}function ee(i,r){1&i&&t.GkF(0,37)}function ne(i,r){1&i&&t.GkF(0)}function ie(i,r){1&i&&t.GkF(0,37)}function re(i,r){1&i&&t.GkF(0)}function oe(i,r){1&i&&t.GkF(0,37)}function ae(i,r){1&i&&t.GkF(0)}function se(i,r){1&i&&t.GkF(0,37)}function ce(i,r){1&i&&t.GkF(0)}function ue(i,r){1&i&&t.GkF(0,37)}function le(i,r){1&i&&t.GkF(0)}function pe(i,r){1&i&&t.GkF(0,37)}function _e(i,r){1&i&&t.GkF(0)}function de(i,r){1&i&&t.GkF(0,37)}function ge(i,r){1&i&&t.GkF(0)}function me(i,r){1&i&&t.GkF(0,37)}const he=function(){return{label:"\u4fa1\u683c\u5909\u66f4\u4e88\u5b9a\u65e5",required:!0}},U=function(i){return{ctrl:i}},fe=function(){return{label:"\u30d0\u30e9\u4ed5\u5165\u5358\u4fa1",required:!0}},Ce=function(){return{label:"\u30d0\u30e9\u7c97\u5229\u7387\uff08%\uff09",required:!1}},ve=function(){return{label:"\u30d0\u30e9\u58f2\u4fa1",required:!0}},Te=function(){return{label:"\u5c0f\u5206\u3051\u4ed5\u5165\u5358\u4fa1",required:!1}},xe=function(){return{label:"\u5c0f\u5206\u3051\u7c97\u5229\u7387\uff08%\uff09",required:!1}},be=function(){return{label:"\u5c0f\u5206\u3051\u58f2\u4fa1",required:!1}},Ae=function(){return{label:"\u30b1\u30fc\u30b9\u4ed5\u5165\u5358\u4fa1",required:!1}},Ee=function(){return{label:"\u30b1\u30fc\u30b9\u7c97\u5229\u7387\uff08%\uff09",required:!1}},Fe=function(){return{label:"\u30b1\u30fc\u30b9\u58f2\u4fa1",required:!1}};function Ze(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",8),t.NdJ("ngSubmit",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.handleClickSaveButton())}),t.TgZ(2,"div",9)(3,"div")(4,"h3",10),t._uU(5,"\u4fa1\u683c\u5909\u66f4\u60c5\u5831\u5165\u529b"),t.qZA(),t._UZ(6,"hr",11),t.TgZ(7,"p",12),t._uU(8," \u203b \u58f2\u4fa1\u307e\u308b\u3081\u6761\u4ef6\u304c\u9069\u7528\u3055\u308c\u308b\u58f2\u4fa1\u304c\u7c97\u5229\u7387\u306b\u3088\u3063\u3066\u7b97\u51fa\u3055\u308c\u305f\u5834\u5408\u3001\u58f2\u4fa1\u306f\u307e\u308b\u3081\u51e6\u7406\u3092\u884c\u3044\u307e\u3059\u304c\u7c97\u5229\u7387\u306f\u518d\u8a08\u7b97\u3055\u308c\u307e\u305b\u3093\u3002 "),t.qZA(),t.TgZ(9,"div",13)(10,"p",10),t._uU(11),t.qZA()(),t.TgZ(12,"div",14)(13,"div",15)(14,"app-date-term",16),t.YNc(15,Wt,1,0,"ng-container",17),t.YNc(16,Xt,1,0,"ng-container",18),t.qZA()(),t._UZ(17,"div",15)(18,"div",15),t.qZA(),t.TgZ(19,"p",19),t._uU(20,"\u4fa1\u683c\u60c5\u5831"),t.qZA(),t._UZ(21,"hr",20),t.TgZ(22,"div",21)(23,"div",22)(24,"div",23)(25,"span"),t._uU(26,"\u30d0\u30e9"),t.qZA()()(),t.TgZ(27,"div",24)(28,"app-text-container",25),t.YNc(29,Ht,1,0,"ng-container",17),t.YNc(30,zt,1,0,"ng-container",18),t.qZA()(),t.TgZ(31,"div",24)(32,"app-text-container",26),t.YNc(33,te,1,0,"ng-container",17),t.YNc(34,ee,1,0,"ng-container",18),t.qZA()(),t.TgZ(35,"div",24)(36,"app-text-container",27),t.YNc(37,ne,1,0,"ng-container",17),t.YNc(38,ie,1,0,"ng-container",18),t.qZA()()(),t._UZ(39,"hr",28),t.TgZ(40,"div",21)(41,"div",22)(42,"div")(43,"span"),t._uU(44,"\u5c0f\u5206\u3051"),t.qZA()()(),t.TgZ(45,"div",24)(46,"app-text-container",29),t.YNc(47,re,1,0,"ng-container",17),t.YNc(48,oe,1,0,"ng-container",18),t.qZA()(),t.TgZ(49,"div",24)(50,"app-text-container",30),t.YNc(51,ae,1,0,"ng-container",17),t.YNc(52,se,1,0,"ng-container",18),t.qZA()(),t.TgZ(53,"div",24)(54,"app-text-container",31),t.YNc(55,ce,1,0,"ng-container",17),t.YNc(56,ue,1,0,"ng-container",18),t.qZA()()(),t._UZ(57,"hr",28),t.TgZ(58,"div",21)(59,"div",22)(60,"div")(61,"span"),t._uU(62,"\u30b1\u30fc\u30b9"),t.qZA()()(),t.TgZ(63,"div",24)(64,"app-text-container",32),t.YNc(65,le,1,0,"ng-container",17),t.YNc(66,pe,1,0,"ng-container",18),t.qZA()(),t.TgZ(67,"div",24)(68,"app-text-container",33),t.YNc(69,_e,1,0,"ng-container",17),t.YNc(70,de,1,0,"ng-container",18),t.qZA()(),t.TgZ(71,"div",24)(72,"app-text-container",34),t.YNc(73,ge,1,0,"ng-container",17),t.YNc(74,me,1,0,"ng-container",18),t.qZA()()()(),t.TgZ(75,"div",35)(76,"app-button",3),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onClickReset())}),t._uU(77,"\u30af\u30ea\u30a2"),t.qZA(),t.TgZ(78,"app-button",36),t._uU(79," \u4fdd\u5b58 "),t.qZA()()()(),t.BQk()}if(2&i){const e=t.oxw(),n=t.MAs(9),o=t.MAs(11);t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(10),t.hij(" \u4fa1\u683c\u5909\u66f4\u5bfe\u8c61\u5546\u54c1\u540d\uff1a",e.priceChange.product_name," "),t.xp6(3),t.Q6J("formCtrl",e.fc.scheduled_price_change_date)("invalid",e.formControlStateManager(e.fc.scheduled_price_change_date)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(72,he)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(73,U,e.fc.scheduled_price_change_date)),t.xp6(12),t.Q6J("formCtrl",e.fc.cost_price)("textRight",!0)("invalid",e.formControlStateManager(e.fc.cost_price)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(75,fe)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(76,U,e.fc.cost_price)),t.xp6(2),t.Q6J("formCtrl",e.fc.gross_profit_rate)("textRight",!0)("invalid",e.formControlStateManager(e.fc.gross_profit_rate)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(78,Ce)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(79,U,e.fc.gross_profit_rate)),t.xp6(2),t.Q6J("formCtrl",e.fc.selling_price)("textRight",!0)("invalid",e.formControlStateManager(e.fc.selling_price)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(81,ve)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(82,U,e.fc.selling_price)),t.xp6(8),t.Q6J("formCtrl",e.fc.b_cost_price)("textRight",!0)("invalid",e.formControlStateManager(e.fc.b_cost_price)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(84,Te)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(85,U,e.fc.b_cost_price)),t.xp6(2),t.Q6J("formCtrl",e.fc.b_gross_profit_rate)("textRight",!0)("invalid",e.formControlStateManager(e.fc.b_gross_profit_rate)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(87,xe)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(88,U,e.fc.b_gross_profit_rate)),t.xp6(2),t.Q6J("formCtrl",e.fc.b_selling_price)("textRight",!0)("invalid",e.formControlStateManager(e.fc.b_selling_price)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(90,be)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(91,U,e.fc.b_selling_price)),t.xp6(8),t.Q6J("formCtrl",e.fc.c_cost_price)("textRight",!0)("invalid",e.formControlStateManager(e.fc.c_cost_price)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(93,Ae)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(94,U,e.fc.c_cost_price)),t.xp6(2),t.Q6J("formCtrl",e.fc.c_gross_profit_rate)("textRight",!0)("invalid",e.formControlStateManager(e.fc.c_gross_profit_rate)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(96,Ee)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(97,U,e.fc.c_gross_profit_rate)),t.xp6(2),t.Q6J("formCtrl",e.fc.c_selling_price)("textRight",!0)("invalid",e.formControlStateManager(e.fc.c_selling_price)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(99,Fe)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(100,U,e.fc.c_selling_price)),t.xp6(4),t.Q6J("buttonDisabled",e.form.invalid||e.form.pristine)}}function Pe(i,r){1&i&&(t.TgZ(0,"span",40),t._uU(1,"\u5fc5\u9808"),t.qZA())}function Oe(i,r){if(1&i&&(t.TgZ(0,"div",38)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,Pe,2,0,"span",39),t.qZA()),2&i){const e=r.label,n=r.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",n)}}function Me(i,r){if(1&i&&(t.TgZ(0,"p",42),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function Se(i,r){if(1&i&&(t.TgZ(0,"p",42),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MAX_LIMIT," ")}}function Ue(i,r){if(1&i&&(t.TgZ(0,"p",42),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function Ie(i,r){if(1&i&&(t.TgZ(0,"p",42),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}function Re(i,r){if(1&i&&(t.ynx(0),t.YNc(1,Me,2,1,"p",41),t.YNc(2,Se,2,1,"p",41),t.YNc(3,Ue,2,1,"p",41),t.YNc(4,Ie,2,1,"p",41),t.BQk()),2&i){const e=t.oxw().ctrl,n=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.maxlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===n.regExConst.NUMERIC_REG_EX+""),t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.beforeFromDate)}}function De(i,r){if(1&i&&t.YNc(0,Re,5,4,"ng-container",4),2&i){const e=r.ctrl,n=t.oxw();t.Q6J("ngIf",n.formControlStateManager(e))}}const Ne=function(i){return{path:i,text:"\u8a2d\u5b9a\u4e00\u89a7"}},ye=function(i){return{path:i,text:"\u4fa1\u683c\u5909\u66f4\u4e00\u89a7"}},Be=function(i){return{path:i,text:"\u4fa1\u683c\u5909\u66f4\u8a73\u7d30"}},qe=function(){return{text:"\u4fa1\u683c\u5909\u66f4\u7de8\u96c6"}},Je=function(i,r,e,n){return[i,r,e,n]};let ke=(()=>{class i{constructor(e,n,o,s,d,u,M,J,G,w,j){this.authorService=e,this.fb=n,this.route=o,this.errorService=s,this.priceChangeService=d,this.router=u,this.modalService=M,this.productService=J,this.flashMessageService=G,this.priceService=w,this.common=j,this.subscription=new C.w0,this.listPagePath="/setting/price-change",this.settingMenuPath="/setting",this.cancelModalTitle="\u4fa1\u683c\u5909\u66f4\u7de8\u96c6\u30ad\u30e3\u30f3\u30bb\u30eb\uff1a"+p.yR.TITLE.CANCEL,this.errorConst=m.c,this.regExConst=A.m,this.form=this.fb.group({product_id:["",[c.kI.required]],product_name:[""],supplier_sales_tax_division_id:["",[c.kI.required]],sales_tax_division_id:["",[c.kI.required]],cost_price:["",[c.kI.required,c.kI.pattern(A.m.NUMERIC_REG_EX)]],b_cost_price:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],c_cost_price:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],gross_profit_rate:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],b_gross_profit_rate:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],c_gross_profit_rate:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],selling_price:["",[c.kI.required,c.kI.pattern(A.m.NUMERIC_REG_EX)]],b_selling_price:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],c_selling_price:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],scheduled_price_change_date:["",[c.kI.required]]})}get fc(){return this.form.controls}ngOnInit(){this.authorService.author?(this.author=this.authorService.author,this.updater=this.author.last_name+" "+this.author.first_name):this.subscription.add(this.authorService.author$.subscribe(o=>{this.author=o,this.updater=o.last_name+" "+o.first_name}));const e=this.route.snapshot.params.id;(0,F.oG)(e)?this.handleError(400,"\u30d1\u30e9\u30e1\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc","\u30d1\u30e9\u30e1\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u4e00\u89a7\u753b\u9762\u3078\u623b\u308a\u307e\u3059\u3002",this.listPagePath):(this.selectedId=Number(e),this.detailPagePath=this.listPagePath+"/detail/"+this.selectedId,this.subscription.add(this.modalService.closeEventObservable$.pipe((0,v.h)(o=>this.modalService.getModalProperties().title===this.cancelModalTitle)).subscribe(o=>{o===p.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.detailPagePath)})),this.getPriceChange(this.selectedId))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getPriceChange(e){this.common.loading=!0,this.subscription.add(this.priceChangeService.find(e).pipe((0,b.K)(n=>(this.common.loading=!1,(0,S.of)(n))),(0,R.w)(n=>{if(n instanceof f.UA)return(0,S.of)(n);const o=n.data[0];return this.productService.find(o.product_id).pipe((0,H.U)(s=>({priceChange:o,product:s.data[0]})),(0,b.K)(s=>(this.common.loading=!1,(0,S.of)(s))))})).subscribe(n=>{if(n instanceof f.UA)return void this.handleError(n.status,n.error&&n.error.title?n.error.title:"\u4fa1\u683c\u5909\u66f4\u53d6\u5f97",n.error?n.error.message:n.message,this.detailPagePath);this.priceChange=n.priceChange,this.targetProduct=n.product;const o={product_id:String(this.priceChange.product_id),product_name:this.priceChange.product_name,supplier_sales_tax_division_id:String(this.priceChange.supplier_sales_tax_division_id),sales_tax_division_id:String(this.priceChange.sales_tax_division_id),cost_price:String(this.priceChange.cost_price),b_cost_price:String(this.priceChange.b_cost_price),c_cost_price:String(this.priceChange.c_cost_price),gross_profit_rate:String(this.priceChange.gross_profit_rate),b_gross_profit_rate:String(this.priceChange.b_gross_profit_rate),c_gross_profit_rate:String(this.priceChange.c_gross_profit_rate),selling_price:String(this.priceChange.selling_price),b_selling_price:String(this.priceChange.b_selling_price),c_selling_price:String(this.priceChange.c_selling_price),scheduled_price_change_date:this.priceChange.scheduled_price_change_date};this.form.patchValue(o),this.supplierTaxFractionMethod=(0,F.fy)(this.targetProduct.division_supplier_sales_fraction_code),this.taxFractionMethod=(0,F.fy)(this.targetProduct.division_sales_fraction_code),this.supplierTaxRateAndTaxIncludedFlag=(0,F.zn)(this.targetProduct.division_supplier_sales_tax_code),this.taxRateAndTaxIncludedFlag=(0,F.zn)(this.targetProduct.division_sales_tax_code),this.handleChangePriceData(),this.common.loading=!1}))}getPriceData(){return[{price:this.fc.selling_price,cost:this.fc.cost_price,rate:this.fc.gross_profit_rate},{price:this.fc.b_selling_price,cost:this.fc.b_cost_price,rate:this.fc.b_gross_profit_rate},{price:this.fc.c_selling_price,cost:this.fc.c_cost_price,rate:this.fc.c_gross_profit_rate}]}isNullOrUndefinedOrEmpty(e){return null==e||""===e||"0"===e}getCostPrices(e){return(0,F.e_)(Number(e),this.supplierTaxRateAndTaxIncludedFlag.taxRate,this.supplierTaxRateAndTaxIncludedFlag.isTaxIncluded,this.supplierTaxFractionMethod)}getSellingPrices(e,n){return(0,F.e_)(e,this.taxRateAndTaxIncludedFlag.taxRate,n,this.taxFractionMethod)}subscribeCostChanges(e){const n=e.cost.valueChanges.pipe((0,N.x)()).subscribe(o=>{this.handleCostChanges(o,e)});this.subscription.add(n)}handleCostChanges(e,n){if(this.isNullOrUndefinedOrEmpty(e))return n.rate.patchValue("",{emitEvent:!1}),n.rate.setErrors(["required"]),n.price.patchValue("",{emitEvent:!1}),void n.price.setErrors(["required"]);if(!this.isNullOrUndefinedOrEmpty(n.rate.value)){const o=this.getCostPrices(e);if(o instanceof Error)return void this.handleError(500,"\u4fa1\u683c\u5909\u66f4\u30a8\u30e9\u30fc",o.message,this.listPagePath);const s=Number(n.cost.value),d=Number(n.rate.value),M=this.priceService.getSalesPrice(s,d,this.targetProduct.division_sales_tax_code);n.price.patchValue(String(M),{emitEvent:!1})}}subscribeRateChanges(e){const n=e.rate.valueChanges.pipe((0,N.x)()).subscribe(o=>{this.handleRateChanges(o,e)});this.subscription.add(n)}handleRateChanges(e,n){if(this.isNullOrUndefinedOrEmpty(e))return n.price.patchValue("",{emitEvent:!1}),void n.price.setErrors(["required"]);if(Number(e)>99||Number(e)<0)return n.rate.patchValue("",{emitEvent:!1}),void n.rate.setErrors(["required"]);if(!this.isNullOrUndefinedOrEmpty(n.cost.value)){const o=this.getCostPrices(n.cost.value);if(o instanceof Error)return void this.handleError(500,"\u4fa1\u683c\u5909\u66f4\u30a8\u30e9\u30fc",o.message,this.listPagePath);const s=Number(n.cost.value),d=Number(n.rate.value),M=this.priceService.getSalesPrice(s,d,this.targetProduct.division_sales_tax_code);n.price.patchValue(String(M),{emitEvent:!1})}}subscribePriceChanges(e){const n=e.price.valueChanges.pipe((0,N.x)()).subscribe(o=>{this.handlePriceChanges(o,e)});this.subscription.add(n)}handlePriceChanges(e,n){if(this.isNullOrUndefinedOrEmpty(e))return n.rate.patchValue("",{emitEvent:!1}),void n.rate.setErrors(["required"]);const o=(0,F._k)(Number(e));if(n.price.patchValue(String(o),{emitEvent:!1}),!this.isNullOrUndefinedOrEmpty(n.cost.value)){const s=Number(n.cost.value),d=Number(n.price.value),M=this.priceService.getGrossProfitRate(s,d,this.targetProduct.division_sales_tax_code);n.rate.patchValue(String(Math.round(M)),{emitEvent:!1})}}handleChangePriceData(){this.getPriceData().forEach(n=>{this.subscribeCostChanges(n),this.subscribeRateChanges(n),this.subscribePriceChanges(n)})}handleClickCancelLink(){this.form.pristine?this.router.navigateByUrl(this.detailPagePath):this.modalService.setModal(this.cancelModalTitle,p.yR.BODY.CANCEL,"warning",p.yR.BUTTON_TITLE.EXECUTION,p.yR.BUTTON_TITLE.CANCEL)}handleClickSaveButton(){this.common.loading=!0;const e={product_id:this.fc.product_id.value,supplier_sales_tax_division_id:this.fc.supplier_sales_tax_division_id.value,sales_tax_division_id:this.fc.sales_tax_division_id.value,cost_price:this.fc.cost_price.value,b_cost_price:this.fc.b_cost_price.value,c_cost_price:this.fc.c_cost_price.value,gross_profit_rate:this.fc.gross_profit_rate.value,b_gross_profit_rate:this.fc.b_gross_profit_rate.value,c_gross_profit_rate:this.fc.c_gross_profit_rate.value,selling_price:this.fc.selling_price.value,b_selling_price:this.fc.b_selling_price.value,c_selling_price:this.fc.c_selling_price.value,scheduled_price_change_date:new Date(String(this.fc.scheduled_price_change_date.value)).toLocaleDateString()};this.subscription.add(this.priceChangeService.update(this.selectedId,e).pipe((0,b.K)(n=>(this.common.loading=!1,(0,S.of)(n)))).subscribe(n=>{n instanceof f.UA?this.handleError(n.status,n.error?n.error.title:"\u30a8\u30e9\u30fc",n.error?n.error.message:"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002",this.detailPagePath):(this.common.loading=!1,this.flashMessageService.setFlashMessage(n.message,"success",15e3),this.router.navigateByUrl(this.detailPagePath))}))}onClickReset(){window.location.reload()}handleError(e,n,o,s){this.errorService.setError({status:e,title:"\u4fa1\u683c\u5909\u66f4\u30a8\u30e9\u30fc\uff1a"+n+" "+p.yR.TITLE.HAS_ERROR,message:o,redirectPath:s})}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Y.Y),t.Y36(c.qu),t.Y36(_.gz),t.Y36(g.T),t.Y36(B),t.Y36(_.F0),t.Y36(P.Z),t.Y36(V.M),t.Y36(L.P),t.Y36(z.N),t.Y36(x.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-edit"]],decls:12,vars:15,consts:[[3,"breadcrumbList"],[1,"mt-8","text-xl"],[1,"flex","items-center","justify-between","mt-6","mb-2"],[3,"click"],[4,"ngIf"],[1,"width-limit-break","border-t","border-gray-400"],["labels",""],["errors",""],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"mt-8","mb-24","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light","border-t-4","mb-4"],[1,"mt-6","text-rose-400"],[1,"mt-8"],[1,"flex","gap-6","mt-6"],[1,"w-1/3"],["nameAttrValue","scheduled_price_change_date","idAttrValue","scheduled-price-change-date",3,"formCtrl","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mt-6","pl-2"],[1,"border-t-warning-hover","border-t-4","mt-1"],[1,"flex","gap-4","mt-4"],[1,"w-[10%]","flex","items-center","justify-center"],[1,"mt-[24px]"],[1,"w-[30%]"],["nameAttrValue","cost_price","idAttrValue","cost-price","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","gross_profit_rate","idAttrValue","gross-profit-rate","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","selling_price","idAttrValue","selling-price","inputType","number",3,"formCtrl","textRight","invalid"],[1,"mt-4"],["nameAttrValue","b_cost_price","idAttrValue","b-cost-price","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","b_gross_profit_rate","idAttrValue","b-gross-profit-rate","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","b_selling_price","idAttrValue","b-selling-price","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","c_cost_price","idAttrValue","c-cost-price","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","c_gross_profit_rate","idAttrValue","c-gross-profit-rate","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","c_selling_price","idAttrValue","c-selling-price","inputType","number",3,"formCtrl","textRight","invalid"],[1,"width-limit-break","bg-primary-light","flex","flex-row","justify-center","bottom-[40px]","left-0","right-0","p-2","fixed","gap-8"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success",3,"buttonDisabled"],["message",""],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"]],template:function(e,n){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"h2",1),t._uU(2,"\u4fa1\u683c\u5909\u66f4\u7de8\u96c6"),t.qZA(),t.TgZ(3,"div",2)(4,"app-cancel-link-org",3),t.NdJ("click",function(){return n.handleClickCancelLink()}),t.qZA(),t.YNc(5,$t,2,1,"app-last-updater-org",4),t.qZA(),t._UZ(6,"hr",5),t.YNc(7,Ze,80,102,"ng-container",4),t.YNc(8,Oe,4,2,"ng-template",null,6,t.W1O),t.YNc(10,De,1,1,"ng-template",null,7,t.W1O)),2&e&&(t.Q6J("breadcrumbList",t.l5B(10,Je,t.VKq(3,Ne,n.settingMenuPath),t.VKq(5,ye,n.listPagePath),t.VKq(7,Be,n.detailPagePath),t.DdM(9,qe))),t.xp6(5),t.Q6J("ngIf",n.updater),t.xp6(2),t.Q6J("ngIf",n.priceChange&&n.targetProduct))},dependencies:[l.O5,l.tP,c._Y,c.JL,c.sg,q.Z,K.K,Q.R,k.r,tt.O,et.a]}),i})();var Ye=a(4562);function Le(i,r){if(1&i&&(t.TgZ(0,"app-last-updater-org"),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" \u767b\u9332\u8005\uff1a",e.updater," ")}}function Qe(i,r){1&i&&t.GkF(0)}function Ve(i,r){1&i&&t.GkF(0)}function Ke(i,r){1&i&&t.GkF(0,44)}function Ge(i,r){1&i&&t.GkF(0)}function we(i,r){1&i&&t.GkF(0,44)}function je(i,r){1&i&&t.GkF(0)}function $e(i,r){1&i&&t.GkF(0,44)}function We(i,r){1&i&&t.GkF(0)}function Xe(i,r){1&i&&t.GkF(0,44)}function He(i,r){1&i&&t.GkF(0)}function ze(i,r){1&i&&t.GkF(0,44)}function tn(i,r){1&i&&t.GkF(0)}function en(i,r){1&i&&t.GkF(0,44)}function nn(i,r){1&i&&t.GkF(0)}function rn(i,r){1&i&&t.GkF(0,44)}function on(i,r){1&i&&t.GkF(0)}function an(i,r){1&i&&t.GkF(0,44)}function sn(i,r){1&i&&t.GkF(0)}function cn(i,r){1&i&&t.GkF(0,44)}function un(i,r){1&i&&t.GkF(0)}function ln(i,r){1&i&&t.GkF(0,44)}const pn=function(){return{label:"\u4fa1\u683c\u5909\u66f4\u4e88\u5b9a\u65e5",required:!0}},I=function(i){return{ctrl:i}},_n=function(){return{label:"\u30d0\u30e9\u4ed5\u5165\u5358\u4fa1",required:!0}},dn=function(){return{label:"\u30d0\u30e9\u7c97\u5229\u7387\uff08%\uff09",required:!1}},gn=function(){return{label:"\u30d0\u30e9\u58f2\u4fa1",required:!0}},mn=function(){return{label:"\u5c0f\u5206\u3051\u4ed5\u5165\u5358\u4fa1",required:!1}},hn=function(){return{label:"\u5c0f\u5206\u3051\u7c97\u5229\u7387\uff08%\uff09",required:!1}},fn=function(){return{label:"\u5c0f\u5206\u3051\u58f2\u4fa1",required:!1}},Cn=function(){return{label:"\u30b1\u30fc\u30b9\u4ed5\u5165\u5358\u4fa1",required:!1}},vn=function(){return{label:"\u30b1\u30fc\u30b9\u7c97\u5229\u7387\uff08%\uff09",required:!1}},Tn=function(){return{label:"\u30b1\u30fc\u30b9\u58f2\u4fa1",required:!1}};function xn(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",18)(2,"h3",8),t._uU(3,"\u5909\u66f4\u30c7\u30fc\u30bf\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"),t.qZA(),t._UZ(4,"hr",19),t.TgZ(5,"p",20),t._uU(6),t.qZA(),t._UZ(7,"hr",21),t.TgZ(8,"p",22),t._uU(9," \u203b \u58f2\u4fa1\u307e\u308b\u3081\u6761\u4ef6\u304c\u9069\u7528\u3055\u308c\u308b\u58f2\u4fa1\u304c\u7c97\u5229\u7387\u306b\u3088\u3063\u3066\u7b97\u51fa\u3055\u308c\u305f\u5834\u5408\u3001\u58f2\u4fa1\u306f\u307e\u308b\u3081\u51e6\u7406\u3092\u884c\u3044\u307e\u3059\u304c\u7c97\u5229\u7387\u306f\u518d\u8a08\u7b97\u3055\u308c\u307e\u305b\u3093\u3002 "),t.qZA(),t.TgZ(10,"div",23)(11,"div",11)(12,"app-date-term",24),t.YNc(13,Ve,1,0,"ng-container",13),t.YNc(14,Ke,1,0,"ng-container",25),t.qZA()(),t._UZ(15,"div",11)(16,"div",11),t.qZA(),t.TgZ(17,"p",26),t._uU(18,"\u4fa1\u683c\u60c5\u5831"),t.qZA(),t._UZ(19,"hr",27),t.TgZ(20,"div",28)(21,"div",29)(22,"div",30)(23,"span"),t._uU(24,"\u30d0\u30e9"),t.qZA()()(),t.TgZ(25,"div",31)(26,"app-text-container",32),t.YNc(27,Ge,1,0,"ng-container",13),t.YNc(28,we,1,0,"ng-container",25),t.qZA()(),t.TgZ(29,"div",31)(30,"app-text-container",33),t.YNc(31,je,1,0,"ng-container",13),t.YNc(32,$e,1,0,"ng-container",25),t.qZA()(),t.TgZ(33,"div",31)(34,"app-text-container",34),t.YNc(35,We,1,0,"ng-container",13),t.YNc(36,Xe,1,0,"ng-container",25),t.qZA()()(),t._UZ(37,"hr",35),t.TgZ(38,"div",28)(39,"div",29)(40,"div")(41,"span"),t._uU(42,"\u5c0f\u5206\u3051"),t.qZA()()(),t.TgZ(43,"div",31)(44,"app-text-container",36),t.YNc(45,He,1,0,"ng-container",13),t.YNc(46,ze,1,0,"ng-container",25),t.qZA()(),t.TgZ(47,"div",31)(48,"app-text-container",37),t.YNc(49,tn,1,0,"ng-container",13),t.YNc(50,en,1,0,"ng-container",25),t.qZA()(),t.TgZ(51,"div",31)(52,"app-text-container",38),t.YNc(53,nn,1,0,"ng-container",13),t.YNc(54,rn,1,0,"ng-container",25),t.qZA()()(),t._UZ(55,"hr",35),t.TgZ(56,"div",28)(57,"div",29)(58,"div")(59,"span"),t._uU(60,"\u30b1\u30fc\u30b9"),t.qZA()()(),t.TgZ(61,"div",31)(62,"app-text-container",39),t.YNc(63,on,1,0,"ng-container",13),t.YNc(64,an,1,0,"ng-container",25),t.qZA()(),t.TgZ(65,"div",31)(66,"app-text-container",40),t.YNc(67,sn,1,0,"ng-container",13),t.YNc(68,cn,1,0,"ng-container",25),t.qZA()(),t.TgZ(69,"div",31)(70,"app-text-container",41),t.YNc(71,un,1,0,"ng-container",13),t.YNc(72,ln,1,0,"ng-container",25),t.qZA()()()(),t.TgZ(73,"div",42)(74,"app-button",3),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onClickReset())}),t._uU(75,"\u30af\u30ea\u30a2"),t.qZA(),t.TgZ(76,"app-button",43),t._uU(77," \u4fdd\u5b58 "),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw(),n=t.MAs(21),o=t.MAs(23);t.xp6(6),t.AsE(" \u4ed5\u5165\u5148\u6d88\u8cbb\u7a0e\u533a\u5206\uff1a",e.targetProduct.division_supplier_sales_tax_value,"\u3000\u5546\u54c1\u6d88\u8cbb\u7a0e\u533a\u5206\uff1a",e.targetProduct.division_sales_tax_value," "),t.xp6(6),t.Q6J("formCtrl",e.fc.scheduled_price_change_date)("invalid",e.formControlStateManager(e.fc.scheduled_price_change_date)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(72,pn)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(73,I,e.fc.scheduled_price_change_date)),t.xp6(12),t.Q6J("formCtrl",e.fc.cost_price)("textRight",!0)("invalid",e.formControlStateManager(e.fc.cost_price)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(75,_n)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(76,I,e.fc.cost_price)),t.xp6(2),t.Q6J("formCtrl",e.fc.gross_profit_rate)("textRight",!0)("invalid",e.formControlStateManager(e.fc.gross_profit_rate)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(78,dn)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(79,I,e.fc.gross_profit_rate)),t.xp6(2),t.Q6J("formCtrl",e.fc.selling_price)("textRight",!0)("invalid",e.formControlStateManager(e.fc.selling_price)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(81,gn)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(82,I,e.fc.selling_price)),t.xp6(8),t.Q6J("formCtrl",e.fc.b_cost_price)("textRight",!0)("invalid",e.formControlStateManager(e.fc.b_cost_price)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(84,mn)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(85,I,e.fc.b_cost_price)),t.xp6(2),t.Q6J("formCtrl",e.fc.b_gross_profit_rate)("textRight",!0)("invalid",e.formControlStateManager(e.fc.b_gross_profit_rate)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(87,hn)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(88,I,e.fc.b_gross_profit_rate)),t.xp6(2),t.Q6J("formCtrl",e.fc.b_selling_price)("textRight",!0)("invalid",e.formControlStateManager(e.fc.b_selling_price)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(90,fn)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(91,I,e.fc.b_selling_price)),t.xp6(8),t.Q6J("formCtrl",e.fc.c_cost_price)("textRight",!0)("invalid",e.formControlStateManager(e.fc.c_cost_price)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(93,Cn)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(94,I,e.fc.c_cost_price)),t.xp6(2),t.Q6J("formCtrl",e.fc.c_gross_profit_rate)("textRight",!0)("invalid",e.formControlStateManager(e.fc.c_gross_profit_rate)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(96,vn)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(97,I,e.fc.c_gross_profit_rate)),t.xp6(2),t.Q6J("formCtrl",e.fc.c_selling_price)("textRight",!0)("invalid",e.formControlStateManager(e.fc.c_selling_price)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(99,Tn)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(100,I,e.fc.c_selling_price)),t.xp6(4),t.Q6J("buttonDisabled",e.form.invalid||e.form.pristine)}}function bn(i,r){1&i&&(t.TgZ(0,"span",47),t._uU(1,"\u5fc5\u9808"),t.qZA())}function An(i,r){if(1&i&&(t.TgZ(0,"div",45)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,bn,2,0,"span",46),t.qZA()),2&i){const e=r.label,n=r.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",n)}}function En(i,r){if(1&i&&(t.TgZ(0,"p",49),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function Fn(i,r){if(1&i&&(t.TgZ(0,"p",49),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MAX_LIMIT," ")}}function Zn(i,r){if(1&i&&(t.TgZ(0,"p",49),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function Pn(i,r){if(1&i&&(t.TgZ(0,"p",49),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}function On(i,r){if(1&i&&(t.ynx(0),t.YNc(1,En,2,1,"p",48),t.YNc(2,Fn,2,1,"p",48),t.YNc(3,Zn,2,1,"p",48),t.YNc(4,Pn,2,1,"p",48),t.BQk()),2&i){const e=t.oxw().ctrl,n=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.maxlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===n.regExConst.NUMERIC_REG_EX+""),t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.beforeFromDate)}}function Mn(i,r){if(1&i&&t.YNc(0,On,5,4,"ng-container",4),2&i){const e=r.ctrl,n=t.oxw();t.Q6J("ngIf",n.formControlStateManager(e))}}const Sn=function(i){return{path:i,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Un=function(i){return{path:i,text:"\u4fa1\u683c\u5909\u66f4\u4e00\u89a7"}},In=function(){return{text:"\u4fa1\u683c\u5909\u66f4\u65b0\u898f\u767b\u9332"}},Rn=function(i,r,e){return[i,r,e]},Dn=function(){return{label:"\u4fa1\u683c\u5909\u66f4\u5bfe\u8c61\u5546\u54c1",required:!1}};let Nn=(()=>{class i{constructor(e,n,o,s,d,u,M,J,G,w,j){this.fb=e,this.productService=n,this.priceChangeService=o,this.authorService=s,this.supplierService=d,this.errorService=u,this.modalService=M,this.router=J,this.flashMessageService=G,this.priceService=w,this.common=j,this.subscription=new C.w0,this.listPagePath="/setting/price-change",this.settingMenuPath="/setting",this.cancelModalTitle="\u4fa1\u683c\u5909\u66f4\u767b\u9332\u30ad\u30e3\u30f3\u30bb\u30eb\uff1a"+p.yR.TITLE.CANCEL,this.isDuringProductSelection=!1,this.errorConst=m.c,this.regExConst=A.m,this.form=this.fb.group({product_id:["",[c.kI.required]],product_name:[""],supplier_sales_tax_division_id:["",[c.kI.required]],sales_tax_division_id:["",[c.kI.required]],cost_price:["",[c.kI.required,c.kI.pattern(A.m.NUMERIC_REG_EX)]],b_cost_price:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],c_cost_price:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],gross_profit_rate:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],b_gross_profit_rate:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],c_gross_profit_rate:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],selling_price:["",[c.kI.required,c.kI.pattern(A.m.NUMERIC_REG_EX)]],b_selling_price:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],c_selling_price:["",[c.kI.pattern(A.m.NUMERIC_REG_EX)]],scheduled_price_change_date:["",[c.kI.required]]})}get fc(){return this.form.controls}ngOnInit(){this.authorService.author?(this.author=this.authorService.author,this.updater=this.author.last_name+" "+this.author.first_name):this.subscription.add(this.authorService.author$.subscribe(e=>{this.author=e,this.updater=this.author.last_name+" "+this.author.first_name})),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,v.h)(e=>this.modalService.getModalProperties().title===this.cancelModalTitle)).subscribe(e=>{e===p.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.listPagePath)})),this.handleChangePriceData()}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getPriceData(){return[{price:this.fc.selling_price,cost:this.fc.cost_price,rate:this.fc.gross_profit_rate},{price:this.fc.b_selling_price,cost:this.fc.b_cost_price,rate:this.fc.b_gross_profit_rate},{price:this.fc.c_selling_price,cost:this.fc.c_cost_price,rate:this.fc.c_gross_profit_rate}]}isNullOrUndefinedOrEmpty(e){return null==e||""===e||"0"===e}getCostPrices(e){return(0,F.e_)(Number(e),this.supplierTaxRateAndTaxIncludedFlag.taxRate,this.supplierTaxRateAndTaxIncludedFlag.isTaxIncluded,this.supplierTaxFractionMethod)}getSellingPrices(e,n){return(0,F.e_)(e,this.taxRateAndTaxIncludedFlag.taxRate,n,this.taxFractionMethod)}subscribeCostChanges(e){const n=e.cost.valueChanges.pipe((0,N.x)()).subscribe(o=>{this.handleCostChanges(o,e)});this.subscription.add(n)}handleCostChanges(e,n){if(this.isNullOrUndefinedOrEmpty(e))return n.rate.patchValue("",{emitEvent:!1}),n.rate.setErrors(["required"]),n.price.patchValue("",{emitEvent:!1}),void n.price.setErrors(["required"]);if(!this.isNullOrUndefinedOrEmpty(n.rate.value)){const o=Number(n.cost.value),s=Number(n.rate.value),u=this.priceService.getSalesPrice(o,s,this.targetProduct.division_sales_tax_code);n.price.patchValue(String(u),{emitEvent:!1})}}subscribeRateChanges(e){const n=e.rate.valueChanges.pipe((0,N.x)()).subscribe(o=>{this.handleRateChanges(o,e)});this.subscription.add(n)}handleRateChanges(e,n){if(this.isNullOrUndefinedOrEmpty(e))return n.price.patchValue("",{emitEvent:!1}),void n.price.setErrors(["required"]);if(Number(e)>99||Number(e)<0)return n.rate.patchValue("",{emitEvent:!1}),void n.rate.setErrors(["required"]);if(!this.isNullOrUndefinedOrEmpty(n.cost.value)){const o=Number(n.cost.value),s=Number(n.rate.value),u=this.priceService.getSalesPrice(o,s,this.targetProduct.division_sales_tax_code);n.price.patchValue(String(u),{emitEvent:!1})}}subscribePriceChanges(e){const n=e.price.valueChanges.pipe((0,N.x)()).subscribe(o=>{this.handlePriceChanges(o,e)});this.subscription.add(n)}handlePriceChanges(e,n){if(this.isNullOrUndefinedOrEmpty(e))return n.rate.patchValue("",{emitEvent:!1}),void n.rate.setErrors(["required"]);const o=(0,F._k)(Number(e));if(n.price.patchValue(String(o),{emitEvent:!1}),!this.isNullOrUndefinedOrEmpty(n.cost.value)){const s=Number(n.cost.value),d=Number(n.price.value),M=this.priceService.getGrossProfitRate(s,d,this.targetProduct.division_sales_tax_code);n.rate.patchValue(String(Math.round(M)),{emitEvent:!1})}}handleChangePriceData(){this.getPriceData().forEach(n=>{this.subscribeCostChanges(n),this.subscribeRateChanges(n),this.subscribePriceChanges(n)})}getProductSuggests(){return{observable:this.productService.getAll({name:this.fc.product_name.value,$select:"id,name"}),idField:"id",nameField:"name"}}handleClickProductSelectedButton(){const e=this.fc.product_id.value;if(null==e||""===e)return this.targetProduct={},this.form.reset(),void(this.isDuringProductSelection=!1);this.common.loading=!0,this.subscription.add(this.productService.find(Number(e)).pipe((0,b.K)(n=>(this.common.loading=!1,(0,S.of)(n))),(0,R.w)(n=>{if(n instanceof f.UA)return(0,S.of)(n);const o=n.data[0];return this.supplierService.find(o.supplier_id).pipe((0,H.U)(s=>({targetProduct:o,supplier:s.data[0]})),(0,b.K)(s=>(this.common.loading=!1,(0,S.of)(s))))})).subscribe(n=>{n instanceof f.UA?this.handleError(n.status,n.error?n.error.title:"\u30a8\u30e9\u30fc",n.error?n.error.message:"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002",this.listPagePath):(this.targetProduct=n.targetProduct,this.form.patchValue({product_id:String(this.targetProduct.id),product_name:this.targetProduct.name,supplier_sales_tax_division_id:String(this.targetProduct.supplier_sales_tax_division_id),sales_tax_division_id:String(this.targetProduct.sales_tax_division_id),cost_price:String(this.targetProduct.supplier_cost_price),b_cost_price:String(this.targetProduct.b_supplier_cost_price),c_cost_price:String(this.targetProduct.c_supplier_cost_price),gross_profit_rate:String(this.targetProduct.gross_profit_rate),b_gross_profit_rate:String(this.targetProduct.b_gross_profit_rate),c_gross_profit_rate:String(this.targetProduct.c_gross_profit_rate),selling_price:String(this.targetProduct.selling_price),b_selling_price:String(this.targetProduct.b_selling_price),c_selling_price:String(this.targetProduct.c_selling_price)},{emitEvent:!1}),this.supplierTaxFractionMethod=(0,F.fy)(this.targetProduct.division_supplier_sales_fraction_code),this.taxFractionMethod=(0,F.fy)(this.targetProduct.division_sales_fraction_code),this.supplierTaxRateAndTaxIncludedFlag=(0,F.zn)(this.targetProduct.division_supplier_sales_tax_code),this.taxRateAndTaxIncludedFlag=(0,F.zn)(this.targetProduct.division_sales_tax_code),this.common.loading=!1,this.isDuringProductSelection=!0)}))}onClickReset(){window.location.reload()}handleClickCancelLink(){this.form.pristine?this.router.navigateByUrl(this.listPagePath):this.modalService.setModal(this.cancelModalTitle,p.yR.BODY.CANCEL,"warning",p.yR.BUTTON_TITLE.EXECUTION,p.yR.BUTTON_TITLE.CANCEL)}handleClickSaveButton(){this.common.loading=!0;const e={product_id:this.fc.product_id.value,supplier_sales_tax_division_id:this.fc.supplier_sales_tax_division_id.value,sales_tax_division_id:this.fc.sales_tax_division_id.value,cost_price:this.fc.cost_price.value,b_cost_price:this.fc.b_cost_price.value,c_cost_price:this.fc.c_cost_price.value,gross_profit_rate:this.fc.gross_profit_rate.value,b_gross_profit_rate:this.fc.b_gross_profit_rate.value,c_gross_profit_rate:this.fc.c_gross_profit_rate.value,selling_price:this.fc.selling_price.value,b_selling_price:this.fc.b_selling_price.value,c_selling_price:this.fc.c_selling_price.value,scheduled_price_change_date:new Date(String(this.fc.scheduled_price_change_date.value)).toLocaleDateString()};this.subscription.add(this.priceChangeService.add(e).pipe((0,b.K)(n=>(this.common.loading=!1,(0,S.of)(n)))).subscribe(n=>{n instanceof f.UA?this.handleError(n.status,n.error?n.error.title:"\u30a8\u30e9\u30fc",n.error?n.error.message:"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002",this.listPagePath):(this.common.loading=!1,this.flashMessageService.setFlashMessage(n.message,"success",15e3),this.router.navigateByUrl(this.listPagePath))}))}handleError(e,n,o,s){this.errorService.setError({status:e,title:"\u4fa1\u683c\u5909\u66f4\u30a8\u30e9\u30fc\uff1a"+n+" "+p.yR.TITLE.HAS_ERROR,message:o,redirectPath:s})}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.qu),t.Y36(V.M),t.Y36(B),t.Y36(Y.Y),t.Y36(Ye.p),t.Y36(g.T),t.Y36(P.Z),t.Y36(_.F0),t.Y36(L.P),t.Y36(z.N),t.Y36(x.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-add"]],decls:24,vars:20,consts:[[3,"breadcrumbList"],[1,"mt-8","text-xl"],[1,"flex","items-center","justify-between","mt-6","mb-2"],[3,"click"],[4,"ngIf"],[1,"width-limit-break","border-t","border-gray-400"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"mt-8","mb-24","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4","mb-4"],[1,"flex"],[1,"w-1/3"],["nameAttrValue","product_name","idAttrValue","product-name",3,"idCtrl","nameCtrl","apiInput","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mt-[28px]"],["btnType","button",3,"click"],["labels",""],["errors",""],[1,"mt-8"],[1,"border-t-warning-dark","border-t-4","mb-4"],[1,"mt-6"],[1,"mt-[2px]"],[1,"mt-6","text-rose-400"],[1,"flex","gap-6","mt-6"],["nameAttrValue","scheduled_price_change_date","idAttrValue","scheduled-price-change-date",3,"formCtrl","invalid"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mt-6","pl-2"],[1,"border-t-warning-hover","border-t-4","mt-1"],[1,"flex","gap-4","mt-4"],[1,"w-[10%]","flex","items-center","justify-center"],[1,"mt-[24px]"],[1,"w-[30%]"],["nameAttrValue","cost_price","idAttrValue","cost-price","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","gross_profit_rate","idAttrValue","gross-profit-rate","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","selling_price","idAttrValue","selling-price","inputType","number",3,"formCtrl","textRight","invalid"],[1,"mt-4"],["nameAttrValue","b_cost_price","idAttrValue","b-cost-price","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","b_gross_profit_rate","idAttrValue","b-gross-profit-rate","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","b_selling_price","idAttrValue","b-selling-price","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","c_cost_price","idAttrValue","c-cost-price","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","c_gross_profit_rate","idAttrValue","c-gross-profit-rate","inputType","number",3,"formCtrl","textRight","invalid"],["nameAttrValue","c_selling_price","idAttrValue","c-selling-price","inputType","number",3,"formCtrl","textRight","invalid"],[1,"width-limit-break","bg-primary-light","flex","flex-row","justify-center","bottom-[40px]","left-0","right-0","p-2","fixed","gap-8"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success",3,"buttonDisabled"],["message",""],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"]],template:function(e,n){if(1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"h2",1),t._uU(2,"\u4fa1\u683c\u5909\u66f4\u65b0\u898f\u767b\u9332"),t.qZA(),t.TgZ(3,"div",2)(4,"app-cancel-link-org",3),t.NdJ("click",function(){return n.handleClickCancelLink()}),t.qZA(),t.YNc(5,Le,2,1,"app-last-updater-org",4),t.qZA(),t._UZ(6,"hr",5),t.TgZ(7,"form",6),t.NdJ("ngSubmit",function(){return n.handleClickSaveButton()}),t.TgZ(8,"div",7)(9,"h3",8),t._uU(10,"\u4fa1\u683c\u3092\u5909\u66f4\u3059\u308b\u5546\u54c1\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044"),t.qZA(),t._UZ(11,"hr",9),t.TgZ(12,"div",10)(13,"div",11)(14,"app-real-time-suggest-container",12),t.YNc(15,Qe,1,0,"ng-container",13),t.qZA()(),t.TgZ(16,"div",14)(17,"app-button",15),t.NdJ("click",function(){return n.handleClickProductSelectedButton()}),t._uU(18,"\u6c7a\u5b9a"),t.qZA()()(),t.YNc(19,xn,78,102,"ng-container",4),t.qZA()(),t.YNc(20,An,4,2,"ng-template",null,16,t.W1O),t.YNc(22,Mn,1,1,"ng-template",null,17,t.W1O)),2&e){const o=t.MAs(21);t.Q6J("breadcrumbList",t.kEZ(15,Rn,t.VKq(10,Sn,n.settingMenuPath),t.VKq(12,Un,n.listPagePath),t.DdM(14,In))),t.xp6(5),t.Q6J("ngIf",n.updater),t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(7),t.Q6J("idCtrl",n.fc.product_id)("nameCtrl",n.fc.product_name)("apiInput",n.getProductSuggests())("invalid",n.formControlStateManager(n.fc.product_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.DdM(19,Dn)),t.xp6(4),t.Q6J("ngIf",n.isDuringProductSelection)}},dependencies:[l.O5,l.tP,c._Y,c.JL,c.sg,q.Z,K.K,Q.R,W.Y,k.r,tt.O,et.a]}),i})();var yn=a(8746),Bn=a(2482),qn=a(5108);function Jn(i,r){if(1&i&&(t.ynx(0),t.TgZ(1,"app-last-updater-org",17),t._uU(2),t.qZA(),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("roleTypeName",e.author.role_name),t.xp6(1),t.hij(" \u767b\u9332\u8005\uff1a",e.updater," ")}}function kn(i,r){if(1&i&&(t.ynx(0),t.TgZ(1,"div",21),t._uU(2),t.qZA(),t.TgZ(3,"div",22),t._uU(4),t.qZA(),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.hij(" ",e.title," "),t.xp6(2),t.hij(" ",e.description," ")}}function Yn(i,r){1&i&&(t.TgZ(0,"span",26),t._uU(1," \u5fc5\u9808 "),t.qZA())}function Ln(i,r){if(1&i&&(t.TgZ(0,"div",23),t._uU(1),t.YNc(2,Yn,2,0,"span",24),t.qZA(),t.TgZ(3,"div",25),t._uU(4),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.title," "),t.xp6(1),t.Q6J("ngIf",e.required),t.xp6(2),t.Oqu(e.description)}}function Qn(i,r){if(1&i&&(t.TgZ(0,"li",18),t.YNc(1,kn,5,2,"ng-container",19),t.YNc(2,Ln,5,3,"ng-template",null,20,t.W1O),t.qZA()),2&i){const e=r.first,n=t.MAs(3);t.xp6(1),t.Q6J("ngIf",e)("ngIfElse",n)}}function Vn(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"p",27),t._uU(2),t.qZA(),t.TgZ(3,"app-icon",28),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.ctrl.reset())}),t.qZA(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.filename)}}const Kn=function(i){return{path:i,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Gn=function(i){return{path:i,text:"\u4fa1\u683c\u5909\u66f4\u4e00\u89a7"}},wn=function(){return{text:"\u4fa1\u683c\u5909\u66f4\u65b0\u898f\u767b\u9332"}},jn=function(i,r,e){return[i,r,e]},$n=[{path:"",component:y,children:[{path:"",component:Mt},{path:"detail/:id",component:jt},{path:"edit/:id",component:ke},{path:"add",component:Nn},{path:"bulk-add",component:(()=>{class i{constructor(e,n,o,s,d,u){this.authorService=e,this.priceChangeService=n,this.modal=o,this.flash=s,this.router=d,this.common=u,this.subscription=new C.w0,this.listPagePath="/setting/price-change",this.settingMenuPath="/setting",this.fileNamePrefix="\u4fa1\u683c\u5909\u66f4",this.ctrl=new c.NI(null,c.kI.required),this.descriptions=[{title:"\u9805\u76ee\u540d",description:"\u6982\u8981"},{title:"product_id",description:"\u5546\u54c1ID",required:!0},{title:"cost_price",description:"\u30d0\u30e9\u4ed5\u5165\u5358\u4fa1",required:!0},{title:"b_cost_price",description:"\u5c0f\u5206\u3051\u4ed5\u5165\u5358\u4fa1"},{title:"c_cost_price",description:"\u30b1\u30fc\u30b9\u4ed5\u5165\u5358\u4fa1"},{title:"gross_profit_rate",description:"\u30d0\u30e9\u7c97\u5229\u7387"},{title:"b_gross_profit_rate",description:"\u5c0f\u5206\u3051\u7c97\u5229\u7387"},{title:"c_gross_profit_rate",description:"\u30b1\u30fc\u30b9\u7c97\u5229\u7387"},{title:"gross_profit_rate",description:"\u30d0\u30e9\u58f2\u4fa1",required:!0},{title:"b_gross_profit_rate",description:"\u5c0f\u5206\u3051\u58f2\u4fa1"},{title:"c_gross_profit_rate",description:"\u30b1\u30fc\u30b9\u58f2\u4fa1"},{title:"scheduled_price_change_date",description:"\u4fa1\u683c\u5909\u66f4\u4e88\u5b9a\u65e5\u6642",required:!0}]}ngOnInit(){this.authorService.author?(this.author=this.authorService.author,this.updater=this.author.last_name+" "+this.author.first_name):this.subscription.add(this.authorService.author$.subscribe(e=>{this.author=e,this.updater=this.author.last_name+" "+this.author.first_name})),this.subscription.add(this.ctrl.valueChanges.subscribe(e=>this.filename=e?.name)),this.template$=this.priceChangeService.getCsv("template").pipe((0,b.K)(this.handleError("")))}onClickUpload(){!this.ctrl.value||(this.common.loading=!0,this.subscription.add(this.priceChangeService.bulkAdd(this.ctrl.value).pipe((0,b.K)(this.handleError({})),(0,yn.x)(()=>this.common.loading=!1)).subscribe(e=>{"\u767b\u9332\u3057\u307e\u3057\u305f"===e.message&&(this.flash.setFlashMessage("\u8ca9\u58f2\u4fa1\u683c\u60c5\u5831\u304c\u6b63\u5e38\u306b\u767b\u9332\u3055\u308c\u307e\u3057\u305f\u3002","success",15e3),this.router.navigateByUrl(this.listPagePath))})))}handleError(e){return n=>(console.error(n),this.modal.setModal(p.yR.TITLE.HAS_ERROR,n.message,"danger","\u9589\u3058\u308b",""),(0,S.of)(e))}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Y.Y),t.Y36(B),t.Y36(P.Z),t.Y36(L.P),t.Y36(_.F0),t.Y36(x.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-bulk-add"]],decls:22,vars:17,consts:[[3,"breadcrumbList"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],["routerLink","../"],[4,"ngIf"],[1,"width-limit-break","border-t","border-gray-400"],[1,"flex","justify-end","mt-8",3,"api$","fileNamePrefix","statusChange"],[1,"mt-2","mb-28","py-8","px-6","bg-white","shadow","border","border-slate-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4","mb-2"],[1,"text-sm","mb-4"],[1,"mb-8"],["class","flex border border-b-0 last:border-b border-slate-300",4,"ngFor","ngForOf"],[1,"flex","justify-between","mb-2"],[1,"flex","items-center"],["accept","text/csv",3,"formCtrl"],["btnFillColor","bg-success hover:bg-success-hover border-success text-white",3,"buttonDisabled","click"],[3,"roleTypeName"],[1,"flex","border","border-b-0","last:border-b","border-slate-300"],[4,"ngIf","ngIfElse"],["contents",""],[1,"flex","items-center","w-1/3","bg-iron-blue-300","p-4"],[1,"grow","bg-iron-blue-300","border-l","border-l-slate-300","p-4"],[1,"flex","items-center","w-1/3","bg-slate-100","p-4"],["class","px-3 py-0.5 ml-2 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"grow","p-4"],[1,"px-3","py-0.5","ml-2","text-xs","text-white","bg-warning-dark","rounded-full"],[1,"ml-4"],["icon","delete-bin-line",1,"w-6","cursor-pointer","ml-2","fill-red-500",3,"click"]],template:function(e,n){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"h2",1),t._uU(2,"\u8ca9\u58f2\u4fa1\u683c\u4e00\u62ec\u767b\u9332"),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"app-cancel-link-org",3),t.YNc(5,Jn,3,2,"ng-container",4),t.qZA(),t._UZ(6,"hr",5),t.TgZ(7,"app-template-download-link-org",6),t.NdJ("statusChange",function(s){return n.common.loading=!!s}),t.qZA(),t.TgZ(8,"div",7)(9,"p",8),t._uU(10,"CSV\u30d5\u30a1\u30a4\u30eb\u306e\u30d8\u30c3\u30c0\u30fc\u3068\u5024"),t.qZA(),t._UZ(11,"hr",9),t.TgZ(12,"p",10),t._uU(13,"\u5fc5\u9808\u9805\u76ee\u304c\u306a\u3044\u30ec\u30b3\u30fc\u30c9\u306f\u7121\u8996\u3055\u308c\u307e\u3059\u3002"),t.qZA(),t.TgZ(14,"ul",11),t.YNc(15,Qn,4,2,"li",12),t.qZA(),t.TgZ(16,"div",13)(17,"div",14),t._UZ(18,"app-file",15),t.YNc(19,Vn,4,1,"ng-container",4),t.qZA(),t.TgZ(20,"app-button",16),t.NdJ("click",function(){return n.onClickUpload()}),t._uU(21," \u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5b9f\u884c "),t.qZA()()()),2&e&&(t.Q6J("breadcrumbList",t.kEZ(13,jn,t.VKq(8,Kn,n.settingMenuPath),t.VKq(10,Gn,n.listPagePath),t.DdM(12,wn))),t.xp6(5),t.Q6J("ngIf",n.author&&n.updater),t.xp6(2),t.Q6J("api$",n.template$)("fileNamePrefix",n.fileNamePrefix),t.xp6(8),t.Q6J("ngForOf",n.descriptions),t.xp6(3),t.Q6J("formCtrl",n.ctrl),t.xp6(1),t.Q6J("ngIf",n.ctrl.value),t.xp6(1),t.Q6J("buttonDisabled",n.ctrl.invalid))},dependencies:[l.sg,l.O5,_.rH,q.Z,K.K,Q.R,k.r,Bn.V,qn.P,X.o]}),i})()}]}];let Wn=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[_.Bz.forChild($n),_.Bz]}),i})();var Xn=a(4560);let Hn=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[l.ez,Xn.Z]}),i})();var nt=a(4854),it=a(3894),rt=a(8511),zn=a(855);let ti=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[l.ez,c.UX,nt.C,it.h,rt.Q,zn.W]}),i})();var ei=a(9307),ni=a(9104),ii=a(4933),ri=a(6968),oi=a(3560),ai=a(4470),si=a(9434),ci=a(6321),ui=a(5274),li=a(3415),pi=a(4663),_i=a(3042),di=a(2923),gi=a(3962);let mi=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[x.v],imports:[l.ez,Wn,c.UX,Hn,ti,ei.u,ni.u,ii.M,ri.V,oi.r,ai.x,nt.C,it.h,si.H,ui.s,li.x,ci.T,pi.Q,rt.Q,_i.C,di.D,gi.J]}),i})()},6082:(D,Z,a)=>{a.d(Z,{M:()=>x});var l=a(2340),_=a(262),C=a(4004),T=a(8372),v=a(1884),m=a(3900),p=a(9646),t=a(1751),P=a(529),g=a(1571);let x=(()=>{class O extends t.O{constructor(){super(...arguments),this.endpoint=l.pU.productApi.endpoint}getAll(h={}){return this.httpOptions.params=h,this.http.get(this.endpoint,this.httpOptions).pipe((0,_.K)(this.setErrorMessage("\u5546\u54c1\u4e00\u89a7\u306e\u53d6\u5f97")))}get(h,f={}){return this.getAll({...f,supplier_id:h})}getCsv(h,f){const E={params:f,responseType:"text",headers:new P.WM({"X-Download":h})};return this.http.get(this.endpoint,E).pipe((0,_.K)(this.setErrorMessage("\u4e00\u62ec\u767b\u9332\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u53d6\u5f97")))}find(h){return this.http.get(`${this.endpoint}/${h}`).pipe((0,_.K)(this.setErrorMessage("\u5546\u54c1\u60c5\u5831\u306e\u53d6\u5f97")))}add(h){const f=this.generateFormData(h);return this.http.post(this.endpoint,f).pipe((0,_.K)(this.setErrorMessage("\u5546\u54c1\u60c5\u5831\u306e\u767b\u9332")))}bulkAdd(h){const f=this.generateFormData({file:h});return this.http.put(this.endpoint,f).pipe((0,_.K)(this.setErrorMessage("\u5546\u54c1\u60c5\u5831\u306e\u4e00\u62ec\u767b\u9332")))}update(h,f){const E=this.generateFormData(f);return this.http.patch(`${this.endpoint}/${h}`,E).pipe((0,_.K)(this.setErrorMessage("\u5546\u54c1\u60c5\u5831\u306e\u66f4\u65b0")))}remove(h){return this.http.delete(`${this.endpoint}/${h}`).pipe((0,_.K)(this.setErrorMessage("\u5546\u54c1\u60c5\u5831\u306e\u524a\u9664")))}getAsSelectOptions(h){return this.getAll(h).pipe((0,C.U)(f=>f.data.map(E=>({text:E.name+"",value:E.id}))))}getAsSelectOptionsForNameSearch(h){return this.getAll(h).pipe((0,C.U)(f=>f.data.map(E=>({text:E.name+"",value:E.name}))))}observableProductId(h,f,E){E.loading=!1,h.valueChanges.pipe((0,T.b)(500),(0,v.x)(),(0,m.w)(R=>this.observableSetProductName(String(R),f,E))).subscribe()}observableSetProductName(h,f,E){return null==h||""===h?(f.setValue("",{emitEvent:!1}),(0,p.of)()):(E.loading=!0,this.find(Number(h)).pipe((0,C.U)(R=>{const b=R.data[0];E.loading=!1,f.setValue(b?.name,{emitEvent:!1})}),(0,_.K)(R=>(E.loading=!1,this.handleErrorModal()(R)))))}}return O.\u0275fac=function(){let y;return function(f){return(y||(y=g.n5z(O)))(f||O)}}(),O.\u0275prov=g.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})()},4562:(D,Z,a)=>{a.d(Z,{p:()=>p});var l=a(2340),_=a(262),C=a(4004),T=a(1751),v=a(529),m=a(1571);let p=(()=>{class t extends T.O{constructor(){super(...arguments),this.endpoint=l.pU.supplierApi.endpoint}getAll(g={}){return this.httpOptions.params=g,this.http.get(this.endpoint,this.httpOptions).pipe((0,_.K)(this.setErrorMessage("\u4ed5\u5165\u5148\u4e00\u89a7\u306e\u53d6\u5f97")))}find(g){return this.http.get(`${this.endpoint}/${g}`).pipe((0,_.K)(this.setErrorMessage("\u4ed5\u5165\u5148\u60c5\u5831\u306e\u53d6\u5f97")))}getCsv(g,x){const O={params:x,responseType:"text",headers:new v.WM({"X-Download":g})};return this.http.get(this.endpoint,O).pipe((0,_.K)(this.setErrorMessage("\u4e00\u62ec\u767b\u9332\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u53d6\u5f97")))}add(g){const x=this.generateFormData(g);return this.http.post(this.endpoint,x).pipe((0,_.K)(this.setErrorMessage("\u4ed5\u5165\u5148\u60c5\u5831\u306e\u767b\u9332")))}bulkAdd(g){const x=this.generateFormData({file:g});return this.http.put(this.endpoint,x).pipe((0,_.K)(this.setErrorMessage("\u4ed5\u5165\u5148\u60c5\u5831\u306e\u4e00\u62ec\u767b\u9332")))}update(g,x){const O=this.generateFormData(x);return this.http.patch(`${this.endpoint}/${g}`,O).pipe((0,_.K)(this.setErrorMessage("\u4ed5\u5165\u5148\u60c5\u5831\u306e\u66f4\u65b0")))}remove(g){return this.http.delete(`${this.endpoint}/${g}`).pipe((0,_.K)(this.setErrorMessage("\u4ed5\u5165\u5148\u60c5\u5831\u306e\u524a\u9664")))}getAsSelectOptions(){return this.getAll({$select:"id,name"}).pipe((0,C.U)(g=>g.data.map(O=>({value:O.id,text:O.name}))))}}return t.\u0275fac=function(){let P;return function(x){return(P||(P=m.n5z(t)))(x||t)}}(),t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);