"use strict";(self.webpackChunknisshin=self.webpackChunknisshin||[]).push([[943],{2943:(bo,qt,l)=>{l.r(qt),l.d(qt,{AccountsReceivableAggregateModule:()=>fo});var g=l(6895),x=l(1690),A=l(727),O=l(9300),t=l(1571),S=l(8832),Yt=l(2125);let ot=(()=>{class n{constructor(e,i){this.common=e,this.router=i,this.loading=!1,this.subscription=new A.w0,this.breadcrumbList=[],this.menuList=[]}ngOnInit(){this.subscription=this.common.loading$.subscribe(e=>{setTimeout(()=>this.loading=e)}),this.subscription.add(this.router.events.pipe((0,O.h)(e=>e instanceof x.m2)).subscribe(e=>this.breadcrumbList=this.createBreadcrumbList(e.urlAfterRedirects))),this.breadcrumbList=this.createBreadcrumbList(this.router.url)}ngOnDestroy(){this.subscription?.unsubscribe()}createBreadcrumbList(e){const i=e.replace(/.*\/accounts-receivable-aggregate\/?/,"").split("/"),a=[{name:"individual-bill",name_jp:"\u8acb\u6c42",path:"bill"},{name:"bill",name_jp:"\u8acb\u6c42",path:"bill"},{name:"deposit",name_jp:"\u5165\u91d1",path:"deposit"},{name:"accounts-receivable-balance",name_jp:"\u58f2\u639b\u6b8b",path:"accounts-receivable-balance"}],s=[{path:"/setting/menu",text:"\u8a2d\u5b9a\u4e00\u89a7"}],r=[],c=a.find(_=>_.name===i[0])?.path,u=a.find(_=>_.name===i[0])?.name_jp;if(s.push({path:`/setting/accounts-receivable-aggregate/${c}`,text:`${u}\u4e00\u89a7`}),1===i.length)"individual-bill"===i[0]?(s.push({text:"\u500b\u5225\u8acb\u6c42\u30c7\u30fc\u30bf\u4f5c\u6210"}),r.push(s[2])):(delete s[1].path,r.push(s[1]));else if("list"===(r.push(s[1]),i[1]))delete s[1].path;else{const _=[{name:"slip-list",name_jp:"\u8acb\u6c42\u4f1d\u7968\u4e00\u89a7"},{name:"slip-detail",name_jp:"\u8acb\u6c42\u4f1d\u7968\u8a73\u7d30"},{name:"add",name_jp:"\u5165\u91d1\u65b0\u898f\u767b\u9332"},{name:"detail-view",name_jp:"\u5165\u91d1\u8a73\u7d30\u95b2\u89a7"},{name:"detail-edit",name_jp:"\u5165\u91d1\u8a73\u7d30\u7de8\u96c6"}].find(m=>m.name===i[1])?.name_jp;s.push({text:`${_}`}),r.push(s[3])}return this.menuList=r,s}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(S.v),t.Y36(x.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-accounts-receivable-aggregate"]],decls:2,vars:1,consts:[[3,"isLoading"]],template:function(e,i){1&e&&t._UZ(0,"router-outlet")(1,"app-loading-container",0),2&e&&(t.xp6(1),t.Q6J("isLoading",i.loading))},dependencies:[x.lC,Yt.o]}),n})();var C=l(529),d=l(4006),B=l(7579),I=l(4128),f=l(8746),h=l(262),b=l(9646),N=l(5698),F=l(5450),T=l(8037),p=l(6585),y=l(1609),P=l(8782),q=l(2425),vt=l(1269),w=l(2334),Q=l(1751),V=l(2340);let pe=(()=>{class n extends Q.O{constructor(){super(...arguments),this.endpoint=V.pU.billingDataCreationApi.endpoint}createBillingData(e){const i=this.generateFormData(e);return this.http.post(this.endpoint,i).pipe((0,h.K)(this.setErrorMessage("\u500b\u5225\u8acb\u6c42\u66f8\u60c5\u5831\u306e\u767b\u9332")))}}return n.\u0275fac=function(){let o;return function(i){return(o||(o=t.n5z(n)))(i||n)}}(),n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var R=l(7030),Ct=l(1805),k=l(5146);let st=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-toggle-button"]],decls:9,vars:0,consts:[[1,"mt-8"],["routerLink","../individual-bill","routerLinkActive","active"],["routerLink","../bill","routerLinkActive","active"],["routerLink","../deposit","routerLinkActive","active"],["routerLink","../accounts-receivable-balance","routerLinkActive","active"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"button",1),t._uU(2," \u500b\u5225\u8acb\u6c42\u30c7\u30fc\u30bf\u4f5c\u6210 "),t.qZA(),t.TgZ(3,"button",2),t._uU(4,"\u8acb\u6c42\u4e00\u89a7"),t.qZA(),t.TgZ(5,"button",3),t._uU(6,"\u5165\u91d1\u4e00\u89a7"),t.qZA(),t.TgZ(7,"button",4),t._uU(8," \u58f2\u639b\u6b8b\u4e00\u89a7 "),t.qZA()())},dependencies:[x.rH,x.Od],styles:["button[_ngcontent-%COMP%]{border-width:1px;--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity));padding:.25rem 1rem}button[_ngcontent-%COMP%]:first-child{border-top-left-radius:.25rem;border-bottom-left-radius:.25rem}button[_ngcontent-%COMP%]:last-child{border-top-right-radius:.25rem;border-bottom-right-radius:.25rem}.active[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}"]}),n})();var j=l(3148),K=l(7540);function de(n,o){1&n&&t.GkF(0)}function _e(n,o){1&n&&t.GkF(0,28)}function me(n,o){1&n&&t.GkF(0)}function he(n,o){1&n&&t.GkF(0,28)}function ge(n,o){1&n&&t.GkF(0)}function fe(n,o){1&n&&t.GkF(0,28)}function be(n,o){1&n&&t.GkF(0,28)}function ve(n,o){1&n&&(t.TgZ(0,"span",31),t._uU(1,"\u5fc5\u9808"),t.qZA())}function Ce(n,o){if(1&n&&(t.TgZ(0,"div",29)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,ve,2,0,"span",30),t.qZA()),2&n){const e=o.label,i=o.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",i)}}function Te(n,o){if(1&n&&(t.TgZ(0,"p",34),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function xe(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Te,2,1,"p",33),t.BQk()),2&n){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required)}}function Ae(n,o){if(1&n&&t.YNc(0,xe,2,1,"ng-container",32),2&n){const e=o.ctrl,i=t.oxw();t.Q6J("ngIf",i.formControlStateManager(e))}}function Ee(n,o){if(1&n&&(t.TgZ(0,"p",34),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}const Se=function(n){return{path:n,text:"\u8a2d\u5b9a\u4e00\u89a7"}},De=function(n){return{path:n,text:"\u8acb\u6c42\u4e00\u89a7"}},Ze=function(){return{text:"\u500b\u5225\u8acb\u6c42\u30c7\u30fc\u30bf\u4f5c\u6210"}},Oe=function(n,o,e){return[n,o,e]},Fe=function(){return{label:"\u7de0\u65e5"}},Tt=function(n){return{ctrl:n}},ye=function(){return{label:"\u5f97\u610f\u5148"}},we=function(){return{label:"\u58f2\u4e0a\u65e5",required:"true"}};let Ie=(()=>{class n{constructor(e,i,a,s,r,c,u,_,m){this.modalService=e,this.flashMessageService=i,this.clientService=a,this.router=s,this.fb=r,this.authorService=c,this.errorService=u,this.common=_,this.individualBillService=m,this.subscription=new A.w0,this.subject=new B.x,this.topPagePath="/setting",this.listPagePath="../bill",this.mainPagePath="/individual-bill",this.errorLoadTitle="\u500b\u5225\u8acb\u6c42\u30c7\u30fc\u30bf\u753b\u9762\u30a8\u30e9\u30fc\uff1a"+p.yR.TITLE.HAS_ERROR,this.errorModalTitle="\u8acb\u6c42\u30c7\u30fc\u30bf\u4f5c\u6210\u30a8\u30e9\u30fc\uff1a"+p.yR.TITLE.HAS_ERROR,this.errorConst=T.c,this.init_date=this.getInitDate(),this.inputForm=this.fb.group({cutoff_date_billing:[""],client_id:[""],sale_date:this.fb.group({from:["",[d.kI.required]],to:["",[d.kI.required]]},{validators:[F.d.beforeFromDate()]})},{validators:this.customValidator})}customValidator(e){const i=e.get("cutoff_date_billing")?.value,a=e.get("client_id")?.value;return i||a?null:{bothFieldsEmpty:!0}}get ctrls(){return this.inputForm.controls}getInitDate(){var e=new Date;return new Date(e.getFullYear(),e.getMonth()-1,1)}getEndDate(){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),0)}ngOnInit(){this.authorService.author?this.author=this.authorService.author:this.subscription.add(this.authorService.author$.subscribe(e=>{this.author=e})),this.initOptions(),this.setDefaultValue(),this.setSubscribe()}setDefaultValue(){}ngOnDestroy(){this.subscription.unsubscribe()}initOptions(){this.common.loading=!0,this.subscription.add((0,I.D)([this.clientService.getAsSelectOptions({},i=>({value:i.id,text:`${i.name}`,cutoff_date_billing:i.cutoff_date_billing}))]).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(i=>(0,b.of)(i))).subscribe(i=>{if(i instanceof C.UA)this.handleError(i.status,this.errorLoadTitle,i.message);else if(null!=i)if(1===i.length){this.cutoffDateBillingSuggests=[];for(let a=1;a<31;a++)this.cutoffDateBillingSuggests.push({value:a,text:a+"\u65e5"});this.cutoffDateBillingSuggests.push({value:99,text:"\u672b\u65e5"},{value:98,text:"\u7121\u3057"}),this.clientSuggests=i[0]}else this.handleError(400,this.errorLoadTitle,p.yR.BODY.HAS_ERROR);else this.handleError(400,this.errorLoadTitle,p.yR.BODY.HAS_ERROR)}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleError(e,i,a){this.modalService.setModal(i,0===e?a+T.c.GUIDANCE_OF_SUPPORT:`\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9: ${e} \n\u30e1\u30c3\u30bb\u30fc\u30b8: `+a+T.c.GUIDANCE_OF_SUPPORT,"danger",p.yR.BUTTON_TITLE.CLOSE,""),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,O.h)(r=>this.modalService.getModalProperties().title===i)).subscribe(r=>{}))}handleClickSaveButton(){this.inputForm.markAsPristine(),this.common.loading=!0;const e=this.inputForm.value;if(!e.sale_date?.from||!e.sale_date?.to)return this.ctrls.sale_date.controls.from.setValue(""),this.ctrls.sale_date.controls.to.setValue(""),void(this.common.loading=!1);const i={client_id:Number(e.client_id),from_sale_date:new Date(e.sale_date.from).toLocaleDateString(),to_sale_date:new Date(e.sale_date.to).toLocaleDateString()};null!==e.cutoff_date_billing&&(i.cutoff_date_billing=Number(e.cutoff_date_billing)),console.log("postData formVal.cutoff_date_billing:: ",e.cutoff_date_billing),console.log("postData formVal.client_id:: ",e.client_id),console.log("postData postData:: ",i),this.subscription.add(this.individualBillService.createBillingData(i).pipe((0,h.K)(a=>(0,b.of)(a)),(0,f.x)(()=>this.common.loading=!1)).subscribe(a=>{a instanceof C.UA?this.handleError(a.status,this.errorModalTitle,a.error.message):(this.flashMessageService.setFlashMessage(a.message,"success",15e3),this.subject.next({}))}))}setSubscribe(){let e=new A.w0,i=new A.w0;const a=r=>{e.unsubscribe(),this.inputForm.get("cutoff_date_billing")?.setValue(null),this.ctrls.sale_date.controls.from.setValue(null),this.ctrls.sale_date.controls.to.setValue(null);const c=this.clientSuggests.find(u=>u.value===r);c&&(this.cutoffDateBilling=Number(c.cutoff_date_billing)),e=this.inputForm.get("cutoff_date_billing")?.valueChanges.subscribe(s)},s=r=>{this.cutoffDateBilling=r,i.unsubscribe(),this.inputForm.get("client_id")?.setValue(null),this.ctrls.sale_date.controls.from.setValue(null),this.ctrls.sale_date.controls.to.setValue(null),i=this.inputForm.get("client_id")?.valueChanges.subscribe(a)};e=this.inputForm.get("cutoff_date_billing")?.valueChanges.subscribe(s),i=this.inputForm.get("client_id")?.valueChanges.subscribe(a)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(y.Z),t.Y36(P.P),t.Y36(q.y),t.Y36(x.F0),t.Y36(d.qu),t.Y36(vt.Y),t.Y36(w.T),t.Y36(S.v),t.Y36(pe))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-individual-bill"]],decls:44,vars:47,consts:[[3,"breadcrumbList"],[1,"mb-8"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-end"],[3,"roleTypeName"],[1,"width-limit-break","border-t","border-gray-400"],[3,"formGroup","ngSubmit"],[1,"mt-8","mb-24","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"flex","gap-6","mt-6","mb-6"],[1,"w-2/5"],[1,"flex","justify-center"],[1,"w-1/2"],[1,"flex","justify-between"],[1,"w-1/5"],["nameAttrValue","cutoff_date_billing","idAttrValue","cutoff-date-billing","placeholder","\u7de0\u65e5\u9078\u629e",3,"formCtrl","suggests","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-3/4"],["nameAttrValue","client_id","idAttrValue","client-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[1,"flex","justify-center","gap-6"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","cutoffDateBilling","invalid"],["message","",4,"ngIf","ngIfThen"],[1,"width-limit-break","bg-primary-light","flex","flex-row","justify-center","bottom-[40px]","left-0","right-0","p-2","fixed","gap-8"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["labels",""],["errors",""],["beforeFromDate",""],["message",""],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[4,"ngIf"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,i){if(1&e&&(t._UZ(0,"app-breadcrumb-org",0)(1,"app-toggle-button"),t.TgZ(2,"main",1)(3,"div",2)(4,"div")(5,"app-last-updater-org",3),t._uU(6),t.qZA()()(),t._UZ(7,"hr",4),t.TgZ(8,"form",5),t.NdJ("ngSubmit",function(){return i.handleClickSaveButton()}),t.TgZ(9,"div",6)(10,"h2",7),t._uU(11,"\u500b\u5225\u8acb\u6c42\u30c7\u30fc\u30bf\u4f5c\u6210"),t.qZA(),t._UZ(12,"hr",8),t.TgZ(13,"div",9),t._UZ(14,"div",10)(15,"div",10),t.qZA(),t.TgZ(16,"div",11)(17,"div",12)(18,"div",13)(19,"div",14)(20,"app-select-suggest-container",15),t.YNc(21,de,1,0,"ng-container",16),t.YNc(22,_e,1,0,"ng-container",17),t.qZA()(),t.TgZ(23,"div",18)(24,"app-select-suggest-container",19),t.YNc(25,me,1,0,"ng-container",16),t.YNc(26,he,1,0,"ng-container",17),t.qZA()()()()(),t.TgZ(27,"div",20)(28,"app-date-term-clear-container",21),t.YNc(29,ge,1,0,"ng-container",16),t.YNc(30,fe,1,0,"ng-container",17),t.YNc(31,be,1,0,"ng-container",22),t.qZA()(),t.TgZ(32,"div",9),t._UZ(33,"div",10)(34,"div",10),t.qZA()(),t.TgZ(35,"div",23)(36,"app-button",24),t._uU(37,"\u8acb\u6c42\u30c7\u30fc\u30bf\u4f5c\u6210"),t.qZA()()()(),t.YNc(38,Ce,4,2,"ng-template",null,25,t.W1O),t.YNc(40,Ae,1,1,"ng-template",null,26,t.W1O),t.YNc(42,Ee,2,1,"ng-template",null,27,t.W1O)),2&e){const a=t.MAs(39),s=t.MAs(41),r=t.MAs(43);t.Q6J("breadcrumbList",t.kEZ(34,Oe,t.VKq(29,Se,i.topPagePath),t.VKq(31,De,i.listPagePath),t.DdM(33,Ze))),t.xp6(5),t.Q6J("roleTypeName",i.author&&i.author.role_name?i.author.role_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.xp6(1),t.hij(" \u4f5c\u6210\u8005\uff1a",i.author?i.author.last_name+" "+i.author.first_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."," "),t.xp6(2),t.Q6J("formGroup",i.inputForm),t.xp6(12),t.Q6J("formCtrl",i.ctrls.cutoff_date_billing)("suggests",i.cutoffDateBillingSuggests)("invalid",i.formControlStateManager(i.ctrls.cutoff_date_billing)),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(38,Fe)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(39,Tt,i.ctrls.cutoff_date_billing)),t.xp6(2),t.Q6J("formCtrl",i.ctrls.client_id)("suggests",i.clientSuggests)("invalid",i.formControlStateManager(i.ctrls.client_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(41,ye)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(42,Tt,i.ctrls.client_id)),t.xp6(2),t.Q6J("dateFromFormCtrl",i.ctrls.sale_date.controls.from)("dateToFormCtrl",i.ctrls.sale_date.controls.to)("cutoffDateBilling",i.cutoffDateBilling)("invalid",!!i.ctrls.sale_date.errors),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(44,we)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(45,Tt,i.ctrls.sale_date.controls.from)),t.xp6(1),t.Q6J("ngIf",null==i.ctrls.sale_date.errors?null:i.ctrls.sale_date.errors.beforeFromDate)("ngIfThen",r),t.xp6(5),t.Q6J("buttonDisabled",i.inputForm.invalid||i.inputForm.pristine)}},dependencies:[g.O5,g.tP,R.Z,Ct.R,k.r,st,d._Y,d.JL,d.sg,j.w,K.X]}),n})(),Y=(()=>{class n extends Q.O{constructor(){super(...arguments),this.endpoint=V.pU.accountsReceivableAggregateApi.endpoint,this._paymentEventSource=new B.x,this.paymentEvent$=this._paymentEventSource.asObservable()}getAll(e={}){return this.httpOptions.params=e,this.http.get(this.endpoint,this.httpOptions)}find(e){return this.http.get(`${this.endpoint}/${e}`)}getCsv(e,i={}){const a={params:i,responseType:"text",headers:new C.WM({"X-Download":e})};return this.http.get(this.endpoint,a).pipe((0,h.K)(this.setErrorMessage("\u4e00\u62ec\u767b\u9332\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u53d6\u5f97")))}getPdf(e,i={}){const a={params:i,responseType:"blob",headers:new C.WM({"X-Download":e})};return this.http.get(this.endpoint,a).pipe((0,h.K)(this.setErrorMessage("\u8acb\u6c42\u66f8PDF\u4e00\u62ec\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9")))}add(e){const i=this.generateFormData(e);return this.http.post(this.endpoint,i)}aggregate(e){const i=this.generateFormData(e);return this.http.post(this.endpoint,i)}bulkAdd(e){const i=this.generateFormData({file:e});return this.http.put(this.endpoint,i)}update(e,i){const a=this.generateFormData(i);return this.http.patch(`${this.endpoint}/${e}`,a)}remove(e){return this.http.delete(`${this.endpoint}/${e}`,this.httpOptions)}sendPaymentEvent(e){this._paymentEventSource.next(e)}listremove(e){return this.http.delete(`${this.endpoint}/?delete_id=${e}`).pipe((0,h.K)(this.setErrorMessage("\u8acb\u6c42\u306e\u524a\u9664")))}}return n.\u0275fac=function(){let o;return function(i){return(o||(o=t.n5z(n)))(i||n)}}(),n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var $=l(4181),rt=l(8505),xt=l(3900),D=l(2352),Pe=l(8501),ke=l(1043),At=l(4333),U=l(3761),Ue=l(5861),G=l(349);function Be(n,o){if(1&n&&t._UZ(0,"app-icon",8),2&n){const e=t.oxw().$implicit,i=t.oxw();t.Q6J("icon",i.sort.column===e&&"desc"===i.sort.order?"sort-desc":"sort-asc")("ngClass",i.sort.column===e?"fill-primary":"fill-slate-300")}}function Ne(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"th",5),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.changeSort(s))}),t.TgZ(1,"div",6)(2,"span"),t._uU(3),t.qZA(),t.YNc(4,Be,1,2,"app-icon",7),t.qZA()()}if(2&n){const e=o.$implicit;t.Q6J("ngClass",e?"hover:bg-iron-blue-200 cursor-pointer":"cursor-auto"),t.xp6(3),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",e)}}function Re(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",16)(2,"a",17),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,s=t.oxw(2);return t.KtG(s.getPdfItem(a.href))}),t._UZ(3,"app-icon",8),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw(2).$implicit;t.xp6(3),t.Q6J("icon",e.icon)("ngClass","inline fill-primary-light hover:fill-primary-light-hover")}}function Me(n,o){if(1&n&&(t.TgZ(0,"a",18),t._uU(1),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.Q6J("routerLink",e.href),t.xp6(1),t.hij(" ",e.text," ")}}function Le(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Re,4,2,"ng-container",12),t.YNc(2,Me,2,2,"ng-template",null,15,t.W1O),t.BQk()),2&n){const e=t.MAs(3),i=t.oxw().$implicit,a=t.oxw(2);t.xp6(1),t.Q6J("ngIf",a.isIconLinkData(i))("ngIfElse",e)}}function qe(n,o){if(1&n&&t._uU(0),2&n){const e=t.oxw().$implicit,i=t.oxw(2);t.hij(" ",i.isNormalData(e)?e.text:""," ")}}function Ye(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",19),t.NdJ("change",function(a){t.CHM(e);const s=t.oxw().$implicit,r=t.oxw(2);return t.KtG(s.value=r.getValue(a))}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("id",e.id)("value",e.value)}}function Je(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",20),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.addNewItem(a.value))}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("value",e.value)("checked",e.selected)}}const Qe=function(n,o){return[n,o]};function Ve(n,o){if(1&n&&(t.TgZ(0,"td",11),t.YNc(1,Le,4,2,"ng-container",12),t.YNc(2,qe,1,1,"ng-template",null,13,t.W1O),t.YNc(4,Ye,2,2,"ng-container",14),t.YNc(5,Je,2,2,"ng-container",14),t.qZA()),2&n){const e=o.$implicit,i=t.MAs(3),a=t.oxw().first,s=t.oxw();t.Q6J("ngClass",t.WLB(5,Qe,a?"":"border-t border-t-iron-blue-300",s.getPositionClass(e))),t.xp6(1),t.Q6J("ngIf",s.isLinkData(e))("ngIfElse",i),t.xp6(3),t.Q6J("ngIf",s.isInputNumber(e)),t.xp6(1),t.Q6J("ngIf",s.isCheckBox(e))}}function je(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr",9),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.editPanelOpen(r.isLinkData(s[0])?s[0].text:""))}),t.YNc(2,Ve,6,8,"td",10),t.qZA(),t.BQk()}if(2&n){const e=o.$implicit;t.xp6(2),t.Q6J("ngForOf",e)}}function Ke(n,o){1&n&&(t.TgZ(0,"span",23),t._uU(1,"\u5fc5\u9808"),t.qZA())}function $e(n,o){if(1&n&&(t.TgZ(0,"div",21)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,Ke,2,0,"span",22),t.qZA()),2&n){const e=o.label,i=o.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",i)}}function Ge(n,o){if(1&n&&(t.TgZ(0,"p",25),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function He(n,o){if(1&n&&(t.TgZ(0,"p",25),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function We(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Ge,2,1,"p",24),t.YNc(2,He,2,1,"p",24),t.BQk()),2&n){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.pattern)}}function ze(n,o){if(1&n&&t.YNc(0,We,3,2,"ng-container",14),2&n){const e=o.ctrl,i=t.oxw();t.Q6J("ngIf",i.formControlStateManager(e))}}let Xe=(()=>{class n{constructor(e,i){this.fb=e,this.araService=i,this.event=new t.vpe,this.newItemEvent=new t.vpe,this.changeItemEvent=new t.vpe,this.statusChange=new t.vpe,this.isEditable=!1,this.errorConst=T.c,this.form=this.fb.group({payment_date:["",[d.kI.required]],payment_amount:["",[d.kI.required,d.kI.pattern(G.m.NUMERIC_REG_EX)]]})}get fc(){return this.form.controls}ngOnInit(){this.sort={column:this.header?this.header.filter(e=>e)[0]:"",order:"asc"}}changeSort(e){!e||(this.sort.order=this.sort.column===e&&"asc"===this.sort.order?"desc":"asc",this.sort.column=e,this.event.emit(this.sort))}isLinkData(e){return void 0!==e.href}isIconLinkData(e){return this.isLinkData(e)&&void 0!==e.icon}isNormalData(e){return!this.isLinkData(e)&&!this.isIconLinkData(e)}isInputNumber(e){return"string"==typeof e.name&&"string"==typeof e.value&&"boolean"==typeof e.text}isCheckBox(e){return"string"==typeof e.name&&"string"==typeof e.value&&"boolean"==typeof e.selected&&"boolean"==typeof e.checkbox}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}editPanelOpen(e){""===e||null==e||this.editTargetId===e||(this.isEditable=!0,this.editTargetId=e)}getPdfItem(e){var i=this;(0,Ue.Z)(function*(){i.statusChange.emit(3),fetch(e).then(a=>a.blob()).then(a=>{const s=window.URL.createObjectURL(a);var r=document.createElement("a");document.body.appendChild(r),r.setAttribute("style","display: none"),r.href=s,r.download="\u8acb\u6c42\u66f8.pdf",r.click(),setTimeout(()=>{window.URL.revokeObjectURL(s)},250)}),i.statusChange.emit(0)})()}checkUnCheck(e,i){const a=i.value;if(1==e.target.checked)return void this.bulkIds.push(a);const s=this.bulkIds.indexOf(a);s>-1&&this.bulkIds.splice(s,1)}addNewItem(e){this.newItemEvent.emit(e)}getValue(e){let i=e.target.value,s=e.target.id.split("__");return this.changeItemEvent.emit({id:s[1],name:s[0],value:i}),i}getPositionClass(e){return e&&"object"==typeof e&&"position"in e?e.position:"text-center"}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.qu),t.Y36(Y))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-accounts-receivable-aggregate-bill-list-table"]],inputs:{header:"header",data:"data",selctedlist:"selctedlist",bulkIds:"bulkIds"},outputs:{event:"event",newItemEvent:"newItemEvent",changeItemEvent:"changeItemEvent",statusChange:"statusChange"},decls:10,vars:2,consts:[[1,"whitespace-nowrap","border-separate","border-spacing-0","w-full"],["class","font-normal border border-x-0 border-slate-300 px-3 py-4 hover:transition-all duration-300",3,"ngClass","click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["labels",""],["errors",""],[1,"font-normal","border","border-x-0","border-slate-300","px-3","py-4","hover:transition-all","duration-300",3,"ngClass","click"],[1,"flex","gap-1","pl-2","justify-center"],["class","w-6",3,"icon","ngClass",4,"ngIf"],[1,"w-6",3,"icon","ngClass"],[1,"bg-white","even:bg-iron-blue-100","hover:bg-iron-blue-200","hover:transition-all","duration-300",3,"click"],["class","px-3 py-4",3,"ngClass",4,"ngFor","ngForOf"],[1,"px-3","py-4",3,"ngClass"],[4,"ngIf","ngIfElse"],["noLinkData",""],[4,"ngIf"],["normalLinkData",""],[1,"flex","justify-center"],["target","_blank","download","example.pdf",3,"click"],[1,"text-primary-light","border-b","border-primary-light","hover:text-primary-light-hover","hover:border-primary-light-hover",3,"routerLink"],["type","text","name","item.name",3,"id","value","change"],["type","checkbox","name","item.name",2,"transform","scale(1.5)","margin-left","0.5em",3,"value","checked","click"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,i){1&e&&(t.TgZ(0,"table",0)(1,"thead")(2,"tr"),t.YNc(3,Ne,5,3,"th",1),t.qZA()(),t.TgZ(4,"tbody"),t.YNc(5,je,3,1,"ng-container",2),t.qZA()(),t.YNc(6,$e,4,2,"ng-template",null,3,t.W1O),t.YNc(8,ze,1,1,"ng-template",null,4,t.W1O)),2&e&&(t.xp6(3),t.Q6J("ngForOf",i.header),t.xp6(2),t.Q6J("ngForOf",i.data))},dependencies:[g.mk,g.sg,g.O5,x.yS,U.o]}),n})();var ti=l(5142);function ei(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-icon",20),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(11);return t.KtG(a.setCurrent(1))}),t.qZA()}}function ii(n,o){1&n&&t._UZ(0,"app-icon",21)}function ni(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-icon",22),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(11);return t.KtG(a.previous())}),t.qZA()}}function ai(n,o){1&n&&t._UZ(0,"app-icon",23)}function oi(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"span",27),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit;t.oxw();const s=t.MAs(11);return t.KtG(s.setCurrent(a.value))}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.label)}}function si(n,o){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.label)}}function ri(n,o){if(1&n&&(t.TgZ(0,"div",24),t.YNc(1,oi,2,1,"span",25),t.YNc(2,si,2,1,"span",26),t.qZA()),2&n){const e=o.$implicit;t.oxw();const i=t.MAs(11);t.Q6J("ngClass",i.getCurrent()===e.value?"cursor-auto bg-primary text-white":"hover:text-slate-400"),t.xp6(1),t.Q6J("ngIf",i.getCurrent()!==e.value),t.xp6(1),t.Q6J("ngIf",i.getCurrent()===e.value)}}function li(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-icon",28),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(11);return t.KtG(a.next())}),t.qZA()}}function ci(n,o){1&n&&t._UZ(0,"app-icon",29)}function ui(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-icon",30),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(11);return t.KtG(a.setCurrent(a.getLastPage()))}),t.qZA()}}function pi(n,o){1&n&&t._UZ(0,"app-icon",31)}const di=function(n,o,e){return{currentPage:n,itemsPerPage:o,totalItems:e}},_i=["*"];let mi=(()=>{class n{constructor(){this.subscription=new A.w0,this.loading=!1,this._params={total:0,header:[],body:[]},this.pageChange=new t.vpe,this.checkItem=new t.vpe,this.changeItem=new t.vpe,this.options=[{value:10,text:"1\u30da\u30fc\u30b8\u306b10\u30ec\u30b3\u30fc\u30c9\u8868\u793a"},{value:25,text:"1\u30da\u30fc\u30b8\u306b25\u30ec\u30b3\u30fc\u30c9\u8868\u793a"}],this.select=new d.NI(this.options[0].value),this.sort={},this.page=1,this.itemsPerPage=Number(this.options[0].value),this.counts={start:0,end:0}}ngOnInit(){this.subscription.add(this.params.subscribe(e=>{e.total!==this._params.total&&(this.page=1),this._params=e,this.updateCounts()})),this.subscription.add(this.select.valueChanges.subscribe(e=>{this.changeSelect(Number(e))}))}updatePage(e){this.page=e,this.pageChange.emit({page:this.page,itemsPerPage:this.itemsPerPage,sort:this.sort})}changeSelect(e){this.page=Math.ceil(this.counts.start/e),this.page=this.page>0?this.page:1,this.itemsPerPage=e,this.updatePage(this.page)}updateCounts(){const e=(this.page-1)*this.itemsPerPage+1;this.counts.start=e<this._params.total?e:this._params.total;const i=e+this.itemsPerPage-1;this.counts.end=i<this._params.total?i:this._params.total}ngOnDestroy(){this.subscription.unsubscribe()}addItem(e){this.checkItem.emit(e)}changeItemData(e){this.changeItem.emit(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-table-with-pagination"]],inputs:{loading:"loading",params:"params",bulkIds:"bulkIds",selectitemList:"selectitemList"},outputs:{pageChange:"pageChange",checkItem:"checkItem",changeItem:"changeItem"},ngContentSelectors:_i,decls:28,vars:35,consts:[[1,"bg-white","border-t-4","border-t-primary-light","border","border-slate-50","rounded-b-lg","shadow"],[1,"flex","justify-between","items-center","px-4","py-2"],[1,"mr-6",3,"formCtrl","options"],[1,"overflow-auto"],[3,"header","bulkIds","data","selctedlist","event","newItemEvent","changeItemEvent"],[1,"border-y","border-t-slate-400","py-4"],["width","w-6","height","h-6","borderWidth","border-[6px]"],[1,"flex","items-center","justify-between","gap-2","px-4","py-6","border-t","border-t-slate-300",3,"pageChange"],["p","paginationApi"],[1,"w-1/3"],[1,"flex","items-center","gap-2"],["class","w-6 cursor-pointer hover:opacity-60","icon","skip-back-line",3,"click",4,"ngIf"],["class","w-6 fill-iron-blue-400","icon","skip-back-line",4,"ngIf"],["class","w-6 rotate-180 cursor-pointer hover:opacity-60","icon","back-line",3,"click",4,"ngIf"],["class","w-6 rotate-180 fill-iron-blue-400","icon","back-line",4,"ngIf"],["class","min-w-[1.75rem] rounded text-center cursor-pointer p-1",3,"ngClass",4,"ngFor","ngForOf"],["class","w-6 cursor-pointer hover:opacity-60","icon","back-line",3,"click",4,"ngIf"],["class","w-6 fill-iron-blue-400","icon","back-line",4,"ngIf"],["class","w-6 cursor-pointer hover:opacity-60","icon","skip-forward-line",3,"click",4,"ngIf"],["class","w-6 fill-iron-blue-400","icon","skip-forward-line",4,"ngIf"],["icon","skip-back-line",1,"w-6","cursor-pointer","hover:opacity-60",3,"click"],["icon","skip-back-line",1,"w-6","fill-iron-blue-400"],["icon","back-line",1,"w-6","rotate-180","cursor-pointer","hover:opacity-60",3,"click"],["icon","back-line",1,"w-6","rotate-180","fill-iron-blue-400"],[1,"min-w-[1.75rem]","rounded","text-center","cursor-pointer","p-1",3,"ngClass"],["class","block",3,"click",4,"ngIf"],[4,"ngIf"],[1,"block",3,"click"],["icon","back-line",1,"w-6","cursor-pointer","hover:opacity-60",3,"click"],["icon","back-line",1,"w-6","fill-iron-blue-400"],["icon","skip-forward-line",1,"w-6","cursor-pointer","hover:opacity-60",3,"click"],["icon","skip-forward-line",1,"w-6","fill-iron-blue-400"]],template:function(e,i){if(1&e&&(t.F$t(),t.TgZ(0,"div",0)(1,"div",1)(2,"app-title"),t.Hsn(3),t.qZA(),t._UZ(4,"app-select",2),t.qZA(),t.TgZ(5,"div",3)(6,"app-accounts-receivable-aggregate-bill-list-table",4),t.NdJ("event",function(s){return i.sort=s,i.updatePage(i.page)})("newItemEvent",function(s){return i.addItem(s)})("changeItemEvent",function(s){return i.changeItemData(s)}),t.ALo(7,"paginate"),t.qZA(),t.TgZ(8,"div",5),t._UZ(9,"app-spinner",6),t.qZA()(),t.TgZ(10,"pagination-template",7,8),t.NdJ("pageChange",function(s){return i.updatePage(s)}),t.TgZ(12,"p",9),t._uU(13),t.ALo(14,"number"),t.ALo(15,"number"),t.ALo(16,"number"),t.qZA(),t.TgZ(17,"div",10),t.YNc(18,ei,1,0,"app-icon",11),t.YNc(19,ii,1,0,"app-icon",12),t.YNc(20,ni,1,0,"app-icon",13),t.YNc(21,ai,1,0,"app-icon",14),t.YNc(22,ri,3,3,"div",15),t.YNc(23,li,1,0,"app-icon",16),t.YNc(24,ci,1,0,"app-icon",17),t.YNc(25,ui,1,0,"app-icon",18),t.YNc(26,pi,1,0,"app-icon",19),t.qZA(),t._UZ(27,"div",9),t.qZA()()),2&e){const a=t.MAs(11);t.xp6(4),t.Q6J("formCtrl",i.select)("options",i.options),t.xp6(2),t.ekj("hidden",i.loading),t.Q6J("header",i._params.header)("bulkIds",i.bulkIds)("data",t.xi3(7,22,i._params.body,t.kEZ(31,di,i.page,i.itemsPerPage,i._params.total)))("selctedlist",i.selecteditemList),t.xp6(2),t.ekj("hidden",!i.loading),t.xp6(5),t.lnq(" ",t.lcZ(14,25,i._params.total)," \u4ef6\u4e2d ",t.lcZ(15,27,i.counts.start)," \uff5e ",t.lcZ(16,29,i.counts.end)," \u4ef6 \u8868\u793a\u4e2d "),t.xp6(5),t.Q6J("ngIf",!a.isFirstPage()),t.xp6(1),t.Q6J("ngIf",a.isFirstPage()),t.xp6(1),t.Q6J("ngIf",!a.isFirstPage()),t.xp6(1),t.Q6J("ngIf",a.isFirstPage()),t.xp6(1),t.Q6J("ngForOf",a.pages),t.xp6(1),t.Q6J("ngIf",!a.isLastPage()),t.xp6(1),t.Q6J("ngIf",a.isLastPage()),t.xp6(1),t.Q6J("ngIf",!a.isLastPage()),t.xp6(1),t.Q6J("ngIf",a.isLastPage())}},dependencies:[g.mk,g.sg,g.O5,Pe.r,ke.H,At.tk,U.o,Xe,ti.O,g.JJ,At._s]}),n})(),hi=(()=>{class n{constructor(e,i,a,s,r){this.araService=e,this.common=i,this.modalService=a,this.router=s,this.flashMessageService=r,this.subscription=new A.w0,this.errorEvent=new t.vpe,this.bulkIdsChange=new t.vpe,this.items=[],this.listItem=[],this.filter={},this.defaultSort={column:"\u8acb\u6c42ID",order:"desc"},this.pages={page:1,itemsPerPage:10,sort:this.defaultSort},this.tableParams=new B.x,this.loading=!1,this.headerContents=[{displayName:"\u9078\u629e",colName:"id"},{displayName:"\u8acb\u6c42ID",colName:"id"},{displayName:"\u8acb\u6c42\u5148",colName:"client_name"},{displayName:"\u8acb\u6c42\u65e5",colName:"billing_date"},{displayName:"\u8acb\u6c42\u91d1\u984d",colName:"billing_amount"},{displayName:"\u5165\u91d1\u4e88\u5b9a\u65e5",colName:"payment_exp_date"},{displayName:"\u8acb\u6c42\u66f8PDF",colName:"pdf"}],this.deleteList=new d.cw({idlist:new d.NI("",[d.kI.required])}),this.list_string="",this.button_status=!0}ngOnInit(){this.button_status=!0,this.loadTableData(!1),this.resetSelectItems()}loadTableData(e){this.subscribeEventListener(e),this.eventListener.next(this.pages)}subscribeEventListener(e){this.subscription?.unsubscribe(),this.subscription=this.eventListener.pipe((0,rt.b)(()=>this.common.loading=!0),(0,xt.w)(i=>this.araService.getAll(this.createApiParams(i))),(0,h.K)(i=>(0,b.of)(i)),(0,f.x)(()=>this.common.loading=!1)).subscribe({next:i=>{this.common.loading=!1,i instanceof C.UA?this.handleErrors(i.status,"\u767a\u6ce8\u66f8\u4e00\u89a7\uff1a"+p.yR.TITLE.HAS_ERROR,i.error.message):this.tableParams.next(this.createTableParams(i,e))},complete:()=>this.subscribeEventListener(e)})}createApiParams(e){this.isTableWithPaginationEvent(e)?this.pages=e:(this.filter=e,this.pages.page=1),0===Object.keys(this.pages.sort).length&&(this.pages.sort=this.defaultSort);const a=this.headerContents.find(r=>r.displayName===this.pages.sort.column)?.colName;let s;return s="client_name"===a?"client_name_kana":"created_id"===a||"pdf"===a?"id":a,{...this.filter,limit:this.pages.itemsPerPage,offset:(this.pages.page-1)*this.pages.itemsPerPage,sort:s?`${s}:${this.pages.sort.order}`:""}}isTableWithPaginationEvent(e){const{page:i,itemsPerPage:a,sort:s}=e;return"number"==typeof i&&"number"==typeof a&&"object"==typeof s}createTableParams(e,i){const a=this.headerContents.map(r=>r.displayName),s=e.data.map(r=>this.headerContents.map(c=>r[c.colName]));return this.listItem=this.deleteList.get("idlist"),this.selectitems=this.listItem.value,null!=this.selectitems&&(this.selectLists=this.selectitems?.split(",")),s.forEach((r,c)=>{let u=-1;const _=!0===i;u=a.indexOf("\u8acb\u6c42ID");let m=r[u]?.toLocaleString();this.selectLists.includes(m),u=a.indexOf("\u9078\u629e"),r[u]={checkbox:!0,name:"checkbox",value:r[u]+"",selected:_},!0===i&&this.selectcheck(r[u]),u=a.indexOf("\u8acb\u6c42ID"),r[u]={position:"text-center",href:`./slip-list/${e.data[c].id}`,text:r[u]+""},u=a.indexOf("\u8acb\u6c42\u5148"),r[u]={position:"text-center",text:r[u]+""},u=a.indexOf("\u8acb\u6c42\u65e5"),r[u]=""===r[u]||null==r[u]||"NaT"===r[u]?{position:"text-center",text:""}:{position:"text-center",text:new Date(r[u]).toLocaleDateString()},u=a.indexOf("\u8acb\u6c42\u91d1\u984d"),r[u]={position:"text-right",text:r[u]?Number(r[u]).toLocaleString()+" ":"0 "},u=a.indexOf("\u5165\u91d1\u4e88\u5b9a\u65e5"),r[u]=""===r[u]||null==r[u]||"NaT"===r[u]?{position:"text-center",text:""}:{position:"text-center",text:new Date(r[u]).toLocaleDateString()},u=a.indexOf("\u8acb\u6c42\u66f8PDF"),""!==r[u]&&(r[u]={position:"text-center",href:r[u],icon:"article-line"})}),{total:e.totalItems,header:a,body:s}}handleError(e,i){this.errorEvent.emit({status:e,title:"\u50b5\u6a29\u4e00\u89a7\uff1a"+p.yR.TITLE.HAS_ERROR,message:i})}handleErrors(e,i,a){this.errorEvent.emit({status:e,title:i,message:a})}ngOnDestroy(){this.subscription.unsubscribe()}resetSelectItems(){this.selectitems="",this.listItem=[],this.list_string="",this.updateBulkIds([]),this.items=[],this.deleteList.setValue({idlist:""})}checkUncheckAll(e){this.loadTableData(e.target.checked)}checkUnCheck(e){const i=e.value;if(1==e.selected)return void this.bulkIds.push(i);const a=this.bulkIds.indexOf(i);a>-1&&this.bulkIds.splice(a,1)}allSelectItems(){this.resetSelectItems(),this.loadTableData(!0)}selectcheck(e){this.selectItemList(e.value)}selectItemList(e){let i=this.items.indexOf(e);-1===i?this.items.push(e):this.items.splice(i,1),this.updateBulkIds(this.items),this.items.length>0?(this.list_string=this.items.join(","),this.button_status=!1):this.button_status=!0,this.deleteList.setValue({idlist:this.list_string}),this.selectitems=this.list_string}reset(){this.ngOnDestroy(),this.ngOnInit()}handleClickDelete(){if(this.isSent)return void this.handleErrors(422,D._.ERROR.CANNOT_BE_DELETED,D._.ERROR.ATTEMPTED_TO_MODIFY_SUBMITTED_DATA_CHANGE);const e="\u767a\u6ce8\u66f8"+p.yR.TITLE.DELETE;this.modalService.setModal(e,p.yR.BODY.DELETE,"danger",p.yR.BUTTON_TITLE.DELETE,p.yR.BUTTON_TITLE.CANCEL),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,O.h)(a=>this.modalService.getModalProperties().title===e)).subscribe(a=>{a===p.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&(this.common.loading=!0,console.log("Deletes"),this.araService.listremove(this.list_string).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(s=>(0,b.of)(s))).subscribe(s=>{s instanceof C.UA?this.handleErrors(s.status,s.error.title,s.message):(this.flashMessageService.setFlashMessage(s.message,"success",15e3),this.resetSelectItems(),this.ngOnDestroy(),this.ngOnInit(),this.common.loading=!1,this.router.navigateByUrl("accounts-receivable-aggregate/bill"))}))}))}updateBulkIds(e){this.bulkIds=e,this.bulkIdsChange.emit(this.bulkIds)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Y),t.Y36(S.v),t.Y36(y.Z),t.Y36(x.F0),t.Y36(P.P))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-table"]],inputs:{isLoading:"isLoading",eventListener:"eventListener",paymentEvent:"paymentEvent",bulkIds:"bulkIds"},outputs:{errorEvent:"errorEvent",bulkIdsChange:"bulkIdsChange"},decls:16,vars:6,consts:[[3,"params","bulkIds","loading","pageChange","checkItem"],[1,"flex"],[1,"mt-1","mb-1"],["btnType","button","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"click"],[3,"formGroup","ngSubmit"],["type","text","formControlName","idlist",2,"display","none"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["btnType","button","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"app-table-with-pagination",0),t.NdJ("pageChange",function(s){return i.eventListener.next(s)})("checkItem",function(s){return i.selectItemList(s)}),t._uU(1," \u8acb\u6c42\u4e00\u89a7 "),t.TgZ(2,"div",1)(3,"div",2)(4,"app-button",3),t.NdJ("click",function(){return i.allSelectItems()}),t._uU(5,"\u5168\u9078\u629e"),t.qZA()(),t._uU(6," \xa0\xa0 "),t.TgZ(7,"div",2)(8,"form",4),t.NdJ("ngSubmit",function(){return i.handleClickDelete()}),t._UZ(9,"input",5),t.TgZ(10,"app-button",6),t._uU(11,"\u9078\u629e\u524a\u9664"),t.qZA()()(),t._uU(12," \xa0\xa0 "),t.TgZ(13,"div",2)(14,"app-button",7),t.NdJ("click",function(){return i.reset()}),t._uU(15,"\u9078\u629e\u89e3\u9664"),t.qZA()()()()),2&e&&(t.Q6J("params",i.tableParams)("bulkIds",i.bulkIds)("loading",i.loading),t.xp6(8),t.Q6J("formGroup",i.deleteList),t.xp6(2),t.Q6J("buttonDisabled",i.button_status),t.xp6(4),t.Q6J("buttonDisabled",i.button_status))},dependencies:[mi,k.r,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u]}),n})();var E=l(1267),Vt=l(1914);let Et=(()=>{class n{constructor(e){this.modal=e,this.exportFileExtension="csv",this.text="\u30a8\u30af\u30b9\u30dd\u30fc\u30c8",this.resBackSu=1e3,this.statusChange=new t.vpe}ngOnDestroy(){this.modal.requestCloseModal("cancel")}onClick(){const e="\u30c7\u30fc\u30bf\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u304b\uff1f",i=(0,E.Yc)(this.fileNamePrefix,this.exportFileExtension);this.modal.closeEventObservable$.pipe((0,N.q)(1),(0,O.h)(()=>this.modal.getModalProperties().title===e),(0,O.h)(a=>"continue"===a),(0,rt.b)(()=>this.statusChange.emit($.U.START)),(0,xt.w)(()=>this.export$),(0,rt.b)(()=>this.statusChange.emit($.U.FETCHED)),(0,O.h)(a=>!!a),(0,f.x)(()=>this.statusChange.emit($.U.END))).subscribe(a=>{if(this.isJson(a)){const s=JSON.parse(a);Number(s.totalItems)>this.resBackSu&&this.modal.setModal("\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f","\u4ef6\u6570\u304c\u591a\u3044\u305f\u3081\u3001\u3054\u767b\u9332\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30ea\u30f3\u30af\u304c\u8a18\u8f09\u3055\u308c\u305f\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002\n\u30e1\u30fc\u30eb\u672c\u6587\u306e\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u203b \u30e1\u30fc\u30eb\u304c\u8ff7\u60d1\u30e1\u30fc\u30eb\u306b\u632f\u308a\u5206\u3051\u3089\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u203b \u30e1\u30fc\u30eb\u304c\u9001\u4fe1\u3055\u308c\u308b\u307e\u3067\u6570\u5206\u304b\u304b\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002","success","\u9589\u3058\u308b","\u9589\u3058\u308b",!1)}else(0,E.LR)((0,E.lJ)(a),i)}),this.modal.setModal(e,"\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3068CSV\u30d5\u30a1\u30a4\u30eb\u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u307e\u3059\u3002\n\u7d5e\u308a\u8fbc\u307f\u3092\u884c\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u7d5e\u308a\u8fbc\u307e\u308c\u305f\u30c7\u30fc\u30bf\u304c\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u5bfe\u8c61\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u203b \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u51e6\u7406\u306b\u6570\u5206\u304b\u304b\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002","warning")}isJson(e){try{return JSON.parse(e),!0}catch{return!1}}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(y.Z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-export-link"]],inputs:{export$:"export$",fileNamePrefix:"fileNamePrefix",exportFileExtension:"exportFileExtension",text:"text",resBackSu:"resBackSu"},outputs:{statusChange:"statusChange"},decls:4,vars:1,consts:[["icon","download-cloud-2-fill","appendClassForIcon","fill-primary-light",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div")(1,"app-icon-container",0),t.NdJ("click",function(){return i.onClick()}),t.TgZ(2,"span"),t._uU(3),t.qZA()()()),2&e&&(t.xp6(3),t.Oqu(i.text))},dependencies:[Vt.J],styles:['div[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:relative;cursor:pointer}div[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:after{position:absolute;left:0;bottom:-4px;height:1px;width:100%;--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity));--tw-content: "";transform-origin:top left;--tw-scale-x: 0;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));content:var(--tw-content);transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}div[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:hover:after{content:var(--tw-content);--tw-scale-x: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}']}),n})();let gi=(()=>{class n{constructor(e){this.modal=e,this.text="PDF\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9",this.statusChange=new t.vpe,this.message="\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3068PDF\u30d5\u30a1\u30a4\u30eb\u304c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u307e\u3059\u3002\n\u7d5e\u308a\u8fbc\u307f\u3092\u884c\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u7d5e\u308a\u8fbc\u307e\u308c\u305f\u30c7\u30fc\u30bf\u304c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u5bfe\u8c61\u306b\u306a\u308a\u307e\u3059\u3002"}onClick(){const e="\u30c7\u30fc\u30bf\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u304b\uff1f";this.modal.closeEventObservable$.pipe((0,N.q)(1),(0,O.h)(()=>this.modal.getModalProperties().title===e),(0,O.h)(i=>"continue"===i),(0,rt.b)(()=>this.statusChange.emit(1)),(0,xt.w)(()=>this.apiResponse$)).subscribe(i=>{this.statusChange.emit(3),(0,E.LR)((0,E.hv)(i),this.filename),this.statusChange.emit(0)}),this.modal.setModal(e,this.modalMessage?this.modalMessage:this.message,"warning")}ngOnDestroy(){this.modal.requestCloseModal("cancel")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(y.Z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-export-pdf-org"]],inputs:{apiResponse$:"apiResponse$",filename:"filename",modalMessage:"modalMessage",text:"text"},outputs:{statusChange:"statusChange"},decls:4,vars:1,consts:[[1,"export-pdf-org"],["icon","download-cloud-2-fill","appendClassForIcon","fill-primary-light",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"app-icon-container",1),t.NdJ("click",function(){return i.onClick()}),t.TgZ(2,"span"),t._uU(3),t.qZA()()()),2&e&&(t.xp6(3),t.Oqu(i.text))},dependencies:[Vt.J],styles:['div[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:relative;cursor:pointer}div[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:after{position:absolute;left:0;bottom:-4px;height:1px;width:100%;--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity));--tw-content: "";transform-origin:top left;--tw-scale-x: 0;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));content:var(--tw-content);transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}div[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:hover:after{content:var(--tw-content);--tw-scale-x: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}']}),n})();var lt=l(6232),jt=l(6502);function fi(n,o){1&n&&t.GkF(0,26)}function bi(n,o){1&n&&t.GkF(0)}function vi(n,o){1&n&&t.GkF(0,26)}function Ci(n,o){1&n&&t.GkF(0,26)}function Ti(n,o){1&n&&t.GkF(0,26)}function xi(n,o){1&n&&(t.TgZ(0,"app-button",27),t._uU(1," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA())}function Ai(n,o){1&n&&(t.TgZ(0,"app-button",28),t._uU(1," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA())}function Ei(n,o){if(1&n&&(t.TgZ(0,"div",29)(1,"span"),t._uU(2),t.qZA()()),2&n){const e=o.label;t.xp6(2),t.Oqu(e)}}function Si(n,o){if(1&n&&(t.TgZ(0,"p",32),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MIN_LIMIT," ")}}function Di(n,o){if(1&n&&(t.TgZ(0,"p",32),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function Zi(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Si,2,1,"p",31),t.YNc(2,Di,2,1,"p",31),t.BQk()),2&n){const e=t.oxw().ctrl,i=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.minlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===i.regExConst.NUMERIC_REG_EX+"")}}function Oi(n,o){if(1&n&&t.YNc(0,Zi,3,2,"ng-container",30),2&n){const e=o.ctrl,i=t.oxw();t.Q6J("ngIf",i.invalid(e))}}function Fi(n,o){if(1&n&&(t.TgZ(0,"p",33),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}const Kt=function(n){return{ctrl:n}},yi=function(){return{label:"\u8acb\u6c42\u5148",required:"false"}};let wi=(()=>{class n{constructor(e,i,a,s){this.fb=e,this.clientService=i,this.divisionService=a,this.errorService=s,this.searchEvent=new t.vpe,this.errorEvent=new t.vpe,this.subscription=new A.w0,this.errorLoadTitle="\u8acb\u6c42\u4e00\u89a7\u753b\u9762\u30a8\u30e9\u30fc\uff1a"+p.yR.TITLE.HAS_ERROR,this.errorConst=T.c,this.regExConst=G.m,this.isDuringAcquisition=!1,this.hasSearchPanelOpened=!1,this.rotateAnimation="",this.filteredOptions=[],this.isSearchLoading=!1,this.searchForm=this.fb.group({id:"",client_id:"",billing_date:this.fb.group({from:"",to:""},{validators:[F.d.beforeFromDate()]}),payment_exp_date:this.fb.group({from:"",to:""},{validators:[F.d.beforeFromDate()]})})}get ctrls(){return this.searchForm.controls}ngOnInit(){this.searchForm=this.setSearchClear(),this.initialization()}initialization(){this.subscription.add((0,I.D)([this.clientService.getAsSelectOptions()]).pipe((0,h.K)(e=>(e.emit(e),(0,b.of)(e.error)))).subscribe(e=>{e instanceof C.UA?this.handleError(e.status,this.errorLoadTitle,e.message):null!=e&&1===e.length?this.clientSuggests=e[0]:this.handleError(400,this.errorLoadTitle,p.yR.BODY.HAS_ERROR)}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getFormControlTypeValue(e,i){return e.get(i)}handleClickSearchPaneToggleButton(){this.hasSearchPanelOpened?(this.hasSearchPanelOpened=!1,this.rotateAnimation="rotate-animation-0",Object.values(this.ctrls).forEach(e=>e.patchValue(""))):(this.hasSearchPanelOpened=!0,this.rotateAnimation="rotate-animation-180")}handleClickSearchClearButton(){this.searchForm.reset(),this.searchForm=this.setSearchClear()}handleClickSearchSubmitButton(){const e=(0,E.vP)(this.removeNullsAndBlanks(this.searchForm.value));this.searchEvent.emit(e)}removeNullsAndBlanks(e){const i={};for(const[a,s]of Object.entries(e))null!=s&&""!==s&&(i[a]=s);return i}invalid(e){return(e.touched||e.dirty)&&e.invalid}handleError(e,i,a){this.errorService.setError({status:e,title:i,message:a})}ngOnDestroy(){this.subscription.unsubscribe()}setSearchClear(){return this.fb.group({id:"",client_id:"",billing_date:this.fb.group({from:"",to:""},{validators:[F.d.beforeFromDate()]}),payment_exp_date:this.fb.group({from:"",to:""},{validators:[F.d.beforeFromDate()]})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.qu),t.Y36(q.y),t.Y36(lt.E),t.Y36(w.T))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-billlist-search"]],outputs:{searchEvent:"searchEvent",errorEvent:"errorEvent"},decls:42,vars:36,consts:[[3,"isLoading"],[1,"mt-8"],["btnType","button",3,"click"],[1,"w-6"],["icon","filter-2-line"],[1,"inline-block","ml-1","mr-2"],[1,"inline-block","w-6"],["icon","arrow-down-s-fill"],[1,"mt-6"],[1,"accounts-receivable-aggregate-search","width-limit-break","bg-white"],["autocomplete","off",1,"w-[1280px]","mx-auto","px-4",3,"formGroup","ngSubmit"],[1,"flex","gap-6","mt-6"],[1,"w-1/6",3,"formCtrl"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-1/3"],["nameAttrValue","client_id","idAttrValue","client-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],[1,"flex","gap-8","mt-10"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",4,"ngIf","ngIfElse"],[1,"mt-2","text-sm","text-red"],["disable",""],["labels",""],["errors",""],["beforeFromDate",""],["message",""],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover"],["btnFillColor","text-white bg-slate-300 hover:bg-slate-300"],[1,"flex","items-center","gap-2"],[4,"ngIf"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,i){if(1&e&&(t._UZ(0,"app-loading-container",0),t.TgZ(1,"div",1)(2,"app-button",2),t.NdJ("click",function(){return i.handleClickSearchPaneToggleButton()}),t.TgZ(3,"span",3),t._UZ(4,"app-icon",4),t.qZA(),t.TgZ(5,"span",5),t._uU(6),t.qZA(),t.TgZ(7,"span",6),t._UZ(8,"app-icon",7),t.qZA()(),t.TgZ(9,"div",8)(10,"div",9)(11,"form",10),t.NdJ("ngSubmit",function(){return i.handleClickSearchSubmitButton()}),t.TgZ(12,"div",11)(13,"app-text-clear-container",12),t._uU(14," \u8acb\u6c42ID "),t.YNc(15,fi,1,0,"ng-container",13),t.qZA(),t.TgZ(16,"div",14)(17,"app-select-suggest-container",15),t.YNc(18,bi,1,0,"ng-container",16),t.YNc(19,vi,1,0,"ng-container",13),t.qZA()()(),t.TgZ(20,"div",11)(21,"app-date-term-clear-container",17),t._uU(22," \u8acb\u6c42\u65e5 "),t.YNc(23,Ci,1,0,"ng-container",18),t.qZA()(),t.TgZ(24,"div",11)(25,"app-date-term-clear-container",17),t._uU(26," \u5165\u91d1\u4e88\u5b9a\u65e5 "),t.YNc(27,Ti,1,0,"ng-container",18),t.qZA()(),t.TgZ(28,"div",19)(29,"app-button",2),t.NdJ("click",function(){return i.handleClickSearchClearButton()}),t._uU(30," \u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2 "),t.qZA(),t.YNc(31,xi,2,0,"app-button",20),t.qZA(),t.TgZ(32,"p",21),t._uU(33," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()()()(),t.YNc(34,Ai,2,0,"ng-template",null,22,t.W1O),t.YNc(36,Ei,3,1,"ng-template",null,23,t.W1O),t.YNc(38,Oi,1,1,"ng-template",null,24,t.W1O),t.YNc(40,Fi,2,1,"ng-template",null,25,t.W1O)),2&e){const a=t.MAs(35),s=t.MAs(37),r=t.MAs(39),c=t.MAs(41);t.Q6J("isLoading",i.isDuringAcquisition),t.xp6(6),t.hij(" ",i.hasSearchPanelOpened?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(i.rotateAnimation),t.xp6(3),t.ekj("is-open",i.hasSearchPanelOpened)("shadow",i.hasSearchPanelOpened),t.xp6(1),t.Q6J("formGroup",i.searchForm),t.xp6(2),t.Q6J("formCtrl",i.ctrls.id),t.xp6(2),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(31,Kt,i.ctrls.id)),t.xp6(2),t.Q6J("formCtrl",i.ctrls.client_id)("suggests",i.clientSuggests)("invalid",i.formControlStateManager(i.ctrls.client_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.DdM(33,yi)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(34,Kt,i.ctrls.client_id)),t.xp6(2),t.Q6J("dateFromFormCtrl",i.ctrls.billing_date.controls.from)("dateToFormCtrl",i.ctrls.billing_date.controls.to)("invalid",!!i.ctrls.billing_date.errors),t.xp6(2),t.Q6J("ngIf",null==i.ctrls.billing_date.errors?null:i.ctrls.billing_date.errors.beforeFromDate)("ngIfThen",c),t.xp6(2),t.Q6J("dateFromFormCtrl",i.ctrls.payment_exp_date.controls.from)("dateToFormCtrl",i.ctrls.payment_exp_date.controls.to)("invalid",!!i.ctrls.payment_exp_date.errors),t.xp6(2),t.Q6J("ngIf",null==i.ctrls.payment_exp_date.errors?null:i.ctrls.payment_exp_date.errors.beforeFromDate)("ngIfThen",c),t.xp6(4),t.Q6J("ngIf",i.searchForm.valid)("ngIfElse",a)}},dependencies:[g.O5,g.tP,d._Y,d.JL,d.sg,j.w,Yt.o,k.r,U.o,jt.P,K.X],styles:["#suggest[_ngcontent-%COMP%]{display:block;width:100%;border-radius:.25rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(203 213 225 / var(--tw-border-opacity));padding:.5rem}#suggest[_ngcontent-%COMP%]:focus{border-width:1px;--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity))}#suggest[_ngcontent-%COMP%]:focus::placeholder{color:transparent}#suggest[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.invalid[_ngcontent-%COMP%]{outline:2px solid transparent;outline-offset:2px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-opacity: 1;--tw-ring-color: rgb(234 179 8 / var(--tw-ring-opacity))}.accounts-receivable-aggregate-search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease-in;overflow:hidden}.accounts-receivable-aggregate-search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0;overflow:visible}"]}),n})();const Ii=function(n){return{path:n,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Pi=function(){return{text:"\u8acb\u6c42\u4e00\u89a7"}},ki=function(n,o){return[n,o]};let $t=(()=>{class n{constructor(e,i,a,s){this.errorService=e,this.common=i,this.araService=a,this.flashMessageService=s,this.topPagePath="/setting",this.subscription=new A.w0,this._filter={},this.bulkIds=new Array,this.isDuringAcquisition=!1,this.parentSearchEvent=new B.x,this.parentTableEvent=new B.x,this.pdfFileNamePrefix="\u8acb\u6c42\u66f8\u4e00\u62ecPDF",this.fileNamePrefix="\u8acb\u6c42\u4e00\u89a7",this.csvMappings=[{name:"id",prop_name:"id"},{name:"billing_id",prop_name:"billing_id"},{name:"client_id",prop_name:"client_id"},{name:"client_name",prop_name:"client_name"},{name:"billing_date",prop_name:"billing_date"},{name:"billing_amount",prop_name:"billing_amount"},{name:"payment_exp_date",prop_name:"payment_exp_date"},{name:"status_division_id",prop_name:"status_division_id"}]}get exportPdf$(){return console.log(this.bulkIds.join(",")),this.araService.getPdf("bulk-pdf",{id:this.bulkIds.join(",")}).pipe((0,h.K)(this.araService.handleErrorModal("")),(0,f.x)(()=>this.common.loading=!1))}get export$(){return this.araService.getCsv("csv",{...this._filter}).pipe((0,h.K)(this.araService.handleErrorModal("")),(0,f.x)(()=>this.common.loading=!1))}ngOnInit(){this.subscription.add(this.parentSearchEvent.subscribe(e=>{this._filter=e,this.parentTableEvent.next(e)}))}handleBulkIdsChange(e){this.bulkIds=e}onExportStatusChange(e){e===$.U.START&&(this.common.loading=!0)}handleError(e,i){this.errorService.setError({status:e.status,title:e.title?e.title:"\u30a8\u30e9\u30fc",message:e.message?e.message:"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002",redirectPath:i||void 0})}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(w.T),t.Y36(S.v),t.Y36(Y),t.Y36(P.P))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-list"]],decls:10,vars:13,consts:[[3,"breadcrumbList"],[3,"searchEvent","errorEvent"],[1,"flex","justify-end","mt-4"],["text","\u8acb\u6c42\u4e00\u89a7\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3000",3,"export$","fileNamePrefix","statusChange"],["text","\u8acb\u6c42\u66f8PDF\u4e00\u62ec\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3000",3,"apiResponse$","filename","statusChange"],[1,"block","mt-2",3,"bulkIds","eventListener","errorEvent","bulkIdsChange"]],template:function(e,i){1&e&&(t._UZ(0,"app-breadcrumb-org",0)(1,"app-toggle-button"),t.TgZ(2,"main")(3,"div")(4,"app-billlist-search",1),t.NdJ("searchEvent",function(s){return i.parentSearchEvent.next(s)})("errorEvent",function(s){return i.handleError(s)}),t.qZA()(),t.TgZ(5,"div",2),t._UZ(6,"div"),t.TgZ(7,"app-export-link",3),t.NdJ("statusChange",function(s){return i.onExportStatusChange(s)}),t.qZA(),t.TgZ(8,"app-export-pdf-org",4),t.NdJ("statusChange",function(s){return i.onExportStatusChange(s)}),t.qZA()(),t.TgZ(9,"app-table",5),t.NdJ("errorEvent",function(s){return i.handleError(s)})("bulkIdsChange",function(s){return i.handleBulkIdsChange(s)}),t.qZA()()),2&e&&(t.Q6J("breadcrumbList",t.WLB(10,ki,t.VKq(7,Ii,i.topPagePath),t.DdM(9,Pi))),t.xp6(7),t.Q6J("export$",i.export$)("fileNamePrefix",i.fileNamePrefix),t.xp6(1),t.Q6J("apiResponse$",i.exportPdf$)("filename",i.pdfFileNamePrefix),t.xp6(1),t.Q6J("bulkIds",i.bulkIds)("eventListener",i.parentTableEvent))},dependencies:[st,hi,Et,gi,R.Z,wi]}),n})();Array(15).fill(null).map((n,o)=>({id:1,deposit_id:1,deposit_detail_division_code:1,deposit_amount:10,estimated_deposit_amount:10,deposit_date:"2024-02-01T00:00:00",remarks_1:"\u8a73\u7d30\u5099\u8003001",created_at:"2024-02-08T17:25:08",created_id:8,updated_at:"2024-02-08T17:25:08",updated_id:8,deleted_at:"",deleted_id:"",deposit_remarks_1:"\u5099\u80031",deposit_client_id:1,deposit_client_name:"\u5f97\u610f\u5148001",deposit_client_name_kana:"",employee_created_last_name:"\u30c6\u30b9\u30c8",employee_created_first_name:"\u793e\u54e1 \u540d\u66f4\u65b0",employee_updated_last_name:"\u30c6\u30b9\u30c8",employee_updated_first_name:"\u793e\u54e1 \u540d\u66f4\u65b0"}));let Dt=(()=>{class n extends Q.O{constructor(){super(...arguments),this.endpoint=V.pU.billApi.endpoint}getAll(e={}){return this.httpOptions.params=e,this.http.get(this.endpoint,this.httpOptions).pipe((0,h.K)(this.setErrorMessage("\u8acb\u6c42\u4e00\u89a7\u306e\u53d6\u5f97")))}find(e){return this.http.get(`${this.endpoint}/${e}`)}remove(e){return this.http.delete(`${this.endpoint}/${e}`,this.httpOptions)}}return n.\u0275fac=function(){let o;return function(i){return(o||(o=t.n5z(n)))(i||n)}}(),n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),X=(()=>{class n extends Q.O{constructor(){super(...arguments),this.endpoint=V.pU.depositDetailApi.endpoint}getAll(e={}){return this.httpOptions.params=e,this.http.get(this.endpoint,this.httpOptions).pipe((0,h.K)(this.setErrorMessage("\u5165\u91d1\u660e\u7d30\u4e00\u89a7\u306e\u53d6\u5f97")))}find(e){return this.http.get(`${this.endpoint}/${e}`).pipe((0,h.K)(this.setErrorMessage("\u5165\u91d1\u660e\u7d30\u60c5\u5831\u306e\u53d6\u5f97")))}getCsv(e,i={}){const a={params:i,responseType:"text",headers:new C.WM({"X-Download":e})};return this.http.get(this.endpoint,a).pipe((0,h.K)(this.setErrorMessage("\u4e00\u62ec\u767b\u9332\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u53d6\u5f97")))}add(e){const i=this.generateFormData(e);return this.http.post(this.endpoint,i).pipe((0,h.K)(this.setErrorMessage("\u5165\u91d1\u660e\u7d30\u60c5\u5831\u306e\u767b\u9332")))}update(e,i){const a=this.generateFormData(i);return this.http.patch(`${this.endpoint}/${e}`,a).pipe((0,h.K)(this.setErrorMessage("\u5165\u91d1\u660e\u7d30\u60c5\u5831\u306e\u66f4\u65b0")))}remove(e){return this.http.delete(`${this.endpoint}/${e}`).pipe((0,h.K)(this.setErrorMessage("\u5165\u91d1\u660e\u7d30\u60c5\u5831\u306e\u524a\u9664")))}}return n.\u0275fac=function(){let o;return function(i){return(o||(o=t.n5z(n)))(i||n)}}(),n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Gt=(()=>{class n{modifiedTableBody(e,i="",a=""){return s=>{if(""===e[s.name])return e[s.name];if(""!==a&&s.name===a)return{href:`${i}/${e[s.name]}`,text:e[s.name]+""};if("deposit_date"===s.name){let c;return c=""===e.deposit_date||"NaT"===e.deposit_date?"":new Date(e.deposit_date).toLocaleDateString(),c}if("deposit_amount"===s.name){let c=0;return e.deposit_amount&&(c=e.deposit_amount),{unit:!1,align:"right",text:Number(c)}}return"deposit_detail_division_code"===s.name?[{value:D._.STATUS_CODE.CASH,text:D._.STATUS.CASH},{value:D._.STATUS_CODE.DISCOUNT,text:D._.STATUS.DISCOUNT},{value:D._.STATUS_CODE.TRANSFER,text:D._.STATUS.TRANSFER}].find(u=>u.value===e.deposit_detail_division_code)?.text:"employee_created_last_name"===s.name?e.employee_created_last_name+""+e.employee_created_first_name:e[s.name]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var ct=l(2640),Ui=l(843),Zt=l(9586),Ht=l(956),tt=l(7499),ut=l(4416);function Bi(n,o){1&n&&t.GkF(0,15)}function Ni(n,o){1&n&&t.GkF(0,15)}function Ri(n,o){if(1&n&&(t.TgZ(0,"p",18),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MIN_LIMIT," ")}}function Mi(n,o){if(1&n&&(t.TgZ(0,"p",18),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function Li(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Ri,2,1,"p",17),t.YNc(2,Mi,2,1,"p",17),t.BQk()),2&n){const e=t.oxw().ctrl,i=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.minlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===i.regExConst.NUMERIC_REG_EX+"")}}function qi(n,o){if(1&n&&t.YNc(0,Li,3,2,"ng-container",16),2&n){const e=o.ctrl,i=t.oxw();t.Q6J("ngIf",i.invalid(e))}}function Yi(n,o){if(1&n&&(t.TgZ(0,"p",19),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}let Ji=(()=>{class n{constructor(e,i,a,s,r,c,u){this.fb=e,this.common=i,this.deposit=a,this.modalService=s,this.employeeService=r,this.errorService=c,this.flashMessageService=u,this.event=new t.vpe,this.isOpen=!1,this.rotateAnimation="",this.subscription=new A.w0,this.errorConst=T.c,this.regExConst=G.m,this.searchForm=this.fb.group({sale_date:this.fb.group({from:"",to:""},{validators:[F.d.beforeFromDate()]}),business_date:this.fb.group({from:"",to:""},{validators:[F.d.beforeFromDate()]})})}get ctrls(){return this.searchForm.controls}get fc(){return this.searchForm.controls}ngOnInit(){this.searchForm=this.setSearchClear()}ngOnDestroy(){this.subscription.unsubscribe()}searchButtonOnClick(){this.isOpen=!this.isOpen,this.rotateAnimation=this.isOpen?"rotate-animation-180":"rotate-animation-0"}onClickReset(){this.searchForm=this.setSearchClear()}onClickSubmit(){const e=(0,E.vP)(this.removeNullsAndBlanks(this.searchForm.value));this.event.emit(e)}invalid(e){return(e.touched||e.dirty)&&e.invalid}removeNullsAndBlanks(e){const i={};for(const[a,s]of Object.entries(e))null!=s&&""!==s&&(i[a]=s);return i}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getFormControlTypeValue(e,i){return e.get(i)}setSearchClear(){return this.fb.group({sale_date:this.fb.group({from:"",to:""},{validators:[F.d.beforeFromDate()]}),business_date:this.fb.group({from:"",to:""},{validators:[F.d.beforeFromDate()]})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.qu),t.Y36(S.v),t.Y36(tt.s),t.Y36(y.Z),t.Y36(ut.G),t.Y36(w.T),t.Y36(P.P))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-sliplist-search"]],outputs:{event:"event"},decls:27,vars:15,consts:[[1,"mt-8","mb-4"],[3,"click"],["icon","filter-2-line",1,"w-6"],[1,"inline-block","ml-1","mr-2"],["icon","arrow-down-s-fill",1,"w-6"],[1,"search","width-limit-break","bg-white",3,"ngClass"],[1,"w-[1280px]","mx-auto","px-4"],[1,"flex","gap-6","mt-6"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],[1,"flex","gap-8","mt-10"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[1,"mt-2","text-sm","text-red"],["errors",""],["beforeFromDate",""],["message",""],[4,"ngIf"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return i.searchButtonOnClick()}),t._UZ(2,"app-icon",2),t.TgZ(3,"span",3),t._uU(4),t.qZA(),t._UZ(5,"app-icon",4),t.qZA()(),t.TgZ(6,"div",5)(7,"form",6)(8,"div",7)(9,"app-date-term-clear-container",8),t._uU(10," \u58f2\u4e0a\u65e5 "),t.YNc(11,Bi,1,0,"ng-container",9),t.qZA()(),t.TgZ(12,"div",7)(13,"app-date-term-clear-container",8),t._uU(14," \u55b6\u696d\u65e5 "),t.YNc(15,Ni,1,0,"ng-container",9),t.qZA()(),t.TgZ(16,"div",10)(17,"app-button",1),t.NdJ("click",function(){return i.onClickReset()}),t._uU(18,"\u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2"),t.qZA(),t.TgZ(19,"app-button",11),t.NdJ("click",function(){return i.onClickSubmit()}),t._uU(20," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA()(),t.TgZ(21,"p",12),t._uU(22," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()(),t.YNc(23,qi,1,1,"ng-template",null,13,t.W1O),t.YNc(25,Yi,2,1,"ng-template",null,14,t.W1O)),2&e){const a=t.MAs(26);t.xp6(4),t.hij(" ",i.isOpen?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(i.rotateAnimation),t.xp6(1),t.Q6J("ngClass",i.isOpen?"is-open shadow":""),t.xp6(3),t.Q6J("dateFromFormCtrl",i.ctrls.sale_date.controls.from)("dateToFormCtrl",i.ctrls.sale_date.controls.to)("invalid",!!i.ctrls.sale_date.errors),t.xp6(2),t.Q6J("ngIf",null==i.ctrls.sale_date.errors?null:i.ctrls.sale_date.errors.beforeFromDate)("ngIfThen",a),t.xp6(2),t.Q6J("dateFromFormCtrl",i.ctrls.business_date.controls.from)("dateToFormCtrl",i.ctrls.business_date.controls.to)("invalid",!!i.ctrls.business_date.errors),t.xp6(2),t.Q6J("ngIf",null==i.ctrls.business_date.errors?null:i.ctrls.business_date.errors.beforeFromDate)("ngIfThen",a),t.xp6(4),t.Q6J("buttonDisabled",i.searchForm.invalid)}},dependencies:[g.mk,g.O5,d._Y,d.JL,j.w,k.r,U.o],styles:[".search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease;overflow:hidden}.search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0}"]}),n})();function Qi(n,o){1&n&&t.GkF(0,16)}function Vi(n,o){if(1&n&&(t.TgZ(0,"p",19),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MIN_LIMIT," ")}}function ji(n,o){if(1&n&&(t.TgZ(0,"p",19),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function Ki(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Vi,2,1,"p",18),t.YNc(2,ji,2,1,"p",18),t.BQk()),2&n){const e=t.oxw().ctrl,i=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.minlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===i.regExConst.NUMERIC_REG_EX+"")}}function $i(n,o){if(1&n&&t.YNc(0,Ki,3,2,"ng-container",17),2&n){const e=o.ctrl,i=t.oxw();t.Q6J("ngIf",i.invalid(e))}}function Gi(n,o){if(1&n&&(t.TgZ(0,"p",20),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}function Hi(n,o){if(1&n&&(t.TgZ(0,"div",21)(1,"span"),t._uU(2),t.qZA()()),2&n){const e=o.label;t.xp6(2),t.Oqu(e)}}let Wi=(()=>{class n{constructor(e){this.fb=e,this.event=new t.vpe,this.isOpen=!1,this.rotateAnimation="",this.subscription=new A.w0,this.errorConst=T.c,this.regExConst=G.m,this.searchForm=this.fb.group({product_name:"",deposit_date:this.fb.group({from:"",to:""},{validators:[F.d.beforeFromDate()]})})}get ctrls(){return this.searchForm.controls}get fc(){return this.searchForm.controls}ngOnInit(){if(console.log("ngOnInit this.depositDetailsOrg:: ",this.depositDetailsOrg),void 0!==this.depositDetailsOrg){const e=this.depositDetailsOrg.forEach(i=>(console.log(i),{value:i[1],text:i[1]}));console.log(e)}}ngOnChanges(e){e.depositDetailsOrg&&e.depositDetailsOrg.currentValue&&this.updateProductSuggests()}updateProductSuggests(){this.productSuggests=this.depositDetailsOrg.map(e=>({value:e[2],text:e[2]})),console.log("Updated productSuggests:: ",this.productSuggests)}ngOnDestroy(){this.subscription.unsubscribe()}searchButtonOnClick(){this.isOpen=!this.isOpen,this.rotateAnimation=this.isOpen?"rotate-animation-180":"rotate-animation-0"}onClickReset(){this.searchForm.reset({deposit_date:{from:"",to:""}})}onClickSubmit(){this.filterDepositDetails()}filterDepositDetails(){const e=(0,E.vP)(this.removeNullsAndBlanks(this.searchForm.value));console.log(e);const i=e.from_deposit_date,a=e.to_deposit_date,s=new Date(i),r=new Date(a),c=e.product_name,u=this.depositDetailsOrg.filter(_=>{const m=_[1].replace(/ \u5e74 /,"/").replace(/ \u6708 /,"/").replace(/ \u65e5/,""),v=new Date(m);return!(""!==i&&v<s||""!==a&&v>r||void 0!==c&&_[2]!==c)});this.event.emit(u)}invalid(e){return(e.touched||e.dirty)&&e.invalid}removeNullsAndBlanks(e){const i={};for(const[a,s]of Object.entries(e))null!=s&&""!==s&&(i[a]=s);return i}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getFormControlTypeValue(e,i){return e.get(i)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-sliplist-deposit-detail-search"]],inputs:{depositDetailsOrg:"depositDetailsOrg"},outputs:{event:"event"},features:[t.TTD],decls:25,vars:10,consts:[[1,"mt-8","mb-4"],[3,"click"],["icon","filter-2-line",1,"w-6"],[1,"inline-block","ml-1","mr-2"],["icon","arrow-down-s-fill",1,"w-6"],[1,"search","width-limit-break","bg-white",3,"ngClass"],[1,"w-[1280px]","mx-auto","px-4"],[1,"flex","gap-6","mt-6"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],[1,"flex","gap-8","mt-10"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[1,"mt-2","text-sm","text-red"],["errors",""],["beforeFromDate",""],["labels",""],["message",""],[4,"ngIf"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"],[1,"mt-1","pl-1","text-sm","text-red"],[1,"flex","items-center","gap-2"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return i.searchButtonOnClick()}),t._UZ(2,"app-icon",2),t.TgZ(3,"span",3),t._uU(4),t.qZA(),t._UZ(5,"app-icon",4),t.qZA()(),t.TgZ(6,"div",5)(7,"form",6)(8,"div",7)(9,"app-date-term-clear-container",8),t._uU(10," \u5165\u91d1\u65e5 "),t.YNc(11,Qi,1,0,"ng-container",9),t.qZA()(),t.TgZ(12,"div",10)(13,"app-button",1),t.NdJ("click",function(){return i.onClickReset()}),t._uU(14,"\u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2"),t.qZA(),t.TgZ(15,"app-button",11),t.NdJ("click",function(){return i.onClickSubmit()}),t._uU(16," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA()(),t.TgZ(17,"p",12),t._uU(18," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()(),t.YNc(19,$i,1,1,"ng-template",null,13,t.W1O),t.YNc(21,Gi,2,1,"ng-template",null,14,t.W1O),t.YNc(23,Hi,3,1,"ng-template",null,15,t.W1O)),2&e){const a=t.MAs(22);t.xp6(4),t.hij(" ",i.isOpen?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(i.rotateAnimation),t.xp6(1),t.Q6J("ngClass",i.isOpen?"is-open shadow":""),t.xp6(3),t.Q6J("dateFromFormCtrl",i.ctrls.deposit_date.controls.from)("dateToFormCtrl",i.ctrls.deposit_date.controls.to)("invalid",!!i.ctrls.deposit_date.errors),t.xp6(2),t.Q6J("ngIf",null==i.ctrls.deposit_date.errors?null:i.ctrls.deposit_date.errors.beforeFromDate)("ngIfThen",a),t.xp6(4),t.Q6J("buttonDisabled",i.searchForm.invalid)}},dependencies:[g.mk,g.O5,d._Y,d.JL,j.w,k.r,U.o],styles:[".search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease;overflow:hidden}.search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0}"]}),n})();function zi(n,o){if(1&n&&(t.TgZ(0,"div",13)(1,"h2",14),t._uU(2,"\u8acb\u6c42\u30d8\u30c3\u30c0\u30fc"),t.qZA(),t._UZ(3,"hr",15),t.TgZ(4,"div",16),t._UZ(5,"div"),t.TgZ(6,"div")(7,"table",17)(8,"tr",18)(9,"td",19),t._uU(10,"8%\u5bfe\u8c61"),t.qZA(),t.TgZ(11,"td",20),t._uU(12),t.qZA(),t.TgZ(13,"td",19),t._uU(14,"10%\u5bfe\u8c61"),t.qZA(),t.TgZ(15,"td",20),t._uU(16),t.qZA()(),t.TgZ(17,"tr",18)(18,"td",19),t._uU(19,"\u6d88\u8cbb\u7a0e8%"),t.qZA(),t.TgZ(20,"td",20),t._uU(21),t.qZA(),t.TgZ(22,"td",19),t._uU(23,"\u6d88\u8cbb\u7a0e10%"),t.qZA(),t.TgZ(24,"td",20),t._uU(25),t.qZA()()()()(),t.TgZ(26,"div",21)(27,"div",22)(28,"table",23)(29,"tr",18)(30,"td",24),t._uU(31,"\u8acb\u6c42ID"),t.qZA(),t.TgZ(32,"td",25),t._uU(33,"\u8acb\u6c42\u5148"),t.qZA(),t.TgZ(34,"td",19),t._uU(35,"\u8acb\u6c42\u65e5"),t.qZA(),t.TgZ(36,"td",26),t._uU(37,"\u8acb\u6c42\u984d"),t.qZA(),t.TgZ(38,"td",19),t._uU(39,"\u5165\u91d1\u4e88\u5b9a\u65e5"),t.qZA(),t.TgZ(40,"td",26),t._uU(41,"\u6b8b\u9ad8"),t.qZA()(),t.TgZ(42,"tr",18)(43,"td",27),t._uU(44),t.qZA(),t.TgZ(45,"td",27),t._uU(46),t.qZA(),t.TgZ(47,"td",27),t._uU(48),t.qZA(),t.TgZ(49,"td",28),t._uU(50),t.qZA(),t.TgZ(51,"td",27),t._uU(52),t.qZA(),t.TgZ(53,"td",27),t._uU(54),t.qZA()()(),t.TgZ(55,"table",23)(56,"tr",18)(57,"td",26),t._uU(58,"\u524d\u56de\u8acb\u6c42\u984d"),t.qZA(),t.TgZ(59,"td",26),t._uU(60,"\u5165\u91d1\u984d"),t.qZA(),t.TgZ(61,"td",26),t._uU(62,"\u7e70\u8d8a\u984d"),t.qZA(),t.TgZ(63,"td",26),t._uU(64,"\u4f1d\u7968\u679a\u6570"),t.qZA(),t.TgZ(65,"td",26),t._uU(66," \u5f53\u6708\u7a0e\u8fbc\u8cb7\u4e0a\u984d "),t.qZA(),t.TgZ(67,"td",26),t._uU(68,"\u5185\u6d88\u8cbb\u7a0e\u984d"),t.qZA()(),t.TgZ(69,"tr",18)(70,"td",28),t._uU(71),t.qZA(),t.TgZ(72,"td",28),t._uU(73),t.qZA(),t.TgZ(74,"td",28),t._uU(75),t.qZA(),t.TgZ(76,"td",28),t._uU(77),t.qZA(),t.TgZ(78,"td",28),t._uU(79),t.qZA(),t.TgZ(80,"td",28),t._uU(81),t.qZA()()()()()()),2&n){const e=t.oxw();t.xp6(12),t.hij(" ",e.accountsReceivableAggregate.reduced_tax_rate_target_amount.toLocaleString()," "),t.xp6(4),t.hij(" ",e.accountsReceivableAggregate.consumption_tax_rate_target_amount.toLocaleString()," "),t.xp6(5),t.hij(" ",e.accountsReceivableAggregate.reduced_tax.toLocaleString()," "),t.xp6(4),t.hij(" ",e.accountsReceivableAggregate.consumption_tax.toLocaleString()," "),t.xp6(19),t.Oqu(e.accountsReceivableAggregate.id),t.xp6(2),t.hij(" ",e.accountsReceivableAggregate.client_name," "),t.xp6(2),t.hij(" ",e.getDateFormat(e.accountsReceivableAggregate.billing_date)," "),t.xp6(2),t.hij(" ",e.accountsReceivableAggregate.billing_amount.toLocaleString()," "),t.xp6(2),t.hij(" ",e.getDateFormat(e.accountsReceivableAggregate.payment_exp_date)," "),t.xp6(2),t.hij(" ",e.accountsReceivableAggregate.balance?e.accountsReceivableAggregate.balance.toLocaleString():""," "),t.xp6(17),t.hij(" ",e.accountsReceivableAggregate.previous_invoice_total.toLocaleString()," "),t.xp6(2),t.hij(" ",e.accountsReceivableAggregate.payment_total.toLocaleString()," "),t.xp6(2),t.hij(" ",e.accountsReceivableAggregate.carried_over_amount.toLocaleString()," "),t.xp6(2),t.hij(" ",e.accountsReceivableAggregate.slip_quantity.toLocaleString()," "),t.xp6(2),t.hij(" ",e.accountsReceivableAggregate.purchase_total_including_tax.toLocaleString()," "),t.xp6(2),t.hij(" ",e.accountsReceivableAggregate.tax_total.toLocaleString()," ")}}const Xi=function(n){return{path:n,text:"\u8a2d\u5b9a\u4e00\u89a7"}},tn=function(n){return{path:n,text:"\u8acb\u6c42\u4e00\u89a7"}},en=function(){return{text:"\u8acb\u6c42\u4f1d\u7968\u4e00\u89a7"}},nn=function(n,o,e){return[n,o,e]};let an=(()=>{class n{constructor(e,i,a,s,r,c,u,_,m,v){this.route=e,this.router=i,this.modalService=a,this.billService=s,this.depositDetailService=r,this.depositDetailDomain=c,this.accountsReceivableAggregateService=u,this.errorService=_,this.flashMessageService=m,this.common=v,this.subscription=new A.w0,this.topPagePath="/setting",this.listPagePath="../../../bill",this.errorModalTitle="\u8acb\u6c42\u4f1d\u7968\u4e00\u89a7\uff1a"+p.yR.TITLE.HAS_ERROR,this._filter={},this._depositDetailFilter={},this._pages={page:1,itemsPerPage:10,sort:{}},this.defaultDepositDetailSort={column:"\u5165\u91d1ID",order:"desc"},this._depositDetailPages={page:1,itemsPerPage:10,sort:this.defaultDepositDetailSort},this.tableParams=new B.x,this.tableNameMapping=[{name:"sales_slip_cd",name_jp:"\u4f1d\u7968\u756a\u53f7"},{name:"sale_date",name_jp:"\u58f2\u4e0a\u65e5"},{name:"client_name_1",name_jp:"\u5f97\u610f\u5148\u540d"},{name:"business_date",name_jp:"\u55b6\u696d\u65e5"},{name:"total_quantity",name_jp:"\u5408\u8a08\u6570\u91cf"},{name:"slip_amount",name_jp:"\u4f1d\u7968\u91d1\u984d"},{name:"slip_amount_tax_excluded",name_jp:"\u4f1d\u7968\u91d1\u984d(\u5916\u7a0e)"},{name:"sales_slip_tax_rate_8_tax_excluded_target_amount",name_jp:"8%\u5c0f\u8a08"},{name:"sales_slip_tax_rate_8_tax_excluded_target_tax",name_jp:"8%\u6d88\u8cbb\u7a0e"},{name:"sales_slip_tax_rate_10_tax_excluded_target_amount",name_jp:"10%\u5c0f\u8a08"},{name:"sales_slip_tax_rate_10_tax_excluded_target_tax",name_jp:"10%\u6d88\u8cbb\u7a0e"}],this.depositDetailTableNameMapping=[{name:"deposit_id",name_jp:"\u5165\u91d1ID"},{name:"deposit_date",name_jp:"\u5165\u91d1\u65e5"},{name:"deposit_detail_division_code",name_jp:"\u5165\u91d1\u533a\u5206"},{name:"deposit_amount",name_jp:"\u5165\u91d1\u91d1\u984d"},{name:"employee_created_last_name",name_jp:"\u767b\u9332\u8005"}],this.depositDetailsTotalItems=0}set filter(e){this._filter=e,this._pages.page=1,this.callApi(!1)}set depositDetailFilter(e){console.log(e),this.depositDetails=e,this.depositDetailsTotalItems=e.length}set pages(e){this._pages=e,this.callApi(!1)}set depositDetailPages(e){this._depositDetailPages=e}ngOnInit(){this.subscription.add(this.modalService.closeEventObservable$.pipe((0,O.h)(e=>this.modalService.getModalProperties().title===this.errorModalTitle)).subscribe(e=>{e===p.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.listPagePath)})),this.callApi(!0),this.getDepositDetail()}callApi(e){console.log("bill component.ts callApi() called");const i=this.route.snapshot.params.id;(0,E.oG)(i)?this.handleError(400,"\u30d1\u30e9\u30e1\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u4e00\u89a7\u753b\u9762\u3078\u623b\u308a\u307e\u3059\u3002",this.listPagePath):(this.selectedId=Number(i),e&&this.getAccountsReceivableAggregate(this.selectedId),this.getBill())}getAccountsReceivableAggregate(e){this.common.loading=!0,this.subscription.add(this.accountsReceivableAggregateService.find(e).pipe((0,h.K)(i=>(0,b.of)(i)),(0,f.x)(()=>this.common.loading=!1)).subscribe(i=>{i instanceof C.UA?this.handleError(i.status,i.error.message):(0,E.bz)(i)?this.handleError(400,T.c.COULD_NOT_GET_DATA):(this.accountsReceivableAggregate=i.data[0],console.log(i))}))}getBill(){this.common.loading=!0,this.billService.getAll(this.createApiParams()).pipe((0,h.K)(this.billService.handleErrorModal()),(0,f.x)(()=>this.common.loading=!1)).subscribe(e=>{const i=this.createTableParams(e,this.tableNameMapping,this.modifiedTableBody);this.tableParams.next(i),console.log(e)})}getDepositDetail(){this.common.loading=!0,console.log("getDepositDetail this._depositDetailFilter:: ",this._depositDetailFilter),this.subscription.add(this.depositDetailService.getAll({...this._depositDetailFilter,accounts_receivable_aggregate_id:this.selectedId,sort:"id:desc"}).pipe((0,h.K)(e=>(0,b.of)(e)),(0,f.x)(()=>this.common.loading=!1)).subscribe(e=>{if(console.log(e),e instanceof C.UA)return void this.handleError(e.status,e.error?e.error.title:"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002",this.listPagePath);const i=this.createTableParams(e,this.depositDetailTableNameMapping,a=>this.depositDetailDomain.modifiedTableBody(a));this.depositDetailsOrg=i.body,this.depositDetails=this.depositDetailsOrg,this.depositDetailsHeaders=i.header,this.depositDetailsTotalItems=i.total}))}createApiParams(){console.log("bill/slip-list component.ts createApiParams() called");const e=this.tableNameMapping.find(a=>a.name_jp===this._pages.sort.column)?.name;let i;return i="client_name_1"===e?"client_name_kana":e,{...this._filter,accounts_receivable_aggregate_id:this.selectedId,limit:this._pages.itemsPerPage,offset:(this._pages.page-1)*this._pages.itemsPerPage,sort:i?`${i}:${this._pages.sort.order}`:""}}createTableParams(e,i,a){const s=i.map(c=>c.name_jp),r=e.data.map(c=>i.map(a?a(c):u=>c[u.name]));return{total:e.totalItems,header:s,body:r}}modifiedTableBody(e){return i=>{let a="";if(1===e.sales_slip_division_cd&&(a="-"),""===e[i.name])return e[i.name];if("sales_slip_cd"===i.name)return{href:`../../slip-detail/${e.accounts_receivable_aggregate_id}/${e.id}/${e.sales_slip_cd}`,text:e[i.name]+""};if("slip_amount"===i.name)return{unit:!1,align:"right",text:Number(e.slip_amount?a+e.slip_amount:"0")};if("slip_amount_tax_excluded"===i.name)return{unit:!1,align:"right",text:Number(e.slip_amount_tax_excluded?a+e.slip_amount_tax_excluded:"0")};if("sales_slip_tax_rate_8_tax_excluded_target_amount"===i.name){const s=e.sales_slip_tax_rate_8_tax_excluded_target_amount-e.sales_slip_tax_rate_8_tax_excluded_target_tax;return{unit:!1,align:"right",text:Number(s?a+s:"0")}}if("sales_slip_tax_rate_8_tax_excluded_target_tax"===i.name)return{unit:!1,align:"right",text:Number(e.sales_slip_tax_rate_8_tax_excluded_target_tax?a+e.sales_slip_tax_rate_8_tax_excluded_target_tax:"0")};if("sales_slip_tax_rate_10_tax_excluded_target_amount"===i.name){let s=e.sales_slip_tax_rate_10_tax_excluded_target_amount-e.sales_slip_tax_rate_10_tax_excluded_target_tax;return{unit:!1,align:"right",text:Number(s?a+s:"0")}}return"sales_slip_tax_rate_10_tax_excluded_target_tax"===i.name?{unit:!1,align:"right",text:Number(e.sales_slip_tax_rate_10_tax_excluded_target_tax?a+e.sales_slip_tax_rate_10_tax_excluded_target_tax:"0")}:e[i.name]}}handleClickDelete(){const e="\u8acb\u6c42"+p.yR.TITLE.DELETE;this.modalService.setModal(e,p.yR.BODY.DELETE,"danger",p.yR.BUTTON_TITLE.DELETE,p.yR.BUTTON_TITLE.CANCEL),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,O.h)(a=>this.modalService.getModalProperties().title===e)).subscribe(a=>{a===p.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&(this.common.loading=!0,this.accountsReceivableAggregateService.remove(this.selectedId).pipe((0,h.K)(s=>(0,b.of)(s)),(0,f.x)(()=>this.common.loading=!1)).subscribe(s=>{this.common.loading=!1,s instanceof C.UA?this.handleError(s.status,s.error.message):(this.flashMessageService.setFlashMessage(s.message,"success",15e3),this.router.navigateByUrl(this.listPagePath))}))}))}modifiedDepositDetailTableBody(e){return i=>{if(""===e[i.name])return e[i.name];if("deposit_date"===i.name){let s;return s=""===e.deposit_date||"NaT"===e.deposit_date?"":new Date(e.deposit_date).toLocaleDateString(),s}if("deposit_amount"===i.name){let s=0;return e.deposit_amount&&(s=e.deposit_amount),{unit:!1,align:"right",text:Number(s)}}return"deposit_detail_division_code"===i.name?[{value:D._.STATUS_CODE.CASH,text:D._.STATUS.CASH},{value:D._.STATUS_CODE.DISCOUNT,text:D._.STATUS.DISCOUNT},{value:D._.STATUS_CODE.TRANSFER,text:D._.STATUS.TRANSFER}].find(r=>r.value===e.deposit_detail_division_code)?.text:e[i.name]}}handleError(e,i,a){this.errorService.setError({status:e,title:"\u8acb\u6c42\u4f1d\u7968\u4e00\u89a7\uff1a"+p.yR.TITLE.HAS_ERROR,message:i,redirectPath:a})}ngOnDestroy(){this.subscription.unsubscribe()}getDateFormat(e){let i;return i=""===e||"NaT"===e?"":new Date(e).toLocaleDateString(),i}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.gz),t.Y36(x.F0),t.Y36(y.Z),t.Y36(Dt),t.Y36(X),t.Y36(Gt),t.Y36(Y),t.Y36(w.T),t.Y36(P.P),t.Y36(S.v))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-slip-list"]],decls:20,vars:17,consts:[[3,"breadcrumbList"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"flex","flex-row","items-center","gap-6"],[3,"path"],[1,"cursor-pointer",3,"click"],[1,"width-limit-break","border-t","border-gray-400"],["class","mt-8 py-8 px-6 bg-white shadow border border-gray-300",4,"ngIf"],[3,"event"],[1,"flex","justify-end","gap-8","mt-4"],[1,"block","mt-2",3,"params","pageChange"],[3,"depositDetailsOrg","event"],[1,"block","mt-2",3,"tableHeader","tableData","totalItems","sender"],[1,"mt-8","py-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"flex","justify-end","mt-6"],[1,"w-1/3"],[1,"border","border-slate-200"],[1,"border","bg-slate-100","p-4","min-w-[120px]"],[1,"border","text-right","p-4"],[1,"mt-6","flex","flex-row","gap-10"],[1,"grow"],[1,"w-full"],[1,"border","bg-slate-100","p-4","min-w-[100px]"],[1,"border","bg-slate-100","p-4","min-w-[410px]"],[1,"border","bg-slate-100","p-4","min-w-[150px]"],[1,"border","p-4"],[1,"border","p-4","text-right"]],template:function(e,i){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main")(2,"h1",1),t._uU(3,"\u8acb\u6c42\u4f1d\u7968\u4e00\u89a7"),t.qZA(),t.TgZ(4,"div",2)(5,"div",3)(6,"app-back-to-link-org",4),t._uU(7,"\u4e00\u89a7\u3078\u623b\u308b"),t.qZA(),t.TgZ(8,"div",5),t.NdJ("click",function(){return i.handleClickDelete()}),t._UZ(9,"app-delete-link-org"),t.qZA()()(),t._UZ(10,"hr",6),t.YNc(11,zi,82,16,"div",7),t.TgZ(12,"app-sliplist-search",8),t.NdJ("event",function(s){return i.filter=s}),t.qZA(),t.TgZ(13,"div",9),t._UZ(14,"div"),t.qZA(),t.TgZ(15,"app-table-with-pagination",10),t.NdJ("pageChange",function(s){return i.pages=s}),t._uU(16," \u8acb\u6c42\u4f1d\u7968\u4e00\u89a7 "),t.qZA(),t.TgZ(17,"app-sliplist-deposit-detail-search",11),t.NdJ("event",function(s){return i.depositDetailFilter=s}),t.qZA(),t.TgZ(18,"app-table-container",12),t.NdJ("sender",function(s){return i.depositDetailPages=s}),t._uU(19," \u5165\u91d1\u4e00\u89a7 "),t.qZA()()),2&e&&(t.Q6J("breadcrumbList",t.kEZ(13,nn,t.VKq(8,Xi,i.topPagePath),t.VKq(10,tn,i.listPagePath),t.DdM(12,en))),t.xp6(6),t.s9C("path",i.listPagePath),t.xp6(5),t.Q6J("ngIf",i.accountsReceivableAggregate),t.xp6(4),t.Q6J("params",i.tableParams),t.xp6(2),t.Q6J("depositDetailsOrg",i.depositDetailsOrg),t.xp6(1),t.Q6J("tableHeader",i.depositDetailsHeaders)("tableData",i.depositDetails)("totalItems",i.depositDetailsTotalItems))},dependencies:[g.O5,ct.i,Ui.t,Zt.i,R.Z,Ht.$,Ji,Wi]}),n})(),on=(()=>{class n extends Q.O{constructor(){super(...arguments),this.endpoint=V.pU.billDetailApi.endpoint}getAll(e={}){return this.httpOptions.params=e,this.http.get(this.endpoint,this.httpOptions).pipe((0,h.K)(this.setErrorMessage("\u8acb\u6c42\u660e\u7d30\u4e00\u89a7\u306e\u53d6\u5f97")))}find(e){return this.http.get(`${this.endpoint}/${e}`)}}return n.\u0275fac=function(){let o;return function(i){return(o||(o=t.n5z(n)))(i||n)}}(),n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var sn=l(6082),rn=l(9612);function ln(n,o){1&n&&t.GkF(0)}function cn(n,o){1&n&&(t.TgZ(0,"app-button",19),t._uU(1," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA())}function un(n,o){1&n&&(t.TgZ(0,"span",22),t._uU(1,"\u5fc5\u9808"),t.qZA())}function pn(n,o){if(1&n&&(t.TgZ(0,"div",20)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,un,2,0,"span",21),t.qZA()),2&n){const e=o.label,i=o.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",i)}}const dn=function(){return{label:"\u5546\u54c1",required:!1}};let _n=(()=>{class n{constructor(e,i){this.fb=e,this.productService=i,this.subscription=new A.w0,this.event=new t.vpe,this.errorEvent=new t.vpe,this.errorConst=T.c,this.hasSearchPanelOpened=!1,this.rotateAnimation="",this.searchForm=this.fb.group({product_cd:"",product_name:""})}get ctrls(){return this.searchForm.controls}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getProductSuggests(){return{observable:this.productService.getAll({name:this.ctrls.product_name.value}),idField:"id",nameField:"name"}}handleClickSearchPaneToggleButton(){this.hasSearchPanelOpened?(this.hasSearchPanelOpened=!1,this.rotateAnimation="rotate-animation-0",this.searchForm.reset({product_cd:""})):(this.hasSearchPanelOpened=!0,this.rotateAnimation="rotate-animation-180")}onClickReset(){this.searchForm.reset(),this.searchForm=this.setSearchClear()}onClickSubmit(){const e=(0,E.vP)((0,E.g3)(this.searchForm.value));this.event.emit(e)}ngOnDestroy(){this.subscription.unsubscribe()}setSearchClear(){return this.fb.group({product_cd:"",product_name:""})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.qu),t.Y36(sn.M))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-slipdetail-search"]],outputs:{event:"event",errorEvent:"errorEvent"},decls:26,vars:15,consts:[[1,"mt-8"],["btnType","button",3,"click"],[1,"w-6"],["icon","filter-2-line"],[1,"inline-block","ml-1","mr-2"],[1,"inline-block","w-6"],["icon","arrow-down-s-fill"],[1,"mt-6"],[1,"inventory-search","width-limit-break","bg-white"],[1,"w-[1280px]","mx-auto","px-4"],[1,"flex","gap-4"],[1,"w-1/3"],["nameAttrValue","product_name","idAttrValue","product-name",3,"idCtrl","nameCtrl","apiInput","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"flex","gap-8","mt-10"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[1,"mt-2","text-sm","text-red"],["disable",""],["labels",""],["btnFillColor","text-white bg-slate-300 hover:bg-slate-300"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return i.handleClickSearchPaneToggleButton()}),t.TgZ(2,"span",2),t._UZ(3,"app-icon",3),t.qZA(),t.TgZ(4,"span",4),t._uU(5),t.qZA(),t.TgZ(6,"span",5),t._UZ(7,"app-icon",6),t.qZA()(),t.TgZ(8,"div",7)(9,"div",8)(10,"form",9)(11,"div",10)(12,"div",11)(13,"app-real-time-suggest-container",12),t.YNc(14,ln,1,0,"ng-container",13),t.qZA()()(),t.TgZ(15,"div",14)(16,"app-button",1),t.NdJ("click",function(){return i.onClickReset()}),t._uU(17," \u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2 "),t.qZA(),t.TgZ(18,"app-button",15),t.NdJ("click",function(){return i.onClickSubmit()}),t._uU(19," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA()(),t.TgZ(20,"p",16),t._uU(21," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()()()(),t.YNc(22,cn,2,0,"ng-template",null,17,t.W1O),t.YNc(24,pn,4,2,"ng-template",null,18,t.W1O)),2&e){const a=t.MAs(25);t.xp6(5),t.hij(" ",i.hasSearchPanelOpened?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(i.rotateAnimation),t.xp6(3),t.ekj("is-open",i.hasSearchPanelOpened)("shadow",i.hasSearchPanelOpened),t.xp6(4),t.Q6J("idCtrl",i.ctrls.product_cd)("nameCtrl",i.ctrls.product_name)("apiInput",i.getProductSuggests())("invalid",i.formControlStateManager(i.ctrls.product_cd)),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(14,dn)),t.xp6(4),t.Q6J("buttonDisabled",i.searchForm.invalid)}},dependencies:[g.O5,g.tP,d._Y,d.JL,k.r,U.o,rn.Y],styles:[".inventory-search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease-in;overflow:hidden}.inventory-search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0;overflow:visible}"]}),n})();function mn(n,o){if(1&n&&(t.TgZ(0,"table",17)(1,"tr",18)(2,"td",19),t._uU(3,"\u4f1d\u7968\u756a\u53f7"),t.qZA(),t.TgZ(4,"td",20),t._uU(5,"\u58f2\u4e0a\u65e5"),t.qZA(),t.TgZ(6,"td",21),t._uU(7,"\u5f97\u610f\u5148\u540d"),t.qZA(),t.TgZ(8,"td",20),t._uU(9,"\u55b6\u696d\u65e5"),t.qZA(),t.TgZ(10,"td",19),t._uU(11,"\u5408\u8a08\u6570\u91cf"),t.qZA(),t.TgZ(12,"td",19),t._uU(13,"\u4f1d\u7968\u91d1\u984d"),t.qZA(),t.TgZ(14,"td",19),t._uU(15," \u4f1d\u7968\u91d1\u984d(\u5916\u7a0e) "),t.qZA()(),t.TgZ(16,"tr",18)(17,"td",22),t._uU(18),t.qZA(),t.TgZ(19,"td",22),t._uU(20),t.qZA(),t.TgZ(21,"td",22),t._uU(22),t.qZA(),t.TgZ(23,"td",22),t._uU(24),t.qZA(),t.TgZ(25,"td",22),t._uU(26),t.qZA(),t.TgZ(27,"td",23),t._uU(28),t.qZA(),t.TgZ(29,"td",23),t._uU(30),t.qZA()()()),2&n){const e=t.oxw();t.xp6(18),t.Oqu(e.bill.sales_slip_cd),t.xp6(2),t.Oqu(e.getDateFormat(e.bill.sale_date)),t.xp6(2),t.Oqu(e.bill.client_name_1),t.xp6(2),t.Oqu(e.getDateFormat(e.bill.business_date)),t.xp6(2),t.Oqu(e.bill.total_quantity),t.xp6(2),t.hij(" ",e.total_amount.toLocaleString()," "),t.xp6(2),t.hij(" ",e.subtotal.toLocaleString()," ")}}function hn(n,o){if(1&n&&(t.TgZ(0,"table",24)(1,"tr",25),t._UZ(2,"td",26)(3,"td",26),t.TgZ(4,"td",19),t._uU(5,"8%\u5bfe\u8c61"),t.qZA(),t.TgZ(6,"td",19),t._uU(7,"10%\u5bfe\u8c61"),t.qZA()(),t.TgZ(8,"tr",18)(9,"td",19),t._uU(10,"\u5c0f\u8a08"),t.qZA(),t.TgZ(11,"td",23),t._uU(12),t.qZA(),t.TgZ(13,"td",23),t._uU(14),t.qZA(),t.TgZ(15,"td",23),t._uU(16),t.qZA()(),t.TgZ(17,"tr",18)(18,"td",19),t._uU(19,"\u6d88\u8cbb\u7a0e"),t.qZA(),t.TgZ(20,"td",23),t._uU(21),t.qZA(),t.TgZ(22,"td",23),t._uU(23),t.qZA(),t.TgZ(24,"td",23),t._uU(25),t.qZA()(),t.TgZ(26,"tr",25)(27,"td",19),t._uU(28,"\u5408\u8a08"),t.qZA(),t.TgZ(29,"td",27),t._uU(30),t.qZA(),t._UZ(31,"td",26)(32,"td",26),t.qZA()()),2&n){const e=t.oxw();t.xp6(12),t.hij(" ",e.subtotal.toLocaleString()," "),t.xp6(2),t.hij(" ",e.tax8_without_tax.toLocaleString()," "),t.xp6(2),t.hij(" ",e.tax10_without_tax.toLocaleString()," "),t.xp6(5),t.hij(" ",e.total_amount_tax.toLocaleString()," "),t.xp6(2),t.hij(" ",e.tax_8.toLocaleString()," "),t.xp6(2),t.hij(" ",e.tax_10.toLocaleString()," "),t.xp6(5),t.hij(" ",e.total_amount.toLocaleString()," ")}}const gn=function(n){return{path:n,text:"\u8a2d\u5b9a\u4e00\u89a7"}},fn=function(n){return{path:n,text:"\u8acb\u6c42\u4e00\u89a7"}},bn=function(n){return{path:n,text:"\u8acb\u6c42\u4f1d\u7968\u4e00\u89a7"}},vn=function(){return{text:"\u8acb\u6c42\u4f1d\u7968\u8a73\u7d30"}},Cn=function(n,o,e,i){return[n,o,e,i]};let Tn=(()=>{class n{constructor(e,i,a,s,r,c,u,_){this.route=e,this.router=i,this.modalService=a,this.billService=s,this.billDetailService=r,this.errorService=c,this.flashMessageService=u,this.common=_,this.subscription=new A.w0,this.id=this.route.snapshot.params.id,this.billid=this.route.snapshot.params.bill_id,this.topPagePath="/setting",this.listPagePath="../../../../../bill",this.slipListPagePath=this.listPagePath+"/slip-list/"+this.billid,this.errorModalTitle="\u8acb\u6c42\u4f1d\u7968\u8a73\u7d30\uff1a"+p.yR.TITLE.HAS_ERROR,this._filter={},this._pages={page:1,itemsPerPage:10,sort:{}},this.tableParams=new B.x,this.tableNameMapping=[{name:"gyo_cd",name_jp:"\u884c\u756a\u53f7"},{name:"product_name",name_jp:"\u5546\u54c1\u540d"},{name:"quantity_per_carton",name_jp:"\u6570\u91cf"},{name:"unit_cd",name_jp:"\u5358\u4f4d"},{name:"unit_price",name_jp:"\u5358\u4fa1"},{name:"slip_item_total_sales",name_jp:"\u91d1\u984d"}]}set filter(e){this._filter=e,this._pages.page=1,this.callApi(!1)}set pages(e){this._pages=e,this.callApi(!1)}ngOnInit(){this.subscription.add(this.modalService.closeEventObservable$.pipe((0,O.h)(e=>this.modalService.getModalProperties().title===this.errorModalTitle)).subscribe(e=>{e===p.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.listPagePath)})),this.callApi(!0)}callApi(e){const i=this.route.snapshot.params.id;(0,E.oG)(i)?this.handleError(400,"\u30d1\u30e9\u30e1\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u4e00\u89a7\u753b\u9762\u3078\u623b\u308a\u307e\u3059\u3002",this.listPagePath):(this.selectedId=Number(i),this.salesSlipCd=this.route.snapshot.params.sales_slip_cd,e&&this.getBill(this.selectedId),this.getBillDetail())}getBill(e){this.common.loading=!0,this.subscription.add(this.billService.find(e).pipe((0,h.K)(i=>(0,b.of)(i)),(0,f.x)(()=>this.common.loading=!1)).subscribe(i=>{i instanceof C.UA?this.handleError(i.status,i.error.message):(0,E.bz)(i)?this.handleError(400,T.c.COULD_NOT_GET_DATA):(this.bill=i.data[0],this.subtotal=Number(this.bill.slip_amount_tax_excluded),this.total_amount=Number(this.bill.slip_amount),this.total_amount_tax=Number(this.bill.tax_excluded_target_tax)+Number(this.bill.tax_included_target_tax),this.tax_8=Number(this.bill.sales_slip_tax_rate_8_tax_excluded_target_tax)+Number(this.bill.sales_slip_tax_rate_8_tax_included_target_amount),this.tax_10=Number(this.bill.sales_slip_tax_rate_10_tax_excluded_target_tax)+Number(this.bill.sales_slip_tax_rate_10_tax_included_target_tax),this.tax8_without_tax=Number(this.bill.sales_slip_tax_rate_8_tax_excluded_target_amount)+Number(this.bill.sales_slip_tax_rate_8_tax_included_target_amount)-this.tax_8,this.tax10_without_tax=Number(this.bill.sales_slip_tax_rate_10_tax_excluded_target_amount)+Number(this.bill.sales_slip_tax_rate_10_tax_included_target_amount)-this.tax_10,1===this.bill.sales_slip_division_cd&&(this.subtotal=this.subtotal?-this.subtotal:0,this.total_amount=this.total_amount?-this.total_amount:0,this.total_amount_tax=this.total_amount_tax?-this.total_amount_tax:0,this.tax_8=this.tax_8?-this.tax_8:0,this.tax_10=this.tax_10?-this.tax_10:0,this.tax8_without_tax=this.tax8_without_tax?-this.tax8_without_tax:0,this.tax10_without_tax=this.tax10_without_tax?-this.tax10_without_tax:0))}))}getBillDetail(){this.common.loading=!0,this.billDetailService.getAll(this.createApiParams()).pipe((0,h.K)(this.billDetailService.handleErrorModal()),(0,f.x)(()=>this.common.loading=!1)).subscribe(e=>{const i=this.createTableParams(e,this.tableNameMapping,this.modifiedTableBody);this.tableParams.next(i),console.log(this.tableParams)})}createApiParams(){const e=this.tableNameMapping.find(i=>i.name_jp===this._pages.sort.column)?.name;return{...this._filter,sales_slip_cd:this.salesSlipCd,limit:this._pages.itemsPerPage,offset:(this._pages.page-1)*this._pages.itemsPerPage,sort:e?`${e}:${this._pages.sort.order}`:""}}createTableParams(e,i,a){const s=i.map(c=>c.name_jp),r=e.data.map(c=>i.map(a?a(c):u=>c[u.name]));return{total:e.totalItems,header:s,body:r}}modifiedTableBody(e){return i=>{if(""===e[i.name])return e[i.name];if("product_name"===i.name)return{href:`/master/product/detail/${e.product_cd}`,text:e.product_name};if("slip_item_total_sales"===i.name){let a=Number(e.slip_item_total_sales);return 1===Number(e.sales_slip_division_cd)&&(a=-a),{unit:!1,align:"right",text:Number(a)}}return"unit_price"===i.name?{unit:!1,align:"right",text:Number(e.unit_price)}:e[i.name]}}handleError(e,i,a){this.errorService.setError({status:e,title:"\u8acb\u6c42\u4f1d\u7968\u4e00\u89a7\uff1a"+p.yR.TITLE.HAS_ERROR,message:i,redirectPath:a})}ngOnDestroy(){this.subscription.unsubscribe()}getDateFormat(e){let i;return""===e||"NaT"===e?i="":(e.length>8&&(e=e.substring(0,4)+"-"+e.substring(4,6)+"-"+e.substring(6,8)),i=new Date(e).toLocaleDateString()),i}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.gz),t.Y36(x.F0),t.Y36(y.Z),t.Y36(Dt),t.Y36(on),t.Y36(w.T),t.Y36(P.P),t.Y36(S.v))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-slip-detail"]],decls:25,vars:17,consts:[[3,"breadcrumbList"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"flex","flex-row","items-center","gap-6"],[3,"path"],[1,"width-limit-break","border-t","border-gray-400"],[1,"mt-8","py-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"mt-6","flex","flex-row","gap-10"],[1,"grow"],["class","w-full",4,"ngIf"],[1,"flex","justify-end","mt-6"],["class","w-1/3",4,"ngIf"],[3,"event"],[1,"flex","justify-end","gap-8","mt-4"],[1,"block","mt-2",3,"params","pageChange"],[1,"w-full"],[1,"border","border-slate-200"],[1,"border","bg-slate-100","p-4","min-w-[150px]"],[1,"border","bg-slate-100","p-4","min-w-[120px]"],[1,"border","bg-slate-100","p-4","min-w-[360px]"],[1,"border","p-4"],[1,"border","p-4","text-right"],[1,"w-1/3"],[1,""],[1,"p-4","min-w-[150px]"],[1,"border","p-4","min-w-[150px]","text-right"]],template:function(e,i){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main")(2,"h1",1),t._uU(3,"\u8acb\u6c42\u4f1d\u7968\u8a73\u7d30"),t.qZA(),t.TgZ(4,"div",2)(5,"div",3)(6,"app-back-to-link-org",4),t._uU(7,"\u4e00\u89a7\u3078\u623b\u308b"),t.qZA()()(),t._UZ(8,"hr",5),t.TgZ(9,"div",6)(10,"h2",7),t._uU(11,"\u4f1d\u7968\u30d8\u30c3\u30c0\u30fc"),t.qZA(),t._UZ(12,"hr",8),t.TgZ(13,"div",9)(14,"div",10),t.YNc(15,mn,31,7,"table",11),t.qZA()(),t.TgZ(16,"div",12),t._UZ(17,"div"),t.TgZ(18,"div"),t.YNc(19,hn,33,7,"table",13),t.qZA()()(),t.TgZ(20,"app-slipdetail-search",14),t.NdJ("event",function(s){return i.filter=s}),t.qZA(),t.TgZ(21,"div",15),t._UZ(22,"div"),t.qZA(),t.TgZ(23,"app-table-with-pagination",16),t.NdJ("pageChange",function(s){return i.pages=s}),t._uU(24," \u8acb\u6c42\u4f1d\u7968\u8a73\u7d30\u4e00\u89a7 "),t.qZA()()),2&e&&(t.Q6J("breadcrumbList",t.l5B(12,Cn,t.VKq(5,gn,i.topPagePath),t.VKq(7,fn,i.listPagePath),t.VKq(9,bn,i.slipListPagePath),t.DdM(11,vn))),t.xp6(6),t.s9C("path",i.slipListPagePath),t.xp6(9),t.Q6J("ngIf",i.bill),t.xp6(4),t.Q6J("ngIf",i.bill),t.xp6(4),t.Q6J("params",i.tableParams))},dependencies:[g.O5,ct.i,Zt.i,R.Z,_n]}),n})();var xn=l(3360),An=l(8656);function En(n,o){1&n&&t.GkF(0,23)}function Sn(n,o){1&n&&t.GkF(0)}function Dn(n,o){1&n&&t.GkF(0,23)}function Zn(n,o){1&n&&t.GkF(0)}function On(n,o){1&n&&t.GkF(0,23)}function Fn(n,o){1&n&&t.GkF(0,23)}function yn(n,o){if(1&n&&(t.TgZ(0,"div",24)(1,"span"),t._uU(2),t.qZA()()),2&n){const e=o.label;t.xp6(2),t.Oqu(e)}}function wn(n,o){if(1&n&&(t.TgZ(0,"p",27),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MIN_LIMIT," ")}}function In(n,o){if(1&n&&(t.TgZ(0,"p",27),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function Pn(n,o){if(1&n&&(t.ynx(0),t.YNc(1,wn,2,1,"p",26),t.YNc(2,In,2,1,"p",26),t.BQk()),2&n){const e=t.oxw().ctrl,i=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.minlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===i.regExConst.NUMERIC_REG_EX+"")}}function kn(n,o){if(1&n&&t.YNc(0,Pn,3,2,"ng-container",25),2&n){const e=o.ctrl,i=t.oxw();t.Q6J("ngIf",i.invalid(e))}}function Un(n,o){if(1&n&&(t.TgZ(0,"p",28),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}const Ot=function(n){return{ctrl:n}},Bn=function(){return{label:"\u8acb\u6c42\u5148",required:"false"}},Nn=function(){return{label:"\u767b\u9332\u8005",required:"false"}};let Rn=(()=>{class n{constructor(e,i,a,s,r,c,u,_){this.fb=e,this.common=i,this.deposit=a,this.modalService=s,this.clientService=r,this.employeeService=c,this.errorService=u,this.flashMessageService=_,this.event=new t.vpe,this.isOpen=!1,this.rotateAnimation="",this.subscription=new A.w0,this.errorConst=T.c,this.regExConst=G.m,this.listPagePath="/setting",this.errorModalTitle="\u5165\u91d1\u4e00\u89a7\u53d6\u5f97\u30a8\u30e9\u30fc\uff1a"+p.yR.TITLE.HAS_ERROR,this.localStorageKey="filterParams-deposit",this.searchForm=this.fb.group({deposit_id:"",deposit_client_id:"",cutoff_date_billing:"",created_id:"",deposit_date:this.fb.group({from:"",to:""},{validators:[F.d.beforeFromDate()]})}),this.options={cutoff_date_billing:[]}}get ctrls(){return this.searchForm.controls}get fc(){return this.searchForm.controls}ngOnInit(){this.initOptions()}ngOnDestroy(){this.subscription.unsubscribe()}searchButtonOnClick(){this.isOpen=!this.isOpen,this.rotateAnimation=this.isOpen?"rotate-animation-180":"rotate-animation-0"}onClickReset(){Object.values(this.ctrls).forEach(e=>{e instanceof d.cw?Object.values(e.controls).forEach(i=>{i.patchValue("")}):e.patchValue("")}),this.clearFilterParams()}onClickSubmit(){const e=(0,E.vP)(this.removeNullsAndBlanks(this.searchForm.value));this.event.emit(e)}invalid(e){return(e.touched||e.dirty)&&e.invalid}removeNullsAndBlanks(e){const i={};for(const[a,s]of Object.entries(e))null!=s&&""!==s&&(i[a]=s);return i}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getFormControlTypeValue(e,i){return e.get(i)}initOptions(){this.common.loading=!0;const e=this.loadFilterParams();for(let i=1;i<31;i++)this.options.cutoff_date_billing.push({value:i,text:i+"\u65e5"});if(this.options.cutoff_date_billing.push({value:99,text:"\u672b\u65e5"},{value:98,text:"\u7121\u3057"}),e){if("from_deposit_date"in e){let i=this.convertStringToDate(e.from_deposit_date);isNaN(i.getTime())?this.ctrls.deposit_date.controls.from.setValue(""):this.ctrls.deposit_date.controls.from.setValue(i.toISOString())}if("to_deposit_date"in e){let i=this.convertStringToDate(e.to_deposit_date);isNaN(i.getTime())?this.ctrls.deposit_date.controls.to.setValue(""):this.ctrls.deposit_date.controls.to.setValue(i.toISOString())}this.setSearchArgs(e)}this.subscription.add((0,I.D)([this.clientService.getAsSelectOptions(),this.employeeService.getAsSelectOptions()]).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(i=>(0,b.of)(i))).subscribe(i=>{i instanceof C.UA?this.handleError(i.status,this.errorModalTitle,i.message):null!=i&&2===i.length?(this.clientSuggests=i[0],this.employeeSuggests=i[1],e&&Object.entries(e).forEach(([a,s])=>{if("created_id"===a){const r=this.employeeSuggests.find(c=>Number(c.value)===Number(e.created_id));this.ctrls.created_id.patchValue(String(r?.value))}if("deposit_client_id"===a){const r=this.clientSuggests.find(c=>Number(c.value)===Number(e.deposit_client_id));this.ctrls.deposit_client_id.patchValue(String(r?.value))}})):this.handleError(400,this.errorModalTitle,p.yR.BODY.HAS_ERROR)}))}handleError(e,i,a){this.errorService.setError({status:e,title:i,message:a,redirectPath:this.listPagePath})}saveFilterParams(e){localStorage.setItem(this.localStorageKey,JSON.stringify(e))}loadFilterParams(){const e=localStorage.getItem(this.localStorageKey);return e?JSON.parse(e):null}clearFilterParams(){localStorage.clear()}convertStringToDate(e){return new Date(Date.parse(e))}setSearchArgs(e){Object.entries(e).forEach(([i,a])=>{"from_deposit_date"===i||"to_deposit_date"===i||"created_id"===i||"deposit_client_id"===i||i in this.searchForm.controls&&this.searchForm.controls[i].setValue(a)}),this.searchForm.patchValue(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.qu),t.Y36(S.v),t.Y36(tt.s),t.Y36(y.Z),t.Y36(q.y),t.Y36(ut.G),t.Y36(w.T),t.Y36(P.P))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-search"]],outputs:{event:"event"},decls:40,vars:38,consts:[[1,"mt-8","mb-4"],[3,"click"],["icon","filter-2-line",1,"w-6"],[1,"inline-block","ml-1","mr-2"],["icon","arrow-down-s-fill",1,"w-6"],[1,"search","width-limit-break","bg-white",3,"ngClass"],[1,"w-[1280px]","mx-auto","px-4"],[1,"flex","gap-6","mt-6"],[1,"w-1/6",3,"formCtrl"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-2/5"],["nameAttrValue","deposit_client_id","idAttrValue","deposit-client-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-1/6",3,"formCtrl","options","useClear"],["nameAttrValue","created_id","idAttrValue","created-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],[1,"flex","gap-8","mt-10"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[1,"mt-2","text-sm","text-red"],["labels",""],["errors",""],["beforeFromDate",""],["message",""],[1,"flex","items-center","gap-2"],[4,"ngIf"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return i.searchButtonOnClick()}),t._UZ(2,"app-icon",2),t.TgZ(3,"span",3),t._uU(4),t.qZA(),t._UZ(5,"app-icon",4),t.qZA()(),t.TgZ(6,"div",5)(7,"form",6)(8,"div",7)(9,"app-text-clear-container",8),t._uU(10," \u5165\u91d1ID "),t.YNc(11,En,1,0,"ng-container",9),t.qZA(),t.TgZ(12,"div",10)(13,"app-select-suggest-container",11),t.YNc(14,Sn,1,0,"ng-container",12),t.YNc(15,Dn,1,0,"ng-container",9),t.qZA()()(),t.TgZ(16,"div",7)(17,"app-select",13),t._uU(18," \u7de0\u65e5 "),t.qZA(),t.TgZ(19,"div",10)(20,"app-select-suggest-container",14),t.YNc(21,Zn,1,0,"ng-container",12),t.YNc(22,On,1,0,"ng-container",9),t.qZA()()(),t.TgZ(23,"div",7)(24,"app-date-term-clear-container",15),t._uU(25," \u5165\u91d1\u65e5 "),t.YNc(26,Fn,1,0,"ng-container",16),t.qZA()(),t.TgZ(27,"div",17)(28,"app-button",1),t.NdJ("click",function(){return i.onClickReset()}),t._uU(29,"\u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2"),t.qZA(),t.TgZ(30,"app-button",18),t.NdJ("click",function(){return i.onClickSubmit()}),t._uU(31," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA()(),t.TgZ(32,"p",19),t._uU(33," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()(),t.YNc(34,yn,3,1,"ng-template",null,20,t.W1O),t.YNc(36,kn,1,1,"ng-template",null,21,t.W1O),t.YNc(38,Un,2,1,"ng-template",null,22,t.W1O)),2&e){const a=t.MAs(35),s=t.MAs(37),r=t.MAs(39);t.xp6(4),t.hij(" ",i.isOpen?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(i.rotateAnimation),t.xp6(1),t.Q6J("ngClass",i.isOpen?"is-open shadow":""),t.xp6(3),t.Q6J("formCtrl",i.ctrls.deposit_id),t.xp6(2),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(30,Ot,i.ctrls.deposit_id)),t.xp6(2),t.Q6J("formCtrl",i.ctrls.deposit_client_id)("suggests",i.clientSuggests)("invalid",i.formControlStateManager(i.ctrls.deposit_client_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(32,Bn)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(33,Ot,i.ctrls.deposit_client_id)),t.xp6(2),t.Q6J("formCtrl",i.ctrls.cutoff_date_billing)("options",i.options.cutoff_date_billing)("useClear",!0),t.xp6(3),t.Q6J("formCtrl",i.ctrls.created_id)("suggests",i.employeeSuggests)("invalid",i.formControlStateManager(i.ctrls.created_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(35,Nn)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(36,Ot,i.ctrls.created_id)),t.xp6(2),t.Q6J("dateFromFormCtrl",i.ctrls.deposit_date.controls.from)("dateToFormCtrl",i.ctrls.deposit_date.controls.to)("invalid",!!i.ctrls.deposit_date.errors),t.xp6(2),t.Q6J("ngIf",null==i.ctrls.deposit_date.errors?null:i.ctrls.deposit_date.errors.beforeFromDate)("ngIfThen",r),t.xp6(4),t.Q6J("buttonDisabled",i.searchForm.invalid)}},dependencies:[g.mk,g.O5,g.tP,d._Y,d.JL,An.H,j.w,k.r,U.o,jt.P,K.X],styles:[".search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease;overflow:hidden}.search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0}"]}),n})();const Mn=function(n){return{path:n,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Ln=function(){return{text:"\u5165\u91d1\u4e00\u89a7"}},qn=function(n,o){return[n,o]};let Wt=(()=>{class n{constructor(e,i,a,s){this.fb=e,this.common=i,this.service=a,this.depositDetailDomain=s,this.topPagePath="/setting",this.localStorageKey="filterParams-deposit",this._filter={},this._pages={page:1,itemsPerPage:10,sort:{}},this.tableParams=new B.x,this.tableNameMapping=[{name:"deposit_id",name_jp:"\u5165\u91d1ID"},{name:"deposit_client_name",name_jp:"\u8acb\u6c42\u5148"},{name:"deposit_date",name_jp:"\u5165\u91d1\u65e5"},{name:"deposit_detail_division_code",name_jp:"\u5165\u91d1\u533a\u5206"},{name:"deposit_amount",name_jp:"\u5165\u91d1\u91d1\u984d"},{name:"employee_created_last_name",name_jp:"\u767b\u9332\u8005"}],this.fileNamePrefix="\u5165\u91d1\u4e00\u89a7",this.errorConst=T.c}set filter(e){this.saveFilterParams(e),this._filter=e,this._pages.page=1,this.callApi()}set pages(e){this._pages=e,this.callApi()}get export$(){return this.service.getCsv("csv",{...this._filter}).pipe((0,h.K)(this.service.handleErrorModal("")),(0,f.x)(()=>this.common.loading=!1))}ngOnInit(){const e=this.loadFilterParams();e&&(this._filter=e),this.callApi()}onExportStatusChange(e){e===$.U.START&&(this.common.loading=!0)}callApi(){this.common.loading=!0;let e=this.createApiParams();this.service.getAll(e).pipe((0,h.K)(this.service.handleErrorModal()),(0,f.x)(()=>this.common.loading=!1)).subscribe(i=>{console.log(e),delete e.limit,console.log(e);let a=0;this.service.getAll(e).pipe((0,h.K)(this.service.handleErrorModal()),(0,f.x)(()=>this.common.loading=!1)).subscribe(s=>{console.log(s),a=s.data.map(_=>({deposit_amount:_.deposit_amount,deposit_detail_division_code:_.deposit_detail_division_code})).reduce((_,m)=>m.deposit_detail_division_code===D._.STATUS_CODE.CASH||m.deposit_detail_division_code===D._.STATUS_CODE.TRANSFER?_+m.deposit_amount:m.deposit_detail_division_code===D._.STATUS_CODE.DISCOUNT?_-m.deposit_amount:_,0);const c=["","","","\u5408\u8a08",a.toLocaleString(),""],u=this.createTableParams(i,this.tableNameMapping,_=>this.depositDetailDomain.modifiedTableBody(_,"./detail-view","deposit_id"),c);this.tableParams.next(u)})})}createApiParams(){const e=this.tableNameMapping.find(a=>a.name_jp===this._pages.sort.column)?.name;let i;return i="deposit_client_name"===e?"deposit_client_name_kana":"employee_created_last_name"===e?"employee_created_last_name_kana":e,{...this._filter,limit:this._pages.itemsPerPage,offset:(this._pages.page-1)*this._pages.itemsPerPage,sort:i?`${i}:${this._pages.sort.order}`:""}}createTableParams(e,i,a,s){const r=i.map(u=>u.name_jp),c=e.data.map(u=>i.map(a?a(u):_=>u[_.name]));return{total:e.totalItems,header:r,body:c,footer:s}}saveFilterParams(e){localStorage.setItem(this.localStorageKey,JSON.stringify(e))}loadFilterParams(){const e=localStorage.getItem(this.localStorageKey);return e?JSON.parse(e):null}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.qu),t.Y36(S.v),t.Y36(X),t.Y36(Gt))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-list"]],decls:9,vars:11,consts:[[3,"breadcrumbList"],[3,"event"],[1,"flex","justify-end","gap-8","mt-4"],["path","../deposit/add"],["text","\u5165\u91d1\u4e00\u89a7CSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3000",3,"export$","fileNamePrefix","resBackSu","statusChange"],[1,"block","mt-2",3,"params","pageChange"]],template:function(e,i){1&e&&(t._UZ(0,"app-breadcrumb-org",0)(1,"app-toggle-button"),t.TgZ(2,"app-search",1),t.NdJ("event",function(s){return i.filter=s}),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"div")(5,"app-new-registration-link-org",3),t.TgZ(6,"app-export-link",4),t.NdJ("statusChange",function(s){return i.onExportStatusChange(s)}),t.qZA()(),t.TgZ(7,"app-table-with-pagination",5),t.NdJ("pageChange",function(s){return i.pages=s}),t._uU(8," \u5165\u91d1\u4e00\u89a7\n"),t.qZA()),2&e&&(t.Q6J("breadcrumbList",t.WLB(8,qn,t.VKq(5,Mn,i.topPagePath),t.DdM(7,Ln))),t.xp6(6),t.Q6J("export$",i.export$)("fileNamePrefix",i.fileNamePrefix)("resBackSu",1),t.xp6(1),t.Q6J("params",i.tableParams))},dependencies:[ct.i,st,xn.S,Et,R.Z,Rn]}),n})();function Yn(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-input-pair",5),t.NdJ("add",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.addTagForm())})("remove",function(){const s=t.CHM(e).index,r=t.oxw();return t.KtG(r.removeTagForm(s))}),t.qZA()}if(2&n){const e=o.$implicit,i=o.index,a=t.oxw();t.Q6J("formGroup",e)("depositDetail",a.depositDetail)("index",i)}}let zt=(()=>{class n{constructor(e,i){this.fb=e,this.depositDetailService=i,this.err=new t.vpe,this.depositDetail=[],this.template={id:"",deposit_id:"",deposit_detail_division_code:"",deposit_amount:"",deposit_date:"",remarks_1:""}}ngOnInit(){this.delArray.removeAt(0),this.depositDetailService.getAll({id:this.itemsId}).pipe((0,h.K)(this.handleError())).subscribe(e=>{this.depositDetail=e.data,console.log(this.depositDetail)})}addTagForm(){this.formArray.push(this.fb.group(this.template))}removeTagForm(e){this.delArray.push(this.formArray.at(e)),this.formArray.removeAt(e)}handleError(){return e=>(this.err.emit(e),(0,b.of)({}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.qu),t.Y36(X))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-deposit-detail"]],inputs:{itemsId:"itemsId",formArray:"formArray",delArray:"delArray"},outputs:{err:"err"},decls:11,vars:1,consts:[[1,""],[1,"flex","flex-row","items-center","bg-slate-100"],[1,"py-3","px-3","border-l-gray-200","bg-slate-100","min-w-[220px]","bg-white"],[1,"py-3","px-3","border-l-gray-200","bg-slate-100","min-w-[520px]","bg-white"],[3,"formGroup","depositDetail","index","add","remove",4,"ngFor","ngForOf"],[3,"formGroup","depositDetail","index","add","remove"]],template:function(e,i){1&e&&(t.TgZ(0,"ul",0)(1,"li",1)(2,"div",2),t._uU(3," \u5165\u91d1\u533a\u5206 "),t.qZA(),t.TgZ(4,"div",2),t._uU(5," \u91d1\u984d "),t.qZA(),t.TgZ(6,"div",2),t._uU(7," \u5165\u91d1\u65e5 "),t.qZA(),t.TgZ(8,"div",3),t._uU(9," \u5099\u8003 "),t.qZA()()(),t.YNc(10,Yn,1,3,"app-input-pair",4)),2&e&&(t.xp6(10),t.Q6J("ngForOf",i.formArray.controls))}}),n})();var Xt=l(387),te=l(228);function Jn(n,o){1&n&&t.GkF(0)}function Qn(n,o){1&n&&t.GkF(0,29)}function Vn(n,o){1&n&&t.GkF(0)}function jn(n,o){1&n&&t.GkF(0,29)}function Kn(n,o){1&n&&t.GkF(0)}function $n(n,o){1&n&&t.GkF(0,29)}function Gn(n,o){if(1&n&&(t.TgZ(0,"p",30),t._uU(1),t.qZA()),2&n){const e=o.message;t.xp6(1),t.hij(" ",e," ")}}function Hn(n,o){1&n&&(t.TgZ(0,"span",33),t._uU(1,"\u5fc5\u9808"),t.qZA())}function Wn(n,o){if(1&n&&(t.TgZ(0,"div",31)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,Hn,2,0,"span",32),t.qZA()),2&n){const e=o.label,i=o.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",i)}}function zn(n,o){if(1&n&&(t.TgZ(0,"p",36),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function Xn(n,o){if(1&n&&(t.ynx(0),t.YNc(1,zn,2,1,"p",35),t.BQk()),2&n){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required)}}function ta(n,o){if(1&n&&t.YNc(0,Xn,2,1,"ng-container",34),2&n){const e=o.ctrl,i=t.oxw();t.Q6J("ngIf",i.formControlStateManager(e))}}function ea(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"p",36),t._uU(2),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.errorConst.FORM_ERROR.DATE_SPECIFICATION_VIOLATION," ")}}function ia(n,o){if(1&n&&t.YNc(0,ea,3,1,"ng-container",34),2&n){const e=o.ctrls;t.Q6J("ngIf",null==e.errors?null:e.errors.endingDateIsSmaller)}}const na=function(){return{label:"\u8acb\u6c42\u5148",required:"true"}},Ft=function(n){return{ctrl:n}},aa=function(){return{label:"\u767b\u9332\u8005",required:"true"}},oa=function(){return{label:"\u5099\u8003",required:!1}};let sa=(()=>{class n{constructor(e,i,a,s,r,c,u,_,m,v,Z,at,L){this.route=e,this.router=i,this.modalService=a,this.flashMessageService=s,this.fb=r,this.authorService=c,this.clientService=u,this.employeeService=_,this.errorService=m,this.depositService=v,this.depositDetailService=Z,this.common=at,this.accountsReceivableAggregateService=L,this.subscription=new A.w0,this.breadcrumbList=[],this.id=this.route.snapshot.params.id,this.url=this.router.url,this.detailUrl=this.url.replace("detail-edit","detail-view"),this.listlUrl=this.id?"../../":this.url.replace("/add",""),this.prevUrl=this.id?`${this.detailUrl}`:`${this.listlUrl}`,this.pageTitle=this.id?"\u5165\u91d1\u8a73\u7d30\u7de8\u96c6":"\u5165\u91d1\u65b0\u898f\u767b\u9332",this.detailPagePath=this.prevUrl,this.authorTitle=this.id?"\u66f4\u65b0\u8005":"\u767b\u9332\u8005",this.depositIdValue=this.id?"\u3000\u5165\u91d1ID\uff1a"+this.id:"",this.updater="\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...",this.authorname="\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...",this.topPagePath="/setting",this.listPagePath="/setting/accounts-receivable-aggregate/deposit",this.cancelModalTitle=this.pageTitle+"\u30ad\u30e3\u30f3\u30bb\u30eb\uff1a"+p.yR.TITLE.CANCEL,this.errorModalTitle=this.pageTitle+"\u30a8\u30e9\u30fc\uff1a"+p.yR.TITLE.HAS_ERROR,this.redirectPath=this.prevUrl,this.errorConst=T.c,this.payment_term={},this.payment_term_prices=[],this.form=this.fb.group({client_id:["",[d.kI.required]],created_id:["",[d.kI.required]],remarks_1:[""],deposit_detail:this.fb.array([this.fb.group({id:[""],deposit_id:[""],deposit_detail_division_code:[""],deposit_amount:[""],deposit_date:[""],remarks_1:[""]})]),deposit_detail_del:this.fb.array([this.fb.group({id:[""],deposit_id:[""],deposit_detail_division_code:[""],deposit_amount:[""],deposit_date:[""],remarks_1:[""]})])}),this.depositDetailAny=[],this.depositAddForms=this.fb.group({forms:this.fb.array([])})}get ctrls(){return this.form.controls}get depositAddFormsArray(){return this.depositAddForms.get("forms")}get depositAddFormsArrayControls(){return this.depositAddFormsArray.controls}ngOnInit(){if(this.breadcrumbList=this.createBreadcrumbList(this.router.url),this.authorService.author?(this.author=this.authorService.author,this.ctrls.created_id.patchValue(String(this.author.id)),this.initOptions()):this.subscription.add(this.authorService.author$.subscribe(i=>{this.author=i,this.ctrls.created_id.patchValue(String(this.author.id)),this.initOptions()})),this.id||(this.detailPagePath=this.listPagePath),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,O.h)(i=>this.modalService.getModalProperties().title===this.cancelModalTitle)).subscribe(i=>{i===p.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.detailPagePath)})),!this.id)return;const e=this.id?"\u5165\u91d1\u8a73\u7d30\u95b2\u89a7":"\u5165\u91d1\u65b0\u898f\u767b\u9332";this.subscription.add(this.depositService.find(this.id).pipe((0,h.K)(i=>(0,b.of)(i)),(0,f.x)(()=>this.common.loading=!1)).subscribe(i=>{if(i instanceof C.UA)return void this.handleError(i.status,e+p.yR.TITLE.HAS_ERROR,i.error.message);if((0,E.bz)(i))return void this.handleError(400,e+p.yR.TITLE.HAS_ERROR,T.c.COULD_NOT_GET_DATA);const s=i.data[0];this.form.controls.client_id.patchValue(String(s.client_id)),this.form.controls.created_id.patchValue(String(s.created_id)),this.form.controls.remarks_1.patchValue(String(s.remarks_1)),this.payment_term={client_id:s.client_id,payment_term:s.client_payment_term}})),this.subscription.add(this.depositDetailService.getAll({deposit_id:this.id}).pipe((0,h.K)(this.depositDetailService.handleErrorModal()),(0,f.x)(()=>this.common.loading=!1)).subscribe(i=>{if(console.log(i),i instanceof C.UA)return void this.handleError(i.status,e+p.yR.TITLE.HAS_ERROR,i.error.message);if((0,E.bz)(i))return void this.handleError(400,e+p.yR.TITLE.HAS_ERROR,T.c.COULD_NOT_GET_DATA);const s=i.data;s.length&&this.form.controls.deposit_detail.clear(),s.map(r=>{let c=this.getDates(r.deposit_date,Number(this.payment_term.payment_term));this.subscription.add(this.accountsReceivableAggregateService.getAll({client_id:r.id,from_payment_due_date:c.from_payment_due_date,to_payment_due_date:c.to_payment_due_date}).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(u=>(0,b.of)(u))).subscribe(u=>{u.data[0]&&this.payment_term_prices.push({id:r.id,billing_amount:u.data[0].billing_amount.toLocaleString(),barance:u.data[0].balance.toLocaleString()})})),this.form.controls.deposit_detail.push(this.fb.group({id:r.id+"",deposit_id:r.deposit_id+"",deposit_detail_division_code:r.deposit_detail_division_code+"",deposit_amount:r.deposit_amount+"",deposit_date:r.deposit_date+"",remarks_1:r.remarks_1}))}),console.log(this.payment_term_prices)}))}getbilling_amount(e,i,a,s){this.subscription.add(this.accountsReceivableAggregateService.getAll({client_id:i,from_payment_due_date:a,to_payment_due_date:s}).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(r=>(0,b.of)(r))).subscribe(r=>{r.data[0]&&this.payment_term_prices.push({id:e,billing_amount:r.data[0].billing_amount.toLocaleString(),barance:r.data[0].balance.toLocaleString()})}))}getDates(e,i){let a=new Date(e);return a.setMonth(a.getMonth()-this.getPaymentDate(i)),a.setDate(1),{from_payment_due_date:a.toLocaleDateString(),to_payment_due_date:new Date(a.getFullYear(),a.getMonth()+1,0).toLocaleDateString()}}getPaymentDate(e){switch(e){case 60:return 1;case 61:return 2;case 124:return 3;default:return 0}}ngOnDestroy(){this.subscription.unsubscribe()}initOptions(){this.common.loading=!0,this.subscription.add((0,I.D)([this.clientService.getAsSelectOptions(),this.employeeService.getAsSelectOptions()]).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(e=>(0,b.of)(e))).subscribe(e=>{e instanceof C.UA?this.handleError(e.status,this.errorModalTitle,e.message):null!=e&&2===e.length?(this.clientSuggests=e[0],this.employeeSuggests=e[1]):this.handleError(400,this.errorModalTitle,p.yR.BODY.HAS_ERROR)}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleClickCancel(){this.form.pristine?this.router.navigateByUrl(this.detailPagePath):this.modalService.setModal(this.cancelModalTitle,p.yR.BODY.CANCEL,"warning",p.yR.BUTTON_TITLE.EXECUTION,p.yR.BUTTON_TITLE.CANCEL)}handleClickSaveButton(){this.form.markAsPristine(),this.common.loading=!0;const e=this.form.value;if(!this.employeeSuggests.some(m=>Number(m.value)===Number(e.created_id)))return this.ctrls.created_id.setValue(""),void(this.common.loading=!1);if(!this.clientSuggests.some(m=>Number(m.value)===Number(e.client_id)))return this.ctrls.client_id.setValue(""),void(this.common.loading=!1);this.id&&this.ctrls.deposit_detail_del.getRawValue().forEach(v=>{v.id&&this.depositDetailService.remove(v.id).pipe((0,h.K)(Z=>(0,b.of)(Z)),(0,f.x)(()=>this.common.loading=!1)).subscribe(Z=>{Z instanceof C.UA&&this.handleError(Z.status,this.errorModalTitle,Z.error.message)})}),this.ctrls.deposit_detail.getRawValue().forEach(m=>{const v={id:"",deposit_id:this.id,deposit_detail_division_code:m.deposit_detail_division_code,deposit_amount:m.deposit_amount,deposit_date:new Date(String(m.deposit_date)).toLocaleString(),remarks_1:m.remarks_1};m.id&&(v.id=m.id),this.depositDetailAny.push(v)});const r={client_id:Number(e.client_id),created_id:Number(e.created_id),remarks_1:String(e.remarks_1),deposit_detail:[...this.depositDetailAny]};let c=this.depositService.add(r);this.id&&(c=this.depositService.update(this.id,r)),c.pipe((0,h.K)(m=>(0,b.of)(m)),(0,f.x)(()=>this.common.loading=!1)).subscribe(m=>{m instanceof C.UA?this.handleError(m.status,this.errorModalTitle,m.message):(this.flashMessageService.setFlashMessage(m.message,"success",15e3),this.router.navigateByUrl(this.prevUrl))})}handleError(e,i,a){this.errorService.setError({status:e,title:i,message:a});this.modalService.setModal(i,0===e?a+T.c.GUIDANCE_OF_SUPPORT:`\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9: ${e} \n\u30e1\u30c3\u30bb\u30fc\u30b8: `+a+T.c.GUIDANCE_OF_SUPPORT,"danger",p.yR.BUTTON_TITLE.CLOSE,""),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,O.h)(r=>this.modalService.getModalProperties().title===i)).subscribe(r=>{this.redirectPath&&this.router.navigateByUrl(this.redirectPath)}))}calc(){let e=0;return this.ctrls.deposit_detail.getRawValue().forEach(a=>{e+=Number(a.deposit_amount)}),Math.floor(e)}createBreadcrumbList(e){e.replace(/.*\/accounts-receivable-aggregate\/?/,"").split("/");const c=[{path:"/setting",text:"\u8a2d\u5b9a\u4e00\u89a7"},{path:this.listlUrl,text:"\u5165\u91d1\u4e00\u89a7"},{path:this.id?`${this.detailUrl}`:"",text:this.id?"\u5165\u91d1\u8a73\u7d30\u95b2\u89a7":"\u5165\u91d1\u65b0\u898f\u767b\u9332"}];return!!this.id&&c.push({text:"\u5165\u91d1\u8a73\u7d30\u7de8\u96c6"}),c}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.gz),t.Y36(x.F0),t.Y36(y.Z),t.Y36(P.P),t.Y36(d.qu),t.Y36(vt.Y),t.Y36(q.y),t.Y36(ut.G),t.Y36(w.T),t.Y36(tt.s),t.Y36(X),t.Y36(S.v),t.Y36(Y))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-add-edit"]],decls:53,vars:41,consts:[[3,"breadcrumbList"],[1,"mb-8"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"cursor-pointer",3,"click"],[3,"roleTypeName"],[1,"width-limit-break","border-t","border-gray-400"],[3,"formGroup","ngSubmit"],[1,"mt-8","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"flex","gap-6","mt-6","mb-6"],[1,"w-2/5"],["nameAttrValue","client_id","idAttrValue","client-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],["nameAttrValue","created_id","idAttrValue","created-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[1,"w-1/2"],["nameAttrValue","remarks_1","idAttrValue","remarks-1",3,"formCtrl","invalid"],[1,"mt-6","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-100"],[1,"block","mt-6",3,"itemsId","formArray","delArray"],[1,"mt-6","mb-24","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-100"],[1,"flex","justify-end","gap-8","mt-4"],[1,"width-limit-break","bg-primary-light","flex","flex-row","justify-center","bottom-[40px]","left-0","right-0","p-2","fixed","gap-8"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["em",""],["labels",""],["errors",""],["dateErrors",""],["message",""],[1,"text-sm","text-red"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[4,"ngIf"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,i){if(1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main",1)(2,"h1",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3)(5,"div",4),t.NdJ("click",function(){return i.handleClickCancel()}),t._UZ(6,"app-cancel-link-org"),t.qZA(),t.TgZ(7,"div")(8,"app-last-updater-org",5),t._uU(9),t.qZA()()(),t._UZ(10,"hr",6),t.TgZ(11,"form",7),t.NdJ("ngSubmit",function(){return i.handleClickSaveButton()}),t.TgZ(12,"div",8)(13,"h2",9),t._uU(14),t.qZA(),t._UZ(15,"hr",10),t.TgZ(16,"div",11)(17,"div",12)(18,"app-select-suggest-container",13),t.YNc(19,Jn,1,0,"ng-container",14),t.YNc(20,Qn,1,0,"ng-container",15),t.qZA()(),t.TgZ(21,"div",12)(22,"app-select-suggest-container",16),t.YNc(23,Vn,1,0,"ng-container",14),t.YNc(24,jn,1,0,"ng-container",15),t.qZA()()(),t.TgZ(25,"div",11)(26,"div",17)(27,"app-textarea-container",18),t.YNc(28,Kn,1,0,"ng-container",14),t.YNc(29,$n,1,0,"ng-container",15),t.qZA()()()(),t.TgZ(30,"div",19)(31,"h2",9),t._uU(32,"\u5165\u91d1\u660e\u7d30"),t.qZA(),t._UZ(33,"hr",10)(34,"app-deposit-detail",20),t.qZA(),t.TgZ(35,"div",21)(36,"h2",9),t._uU(37,"\u8acb\u6c42\u6b8b\u9ad8"),t.qZA(),t._UZ(38,"hr",10),t.TgZ(39,"div",22)(40,"h2",9),t._uU(41),t.qZA()()(),t.TgZ(42,"div",23)(43,"app-button",24),t._uU(44,"\u4fdd\u5b58"),t.qZA()()()(),t.YNc(45,Gn,2,1,"ng-template",null,25,t.W1O),t.YNc(47,Wn,4,2,"ng-template",null,26,t.W1O),t.YNc(49,ta,1,1,"ng-template",null,27,t.W1O),t.YNc(51,ia,1,1,"ng-template",null,28,t.W1O)),2&e){const a=t.MAs(48),s=t.MAs(50);t.Q6J("breadcrumbList",i.breadcrumbList),t.xp6(3),t.Oqu(i.pageTitle),t.xp6(5),t.Q6J("roleTypeName",i.author&&i.author.role_name?i.author.role_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.xp6(1),t.AsE(" ",i.authorTitle,"\uff1a",i.author?i.author.last_name+" "+i.author.first_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."," "),t.xp6(2),t.Q6J("formGroup",i.form),t.xp6(3),t.hij("\u5165\u91d1\u60c5\u5831\u5165\u529b",i.depositIdValue,""),t.xp6(4),t.Q6J("formCtrl",i.ctrls.client_id)("suggests",i.clientSuggests)("invalid",i.formControlStateManager(i.ctrls.client_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(32,na)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(33,Ft,i.ctrls.client_id)),t.xp6(2),t.Q6J("formCtrl",i.ctrls.created_id)("suggests",i.employeeSuggests)("invalid",i.formControlStateManager(i.ctrls.created_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(35,aa)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(36,Ft,i.ctrls.created_id)),t.xp6(3),t.Q6J("formCtrl",i.ctrls.remarks_1)("invalid",i.formControlStateManager(i.ctrls.remarks_1)),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(38,oa)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(39,Ft,i.ctrls.remarks_1)),t.xp6(5),t.Q6J("itemsId",i.id)("formArray",i.ctrls.deposit_detail)("delArray",i.ctrls.deposit_detail_del),t.xp6(7),t.hij("",i.calc(),"\u5186"),t.xp6(2),t.Q6J("buttonDisabled",i.form.invalid||i.form.pristine)}},dependencies:[g.O5,g.tP,zt,d._Y,d.JL,d.sg,Xt.K,k.r,te.t,R.Z,K.X,Ct.R]}),n})(),ee=(()=>{class n{constructor(){}setMessege(e){this.messege=e}getMessege(){return this.messege}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function ra(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-input-pair",7),t.NdJ("add",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.addTagForm())})("remove",function(){const s=t.CHM(e).index,r=t.oxw();return t.KtG(r.removeTagForm(s))}),t.qZA()}if(2&n){const i=o.index;t.Q6J("formGroup",o.$implicit)("index",i)}}let ie=(()=>{class n{constructor(e){this.fb=e,this.err=new t.vpe,this.depositDetail=[],this.template={id:"",deposit_id:"",deposit_client_id:"",deposit_client_name:"",deposit_detail_division_code:"",deposit_amount:"",deposit_date:"",remarks_1:""}}ngOnInit(){this.delArray.removeAt(0)}addTagForm(){this.formArray.push(this.fb.group(this.template))}removeTagForm(e){this.delArray.push(this.formArray.at(e)),this.formArray.removeAt(e)}handleError(){return e=>(this.err.emit(e),(0,b.of)({}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-deposit-add-detail"]],inputs:{itemsId:"itemsId",formArray:"formArray",delArray:"delArray"},outputs:{err:"err"},decls:15,vars:1,consts:[[1,""],[1,"flex","flex-row","items-center","bg-slate-100"],[1,"py-3","px-3","border-l-gray-200","bg-slate-100","w-40","bg-white"],[1,"py-3","px-3","border-l-gray-200","bg-slate-100","w-56","bg-white"],[1,"py-3","px-3","border-l-gray-200","bg-slate-100","w-44","bg-white"],[1,"py-3","px-3","border-l-gray-200","bg-slate-100","min-w-[200px]","bg-white"],[3,"formGroup","index","add","remove",4,"ngFor","ngForOf"],[3,"formGroup","index","add","remove"]],template:function(e,i){1&e&&(t.TgZ(0,"ul",0)(1,"li",1)(2,"div",2),t._uU(3," \u8acb\u6c42\u5148ID "),t.qZA(),t.TgZ(4,"div",3),t._uU(5," \u8acb\u6c42\u5148 "),t.qZA(),t.TgZ(6,"div",4),t._uU(7," \u5165\u91d1\u533a\u5206 "),t.qZA(),t.TgZ(8,"div",4),t._uU(9," \u91d1\u984d "),t.qZA(),t.TgZ(10,"div",4),t._uU(11," \u5165\u91d1\u4e88\u5b9a\u984d "),t.qZA(),t.TgZ(12,"div",5),t._uU(13," \u5099\u8003 "),t.qZA()()(),t.YNc(14,ra,1,2,"app-input-pair",6)),2&e&&(t.xp6(14),t.Q6J("ngForOf",i.formArray.controls))}}),n})();var ne=l(6863);function la(n,o){1&n&&t.GkF(0)}function ca(n,o){1&n&&t.GkF(0)}function ua(n,o){1&n&&t.GkF(0,26)}function pa(n,o){if(1&n&&(t.TgZ(0,"p",27),t._uU(1),t.qZA()),2&n){const e=o.message;t.xp6(1),t.hij(" ",e," ")}}function da(n,o){1&n&&(t.TgZ(0,"span",30),t._uU(1,"\u5fc5\u9808"),t.qZA())}function _a(n,o){if(1&n&&(t.TgZ(0,"div",28)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,da,2,0,"span",29),t.qZA()),2&n){const e=o.label,i=o.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",i)}}function ma(n,o){if(1&n&&(t.TgZ(0,"p",33),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function ha(n,o){if(1&n&&(t.ynx(0),t.YNc(1,ma,2,1,"p",32),t.BQk()),2&n){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required)}}function ga(n,o){if(1&n&&t.YNc(0,ha,2,1,"ng-container",31),2&n){const e=o.ctrl,i=t.oxw();t.Q6J("ngIf",i.formControlStateManager(e))}}function fa(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"p",33),t._uU(2),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.errorConst.FORM_ERROR.DATE_SPECIFICATION_VIOLATION," ")}}function ba(n,o){if(1&n&&t.YNc(0,fa,3,1,"ng-container",31),2&n){const e=o.ctrls;t.Q6J("ngIf",null==e.errors?null:e.errors.endingDateIsSmaller)}}const va=function(){return{label:"\u5165\u91d1\u65e5"}},Ca=function(){return{label:"\u5099\u8003",required:!1}},Ta=function(n){return{ctrl:n}};let xa=(()=>{class n{constructor(e,i,a,s,r,c,u,_,m,v,Z,at){this.route=e,this.router=i,this.modalService=a,this.flashMessageService=s,this.fb=r,this.authorService=c,this.clientService=u,this.employeeService=_,this.errorService=m,this.depositService=v,this.common=Z,this.message=at,this.subscription=new A.w0,this.breadcrumbList=[],this.id=this.route.snapshot.params.id,this.url=this.router.url,this.detailUrl=this.url.replace("detail-edit","detail-view"),this.listlUrl=this.id?"../../":this.url.replace("/add",""),this.prevUrl=this.id?`${this.detailUrl}`:`${this.listlUrl}`,this.pageTitle=this.id?"\u5165\u91d1\u8a73\u7d30\u7de8\u96c6":"\u5165\u91d1\u65b0\u898f\u767b\u9332",this.detailPagePath=this.prevUrl,this.authorTitle=this.id?"\u66f4\u65b0\u8005":"\u767b\u9332\u8005",this.depositIdValue=this.id?"\u3000\u5165\u91d1ID\uff1a"+this.id:"",this.updater="\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...",this.authorname="\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...",this.response=[],this.topPagePath="/setting",this.listPagePath="/setting/accounts-receivable-aggregate/deposit",this.cancelModalTitle=this.pageTitle+"\u30ad\u30e3\u30f3\u30bb\u30eb\uff1a"+p.yR.TITLE.CANCEL,this.errorModalTitle=this.pageTitle+"\u30a8\u30e9\u30fc\uff1a"+p.yR.TITLE.HAS_ERROR,this.redirectPath=this.prevUrl,this.errorConst=T.c,this.deposit_date="",this.form=this.fb.group({created_id:["",[d.kI.required]],deposit_date:["",[d.kI.required]],remarks_1:[""],deposit_detail:this.fb.array([this.fb.group({id:[""],deposit_id:[""],deposit_client_id:["",[d.kI.required]],deposit_client_name:[""],deposit_detail_division_code:[""],deposit_amount:[""],deposit_date:[""],remarks_1:[""]})]),deposit_detail_del:this.fb.array([this.fb.group({id:[""],deposit_id:[""],deposit_client_id:[""],deposit_client_name:[""],deposit_detail_division_code:[""],deposit_amount:[""],deposit_date:[""],remarks_1:[""]})])}),this.depositDetailAny=[],this.depositAddForms=this.fb.group({forms:this.fb.array([])})}get ctrls(){return this.form.controls}get depositAddFormsArray(){return this.depositAddForms.get("forms")}get depositAddFormsArrayControls(){return this.depositAddFormsArray.controls}ngOnInit(){this.breadcrumbList=this.createBreadcrumbList(this.router.url),this.authorService.author?(this.author=this.authorService.author,this.ctrls.created_id.patchValue(String(this.author.id)),this.initOptions()):this.subscription.add(this.authorService.author$.subscribe(e=>{this.author=e,this.ctrls.created_id.patchValue(String(this.author.id)),this.initOptions()})),this.subscription.add(this.errorService.getError().subscribe(e=>{this._handleError(e)})),this.id||(this.detailPagePath=this.listPagePath),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,O.h)(e=>this.modalService.getModalProperties().title===this.cancelModalTitle)).subscribe(e=>{e===p.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.detailPagePath)}))}ngOnDestroy(){this.subscription.unsubscribe()}initOptions(){this.common.loading=!0,this.ctrls.deposit_date.valueChanges.subscribe(()=>{this.deposit_date=this.ctrls.deposit_date.value?new Date(this.ctrls.deposit_date.value).toLocaleDateString():"",this.message.setMessege(this.deposit_date)}),this.subscription.add((0,I.D)([this.clientService.getAsSelectOptions(),this.employeeService.getAsSelectOptions()]).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(e=>(0,b.of)(e))).subscribe(e=>{e instanceof C.UA?this.handleError(e.status,this.errorModalTitle,e.message):null!=e&&2===e.length?(this.clientSuggests=e[0],this.employeeSuggests=e[1]):this.handleError(400,this.errorModalTitle,p.yR.BODY.HAS_ERROR)}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleClickCancel(){this.form.pristine?this.router.navigateByUrl(this.detailPagePath):this.modalService.setModal(this.cancelModalTitle,p.yR.BODY.CANCEL,"warning",p.yR.BUTTON_TITLE.EXECUTION,p.yR.BUTTON_TITLE.CANCEL)}handleClickSaveButton(){this.form.markAsPristine(),this.common.loading=!0;const e=this.form.value;if(!this.employeeSuggests.some(_=>Number(_.value)===Number(this.author.id)))return this.ctrls.created_id.setValue(""),void(this.common.loading=!1);const a=this.ctrls.deposit_detail.getRawValue();let s=[];a.forEach(_=>{const m={id:"",deposit_client_id:Number(_.deposit_client_id),deposit_client_name:_.deposit_client_name,deposit_detail_division_code:_.deposit_detail_division_code,deposit_amount:_.deposit_amount,deposit_date:this.deposit_date,remarks_1:_.remarks_1};this.depositDetailAny.push(m),s.push(Number(_.deposit_client_id))});let c=this.uniq(s),u=[];for(let _ in c){const m=this.depositDetailAny.filter(Z=>c[_]==Z.deposit_client_id),v={client_id:Number(m[0].deposit_client_id),created_id:Number(this.author.id),remarks_1:e.remarks_1?e.remarks_1:"\u3000",deposit_detail:[...m]};u.push(this.depositService.add(v))}(0,I.D)(u).pipe((0,h.K)(_=>(0,b.of)(_)),(0,f.x)(()=>{this.common.loading=!1})).subscribe(_=>{if(_ instanceof C.UA)return this.handleError(_.status,this.errorModalTitle,_.error?_.error.message:this.errorModalTitle),void(this.common.loading=!1);this.response=_}).add(()=>{if(this.response.length>0){const _="success";this.common.loading=!1,this.flashMessageService.setFlashMessage("\u4f5c\u6210\u3057\u307e\u3057\u305f",_,15e3),this.router.navigateByUrl(this.prevUrl)}})}handleError(e,i,a){this.errorService.setError({status:e,title:i,message:a});this.modalService.setModal(i,0===e?a+T.c.GUIDANCE_OF_SUPPORT:`\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9: ${e} \n\u30e1\u30c3\u30bb\u30fc\u30b8: `+a+T.c.GUIDANCE_OF_SUPPORT,"danger",p.yR.BUTTON_TITLE.CLOSE,""),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,O.h)(r=>this.modalService.getModalProperties().title===i)).subscribe(r=>{this.redirectPath&&this.router.navigateByUrl(this.redirectPath)}))}uniq(e){return Array.from(new Set(e))}calc(){let e=0;return this.ctrls.deposit_detail.getRawValue().forEach(a=>{e+=Number(a.deposit_amount)}),Math.floor(e)}createBreadcrumbList(e){e.replace(/.*\/accounts-receivable-aggregate\/?/,"").split("/");const c=[{path:"/setting",text:"\u8a2d\u5b9a\u4e00\u89a7"},{path:this.listlUrl,text:"\u5165\u91d1\u4e00\u89a7"},{path:this.id?`${this.detailUrl}`:"",text:this.id?"\u5165\u91d1\u8a73\u7d30\u95b2\u89a7":"\u5165\u91d1\u65b0\u898f\u767b\u9332"}];return!!this.id&&c.push({text:"\u5165\u91d1\u8a73\u7d30\u7de8\u96c6"}),c}_handleError(e){e.redirectPath&&(this.redirectPath=e.redirectPath),this.modalService.setModal(e.title,0===e.status?e.message+T.c.GUIDANCE_OF_SUPPORT:`\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9: ${e.status} \n\u30e1\u30c3\u30bb\u30fc\u30b8: `+e.message+T.c.GUIDANCE_OF_SUPPORT,"danger",p.yR.BUTTON_TITLE.CLOSE,""),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,O.h)(a=>this.modalService.getModalProperties().title===e.title)).subscribe(a=>{this.redirectPath&&this.router.navigateByUrl(this.redirectPath)}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.gz),t.Y36(x.F0),t.Y36(y.Z),t.Y36(P.P),t.Y36(d.qu),t.Y36(vt.Y),t.Y36(q.y),t.Y36(ut.G),t.Y36(w.T),t.Y36(tt.s),t.Y36(S.v),t.Y36(ee))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-add"]],decls:41,vars:24,consts:[[3,"breadcrumbList"],[1,"mb-8"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"cursor-pointer",3,"click"],[3,"roleTypeName"],[1,"width-limit-break","border-t","border-gray-400"],[3,"formGroup","ngSubmit"],[1,"mt-8","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"flex","gap-6","mt-6","mb-6"],[1,"w-2/5"],["nameAttrValue","deposit_date","idAttrValue","deposit_date",1,"w-1/6",3,"formCtrl"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-1/2"],["nameAttrValue","remarks_1","idAttrValue","remarks-1",3,"formCtrl","invalid"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mt-6","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-100"],[1,"block","mt-6",3,"itemsId","formArray","delArray"],[1,"width-limit-break","bg-primary-light","flex","flex-row","justify-center","bottom-[40px]","left-0","right-0","p-2","fixed","gap-8"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["em",""],["labels",""],["errors",""],["dateErrors",""],["message",""],[1,"text-sm","text-red"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[4,"ngIf"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,i){if(1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main",1)(2,"h1",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3)(5,"div",4),t.NdJ("click",function(){return i.handleClickCancel()}),t._UZ(6,"app-cancel-link-org"),t.qZA(),t.TgZ(7,"div")(8,"app-last-updater-org",5),t._uU(9),t.qZA()()(),t._UZ(10,"hr",6),t.TgZ(11,"form",7),t.NdJ("ngSubmit",function(){return i.handleClickSaveButton()}),t.TgZ(12,"div",8)(13,"h2",9),t._uU(14),t.qZA(),t._UZ(15,"hr",10),t.TgZ(16,"div",11)(17,"div",12)(18,"app-date-term",13),t.YNc(19,la,1,0,"ng-container",14),t.qZA()()(),t.TgZ(20,"div",11)(21,"div",15)(22,"app-textarea-container",16),t.YNc(23,ca,1,0,"ng-container",14),t.YNc(24,ua,1,0,"ng-container",17),t.qZA()()()(),t.TgZ(25,"div",18)(26,"h2",9),t._uU(27,"\u5165\u91d1\u660e\u7d30"),t.qZA(),t._UZ(28,"hr",10)(29,"app-deposit-add-detail",19),t.qZA(),t.TgZ(30,"div",20)(31,"app-button",21),t._uU(32,"\u4fdd\u5b58"),t.qZA()()()(),t.YNc(33,pa,2,1,"ng-template",null,22,t.W1O),t.YNc(35,_a,4,2,"ng-template",null,23,t.W1O),t.YNc(37,ga,1,1,"ng-template",null,24,t.W1O),t.YNc(39,ba,1,1,"ng-template",null,25,t.W1O)),2&e){const a=t.MAs(36),s=t.MAs(38);t.Q6J("breadcrumbList",i.breadcrumbList),t.xp6(3),t.Oqu(i.pageTitle),t.xp6(5),t.Q6J("roleTypeName",i.author&&i.author.role_name?i.author.role_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.xp6(1),t.AsE(" ",i.authorTitle,"\uff1a",i.author?i.author.last_name+" "+i.author.first_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."," "),t.xp6(2),t.Q6J("formGroup",i.form),t.xp6(3),t.hij("\u5165\u91d1\u60c5\u5831\u5165\u529b",i.depositIdValue,""),t.xp6(4),t.Q6J("formCtrl",i.ctrls.deposit_date),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(20,va)),t.xp6(3),t.Q6J("formCtrl",i.ctrls.remarks_1)("invalid",i.formControlStateManager(i.ctrls.remarks_1)),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(21,Ca)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(22,Ta,i.ctrls.remarks_1)),t.xp6(5),t.Q6J("itemsId",i.id)("formArray",i.ctrls.deposit_detail)("delArray",i.ctrls.deposit_detail_del),t.xp6(2),t.Q6J("buttonDisabled",i.form.invalid||i.form.pristine)}},dependencies:[g.O5,g.tP,ie,d._Y,d.JL,d.sg,ne.a,Xt.K,k.r,te.t,R.Z,Ct.R]}),n})();var M=l(9042),Aa=l(4720);function Ea(n,o){if(1&n&&(t.TgZ(0,"div",15)(1,"h2",9),t._uU(2,"\u5165\u91d1\u30d8\u30c3\u30c0\u30fc"),t.qZA(),t._UZ(3,"hr",10),t.TgZ(4,"div",16)(5,"div",17)(6,"table",18)(7,"tr",12)(8,"td",19),t._uU(9,"\u5165\u91d1ID"),t.qZA(),t.TgZ(10,"td",20),t._uU(11,"\u8acb\u6c42\u5148"),t.qZA(),t.TgZ(12,"td",21),t._uU(13,"\u767b\u9332\u8005"),t.qZA(),t.TgZ(14,"td",22),t._uU(15,"\u5099\u8003"),t.qZA()(),t.TgZ(16,"tr",12)(17,"td",23),t._uU(18),t.qZA(),t.TgZ(19,"td",23),t._uU(20),t.qZA(),t.TgZ(21,"td",23),t._uU(22),t.qZA(),t.TgZ(23,"td",23),t._uU(24),t.qZA()()()()()()),2&n){const e=t.oxw();t.xp6(18),t.Oqu(e.deposit.id),t.xp6(2),t.Oqu(e.deposit.client_name),t.xp6(2),t.hij(" ",e.deposit.employee_created_last_name&&e.deposit.employee_created_first_name," "),t.xp6(2),t.Oqu(e.deposit.remarks_1)}}function Sa(n,o){if(1&n&&(t.TgZ(0,"tr",12)(1,"td",23),t._uU(2),t.qZA(),t.TgZ(3,"td",24),t._uU(4),t.qZA(),t.TgZ(5,"td",23),t._uU(6),t.qZA(),t.TgZ(7,"td",23),t._uU(8),t.qZA()()),2&n){const e=o.$implicit,i=t.oxw();t.xp6(2),t.hij(" ",i.getdepositClass(e.deposit_detail_division_code)," "),t.xp6(2),t.hij(" ",e.deposit_amount?e.deposit_amount.toLocaleString():""," "),t.xp6(2),t.Oqu(i.getDateFormat(e.deposit_date)),t.xp6(2),t.Oqu(e.remarks_1)}}const Da=function(n){return{path:n,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Za=function(n){return{path:n,text:"\u5165\u91d1\u4e00\u89a7"}},Oa=function(){return{text:"\u5165\u91d1\u8a73\u7d30\u95b2\u89a7"}},Fa=function(n,o,e){return[n,o,e]};let ya=(()=>{class n{constructor(e,i,a,s,r,c,u,_,m){this.route=e,this.router=i,this.modalService=a,this.depositService=s,this.depositDetailService=r,this.errorService=c,this.flashMessageService=u,this.common=_,this.divisionService=m,this.subscription=new A.w0,this.topPagePath="/setting",this.listPagePath="../../../deposit",this.editPagePath="../../../deposit/detail-edit/{{ depositId }}",this.depositId="",this.errorModalTitle="\u5165\u91d1\u4e00\u89a7\uff1a"+p.yR.TITLE.HAS_ERROR,this.depositDetail=[],this.depositClassficationOption=[]}ngOnInit(){this.subscription.add(this.modalService.closeEventObservable$.pipe((0,O.h)(i=>this.modalService.getModalProperties().title===this.errorModalTitle)).subscribe(i=>{i===p.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.listPagePath)})),this.common.loading=!0,this.subscription.add((0,I.D)([this.divisionService.getAsSelectOptions({name:M.z.DEPOSIT_CLASSIFICATION})]).pipe((0,f.x)(()=>this.common.loading=!1)).subscribe(i=>{i[0][M.z.DEPOSIT_CLASSIFICATION].filter(s=>{this.depositClassficationOption.push({value:s.code,text:s.text})}),this.common.loading=!1}));const e=this.route.snapshot.paramMap.get("id");null!==e?isNaN(Number(e))?this.modalService.setModal(this.errorModalTitle,p.yR.BODY.CANCEL,"danger",p.yR.BUTTON_TITLE.CLOSE):(this.selectedId=Number(e),this.editPath="../../detail-edit/"+this.selectedId,this.getDeposit(this.selectedId),this.getDepositDetail(this.selectedId)):this.modalService.setModal(this.errorModalTitle,p.yR.BODY.CANCEL,"danger",p.yR.BUTTON_TITLE.CLOSE)}getdepositClass(e){return this.depositClassficationOption.find(a=>a.value===e)?.text}getDeposit(e){this.subscription.add(this.depositService.find(e).pipe((0,h.K)(i=>(0,b.of)(i)),(0,f.x)(()=>this.common.loading=!1)).subscribe(i=>{i instanceof C.UA?this.handleError(i.status,i.error.message):(0,E.bz)(i)?this.handleError(400,T.c.COULD_NOT_GET_DATA):this.deposit=i.data[0]}))}getDepositDetail(e){this.subscription.add(this.depositDetailService.getAll({deposit_id:e}).pipe((0,h.K)(this.depositDetailService.handleErrorModal()),(0,f.x)(()=>this.common.loading=!1)).subscribe(i=>{i instanceof C.UA?this.handleError(i.status,i.error.message):(0,E.bz)(i)?this.handleError(400,T.c.COULD_NOT_GET_DATA):(this.depositDetail=i.data,console.log(this.depositDetail))}))}handleError(e,i,a){this.errorService.setError({status:e,title:"\u5165\u91d1\u4e00\u89a7\uff1a"+p.yR.TITLE.HAS_ERROR,message:i,redirectPath:a})}ngOnDestroy(){this.subscription.unsubscribe()}calc(){let e=0;return this.depositDetail.forEach(i=>{e+=Number(i.deposit_amount)}),Math.floor(e)}getDivisionName(e){return[{value:1,text:"\u5165\u91d1\u5f85\u3061"},{value:2,text:"\u5165\u91d1\u6e08\u307f"}].find(a=>a.value===e)?.text}getDateFormat(e){let i;return i=""===e||"NaT"===e?"":new Date(e).toLocaleDateString(),i}handleClickDelete(){const e="\u5165\u91d1"+p.yR.TITLE.DELETE;this.modalService.setModal(e,p.yR.BODY.DELETE,"danger",p.yR.BUTTON_TITLE.DELETE,p.yR.BUTTON_TITLE.CANCEL),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,O.h)(a=>this.modalService.getModalProperties().title===e)).subscribe(a=>{a===p.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&(this.common.loading=!0,this.depositService.remove(this.selectedId).pipe((0,h.K)(s=>(0,b.of)(s)),(0,f.x)(()=>this.common.loading=!1)).subscribe(s=>{s instanceof C.UA?this.handleError(s.status,s.error?s.error.title:"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002",s.message):(this.depositDetail&&this.depositDetail.forEach(c=>{c.id&&this.deleteDepositDetailItem(c.id)}),this.flashMessageService.setFlashMessage(s.message,"success",15e3),this.router.navigateByUrl(this.listPagePath))}))}))}deleteDepositDetailItem(e){this.depositDetailService.remove(e.toString()).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(i=>(0,b.of)(i))).subscribe(i=>{i instanceof C.UA&&this.handleError(i.status,i.error?i.error.title:"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002",i.message)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.gz),t.Y36(x.F0),t.Y36(y.Z),t.Y36(tt.s),t.Y36(X),t.Y36(w.T),t.Y36(P.P),t.Y36(S.v),t.Y36(lt.E))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-detail-view"]],decls:29,vars:14,consts:[[3,"breadcrumbList"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"flex","flex-row","items-center","gap-6"],[3,"path"],[1,"cursor-pointer",3,"click"],[1,"width-limit-break","border-t","border-gray-400"],["class","mt-8 py-8 px-6 bg-white shadow border border-gray-300",4,"ngIf"],[1,"mt-6","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-100"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"mt-6","w-full","shadow"],[1,"border","border-slate-200"],[1,"border","bg-slate-100","p-4"],["class","border border-slate-200",4,"ngFor","ngForOf"],[1,"mt-8","py-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"mt-6","flex","flex-row","gap-10"],[1,"grow"],[1,"w-full"],[1,"border","bg-slate-100","p-4","min-w-[100px]"],[1,"border","bg-slate-100","p-4","min-w-[410px]"],[1,"border","bg-slate-100","p-4","min-w-[220px]"],[1,"border","bg-slate-100","p-4","min-w-[470px]"],[1,"border","p-4"],[1,"border","p-4","text-right"]],template:function(e,i){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main")(2,"h1",1),t._uU(3,"\u5165\u91d1\u8a73\u7d30\u95b2\u89a7"),t.qZA(),t.TgZ(4,"div",2)(5,"div",3)(6,"app-back-to-link-org",4),t._uU(7,"\u4e00\u89a7\u3078\u623b\u308b"),t.qZA(),t.TgZ(8,"app-edit-link-org",4),t._uU(9,"\u7de8\u96c6"),t.qZA(),t.TgZ(10,"div",5),t.NdJ("click",function(){return i.handleClickDelete()}),t._UZ(11,"app-delete-link-org"),t.qZA()()(),t._UZ(12,"hr",6),t.YNc(13,Ea,25,4,"div",7),t.TgZ(14,"div",8)(15,"h2",9),t._uU(16,"\u5165\u91d1\u660e\u7d30"),t.qZA(),t._UZ(17,"hr",10),t.TgZ(18,"table",11)(19,"tr",12)(20,"td",13),t._uU(21,"\u5165\u91d1\u533a\u5206"),t.qZA(),t.TgZ(22,"td",13),t._uU(23,"\u5165\u91d1\u984d"),t.qZA(),t.TgZ(24,"td",13),t._uU(25,"\u5165\u91d1\u65e5"),t.qZA(),t.TgZ(26,"td",13),t._uU(27,"\u5099\u8003"),t.qZA()(),t.YNc(28,Sa,9,4,"tr",14),t.qZA()()()),2&e&&(t.Q6J("breadcrumbList",t.kEZ(10,Fa,t.VKq(5,Da,i.topPagePath),t.VKq(7,Za,i.listPagePath),t.DdM(9,Oa))),t.xp6(6),t.s9C("path",i.listPagePath),t.xp6(2),t.Q6J("path",i.editPath),t.xp6(5),t.Q6J("ngIf",i.deposit),t.xp6(15),t.Q6J("ngForOf",i.depositDetail))},dependencies:[g.sg,g.O5,Zt.i,Aa._,R.Z,Ht.$]}),n})(),ae=(()=>{class n extends Q.O{constructor(){super(...arguments),this.endpoint=V.pU.accountsReceivableBalanceApi.endpoint}getAll(e={}){return this.httpOptions.params=e,this.http.get(this.endpoint,this.httpOptions).pipe((0,h.K)(this.setErrorMessage("\u58f2\u4e0a\u6b8b\u9ad8\u4e00\u89a7\u306e\u53d6\u5f97")))}getCsv(e,i={}){const a={params:i,responseType:"text",headers:new C.WM({"X-Download":e})};return this.http.get(this.endpoint,a).pipe((0,h.K)(this.setErrorMessage("\u4e00\u62ec\u767b\u9332\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u53d6\u5f97")))}aggregate(e){const i=this.generateFormData(e);return this.http.post(`${this.endpoint}/aggregate`,i)}}return n.\u0275fac=function(){let o;return function(i){return(o||(o=t.n5z(n)))(i||n)}}(),n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var yt=l(2195);function wa(n,o){1&n&&t.GkF(0,20)}function Ia(n,o){1&n&&t.GkF(0)}function Pa(n,o){1&n&&t.GkF(0,20)}function ka(n,o){if(1&n&&(t.TgZ(0,"div",21)(1,"span"),t._uU(2),t.qZA()()),2&n){const e=o.label;t.xp6(2),t.Oqu(e)}}function Ua(n,o){if(1&n&&(t.TgZ(0,"p",24),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.EXCEEDED_CHARACTER_MIN_LIMIT," ")}}function Ba(n,o){if(1&n&&(t.TgZ(0,"p",24),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.NUMERIC_LIMIT_VIOLATION," ")}}function Na(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Ua,2,1,"p",23),t.YNc(2,Ba,2,1,"p",23),t.BQk()),2&n){const e=t.oxw().ctrl,i=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.minlength),t.xp6(1),t.Q6J("ngIf",(null==e.errors||null==e.errors.pattern?null:e.errors.pattern.requiredPattern)===i.regExConst.NUMERIC_REG_EX+"")}}function Ra(n,o){if(1&n&&t.YNc(0,Na,3,2,"ng-container",22),2&n){const e=o.ctrl,i=t.oxw();t.Q6J("ngIf",i.invalid(e))}}function Ma(n,o){if(1&n&&(t.TgZ(0,"p",25),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}const La=function(){return{label:"\u8acb\u6c42\u5148",required:"false"}},qa=function(n){return{ctrl:n}};let Ya=(()=>{class n{constructor(e,i,a,s,r){this.fb=e,this.common=i,this.clientService=a,this.errorService=s,this.accountsreceivablebalance=r,this.event=new t.vpe,this.errorLoadTitle="\u58f2\u639b\u6b8b\u4e00\u89a7\u753b\u9762\u30a8\u30e9\u30fc\uff1a"+p.yR.TITLE.HAS_ERROR,this.isOpen=!1,this.rotateAnimation="",this.searchForm=this.fb.group({client_id:"",created_at:this.fb.group({from:"",to:""},{validators:[F.d.beforeFromDate()]})}),this.subscription=new A.w0,this.errorConst=T.c,this.regExConst=G.m}get ctrls(){return this.searchForm.controls}ngOnInit(){this.searchForm=this.setSearchClear(),this.initOptions()}searchButtonOnClick(){this.isOpen=!this.isOpen,this.rotateAnimation=this.isOpen?"rotate-animation-180":"rotate-animation-0"}onClickReset(){this.searchForm.reset(),this.searchForm=this.setSearchClear()}onClickSubmit(){const e=(0,E.vP)(this.removeNullsAndBlanks(this.searchForm.value));this.event.emit(e)}invalid(e){return(e.touched||e.dirty)&&e.invalid}removeNullsAndBlanks(e){const i={};for(const[a,s]of Object.entries(e))null!=s&&""!==s&&(i[a]=s);return i}initOptions(){this.subscription.add((0,I.D)([this.clientService.getAsSelectOptions()]).pipe((0,h.K)(e=>(e.emit(e),(0,b.of)(e.error)))).subscribe(e=>{e instanceof C.UA?this.handleError(e.status,this.errorLoadTitle,e.message):null!=e&&1===e.length?this.clientSuggests=e[0]:this.handleError(400,this.errorLoadTitle,p.yR.BODY.HAS_ERROR)}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleError(e,i,a){this.errorService.setError({status:e,title:i,message:a})}setSearchClear(){return this.fb.group({client_id:"",created_at:this.fb.group({from:"",to:""},{validators:[F.d.beforeFromDate()]})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.qu),t.Y36(S.v),t.Y36(q.y),t.Y36(w.T),t.Y36(ae))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-search"]],outputs:{event:"event"},decls:29,vars:20,consts:[[1,"mt-8","mb-4"],[3,"click"],["icon","filter-2-line",1,"w-6"],[1,"inline-block","ml-1","mr-2"],["icon","arrow-down-s-fill",1,"w-6"],[1,"search","width-limit-break","bg-white",3,"ngClass"],[1,"w-[1280px]","mx-auto","px-4"],[1,"flex","gap-6","mt-6"],[1,"w-3/6",3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],[1,"w-1/3"],["nameAttrValue","client_id","idAttrValue","client-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"flex","gap-8","mt-10"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[1,"mt-2","text-sm","text-red"],["labels",""],["errors",""],["beforeFromDate",""],["message",""],[1,"flex","items-center","gap-2"],[4,"ngIf"],["class","text-sm text-red",4,"ngIf"],[1,"text-sm","text-red"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return i.searchButtonOnClick()}),t._UZ(2,"app-icon",2),t.TgZ(3,"span",3),t._uU(4),t.qZA(),t._UZ(5,"app-icon",4),t.qZA()(),t.TgZ(6,"div",5)(7,"form",6)(8,"div",7)(9,"app-date-term-clear-container",8),t._uU(10," \u5e74\u6708\u5ea6 "),t.YNc(11,wa,1,0,"ng-container",9),t.qZA(),t.TgZ(12,"div",10)(13,"app-select-suggest-container",11),t.YNc(14,Ia,1,0,"ng-container",12),t.YNc(15,Pa,1,0,"ng-container",13),t.qZA()()(),t.TgZ(16,"div",14)(17,"app-button",1),t.NdJ("click",function(){return i.onClickReset()}),t._uU(18,"\u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2"),t.qZA(),t.TgZ(19,"app-button",15),t.NdJ("click",function(){return i.onClickSubmit()}),t._uU(20," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA()(),t.TgZ(21,"p",16),t._uU(22," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()(),t.YNc(23,ka,3,1,"ng-template",null,17,t.W1O),t.YNc(25,Ra,1,1,"ng-template",null,18,t.W1O),t.YNc(27,Ma,2,1,"ng-template",null,19,t.W1O)),2&e){const a=t.MAs(24),s=t.MAs(26),r=t.MAs(28);t.xp6(4),t.hij(" ",i.isOpen?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(i.rotateAnimation),t.xp6(1),t.Q6J("ngClass",i.isOpen?"is-open shadow":""),t.xp6(3),t.Q6J("dateFromFormCtrl",i.ctrls.created_at.controls.from)("dateToFormCtrl",i.ctrls.created_at.controls.to)("invalid",!!i.ctrls.created_at.errors),t.xp6(2),t.Q6J("ngIf",null==i.ctrls.created_at.errors?null:i.ctrls.created_at.errors.beforeFromDate)("ngIfThen",r),t.xp6(2),t.Q6J("formCtrl",i.ctrls.client_id)("suggests",i.clientSuggests)("invalid",i.formControlStateManager(i.ctrls.client_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(17,La)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(18,qa,i.ctrls.client_id)),t.xp6(4),t.Q6J("buttonDisabled",i.searchForm.invalid)}},dependencies:[g.mk,g.O5,g.tP,j.w,k.r,U.o,K.X],styles:[".search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease;overflow:hidden}.search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0}"]}),n})();const Ja=function(n){return{path:n,text:"\u8a2d\u5b9a\u4e00\u89a7"}},Qa=function(){return{text:"\u58f2\u639b\u6b8b\u4e00\u89a7"}},Va=function(n,o){return[n,o]},ja=[{path:"",redirectTo:"bill",pathMatch:"full"},{path:"individual-bill",component:ot,children:[{path:"",component:Ie,pathMatch:"full"}]},{path:"bill",component:ot,children:[{path:"",component:$t,pathMatch:"full"},{path:"list",component:$t},{path:"slip-list/:id",component:an},{path:"slip-detail/:bill_id/:id/:sales_slip_cd",component:Tn}]},{path:"deposit",component:ot,children:[{path:"",component:Wt,pathMatch:"full"},{path:"list",component:Wt},{path:"add",component:xa},{path:"detail-view/:id",component:ya},{path:"detail-edit/:id",component:sa}]},{path:"accounts-receivable-balance",component:ot,children:[{path:"",component:(()=>{class n{constructor(e,i,a,s,r,c,u,_){this.common=e,this.service=i,this.fb=a,this.accountsReceivableAggregateService=s,this.flashMessageService=r,this.errorService=c,this.router=u,this.modalService=_,this.topPagePath="/setting",this.listPagePath=this.topPagePath+"/accounts-receivable-aggregate/accounts-receivable-balance",this._filter={},this.defaultSort={column:"",order:"desc"},this._pages={page:1,itemsPerPage:10,sort:this.defaultSort},this.tableParams=new B.x,this.tableNameMapping=[{name:"client_client_cd",name_jp:"\u8acb\u6c42\u5148\u30b3\u30fc\u30c9"},{name:"client_name",name_jp:"\u8acb\u6c42\u5148\u540d"},{name:"previous_month_balance",name_jp:"\u524d\u6708\u6b8b\u9ad8"},{name:"deposit_amount",name_jp:"\u5165\u91d1\u91d1\u984d"},{name:"sales_amount",name_jp:"\u58f2\u4e0a\u91d1\u984d"},{name:"consumption_tax",name_jp:"\u6d88\u8cbb\u7a0e\u984d"},{name:"reduced_tax_1",name_jp:"\u8efd\u6e1b\u7a0e\u7387\u6d88\u8cbb\u7a0e\u984d"},{name:"current_month_balance",name_jp:"\u5f53\u6708\u6b8b\u9ad8"}],this.fileNamePrefix="\u58f2\u4e0a\u4f1d\u7968",this.form=this.fb.group({payment_date_picker:[""],payment_date:["",[d.kI.required]]}),this.errorModalTitle="\u96c6\u8a08\u30a8\u30e9\u30fc\uff1a"+p.yR.TITLE.HAS_ERROR}set filter(e){this._filter=e,this._pages.page=1,this.callApi()}set pages(e){this._pages=e,this.callApi()}get export$(){return this.service.getCsv("csv",{...this._filter}).pipe((0,h.K)(this.service.handleErrorModal("")),(0,f.x)(()=>this.common.loading=!1))}get ctrls(){return this.form.controls}ngOnInit(){this.callApi(),this.ctrls.payment_date_picker.valueChanges.subscribe(()=>{let e=this.ctrls.payment_date_picker.value;if(e){const i=new Date(e);let a=String(i.getFullYear())+"/"+String(i.getMonth()+1);this.ctrls.payment_date.setValue(a)}})}onClickSubmit(){if(this.common.loading=!0,this.ctrls.payment_date_picker.value){let i=new Date(this.ctrls.payment_date_picker.value);const a={to_sale_date:new Date(i).toLocaleDateString()};console.log(a),this.service.aggregate(a).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(s=>(0,b.of)(s))).subscribe(s=>{if(s instanceof C.UA)return void this.handleError(s.status,this.errorModalTitle,s.message);let c="\u96c6\u8a08\u5b8c\u4e86\u5f8c\u3001\u3054\u767b\u9332\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3044\u305f\u3057\u307e\u3059\u3002\n";c+="\u203b \u30e1\u30fc\u30eb\u304c\u8ff7\u60d1\u30e1\u30fc\u30eb\u306b\u632f\u308a\u5206\u3051\u3089\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n",c+="\u203b \u30e1\u30fc\u30eb\u304c\u9001\u4fe1\u3055\u308c\u308b\u307e\u3067\u6570\u5206\u304b\u304b\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002",this.modalService.setModal("\u96c6\u8a08\u304c\u5b9f\u65bd\u3055\u308c\u307e\u3057\u305f","\u96c6\u8a08\u5b8c\u4e86\u5f8c\u3001\u3054\u767b\u9332\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3044\u305f\u3057\u307e\u3059\u3002\n\u203b \u30e1\u30fc\u30eb\u304c\u8ff7\u60d1\u30e1\u30fc\u30eb\u306b\u632f\u308a\u5206\u3051\u3089\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u203b \u30e1\u30fc\u30eb\u304c\u9001\u4fe1\u3055\u308c\u308b\u307e\u3067\u6570\u5206\u304b\u304b\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002","success","\u9589\u3058\u308b","\u9589\u3058\u308b",!1),this.router.navigateByUrl(this.listPagePath)})}else this.common.loading=!1}invalid(e){return(e.touched||e.dirty)&&e.invalid}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}onExportStatusChange(e){e===$.U.START&&(this.common.loading=!0)}sum_totals(e,i){return e.reduce((s,r)=>s+Number(r[i]),0)}callApi(){this.common.loading=!0;let e=this.createApiParams();this.service.getAll(e).pipe((0,h.K)(this.service.handleErrorModal()),(0,f.x)(()=>this.common.loading=!1)).subscribe(i=>{console.log(e),delete e.limit,console.log(e),this.service.getAll(e).pipe((0,h.K)(this.service.handleErrorModal()),(0,f.x)(()=>this.common.loading=!1)).subscribe(a=>{console.log(a);const s=a.data.map(L=>({previous_month_balance:Number(L.previous_month_balance),deposit_amount:Number(L.deposit_amount),sales_amount:Number(L.sales_amount),consumption_tax:Number(L.consumption_tax),reduced_tax_1:Number(L.reduced_tax_1),current_month_balance:Number(L.current_month_balance)}));let r=this.sum_totals(s,"previous_month_balance"),c=this.sum_totals(s,"deposit_amount"),u=this.sum_totals(s,"sales_amount"),_=this.sum_totals(s,"consumption_tax"),m=this.sum_totals(s,"reduced_tax_1"),v=this.sum_totals(s,"current_month_balance");const Z=["\u5408\u8a08","",r.toLocaleString(),c.toLocaleString(),u.toLocaleString(),_.toLocaleString(),m.toLocaleString(),v.toLocaleString()],at=this.createTableParams(i,this.tableNameMapping,this.modifiedTableBody,Z);this.tableParams.next(at),this.common.loading=!1})})}createApiParams(){0===Object.keys(this._pages.sort).length&&(this._pages.sort=this.defaultSort);const e=this.tableNameMapping.find(a=>a.name_jp===this._pages.sort.column)?.name;let i;return i="client_client_cd"===e?"client_cd":"client_name"===e?"name_kana":e,{...this._filter,limit:this._pages.itemsPerPage,offset:(this._pages.page-1)*this._pages.itemsPerPage,sort:i?`${i}:${this._pages.sort.order}`:""}}createTableParams(e,i,a,s=[]){const r=i.map(u=>u.name_jp),c=e.data.map(u=>i.map(a?a(u):_=>u[_.name]));return{total:e.totalItems,header:r,body:c,footer:s}}modifiedTableBody(e){return i=>""===e[i.name]?e[i.name]:["deposit_amount","previous_month_balance","sales_amount","consumption_tax","reduced_tax_1","current_month_balance"].includes(i.name)?{unit:!1,align:"right",text:Number(e[i.name]||0)}:e[i.name]}handleError(e,i,a){this.errorService.setError({status:e,title:i,message:a,redirectPath:this.listPagePath})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(S.v),t.Y36(ae),t.Y36(d.qu),t.Y36(Y),t.Y36(P.P),t.Y36(w.T),t.Y36(x.F0),t.Y36(y.Z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-accounts-receivable-balance"]],decls:20,vars:15,consts:[[3,"breadcrumbList"],[1,"mt-6","pt-3","pb-3","px-3","bg-white","shadow","border","border-gray-300"],[1,"pb-3","text-base","font-bold","ng-star-inserted"],[1,"flex","gap-6","mt-3","mb-3"],[1,"w-1/5"],["nameAttrValue","payment_date","idAttrValue","payment-date",1,"w-40",3,"formCtrl","invalid"],["nameAttrValue","payment_date_picker","idAttrValue","payment-date-picker",3,"formCtrl"],[1,"w-1/5","mt-1"],["btnFillColor","text-white bg-success hover:bg-success-hover",3,"buttonDisabled","click"],[3,"event"],[1,"flex","justify-between","mt-4"],["text","\u58f2\u639b\u6b8bCSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3000",3,"export$","fileNamePrefix","resBackSu","statusChange"],[1,"app-table","block","mt-2",3,"params","pageChange"]],template:function(e,i){1&e&&(t._UZ(0,"app-breadcrumb-org",0)(1,"app-toggle-button"),t.TgZ(2,"div",1)(3,"div",2),t._uU(4,"\u96c6\u8a08"),t.qZA(),t.TgZ(5,"form")(6,"div",3)(7,"div",4),t._UZ(8,"app-text-container",5),t.qZA(),t.TgZ(9,"div",4),t._UZ(10,"app-date-term",6),t.qZA(),t.TgZ(11,"div",7)(12,"app-button",8),t.NdJ("click",function(){return i.onClickSubmit()}),t._uU(13," \u96c6\u8a08 "),t.qZA()()()()(),t.TgZ(14,"app-search",9),t.NdJ("event",function(s){return i.filter=s}),t.qZA(),t.TgZ(15,"div",10),t._UZ(16,"div"),t.TgZ(17,"app-export-link",11),t.NdJ("statusChange",function(s){return i.onExportStatusChange(s)}),t.qZA()(),t.TgZ(18,"app-table-with-pagination",12),t.NdJ("pageChange",function(s){return i.pages=s}),t._uU(19," \u58f2\u4e0a\u6b8b\u9ad8\u4e00\u89a7\n"),t.qZA()),2&e&&(t.Q6J("breadcrumbList",t.WLB(12,Va,t.VKq(9,Ja,i.topPagePath),t.DdM(11,Qa))),t.xp6(8),t.Q6J("formCtrl",i.ctrls.payment_date)("invalid",i.formControlStateManager(i.ctrls.payment_date)),t.xp6(2),t.Q6J("formCtrl",i.ctrls.payment_date_picker),t.xp6(2),t.Q6J("buttonDisabled",i.form.invalid),t.xp6(5),t.Q6J("export$",i.export$)("fileNamePrefix",i.fileNamePrefix)("resBackSu",1),t.xp6(1),t.Q6J("params",i.tableParams))},dependencies:[ne.a,ct.i,k.r,st,Et,R.Z,yt.O,Ya],styles:["app-table tfoot tr td:first-child{text-align:left!important}  app-table tfoot tr td{text-align:right!important}"]}),n})(),pathMatch:"full"}]}];let oe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[x.Bz.forChild(ja),x.Bz]}),n})();var et=l(9307),wt=l(4933),Ka=l(9823),$a=l(7088),pt=l(3042),dt=l(2923),It=l(4470),it=l(9104),Pt=l(9434),H=l(3894);let _t=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,oe]}),n})();var se=l(3560),mt=l(855),re=l(3962),ht=l(3415),W=l(5274),kt=l(3183),gt=l(1326),Ga=l(973),le=l(1819),ce=l(4854),z=l(7090);let Ha=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[S.v],imports:[g.ez,et.u,wt.M,Ka.U,$a.t,pt.C,dt.D,It.x,it.u,Pt.H,H.h,_t,se.r,d.UX,mt.W,re.J,ht.x,W.s,kt.F,gt.z,Ga.Y,le.l,ce.C,z.G]}),n})();var Ut=l(7766),Bt=l(3257),ft=l(4787),Nt=l(4560),Wa=l(6843),Rt=l(5773),za=l(8460),J=l(8511);let Xa=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,d.UX,x.Bz,J.Q,H.h,ht.x,W.s]}),n})(),to=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,Rt.i,za.A,At.JX,J.Q,Xa,kt.F]}),n})(),eo=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,to,H.h,d.UX]}),n})();var nt=l(8367);let Mt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,gt.z]}),n})();var io=l(589),Lt=l(3718);let no=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,d.UX,Ut.X,Bt.Z,gt.z,ft.N,mt.W,g.ez,it.u,Nt.Z,Wa.y,_t,H.h,eo,J.Q,nt.a,pt.C,wt.M,It.x,Mt,io.P,Lt.z,et.u,dt.D,z.G,ce.C,kt.F,Pt.H]}),n})();var bt=l(67),ao=l(8187),ue=l(7610);function oo(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-icon",8),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.remove.emit(a.index))}),t.qZA()}}function so(n,o){1&n&&t._UZ(0,"div",9)}let ro=(()=>{class n{constructor(e,i){this.divisionService=e,this.common=i,this.add=new t.vpe,this.remove=new t.vpe,this._DepositDetails=[],this.valueSuggests=[],this.pageConst=D._,this.subscription=new A.w0,this.depositClassficationOption=[{value:"",text:bt.s.PLEASE_SELECT}],this.statusDivisionOptions=[{value:"",text:bt.s.PLEASE_SELECT},{value:1,text:"\u5165\u91d1\u5f85\u3061"},{value:2,text:"\u5165\u91d1\u6e08\u307f"}]}get ctrls(){return this.formGroup.controls}set depositDetail(e){this._DepositDetails=e}ngOnInit(){this.common.loading=!0,this.subscription.add((0,I.D)([this.divisionService.getAsSelectOptions({name:M.z.DEPOSIT_CLASSIFICATION})]).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(e=>(0,b.of)(e))).subscribe(e=>{e[0][M.z.DEPOSIT_CLASSIFICATION].filter(a=>{this.depositClassficationOption.push({value:a.code,text:a.text})}),this.common.loading=!1}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(lt.E),t.Y36(S.v))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-input-pair"]],inputs:{formGroup:"formGroup",index:"index",depositDetail:"depositDetail"},outputs:{add:"add",remove:"remove"},decls:9,vars:11,consts:[["idAttrValue","deposit-detail-division-code","nameAttrValue","deposit_detail_division_code","labelSize","sm",1,"w-1/6",3,"formCtrl","options"],["inputType","number",1,"w-1/6",3,"formCtrl","textRight","idAttrValue"],["nameAttrValue","deposit_date",1,"w-1/6",3,"formCtrl","idAttrValue"],[1,"w-1/3",3,"formCtrl","idAttrValue"],[1,"flex","items-center","gap-4"],["icon","add-line",1,"cursor-pointer","w-6",3,"click"],["icon","delete-bin-line","class","cursor-pointer w-6 fill-red-500",3,"click",4,"ngIf","ngIfElse"],["falseContent",""],["icon","delete-bin-line",1,"cursor-pointer","w-6","fill-red-500",3,"click"],[1,"w-6","width:24px;"]],template:function(e,i){if(1&e&&(t._UZ(0,"app-select-clear-container",0)(1,"app-text-container",1)(2,"app-date-term",2)(3,"app-text-container",3),t.TgZ(4,"div",4)(5,"app-icon",5),t.NdJ("click",function(){return i.add.emit()}),t.qZA(),t.YNc(6,oo,1,0,"app-icon",6),t.YNc(7,so,1,0,"ng-template",null,7,t.W1O),t.qZA()),2&e){const a=t.MAs(8);t.Q6J("formCtrl",i.ctrls.deposit_detail_division_code)("options",i.depositClassficationOption),t.xp6(1),t.MGl("idAttrValue","deposit-detail-",i.index,"-deposit_amount"),t.Q6J("formCtrl",i.ctrls.deposit_amount)("textRight",!0),t.xp6(1),t.MGl("idAttrValue","deposit-detail-",i.index,"-deposit_date"),t.Q6J("formCtrl",i.ctrls.deposit_date),t.xp6(1),t.MGl("idAttrValue","deposit-detail-",i.index,"-remarks"),t.Q6J("formCtrl",i.ctrls.remarks_1),t.xp6(3),t.Q6J("ngIf",i.index)("ngIfElse",a)}},dependencies:[g.O5,yt.O,U.o,ao.a,ue.I],styles:["[_nghost-%COMP%]{margin-bottom:1rem;display:flex;align-items:center;gap:1.5rem}"]}),n})(),lo=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,d.UX,Rt.i,W.s,J.Q,ht.x,ft.N,nt.a,z.G]}),n})();function co(n,o){if(1&n&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t._uU(3),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.billing_amount?"\u5165\u91d1\u4e88\u5b9a\u984d\uff1a"+e.billing_amount.toLocaleString():"",""),t.xp6(2),t.hij(" ",e.balance?"\u6b8b\u9ad8\uff1a"+e.balance.toLocaleString():""," ")}}function uo(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-icon",11),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.remove.emit(a.index))}),t.qZA()}}function po(n,o){1&n&&t._UZ(0,"div",12)}t.B6R(zt,[g.sg,d.JL,d.sg,ro],[]);let _o=(()=>{class n{constructor(e,i,a,s,r,c){this.clientService=e,this.divisionService=i,this.common=a,this.billService=s,this.message=r,this.accountsReceivableAggregateService=c,this.add=new t.vpe,this.remove=new t.vpe,this.pageTitle="\u5165\u91d1\u65b0\u898f\u767b\u9332",this.pageConst=D._,this.loading=!1,this.subscription=new A.w0,this.statusDivisionOptions=[{value:"",text:bt.s.PLEASE_SELECT},{value:1,text:"\u5165\u91d1\u5f85\u3061"},{value:2,text:"\u5165\u91d1\u6e08\u307f"}],this.depositClassficationOption=[{value:"",text:bt.s.PLEASE_SELECT}],this.selectedValue={value:0,text:""}}get ctrls(){return this.formGroup.controls}ngOnInit(){this.subscription.add((0,I.D)([this.clientService.getAsSelectOptions(),this.divisionService.getAsSelectOptions({name:M.z.DEPOSIT_CLASSIFICATION}),this.divisionService.getAsSelectOptions({name:M.z.TERM_OF_PAYMENT})]).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(e=>(0,b.of)(e))).subscribe(e=>{this.clientSuggests=e[0],e[1][M.z.DEPOSIT_CLASSIFICATION].filter(a=>{this.depositClassficationOption.push({value:a.code,text:a.text})}),this.divisios=e[2][M.z.TERM_OF_PAYMENT],this.ctrls.deposit_client_id.valueChanges.subscribe(a=>{a&&(this.getClientById(a),this.getClientPaymentData(a))})}))}getClientPaymentData(e){this.message.messege||alert("\u5165\u91d1\u65e5\u306f\u5fc5\u9808\u9805\u76ee\u3067\u3059"),this.loading=!0,this.subscription.add((0,I.D)([this.clientService.find(Number(e))]).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(i=>(0,b.of)(i))).subscribe(i=>{const a=i[0].data[0];this.divisios.find(m=>m.value===a.payment_term);let r=a.payment_term,c=new Date(this.message.messege);c.setMonth(c.getMonth()-this.getPaymentDate(r)),c.setDate(1);let u=c.toLocaleDateString(),_=new Date(c.getFullYear(),c.getMonth()+1,0).toLocaleDateString();this.subscription.add(this.accountsReceivableAggregateService.getAll({client_id:a.id,from_payment_due_date:u,to_payment_due_date:_}).pipe((0,f.x)(()=>this.common.loading=!1),(0,h.K)(m=>(0,b.of)(m))).subscribe(m=>{m.data[0]&&(this.billing_amount=m.data[0].billing_amount.toLocaleString()),m.data[0]&&(this.balance=m.data[0].balance.toLocaleString())}))}))}getPaymentDate(e){switch(e){case 60:return 1;case 61:return 2;case 124:return 3;default:return 0}}setDaySuffix(e){if(!e)return"";switch(e){case 98:return"\u7121\u3057";case 99:return"\u672b\u65e5";default:return e}}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getClientById(e){this.clientSuggests.find(i=>{Number(i.value)===Number(e)&&(this.selectedValue.text=i.text,this.selectedValue.value=Number(i.value),this.ctrls.deposit_client_name.patchValue(this.selectedValue))})}clientChange(e){this.ctrls.deposit_client_id.patchValue(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(q.y),t.Y36(lt.E),t.Y36(S.v),t.Y36(Dt),t.Y36(ee),t.Y36(Y))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-input-pair"]],inputs:{formGroup:"formGroup",index:"index",deposit_date:"deposit_date"},outputs:{add:"add",remove:"remove"},decls:12,vars:16,consts:[[1,"w-40",3,"formCtrl","idAttrValue"],["idAttrValue","deposit-client-name","nameAttrValue","deposit_client_name","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",1,"w-52",3,"formCtrl","suggests","invalid","idValueChanges"],["idAttrValue","deposit-detail-division-code","nameAttrValue","deposit_detail_division_code","labelSize","sm",1,"w-40",3,"formCtrl","options"],["inputType","number",1,"w-40",3,"textRight","formCtrl","idAttrValue"],[1,"w-40"],[4,"ngIf"],[1,"w-52",3,"formCtrl","idAttrValue","invalid"],[1,"flex","items-center","gap-4"],["icon","add-line",1,"cursor-pointer","w-6",3,"click"],["icon","delete-bin-line","class","cursor-pointer w-6 fill-red-500",3,"click",4,"ngIf","ngIfElse"],["falseContent",""],["icon","delete-bin-line",1,"cursor-pointer","w-6","fill-red-500",3,"click"],[1,"w-6","width:24px;"]],template:function(e,i){if(1&e&&(t._UZ(0,"app-text-container",0),t.TgZ(1,"app-select-suggest-container",1),t.NdJ("idValueChanges",function(s){return i.clientChange(s)}),t.qZA(),t._UZ(2,"app-select-clear-container",2)(3,"app-text-container",3),t.TgZ(4,"div",4),t.YNc(5,co,4,2,"ng-container",5),t.qZA(),t._UZ(6,"app-text-container",6),t.TgZ(7,"div",7)(8,"app-icon",8),t.NdJ("click",function(){return i.add.emit()}),t.qZA(),t.YNc(9,uo,1,0,"app-icon",9),t.YNc(10,po,1,0,"ng-template",null,10,t.W1O),t.qZA()),2&e){const a=t.MAs(11);t.MGl("idAttrValue","deposit-detail-",i.index,"-deposit_client_id"),t.Q6J("formCtrl",i.ctrls.deposit_client_id),t.xp6(1),t.Q6J("formCtrl",i.ctrls.deposit_client_name)("suggests",i.clientSuggests)("invalid",i.formControlStateManager(i.ctrls.deposit_client_name)),t.xp6(1),t.Q6J("formCtrl",i.ctrls.deposit_detail_division_code)("options",i.depositClassficationOption),t.xp6(1),t.MGl("idAttrValue","deposit-detail-",i.index,"-deposit_amount"),t.Q6J("textRight",!0)("formCtrl",i.ctrls.deposit_amount),t.xp6(2),t.Q6J("ngIf",i.loading),t.xp6(1),t.MGl("idAttrValue","deposit-detail-",i.index,"-remarks"),t.Q6J("formCtrl",i.ctrls.remarks_1)("invalid",i.formControlStateManager(i.ctrls.remarks_1)),t.xp6(3),t.Q6J("ngIf",i.index)("ngIfElse",a)}},dependencies:[g.O5,yt.O,U.o,ue.I,K.X],styles:["[_nghost-%COMP%]{margin-bottom:1rem;display:flex;align-items:center;gap:1.5rem}"]}),n})(),mo=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,d.UX,Rt.i,W.s,J.Q,ht.x,ft.N,nt.a,z.G]}),n})();t.B6R(ie,[g.sg,d.JL,d.sg,_o],[]);let ho=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[S.v],imports:[g.ez,lo,mo,d.UX,Ut.X,Bt.Z,gt.z,ft.N,mt.W,se.r,g.ez,it.u,Nt.Z,H.h,_t,J.Q,nt.a,pt.C,re.J,wt.M,Mt,W.s,le.l,Lt.z,et.u,dt.D,Pt.H,z.G,It.x]}),n})(),go=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,Ut.X,Bt.Z,mt.W,g.ez,it.u,Nt.Z,H.h,_t,J.Q,nt.a,pt.C,Mt,Lt.z,et.u,dt.D,z.G,W.s]}),n})(),fo=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[S.v],imports:[g.ez,oe,Ha,no,ho,go,et.u,it.u]}),n})()}}]);