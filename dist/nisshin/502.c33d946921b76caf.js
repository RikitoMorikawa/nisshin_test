"use strict";(self.webpackChunknisshin=self.webpackChunknisshin||[]).push([[502],{9502:(tt,q,d)=>{d.r(q),d.d(q,{PurchaseOrderModule:()=>Ln});var Z=d(6895),p=d(4006),E=d(1690),U=d(727),N=d(5698),S=d(9300),y=d(8037),_=d(6585),t=d(1571),F=d(1609),P=d(2334),R=d(8832),bt=d(2125);let Et=(()=>{class i{constructor(e,r,n,o){this.modalService=e,this.errorService=r,this.router=n,this.common=o,this.subscription=new U.w0,this.isLoading=!1}ngOnInit(){this.subscription.add(this.errorService.getError().subscribe(e=>{this.handleError(e)})),this.subscription.add(this.common.loading$.subscribe(e=>{setTimeout(()=>this.isLoading=e)}))}ngOnDestroy(){this.subscription.unsubscribe()}handleError(e){e.redirectPath&&(this.redirectPath=e.redirectPath),this.modalService.setModal(e.title,0===e.status?e.message+y.c.GUIDANCE_OF_SUPPORT:`\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9: ${e.status} \n\u30e1\u30c3\u30bb\u30fc\u30b8: `+e.message+y.c.GUIDANCE_OF_SUPPORT,"danger",_.yR.BUTTON_TITLE.CLOSE,""),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,S.h)(n=>this.modalService.getModalProperties().title===e.title)).subscribe(n=>{this.redirectPath&&this.router.navigateByUrl(this.redirectPath)}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(F.Z),t.Y36(P.T),t.Y36(E.F0),t.Y36(R.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-purchase-order"]],decls:2,vars:1,consts:[[3,"isLoading"]],template:function(e,r){1&e&&t._UZ(0,"router-outlet")(1,"app-loading-container",0),2&e&&(t.xp6(1),t.Q6J("isLoading",r.isLoading))},dependencies:[E.lC,bt.o]}),i})();var et=d(7579),V=d(7030),Ot=d(3360),A=d(529),Dt=d(8505),rt=d(3900),f=d(262),T=d(9646),x=d(8746);const b={FAILED_CHOICES_FOR_NARROWING_DOWN:"\u7d5e\u308a\u8fbc\u307f\u7528\u9078\u629e\u80a2\u304c\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002",ERROR:{CANNOT_BE_DELETED:"\u3053\u306e\u30c7\u30fc\u30bf\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3002",ATTEMPTED_TO_MODIFY_SUBMITTED_DATA_CHANGE:"\u9001\u4fe1\u6e08\u307f\u306e\u767a\u6ce8\u66f8\u3092\u524a\u9664\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u305f\u3081\u51e6\u7406\u3092\u5b9f\u884c\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002"},STATUS_CODE:{DRAFT:0,CANCEL:1,SENT:2},STATUS:{DRAFT:"\u4e0b\u66f8\u304d",CANCEL:"\u53d6\u308a\u6d88\u3057",SENT:"\u9001\u4fe1\u6e08\u307f"},UNIT_CATEGORY:{CODE:{SMALL:1,MEDIUM:2,LARGE:3},VALUE:{SMALL:"\u30d0\u30e9",MEDIUM:"\u5c0f\u5206\u3051",LARGE:"\u30b1\u30fc\u30b9"}}};var St=d(1751),_t=d(2340);let J=(()=>{class i extends St.O{constructor(){super(...arguments),this.endpoint=_t.pU.purchaseOrderApi.endpoint,this.issueEndpoint=_t.pU.purchaseOrderIssueReceptionSlipApi.endpoint}getAll(e={}){return this.httpOptions.params=e,this.http.get(this.endpoint,this.httpOptions).pipe((0,f.K)(this.setErrorMessage("\u767a\u6ce8\u66f8\u4e00\u89a7\u306e\u53d6\u5f97")))}find(e){return this.http.get(`${this.endpoint}/${e}`).pipe((0,f.K)(this.setErrorMessage("\u767a\u6ce8\u66f8\u306e\u53d6\u5f97")))}add(e){const r=this.generateFormData(e);return this.http.post(this.endpoint,r).pipe((0,f.K)(this.setErrorMessage("\u767a\u6ce8\u66f8\u306e\u767b\u9332")))}put(e){console.log(e);const r=this.generateFormData(e),n=new FormData;return n.append("from_date_of_sale",e.from_date_of_sale),n.append("to_date_of_sale",e.to_date_of_sale),console.log(n.get("from_date_of_sale")),console.log(n.get("to_date_of_sale")),console.log(r.get("from_date_of_sale")),console.log(r.get("to_date_of_sale")),this.http.put(this.endpoint,n)}update(e,r){const n=this.generateFormData(r);return this.http.patch(`${this.endpoint}/${e}`,n).pipe((0,f.K)(this.setErrorMessage("\u767a\u6ce8\u66f8\u306e\u66f4\u65b0")))}remove(e){return this.http.delete(`${this.endpoint}/${e}`).pipe((0,f.K)(this.setErrorMessage("\u767a\u6ce8\u66f8\u306e\u524a\u9664")))}listremove(e){return this.http.delete(`${this.endpoint}/?delete_id=${e}`).pipe((0,f.K)(this.setErrorMessage("\u767a\u6ce8\u66f8\u306e\u524a\u9664")))}createPdf(e){return console.log(this.issueEndpoint),this.http.get(`${this.issueEndpoint}/${e}`).pipe((0,f.K)(this.setErrorMessage("\u767a\u6ce8\u66f8PDF\u306e\u4f5c\u6210")))}}return i.\u0275fac=function(){let s;return function(r){return(s||(s=t.n5z(i)))(r||i)}}(),i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var G=d(8782),Zt=d(2640),B=d(5146);let It=(()=>{class i{constructor(e,r,n,o,a){this.poService=e,this.common=r,this.modalService=n,this.router=o,this.flashMessageService=a,this.subscription=new U.w0,this.errorEvent=new t.vpe,this.items=[],this.listItem=[],this.cancelModalTitle="\u767a\u6ce8\u66f8\u524a\u9664\u30ad\u30e3\u30f3\u30bb\u30eb\uff1a"+_.yR.TITLE.CANCEL,this.errorModalTitle="\u767a\u6ce8\u66f8\u524a\u9664\u30ad\u30e3\u30f3\u30bb\u30eb\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.filter={},this.pages={page:1,itemsPerPage:10,sort:{column:"\u767a\u6ce8\u66f8No",order:"desc"}},this.tableParams=new et.x,this.tableNameMapping=[{name:"id",name_jp:"\u9078\u629e"},{name:"id",name_jp:"\u767a\u6ce8\u66f8No"},{name:"order_date",name_jp:"\u767a\u6ce8\u65e5"},{name:"preferred_delivery_date",name_jp:"\u5e0c\u671b\u7d0d\u5165\u65e5"},{name:"supplier_name",name_jp:"\u4ed5\u5165\u5148\u540d"},{name:"employee_order_first_name",name_jp:"\u767a\u6ce8\u62c5\u5f53\u8005"},{name:"purchase_order_status_division_id",name_jp:"\u30b9\u30c6\u30fc\u30bf\u30b9"}],this.deleteList=new p.cw({idlist:new p.NI("",[p.kI.required])}),this.list_string="",this.button_status=!0}ngOnInit(){this.button_status=!0,this.loadTableData(!1),this.resetSelectItems()}loadTableData(e){this.subscribeEventListener(e),this.eventListener.next(this.pages)}subscribeEventListener(e){this.subscription?.unsubscribe(),this.subscription=this.eventListener.pipe((0,Dt.b)(()=>this.common.loading=!0),(0,rt.w)(r=>this.poService.getAll(this.createApiParams(r))),(0,f.K)(r=>(0,T.of)(r)),(0,x.x)(()=>this.common.loading=!1)).subscribe({next:r=>{this.common.loading=!1,r instanceof A.UA?this.handleError(r.status,"\u767a\u6ce8\u66f8\u4e00\u89a7\uff1a"+_.yR.TITLE.HAS_ERROR,r.error.message):this.tableParams.next(this.createTableParams(r,e))},complete:()=>this.subscribeEventListener(e)})}createApiParams(e){this.isTableWithPaginationEvent(e)?this.pages=e:(this.filter=e,this.pages.page=1);const r=this.tableNameMapping.find(n=>n.name_jp===this.pages.sort.column)?.name;return{...this.filter,limit:this.pages.itemsPerPage,offset:(this.pages.page-1)*this.pages.itemsPerPage,sort:r?`${r}:${this.pages.sort.order}`:""}}isTableWithPaginationEvent(e){const{page:r,itemsPerPage:n,sort:o}=e;return"number"==typeof r&&"number"==typeof n&&"object"==typeof o}handleError(e,r,n){this.errorEvent.emit({status:e,title:r,message:n})}createTableParams(e,r){const n=this.tableNameMapping.map(a=>a.name_jp),o=e.data.map(a=>this.tableNameMapping.map(u=>a[u.name]));return this.listItem=this.deleteList.get("idlist"),this.selectitems=this.listItem.value,null!=this.selectitems&&(this.selectLists=this.selectitems?.split(",")),o.forEach((a,u)=>{let l=-1;const m=!0===r;l=n.indexOf("\u767a\u6ce8\u66f8No");let g=a[l]?.toLocaleString();this.selectLists.includes(g),l=n.indexOf("\u9078\u629e"),e.data[u].purchase_order_status_code===b.STATUS_CODE.SENT?a[l]="":(a[l]={checkbox:!0,name:"checkbox",value:a[l]+"",selected:m},!0===r&&this.selectcheck(a[l])),l=n.indexOf("\u767a\u6ce8\u66f8No"),a[l]={href:`./detail/${a[l]}`,text:a[l]+""},l=n.indexOf("\u767a\u6ce8\u65e5"),a[l]=""===a[l]||"NaT"===a[l]?"":new Date(a[l]).toLocaleDateString(),l=n.indexOf("\u5e0c\u671b\u7d0d\u5165\u65e5"),a[l]=""===a[l]||"NaT"===a[l]?"":new Date(a[l]).toLocaleDateString(),l=n.indexOf("\u767a\u6ce8\u62c5\u5f53\u8005");let v="";e.data[u].employee_order_first_name&&(v=e.data[u].employee_order_first_name),a[l]={dummy_flg:!0,text:String(v)+"",dummy:e.data[u].employee_order_last_name+"\u3000"+e.data[u].employee_order_first_name},l=n.indexOf("\u30b9\u30c6\u30fc\u30bf\u30b9"),a[l]=String(e.data[u].purchase_order_status_value)}),{total:e.totalItems,header:n,body:o}}selectItemList(e){let r=this.items.indexOf(e);-1===r?this.items.push(e):this.items.splice(r,1),this.items.length>0?(this.list_string=this.items.join(","),this.button_status=!1):this.button_status=!0,this.deleteList.setValue({idlist:this.list_string}),this.selectitems=this.list_string}onSubmit(){alert(JSON.stringify(this.deleteList.value))}allSelectItems(){this.resetSelectItems(),this.loadTableData(!0)}selectcheck(e){this.selectItemList(e.value)}reset(){this.ngOnDestroy(),this.ngOnInit()}ngOnDestroy(){this.subscription.unsubscribe()}resetSelectItems(){this.selectitems="",this.listItem=[],this.list_string="",this.items=[],this.deleteList.setValue({idlist:""})}handleClickDelete(){if(this.isSent)return void this.handleError(422,b.ERROR.CANNOT_BE_DELETED,b.ERROR.ATTEMPTED_TO_MODIFY_SUBMITTED_DATA_CHANGE);const e="\u767a\u6ce8\u66f8"+_.yR.TITLE.DELETE;this.modalService.setModal(e,_.yR.BODY.DELETE,"danger",_.yR.BUTTON_TITLE.DELETE,_.yR.BUTTON_TITLE.CANCEL),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,S.h)(n=>this.modalService.getModalProperties().title===e)).subscribe(n=>{n===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&(this.common.loading=!0,this.poService.listremove(this.list_string).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(o=>(0,T.of)(o))).subscribe(o=>{o instanceof A.UA?this.handleError(o.status,o.error.title,o.message):(this.flashMessageService.setFlashMessage(o.message,"success",15e3),this.resetSelectItems(),this.ngOnDestroy(),this.ngOnInit(),this.router.navigateByUrl("purchase-order"))}))}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(J),t.Y36(R.v),t.Y36(F.Z),t.Y36(E.F0),t.Y36(G.P))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-table"]],inputs:{eventListener:"eventListener"},outputs:{errorEvent:"errorEvent"},decls:16,vars:5,consts:[[3,"params","loading","pageChange","checkItem"],[1,"flex"],[1,"mt-1","mb-1"],["btnType","button","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"click"],[3,"formGroup","ngSubmit"],["type","text","formControlName","idlist",2,"display","none"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["btnType","button","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled","click"]],template:function(e,r){1&e&&(t.TgZ(0,"app-table-with-pagination",0),t.NdJ("pageChange",function(o){return r.eventListener.next(o)})("checkItem",function(o){return r.selectItemList(o)}),t._uU(1," \u767a\u6ce8\u66f8\u4e00\u89a7 "),t.TgZ(2,"div",1)(3,"div",2)(4,"app-button",3),t.NdJ("click",function(){return r.allSelectItems()}),t._uU(5,"\u5168\u9078\u629e"),t.qZA()(),t._uU(6," \xa0\xa0 "),t.TgZ(7,"div",2)(8,"form",4),t.NdJ("ngSubmit",function(){return r.handleClickDelete()}),t._UZ(9,"input",5),t.TgZ(10,"app-button",6),t._uU(11,"\u9078\u629e\u524a\u9664"),t.qZA()()(),t._uU(12," \xa0\xa0 "),t.TgZ(13,"div",2)(14,"app-button",7),t.NdJ("click",function(){return r.reset()}),t._uU(15,"\u9078\u629e\u89e3\u9664"),t.qZA()()()()),2&e&&(t.Q6J("params",r.tableParams)("loading",r.common.loading),t.xp6(8),t.Q6J("formGroup",r.deleteList),t.xp6(2),t.Q6J("buttonDisabled",r.button_status),t.xp6(4),t.Q6J("buttonDisabled",r.button_status))},dependencies:[Zt.i,p._Y,p.Fj,p.JJ,p.JL,p.sg,p.u,B.r]}),i})();var Y=d(4128),it=d(67),ct=d(3605),H=d(5450),D=d(9042),nt=d(4562),$=d(4416),Q=d(6232),yt=d(3761),Ft=d(6502),ot=d(7540),Ut=d(3148),Nt=d(7610);function qt(i,s){1&i&&t.GkF(0,21)}function Rt(i,s){1&i&&t.GkF(0,21)}function Mt(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"app-button",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.handleClickSubmitButton())}),t._uU(1," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA()}}function Lt(i,s){1&i&&(t.TgZ(0,"app-button",23),t._uU(1," \u7d5e\u308a\u8fbc\u307f\u5b9f\u884c "),t.qZA())}function Pt(i,s){if(1&i&&(t.TgZ(0,"p",24),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.DATE_TERM_TO_BEFORE_FROM," ")}}let Bt=(()=>{class i{constructor(e,r,n,o){this.fb=e,this.supplierService=r,this.employeeService=n,this.divisionService=o,this.subscription=new U.w0,this.searchEvent=new t.vpe,this.errorEvent=new t.vpe,this.hasPanelOpened=!1,this.rotateAnimation="",this.errorConst=y.c,this.form=this.fb.group({id:"",order_date:this.fb.group({from:"",to:""},{validators:[H.d.beforeFromDate()]}),preferred_delivery_date:this.fb.group({from:"",to:""},{validators:[H.d.beforeFromDate()]}),store_id:"",supplier_id:"",order_employee_id:"",purchase_order_status_division_id:""})}get ctrls(){return this.form.controls}ngOnInit(){this.initialization()}ngOnDestroy(){this.subscription.unsubscribe()}initialization(){this.subscription.add((0,Y.D)([this.supplierService.getAsSelectOptions(),this.employeeService.getAsSelectOptions(),this.divisionService.getAsSelectOptions({name:D.z.PURCHASE_ORDER_STATUS})]).pipe((0,f.K)(e=>(e.emit(e),(0,T.of)(e.error)))).subscribe(e=>{e instanceof A.UA?this.handleError(e.status,e.message):null!=e&&3===e.length?(this.supplierSuggests=e[0],this.employeeSuggests=e[1],this.statusOptions=[{value:"",text:it.s.PLEASE_SELECT}].concat(e[2][D.z.PURCHASE_ORDER_STATUS])):this.handleError(400,_.yR.BODY.HAS_ERROR)}))}invalid(e){return(e.touched||e.dirty)&&e.invalid}panelOpenButtonOnClick(){this.hasPanelOpened?(this.hasPanelOpened=!1,this.rotateAnimation="rotate-animation-0"):(this.hasPanelOpened=!0,this.rotateAnimation="rotate-animation-180")}handleClickClearButton(){Object.values(this.ctrls).forEach(e=>{e instanceof p.cw?Object.values(e.controls).forEach(r=>{r.patchValue("")}):e.patchValue("")})}handleClickSubmitButton(){const r=ct.v.flattingFormValue(this.form.value);this.searchEvent.emit(ct.v.removeNullsAndBlanks(r))}handleError(e,r){this.errorEvent.emit({status:e,title:"\u767a\u6ce8\u66f8\u4e00\u89a7\u7d5e\u308a\u8fbc\u307f\uff1a"+_.yR.TITLE.HAS_ERROR,message:r})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(p.qu),t.Y36(nt.p),t.Y36($.G),t.Y36(Q.E))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-search"]],outputs:{searchEvent:"searchEvent",errorEvent:"errorEvent"},decls:40,vars:26,consts:[[1,"mt-8","mb-4"],[3,"click"],["icon","filter-2-line",1,"w-6"],[1,"inline-block","ml-1","mr-2"],["icon","arrow-down-s-fill",1,"w-6"],[1,"mb-6"],[1,"purchase-order-search","width-limit-break","bg-white",3,"ngClass"],[1,"w-[1280px]","mx-auto","px-4",3,"ngSubmit"],[1,"flex","gap-6","mb-6"],[1,"w-1/5",3,"formCtrl"],[1,"w-2/5"],["nameAttrValue","order_employee_id","idAttrValue","order-employee-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],["nameAttrValue","supplier_id","idAttrValue","supplier-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[3,"dateFromFormCtrl","dateToFormCtrl","invalid"],["message","",4,"ngIf","ngIfThen"],["nameAttrValue","purchase_order_status_division_id","idAttrValue","purchase-order-status-division-id",1,"grow",3,"formCtrl","options","invalid"],[1,"flex","gap-8","mt-10"],["btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"click",4,"ngIf","ngIfElse"],[1,"mt-2","text-sm","text-red"],["disable",""],["beforeFromDate",""],["message",""],["btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"click"],["btnFillColor","text-white bg-slate-300 hover:bg-slate-300"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,r){if(1&e&&(t.TgZ(0,"div",0)(1,"app-button",1),t.NdJ("click",function(){return r.panelOpenButtonOnClick()}),t._UZ(2,"app-icon",2),t.TgZ(3,"span",3),t._uU(4),t.qZA(),t._UZ(5,"app-icon",4),t.qZA()(),t.TgZ(6,"div",5)(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return r.handleClickSubmitButton()}),t.TgZ(9,"div",8)(10,"app-text-clear-container",9),t._uU(11,"\u767a\u6ce8\u66f8No"),t.qZA(),t.TgZ(12,"div",10)(13,"app-select-suggest-container",11),t._uU(14," \u767a\u6ce8\u62c5\u5f53\u8005 "),t.qZA()(),t.TgZ(15,"div",10)(16,"app-select-suggest-container",12),t._uU(17," \u4ed5\u5165\u5148 "),t.qZA()()(),t.TgZ(18,"div",8)(19,"app-date-term-clear-container",13)(20,"span"),t._uU(21,"\u767a\u6ce8\u65e5"),t.qZA(),t.YNc(22,qt,1,0,"ng-container",14),t.qZA(),t.TgZ(23,"app-date-term-clear-container",13)(24,"span"),t._uU(25,"\u5e0c\u671b\u7d0d\u5165\u65e5"),t.qZA(),t.YNc(26,Rt,1,0,"ng-container",14),t.qZA(),t.TgZ(27,"app-select-clear-container",15)(28,"span"),t._uU(29,"\u30b9\u30c6\u30fc\u30bf\u30b9"),t.qZA()()(),t.TgZ(30,"div",16)(31,"app-button",1),t.NdJ("click",function(){return r.handleClickClearButton()}),t._uU(32," \u5165\u529b\u5185\u5bb9\u30af\u30ea\u30a2 "),t.qZA(),t.YNc(33,Mt,2,0,"app-button",17),t.qZA(),t.TgZ(34,"p",18),t._uU(35," \u203b \u5165\u529b\u5185\u5bb9\u3092\u30af\u30ea\u30a2\u3057\u305f\u5f8c\u306b\u7d5e\u308a\u8fbc\u307f\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002 "),t.qZA()()()(),t.YNc(36,Lt,2,0,"ng-template",null,19,t.W1O),t.YNc(38,Pt,2,1,"ng-template",null,20,t.W1O)),2&e){const n=t.MAs(37),o=t.MAs(39);t.xp6(4),t.hij(" ",r.hasPanelOpened?"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u975e\u8868\u793a":"\u7d5e\u308a\u8fbc\u307f\u30d5\u30a9\u30fc\u30e0\u8868\u793a"," "),t.xp6(1),t.Tol(r.rotateAnimation),t.xp6(2),t.Q6J("ngClass",r.hasPanelOpened?"is-open shadow":""),t.xp6(3),t.Q6J("formCtrl",r.ctrls.id),t.xp6(3),t.Q6J("formCtrl",r.ctrls.order_employee_id)("suggests",r.employeeSuggests)("invalid",r.invalid(r.ctrls.order_employee_id)),t.xp6(3),t.Q6J("formCtrl",r.ctrls.supplier_id)("suggests",r.supplierSuggests)("invalid",r.invalid(r.ctrls.supplier_id)),t.xp6(3),t.Q6J("dateFromFormCtrl",r.ctrls.order_date.controls.from)("dateToFormCtrl",r.ctrls.order_date.controls.to)("invalid",!!r.ctrls.order_date.errors),t.xp6(3),t.Q6J("ngIf",null==r.ctrls.order_date.errors?null:r.ctrls.order_date.errors.beforeFromDate)("ngIfThen",o),t.xp6(1),t.Q6J("dateFromFormCtrl",r.ctrls.preferred_delivery_date.controls.from)("dateToFormCtrl",r.ctrls.preferred_delivery_date.controls.to)("invalid",!!r.ctrls.preferred_delivery_date.errors),t.xp6(3),t.Q6J("ngIf",null==r.ctrls.preferred_delivery_date.errors?null:r.ctrls.preferred_delivery_date.errors.beforeFromDate)("ngIfThen",o),t.xp6(1),t.Q6J("formCtrl",r.ctrls.purchase_order_status_division_id)("options",r.statusOptions)("invalid",r.invalid(r.ctrls.purchase_order_status_division_id)),t.xp6(6),t.Q6J("ngIf",r.form.valid)("ngIfElse",n)}},dependencies:[Z.mk,Z.O5,p._Y,p.JL,B.r,yt.o,Ft.P,ot.X,Ut.w,Nt.I],styles:[".purchase-order-search[_ngcontent-%COMP%]{max-height:0;padding:0 2.5rem;margin:0;transition:max-height .8s,padding .8s,margin .8s ease-in;overflow:hidden}.purchase-order-search.is-open[_ngcontent-%COMP%]{max-height:100vh;padding:2.5rem;margin:2rem 0}"]}),i})();const Yt=function(){return{text:"\u767a\u6ce8\u66f8\u4e00\u89a7"}},kt=function(i){return[i]},st=function(){return{exact:!0}};let Vt=(()=>{class i{constructor(e,r){this.errorService=e,this.router=r,this.parentSearchEvent=new et.x,this.parentTableEvent=new et.x,this.subscription=new U.w0}ngOnInit(){this.subscription.add(this.parentSearchEvent.subscribe(e=>{this.parentTableEvent.next(e)}))}ngOnDestroy(){this.subscription.unsubscribe()}handleError(e){this.errorService.setError({status:e.status,title:e.title,message:e.message})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(P.T),t.Y36(E.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-list"]],decls:15,vars:11,consts:[[3,"breadcrumbList"],[1,"mt-6","mb-12"],["routerLink","/purchase-order/order-data-creation","routerLinkActive","active",3,"routerLinkActiveOptions"],["routerLink","/purchase-order","routerLinkActive","active",3,"routerLinkActiveOptions"],["routerLink","/purchase-order/specification","routerLinkActive","active",3,"routerLinkActiveOptions"],[3,"searchEvent","errorEvent"],[1,"flex","items-center","justify-end","my-2"],[1,"mr-8"],["path","/purchase-order/add"],[3,"eventListener","errorEvent"]],template:function(e,r){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"div",1)(2,"button",2),t._uU(3," \u767a\u6ce8\u30c7\u30fc\u30bf\u4f5c\u6210 "),t.qZA(),t.TgZ(4,"button",3),t._uU(5," \u767a\u6ce8\u66f8\u4e00\u89a7 "),t.qZA(),t.TgZ(6,"button",4),t._uU(7," \u767a\u6ce8\u500b\u7968\u4e00\u89a7 "),t.qZA()(),t.TgZ(8,"app-search",5),t.NdJ("searchEvent",function(o){return r.parentSearchEvent.next(o)})("errorEvent",function(o){return r.handleError(o)}),t.qZA(),t.TgZ(9,"main")(10,"div",6)(11,"div",7),t._UZ(12,"app-new-registration-link-org",8),t.qZA()(),t.TgZ(13,"div")(14,"app-table",9),t.NdJ("errorEvent",function(o){return r.handleError(o)}),t.qZA()()()),2&e&&(t.Q6J("breadcrumbList",t.VKq(6,kt,t.DdM(5,Yt))),t.xp6(2),t.Q6J("routerLinkActiveOptions",t.DdM(8,st)),t.xp6(2),t.Q6J("routerLinkActiveOptions",t.DdM(9,st)),t.xp6(2),t.Q6J("routerLinkActiveOptions",t.DdM(10,st)),t.xp6(8),t.Q6J("eventListener",r.parentTableEvent))},dependencies:[E.rH,E.Od,V.Z,Ot.S,It,Bt],styles:["button[_ngcontent-%COMP%]{border-width:1px;--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity));padding:.25rem 1rem}button[_ngcontent-%COMP%]:first-child{border-top-left-radius:.25rem;border-bottom-left-radius:.25rem}button[_ngcontent-%COMP%]:last-child{border-top-right-radius:.25rem;border-bottom-right-radius:.25rem}.active[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}"]}),i})();var pt=d(4870),M=d(349),X=d(1269),at=d(2e3),ut=d(6082),w=d(1805),mt=d(1451),z=d(387),dt=d(8187),gt=d(2195),ht=d(9612);function Jt(i,s){1&i&&t.GkF(0)}function Gt(i,s){1&i&&t.GkF(0,34)}function Qt(i,s){1&i&&t.GkF(0)}function wt(i,s){1&i&&t.GkF(0,34)}function Kt(i,s){1&i&&t.GkF(0)}function jt(i,s){1&i&&t.GkF(0,34)}function Ht(i,s){1&i&&t.GkF(0)}function $t(i,s){1&i&&t.GkF(0)}const k=function(i){return{ctrl:i}};function Xt(i,s){if(1&i&&(t.TgZ(0,"div",34),t.YNc(1,$t,1,0,"ng-container",14),t.qZA()),2&i){const e=t.oxw(),r=t.MAs(52);t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(2,k,e.ctrls.dateGroup.controls.order_date))}}function zt(i,s){1&i&&t.GkF(0)}function Wt(i,s){1&i&&t.GkF(0)}function te(i,s){if(1&i&&(t.TgZ(0,"div",34),t.YNc(1,Wt,1,0,"ng-container",14),t.qZA()),2&i){const e=t.oxw(),r=t.MAs(52);t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(2,k,e.ctrls.dateGroup.controls.preferred_delivery_date))}}function ee(i,s){1&i&&t.GkF(0)}function re(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"app-button",35),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addCustomerOrderForm())}),t._uU(1,"\u5546\u54c1\u8ffd\u52a0"),t.qZA()}}function ie(i,s){1&i&&t.GkF(0)}const ne=function(){return{label:"\u5546\u54c1\u756a\u53f7",required:!1}};function oe(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",54)(2,"app-real-time-suggest-container",55),t.NdJ("selectedData",function(n){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.handleSelectedProductData(o,n))}),t.YNc(3,ie,1,0,"ng-container",14),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw().$implicit,r=t.oxw(2),n=t.MAs(50);t.xp6(2),t.Q6J("idCtrl",r.getFormControlTypeValue(e,"product_id"))("nameCtrl",r.getFormControlTypeValue(e,"product_id"))("apiInput",r.getProductIdSuggests(e))("invalid",r.formControlStateManager(r.getFormControlTypeValue(e,"product_id"))),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(6,ne))}}function se(i,s){1&i&&t.GkF(0)}const ae=function(){return{label:"\u54c1\u540d\u3092\u5546\u54c1\u30de\u30b9\u30bf\u304b\u3089\u9078\u629e",required:!0}};function ue(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",46)(1,"app-real-time-suggest-container",56),t.NdJ("selectedData",function(n){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.handleSelectedProductData(o,n))}),t.YNc(2,se,1,0,"ng-container",14),t.qZA()()}if(2&i){const e=t.oxw().$implicit,r=t.oxw(2),n=t.MAs(50);t.xp6(1),t.Q6J("idCtrl",r.getFormControlTypeValue(e,"product_id"))("nameCtrl",r.getFormControlTypeValue(e,"product_name"))("apiInput",r.getProductSuggests(e))("invalid",r.formControlStateManager(r.getFormControlTypeValue(e,"product_name"))),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(6,ae))}}function de(i,s){1&i&&t.GkF(0)}function le(i,s){1&i&&t.GkF(0,34)}function _e(i,s){1&i&&t.GkF(0)}function ce(i,s){1&i&&t.GkF(0,34)}function pe(i,s){1&i&&t.GkF(0)}const me=function(){return{label:"\u5358\u4fa1",required:!1}};function ge(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",12)(2,"app-text-container",57),t.NdJ("change",function(){t.CHM(e);const n=t.oxw().$implicit,o=t.oxw(2);return t.KtG(o.handleCahgeQuantityCostPrice(n))}),t.YNc(3,pe,1,0,"ng-container",14),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw().$implicit,r=t.oxw(2),n=t.MAs(50);t.xp6(2),t.Q6J("formCtrl",r.getFormControlTypeValue(e,"cost_price"))("textRight",!0)("invalid",r.formControlStateManager(r.getFormControlTypeValue(e,"cost_price"))),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(5,me))}}const he=function(){return{label:"\u6570\u91cf",required:"true"}},fe=function(){return{label:"\u5546\u54c1\u540d\u3092\u5909\u66f4\u3059\u308b\u5834\u5408\u4e0b\u8a18\u3078\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",required:!1}};function ve(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",39)(1,"div",40)(2,"app-button",35),t.NdJ("click",function(){const o=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.setSelectionType(o))}),t._uU(3),t.qZA()(),t.TgZ(4,"div",41)(5,"div",42),t.YNc(6,oe,4,7,"ng-container",43),t.YNc(7,ue,3,7,"ng-template",null,44,t.W1O),t.TgZ(9,"div",12)(10,"app-text-container",45),t.NdJ("change",function(){const o=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.handleCahgeQuantityCostPrice(o))}),t.YNc(11,de,1,0,"ng-container",14),t.YNc(12,le,1,0,"ng-container",15),t.qZA()()(),t.TgZ(13,"div",42)(14,"div",46)(15,"app-text-container",47),t.YNc(16,_e,1,0,"ng-container",14),t.YNc(17,ce,1,0,"ng-container",15),t.qZA()(),t.YNc(18,ge,4,6,"ng-container",48),t.qZA()(),t._UZ(19,"hr",41),t.TgZ(20,"div",49)(21,"p"),t._uU(22,"\u5165\u529b\u4e2d\u5546\u54c1\u60c5\u5831"),t.qZA()(),t.TgZ(23,"div",50)(24,"p")(25,"span",51),t._uU(26),t.qZA(),t.TgZ(27,"span",51),t._uU(28),t.qZA(),t.TgZ(29,"span",51),t._uU(30),t.qZA()()(),t.TgZ(31,"div",50)(32,"p")(33,"span",51),t._uU(34),t.qZA(),t.TgZ(35,"span",51),t._uU(36),t.qZA(),t.TgZ(37,"span",51),t._uU(38),t.qZA()()(),t._UZ(39,"hr",41),t.TgZ(40,"div",52)(41,"div",53)(42,"app-button",35),t.NdJ("click",function(){const o=t.CHM(e).index,a=t.oxw(2);return t.KtG(a.removeCustomerOrderForm(o))}),t._uU(43,"\u524a\u9664"),t.qZA()()()()}if(2&i){const e=s.$implicit,r=s.index,n=t.MAs(8),o=t.oxw(2),a=t.MAs(50),u=t.MAs(52);t.ekj("bg-slate-100",r%2==0),t.Q6J("formGroupName",r),t.xp6(3),t.hij(" ",o.getFormControlTypeValue(e,"selectionTypeIsProductId").value?"\u5546\u54c1\u540d\u3067\u6307\u5b9a\u3059\u308b":"\u5546\u54c1\u756a\u53f7\u3067\u6307\u5b9a\u3059\u308b"," "),t.xp6(3),t.Q6J("ngIf",o.getFormControlTypeValue(e,"selectionTypeIsProductId").value)("ngIfElse",n),t.xp6(4),t.Q6J("formCtrl",o.getFormControlTypeValue(e,"order_quantity"))("textRight",!0)("invalid",o.formControlStateManager(o.getFormControlTypeValue(e,"order_quantity"))),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(26,he)),t.xp6(1),t.Q6J("ngTemplateOutlet",u)("ngTemplateOutletContext",t.VKq(27,k,o.getFormControlTypeValue(e,"order_quantity"))),t.xp6(3),t.Q6J("formCtrl",o.getFormControlTypeValue(e,"product_name_alias"))("invalid",o.formControlStateManager(o.getFormControlTypeValue(e,"product_name_alias"))),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.DdM(29,fe)),t.xp6(1),t.Q6J("ngTemplateOutlet",u)("ngTemplateOutletContext",t.VKq(30,k,o.getFormControlTypeValue(e,"product_name_alias"))),t.xp6(1),t.Q6J("ngIf",o.isDivisionCustom),t.xp6(8),t.hij(" \u4ed5\u5165\u5148\uff1a",o.getFormValue(e,"supplier_name")," "),t.xp6(2),t.hij(" \u5546\u54c1\u540d\uff1a",o.getFormValue(e,"product_name")," "),t.xp6(2),t.hij(" \u5546\u54c1\u540d(\u5225\u79f0)\uff1a",e.controls.product_name_alias.value?e.controls.product_name_alias.value:""," "),t.xp6(4),t.hij(" \u6570\u91cf\uff1a",o.getFormValue(e,"order_quantity")," "),t.xp6(2),t.hij(" \u539f\u4fa1\uff1a",o.getFormValue(e,"cost_price").toLocaleString(),"\u5186 "),t.xp6(2),t.hij(" \u91d1\u984d\uff1a",o.getFormValue(e,"total_cost_price").toLocaleString(),"\u5186 ")}}function Te(i,s){if(1&i&&(t.TgZ(0,"div",36)(1,"div",37),t.YNc(2,ve,44,32,"div",38),t.qZA()()),2&i){const e=t.oxw();t.Q6J("formGroup",e.orderForms),t.xp6(2),t.Q6J("ngForOf",e.orderArrayControls)}}function Ce(i,s){1&i&&(t.TgZ(0,"span",60),t._uU(1,"\u5fc5\u9808"),t.qZA())}function Ae(i,s){if(1&i&&(t.TgZ(0,"div",58)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,Ce,2,0,"span",59),t.qZA()),2&i){const e=s.label,r=s.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",r)}}function xe(i,s){if(1&i&&(t.TgZ(0,"p",62),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function be(i,s){if(1&i&&(t.ynx(0),t.YNc(1,xe,2,1,"p",61),t.BQk()),2&i){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required)}}function Ee(i,s){if(1&i&&t.YNc(0,be,2,1,"ng-container",48),2&i){const e=s.ctrl,r=t.oxw();t.Q6J("ngIf",r.formControlStateManager(e))}}function Oe(i,s){if(1&i&&(t.ynx(0),t.TgZ(1,"p",62),t._uU(2),t.qZA(),t.BQk()),2&i){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.errorConst.FORM_ERROR.DATE_SPECIFICATION_VIOLATION," ")}}function De(i,s){if(1&i&&t.YNc(0,Oe,3,1,"ng-container",48),2&i){const e=s.ctrls;t.Q6J("ngIf",null==e.errors?null:e.errors.isStartDateGreaterThanOrEqualToEndDate)}}const Se=function(i){return{path:i,text:"\u767a\u6ce8\u66f8\u4e00\u89a7"}},Ze=function(){return{text:"\u767a\u6ce8\u66f8\u65b0\u898f\u767b\u9332"}},Ie=function(i,s){return[i,s]},ye=function(){return{label:"\u767a\u6ce8\u62c5\u5f53\u8005",required:"true"}},Fe=function(){return{label:"\u4ed5\u5165\u5148",required:"true"}},Ue=function(){return{label:"\u5c4a\u3051\u5148\u5e97\u8217",required:"true"}},Ne=function(){return{label:"\u767a\u6ce8\u65e5",required:"true"}},qe=function(){return{label:"\u5e0c\u671b\u7d0d\u5165\u65e5",required:"true"}},Re=function(i){return{ctrls:i}};let Me=(()=>{class i{constructor(e,r,n,o,a,u,l,m,g,h,c,v,O){this.poService=e,this.modalService=r,this.flashMessageService=n,this.router=o,this.fb=a,this.authorService=u,this.supplierService=l,this.employeeService=m,this.errorService=g,this.storeService=h,this.divisionService=c,this.productService=v,this.common=O,this.subscription=new U.w0,this.listPagePath="/purchase-order",this.cancelModalTitle="\u767a\u6ce8\u66f8\u65b0\u898f\u767b\u9332\u30ad\u30e3\u30f3\u30bb\u30eb\uff1a"+_.yR.TITLE.CANCEL,this.errorModalTitle="\u767a\u6ce8\u66f8\u65b0\u898f\u767b\u9332\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.errorConst=y.c,this.products=[],this.DIVISION_ORDER_STATUS=D.z.ORDER_STATUS,this.DIVISION_ORDER_STATUS_CODE=0,this.product_division=[],this.PRODUCT_DIVISION_CUSTOM_CODE=pt.U.PRODUCT_DIVISION.CODE.CUSTOM,this.isDivisionCustom=!1,this.form=this.fb.group({dateGroup:this.fb.group({order_date:["",[p.kI.required]],preferred_delivery_date:["",[p.kI.required]]},{validators:[H.d.isStartDateGreaterThanOrEqualToEndDate("order_date","preferred_delivery_date")]}),store_id:["",[p.kI.required]],supplier_id:["",[p.kI.required]],order_employee_id:["",[p.kI.required]]}),this.selectionTypeIsProductId=!0,this.DIVISION_PRODUCT_CODE_SPECIAL_ORDER=2,this.unit_division_list=[],this.orderForms=this.fb.group({forms:this.fb.array([])})}get ctrls(){return this.form.controls}ngOnInit(){this.authorService.author?(this.author=this.authorService.author,this.ctrls.order_employee_id.patchValue(String(this.author.id)),this.ctrls.store_id.patchValue(String(this.author.store_id)),this.initOptions()):this.subscription.add(this.authorService.author$.subscribe(e=>{this.author=e,this.ctrls.order_employee_id.patchValue(String(this.author.id)),this.ctrls.store_id.patchValue(String(this.author.store_id)),this.initOptions()})),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,S.h)(e=>this.modalService.getModalProperties().title===this.cancelModalTitle)).subscribe(e=>{e===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.listPagePath)}))}ngOnDestroy(){this.subscription.unsubscribe()}initOptions(){this.common.loading=!0,this.subscription.add((0,Y.D)([this.supplierService.getAsSelectOptions(),this.employeeService.getAsSelectOptions(),this.storeService.getAsSelectOptions(),this.divisionService.getAsSelectOptions({name:D.z.PURCHASE_ORDER_STATUS}),this.divisionService.getAsSelectOptions(),this.divisionService.getAsSelectOptions({name:this.DIVISION_ORDER_STATUS,division_code:this.DIVISION_ORDER_STATUS_CODE})]).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(e=>(0,T.of)(e))).subscribe(e=>{e instanceof A.UA?this.handleError(e.status,this.errorModalTitle,e.message):null!=e&&6===e.length?(this.supplierSuggests=e[0],this.employeeSuggests=e[1],this.storeOptions=e[2],this.poDivisions=e[3][D.z.PURCHASE_ORDER_STATUS],this.unit_division_list=e[4][D.z.UNIT],this.product_division=e[4][D.z.PRODUCT],this.PRODUCT_DIVISION_CUSTOM=this.product_division.find(r=>r.code===this.PRODUCT_DIVISION_CUSTOM_CODE),console.log(this.PRODUCT_DIVISION_CUSTOM),this.status_division_id=e[5][this.DIVISION_ORDER_STATUS][0].value):this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR)}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleClickCancel(){this.form.pristine?this.router.navigateByUrl(this.listPagePath):this.modalService.setModal(this.cancelModalTitle,_.yR.BODY.CANCEL,"warning",_.yR.BUTTON_TITLE.EXECUTION,_.yR.BUTTON_TITLE.CANCEL)}handleClickSaveButton(){this.form.markAsPristine(),this.common.loading=!0;const e=this.form.value,r=this._getCustomerOrders();if(!this.employeeSuggests.some(m=>Number(m.value)===Number(e.order_employee_id)))return this.ctrls.order_employee_id.setValue(""),void(this.common.loading=!1);if(!this.supplierSuggests.some(m=>Number(m.value)===Number(e.supplier_id)))return this.ctrls.supplier_id.setValue(""),void(this.common.loading=!1);if(!this.storeOptions.some(m=>Number(m.value)===Number(e.store_id)))return this.ctrls.store_id.setValue(""),void(this.common.loading=!1);if(!e.dateGroup?.order_date||!e.dateGroup?.preferred_delivery_date)return this.ctrls.dateGroup.controls.order_date.setValue(""),this.ctrls.dateGroup.controls.preferred_delivery_date.setValue(""),void(this.common.loading=!1);const u=this.poDivisions.find(m=>m.text===b.STATUS.DRAFT),l={order_date:new Date(e.dateGroup.order_date).toLocaleDateString(),preferred_delivery_date:new Date(e.dateGroup.preferred_delivery_date).toLocaleDateString(),order_employee_id:e.order_employee_id,supplier_id:e.supplier_id,store_id:e.store_id,purchase_order_status_division_id:u?.value,order:r};this.subscription.add(this.poService.add(l).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(m=>(0,T.of)(m))).subscribe(m=>{m instanceof A.UA?this.handleError(m.status,this.errorModalTitle,m.error.message):(this.flashMessageService.setFlashMessage(m.message,"success",15e3),this.router.navigateByUrl(this.listPagePath))}))}handleError(e,r,n){this.errorService.setError({status:e,title:r,message:n,redirectPath:this.listPagePath})}setSelectionType(e){const r=!e.controls.selectionTypeIsProductId.value;e.reset({product_id:"",quantity:""}),e.controls.selectionTypeIsProductId.patchValue(r),this._setDefaultValue(e)}_setDefaultValue(e){}getProductIdSuggests(e){return{observable:this.productService.getAll({id:e.controls.product_id.value,supplier_id:this.ctrls.supplier_id.value}),idField:"id",nameField:"id"}}getProductSuggests(e){return{observable:this.productService.getAll({name:e.controls.product_name.value,supplier_id:this.ctrls.supplier_id.value}),idField:"id",nameField:"name"}}changeProductNameAlias(e){console.log(e.target.value)}handleSelectedProductData(e,r){if(void 0===r)return;this.getFormControlTypeValue(e,"selectionTypeIsProductId").value&&e.controls.product_name.patchValue(r.name),console.log(r),e.controls.order_quantity.patchValue(1),e.controls.cost_price.patchValue(this.getSupplierCostPrice(r)),e.controls.order_status_division_id.patchValue(this.status_division_id);let n=Number(e.controls.cost_price.value)*Number(e.controls.order_quantity.value);e.controls.total_cost_price.patchValue(n);let o=this.supplierSuggests.find(a=>a.value===this.ctrls.supplier_id.value);e.controls.supplier_name.patchValue(o?.text),e.controls.product_divition_id.patchValue(r.product_division_id),this.isDivisionCustom=r.product_division_id===this.PRODUCT_DIVISION_CUSTOM.value}handleCahgeQuantityCostPrice(e){e.controls.cost_price.value||e.controls.total_cost_price.patchValue(0);let r=Number(e.controls.cost_price.value)*Number(e.controls.order_quantity.value);e.controls.total_cost_price.patchValue(r)}get orderForm(){return this.fb.group({product_id:["",[p.kI.required,p.kI.pattern(M.m.NUMERIC_REG_EX)]],order_quantity:[1,[p.kI.required,p.kI.pattern(M.m.NUMERIC_REG_EX)]],cost_price:["",[p.kI.required,p.kI.pattern(M.m.NUMERIC_REG_EX)]],product_name_alias:[" ",p.kI.maxLength(255)],order_status_division_id:["",[p.kI.pattern(M.m.NUMERIC_REG_EX)]],product_name:["",[p.kI.required]],selectionTypeIsProductId:!0,supplier_name:[""],total_cost_price:[0],product_divition_id:[]})}get orderArray(){return this.orderForms.get("forms")}get orderArrayControls(){return this.orderArray.controls}getFormControlTypeValue(e,r){return e.get(r)}getFormControlTypeValueData(e,r){return e.get(r)?.value}getFormValue(e,r){const n=this.getFormControlTypeValue(e,r);return null===n.value?"":"supplier_name"===r||"product_name"===r?n.value:Number(n.value)}addCustomerOrderForm(){this.orderArray.push(this.orderForm)}removeCustomerOrderForm(e){this.orderArray.removeAt(e)}getProduct(e){this.subscription.add((0,Y.D)([this.productService.getAll({id:e})]).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(r=>(0,T.of)(r))).subscribe(r=>{console.log(r)}))}isNotFalseValue(e){let r=!1;return void 0!==e&&""!==e&&null!==e&&(r=!0),r}isFalseValue(e){let r=!1;return void 0===e&&""===e&&null===e&&(r=!0),r}getSupplierCostPrice(e){let r;if(null==e||null==e)return"";switch(e.ordering_target_barcode){case e.b_barcode:r=e.b_supplier_cost_price;break;case e.c_barcode:r=e.c_supplier_cost_price;break;default:r=e?.supplier_cost_price}return r}_getCustomerOrders(){return this.orderForms.value.forms.map(n=>(n.product_name_alias=n.product_name_alias?n.product_name_alias.trim():"",delete n.selectionTypeIsProductId,delete n.supplier_name,delete n.total_cost_price,n))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(J),t.Y36(F.Z),t.Y36(G.P),t.Y36(E.F0),t.Y36(p.qu),t.Y36(X.Y),t.Y36(nt.p),t.Y36($.G),t.Y36(P.T),t.Y36(at.d),t.Y36(Q.E),t.Y36(ut.M),t.Y36(R.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-add"]],decls:55,vars:59,consts:[[3,"breadcrumbList"],[1,"mb-8"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"cursor-pointer",3,"click"],[3,"roleTypeName"],[1,"width-limit-break","border-t","border-gray-400"],[3,"formGroup","ngSubmit"],[1,"mt-8","mb-24","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"flex","gap-6","mt-6","mb-6"],[1,"w-2/5"],["nameAttrValue","order_employee_id","idAttrValue","order-employee-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],["nameAttrValue","supplier_id","idAttrValue","supplier-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[1,"w-1/3"],["nameAttrValue","store_id","idAttrValue","store-id",3,"formCtrl","invalid","options"],[1,"w-2/3"],[1,"flex","gap-6"],[1,"w-1/2"],["nameAttrValue","order_date","idAttrValue","order-date",3,"formCtrl","invalid"],["message","",4,"ngIf"],["nameAttrValue","preferred_delivery_date","idAttrValue","preferred-delivery-date",3,"formCtrl","invalid"],[1,"mt-6","pl-2"],[1,"border-t-warning-hover","border-t-4","mt-1"],[3,"click",4,"ngIf"],["class","mx-4",3,"formGroup",4,"ngIf"],[1,"width-limit-break","bg-primary-light","flex","flex-row","justify-center","bottom-[40px]","left-0","right-0","p-2","fixed","gap-8"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["labels",""],["errors",""],["dateErrors",""],["message",""],[3,"click"],[1,"mx-4",3,"formGroup"],["formArrayName","forms"],["class","mt-6 py-4 text-base",3,"formGroupName","bg-slate-100",4,"ngFor","ngForOf"],[1,"mt-6","py-4","text-base",3,"formGroupName"],[1,"ml-4"],[1,"mt-4"],[1,"mx-4","flex","gap-6"],[4,"ngIf","ngIfElse"],["selectionTypeIsProductName",""],["nameAttrValue","order_quantity","idAttrValue","order_quantity","inputType","number",3,"formCtrl","textRight","invalid","change"],[1,"w-3/5"],["nameAttrValue","product_name_alias","idAttrValue","product_name_alias","inputType","text",3,"formCtrl","invalid"],[4,"ngIf"],[1,"mt-4","px-4"],[1,"mt-4","pb-2"],[1,"mx-4","px-4","py-[11px]","bg-slate-50","border","border-slate-300","rounded"],[1,"flex","gap-6","justify-end","mx-4","pb-2"],[1,"pt-7"],[1,"grow"],["nameAttrValue","product_id","idAttrValue","product-id",3,"idCtrl","nameCtrl","apiInput","invalid","selectedData"],["nameAttrValue","product_name","idAttrValue","product-name",3,"idCtrl","nameCtrl","apiInput","invalid","selectedData"],["nameAttrValue","cost_price","idAttrValue","cost-price","inputType","number",3,"formCtrl","textRight","invalid","change"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,r){if(1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main",1)(2,"h1",2),t._uU(3,"\u767a\u6ce8\u66f8\u65b0\u898f\u767b\u9332"),t.qZA(),t.TgZ(4,"div",3)(5,"div",4),t.NdJ("click",function(){return r.handleClickCancel()}),t._UZ(6,"app-cancel-link-org"),t.qZA(),t.TgZ(7,"div")(8,"app-last-updater-org",5),t._uU(9),t.qZA()()(),t._UZ(10,"hr",6),t.TgZ(11,"form",7),t.NdJ("ngSubmit",function(){return r.handleClickSaveButton()}),t.TgZ(12,"div",8)(13,"h2",9),t._uU(14,"\u767a\u6ce8\u66f8\u60c5\u5831\u5165\u529b"),t.qZA(),t._UZ(15,"hr",10),t.TgZ(16,"div",11)(17,"div",12)(18,"app-select-suggest-container",13),t.YNc(19,Jt,1,0,"ng-container",14),t.YNc(20,Gt,1,0,"ng-container",15),t.qZA()(),t.TgZ(21,"div",12)(22,"app-select-suggest-container",16),t.YNc(23,Qt,1,0,"ng-container",14),t.YNc(24,wt,1,0,"ng-container",15),t.qZA()()(),t.TgZ(25,"div",11)(26,"div",17)(27,"app-select-container",18),t.YNc(28,Kt,1,0,"ng-container",14),t.YNc(29,jt,1,0,"ng-container",15),t.qZA()(),t.TgZ(30,"div",19)(31,"div",20)(32,"div",21)(33,"app-date-term",22),t.YNc(34,Ht,1,0,"ng-container",14),t.YNc(35,Xt,2,4,"div",23),t.qZA()(),t.TgZ(36,"div",21)(37,"app-date-term",24),t.YNc(38,zt,1,0,"ng-container",14),t.YNc(39,te,2,4,"div",23),t.qZA()()(),t.YNc(40,ee,1,0,"ng-container",14),t.qZA()(),t.TgZ(41,"p",25),t._uU(42,"\u5546\u54c1\u60c5\u5831"),t.qZA(),t._UZ(43,"hr",26),t.YNc(44,re,2,0,"app-button",27),t.YNc(45,Te,3,2,"div",28),t.qZA(),t.TgZ(46,"div",29)(47,"app-button",30),t._uU(48,"\u4fdd\u5b58"),t.qZA()()()(),t.YNc(49,Ae,4,2,"ng-template",null,31,t.W1O),t.YNc(51,Ee,1,1,"ng-template",null,32,t.W1O),t.YNc(53,De,1,1,"ng-template",null,33,t.W1O)),2&e){const n=t.MAs(50),o=t.MAs(52),a=t.MAs(54);t.Q6J("breadcrumbList",t.WLB(43,Ie,t.VKq(40,Se,r.listPagePath),t.DdM(42,Ze))),t.xp6(8),t.Q6J("roleTypeName",r.author&&r.author.role_name?r.author.role_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.xp6(1),t.hij(" \u767b\u9332\u8005\uff1a",r.author?r.author.last_name+" "+r.author.first_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."," "),t.xp6(2),t.Q6J("formGroup",r.form),t.xp6(7),t.Q6J("formCtrl",r.ctrls.order_employee_id)("suggests",r.employeeSuggests)("invalid",r.formControlStateManager(r.ctrls.order_employee_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(46,ye)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(47,k,r.ctrls.order_employee_id)),t.xp6(2),t.Q6J("formCtrl",r.ctrls.supplier_id)("suggests",r.supplierSuggests)("invalid",r.formControlStateManager(r.ctrls.supplier_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(49,Fe)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(50,k,r.ctrls.supplier_id)),t.xp6(3),t.Q6J("formCtrl",r.ctrls.store_id)("invalid",r.formControlStateManager(r.ctrls.store_id))("options",r.storeOptions),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(52,Ue)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(53,k,r.ctrls.store_id)),t.xp6(4),t.Q6J("formCtrl",r.ctrls.dateGroup.controls.order_date)("invalid",r.formControlStateManager(r.ctrls.dateGroup.controls.order_date)||(null==r.ctrls.dateGroup.errors?null:r.ctrls.dateGroup.errors.isStartDateGreaterThanOrEqualToEndDate)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(55,Ne)),t.xp6(1),t.Q6J("ngIf",r.formControlStateManager(r.ctrls.dateGroup.controls.order_date)||(null==r.ctrls.dateGroup.errors?null:r.ctrls.dateGroup.errors.isStartDateGreaterThanOrEqualToEndDate)),t.xp6(2),t.Q6J("formCtrl",r.ctrls.dateGroup.controls.preferred_delivery_date)("invalid",r.formControlStateManager(r.ctrls.dateGroup.controls.preferred_delivery_date)||(null==r.ctrls.dateGroup.errors?null:r.ctrls.dateGroup.errors.isStartDateGreaterThanOrEqualToEndDate)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(56,qe)),t.xp6(1),t.Q6J("ngIf",r.formControlStateManager(r.ctrls.dateGroup.controls.preferred_delivery_date)||(null==r.ctrls.dateGroup.errors?null:r.ctrls.dateGroup.errors.isStartDateGreaterThanOrEqualToEndDate)),t.xp6(1),t.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",t.VKq(57,Re,r.ctrls.dateGroup)),t.xp6(4),t.Q6J("ngIf",r.ctrls.supplier_id.value),t.xp6(1),t.Q6J("ngIf",r.orderArrayControls.length>0),t.xp6(2),t.Q6J("buttonDisabled",r.form.invalid||r.form.pristine)}},dependencies:[Z.sg,Z.O5,Z.tP,V.Z,w.R,mt.d,B.r,z.K,p._Y,p.JL,p.sg,p.x0,p.CE,dt.a,gt.O,ht.Y,ot.X]}),i})();var ft=d(4004);const L_STATUS_CODE_BEFORE_INSPECTION=0,L_STATUS_CODE_INSPECTED=1,L_STATUS_CODE_SHORTAGE_OUT_OF_STOCK=2;var W=d(1267),lt=d(8132),Le=d(3038),vt=d(2398),Tt=d(1903),Ct=d(6815),Pe=d(9586),Be=d(956),Ye=d(4720),ke=d(5142),Ve=d(1914);const Je=["checkboxes"];function Ge(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",19)(1,"app-button",20),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.changeStatus(n.purchaseOrderConst.STATUS.SENT))}),t._uU(2," \u9001\u4fe1\u6e08\u307f\u306b\u3059\u308b "),t.qZA()()}}function Qe(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div")(2,"app-button",26),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(4);return t.KtG(n.getPdf())}),t._uU(3,"\u767a\u6ce8\u66f8PDF\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9"),t.qZA()(),t.BQk()}}function we(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"app-button",26),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(4);return t.KtG(n.createPOPdf())}),t._uU(2,"\u767a\u6ce8\u66f8PDF\u4f5c\u6210"),t.qZA()()}}function Ke(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",21)(1,"div",19)(2,"app-button",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.changeStatus(n.purchaseOrderConst.STATUS.DRAFT))}),t._uU(3,"\u4e0b\u66f8\u304d\u306b\u623b\u3059"),t.qZA()(),t.TgZ(4,"div",23),t.YNc(5,Qe,4,0,"ng-container",24),t.YNc(6,we,3,0,"ng-template",null,25,t.W1O),t.TgZ(8,"app-button",26),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.toInspectionPage())}),t._uU(9," \u691c\u54c1 "),t.qZA()()()}if(2&i){const e=t.MAs(7),r=t.oxw(3);t.xp6(5),t.Q6J("ngIf",r.isPOPdfCreated)("ngIfElse",e)}}function je(i,s){if(1&i&&(t.ynx(0),t.YNc(1,Ge,3,0,"div",17),t.YNc(2,Ke,10,2,"ng-template",null,18,t.W1O),t.BQk()),2&i){const e=t.MAs(3),r=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!r.isSent)("ngIfElse",e)}}function He(i,s){if(1&i&&(t.ynx(0),t.YNc(1,je,4,2,"ng-container",9),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.orders.length>0)}}function $e(i,s){if(1&i&&(t.ynx(0),t.TgZ(1,"div",59)(2,"p",52),t._uU(3,"\u767a\u6ce8\u66f8\u5168\u4f53\u5099\u8003"),t.qZA(),t.TgZ(4,"p",60),t._uU(5),t.qZA()(),t.BQk()),2&i){const e=t.oxw(2);t.xp6(5),t.Oqu(e.purchaseOrder.remarks)}}function Xe(i,s){1&i&&(t.ynx(0),t.TgZ(1,"th",61)(2,"div")(3,"p"),t._uU(4,"\u64cd\u4f5c"),t.qZA()()(),t.BQk())}function ze(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"p")(2,"input",68),t.NdJ("change",function(n){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw(3);return t.KtG(o.product_name_alias=a.getValue(n))}),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("id",e.id)("value",e.product_name)}}function We(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"p")(2,"input",68),t.NdJ("change",function(n){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw(3);return t.KtG(o.product_name_alias=a.getValue(n))}),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("id",e.id)("value",e.product_name_alias)}}function tr(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"p")(2,"input",68),t.NdJ("change",function(n){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw(3);return t.KtG(o.product_name_alias=a.getValue(n))}),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("id",e.id)("value",e.product_name_alias)}}function er(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",70)(2,"app-icon-container",71),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,o=t.oxw(3);return t.KtG(o.deleteOrder(n.id))}),t.qZA()(),t.BQk()}}function rr(i,s){if(1&i&&(t.ynx(0),t.TgZ(1,"td",55)(2,"div",69),t.YNc(3,er,3,0,"ng-container",24),t.qZA()(),t.BQk()),2&i){const e=t.oxw(4),r=t.MAs(20);t.xp6(3),t.Q6J("ngIf",!e.addFormIsOpen)("ngIfElse",r)}}const ir=function(i){return{"bg-slate-100":i}};function nr(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr",63)(2,"td",55)(3,"div",64)(4,"input",65,66),t.NdJ("click",function(n){t.CHM(e);const o=t.oxw(3);return t.KtG(o.getId(n))}),t.qZA()()(),t.TgZ(6,"td",55)(7,"div",64)(8,"p"),t._uU(9),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.qZA()()(),t.TgZ(12,"td",55)(13,"div",64)(14,"p"),t._uU(15),t.qZA(),t.TgZ(16,"p"),t._uU(17),t.qZA()()(),t.TgZ(18,"td",55)(19,"div"),t.YNc(20,ze,3,2,"ng-container",9),t.YNc(21,We,3,2,"ng-container",9),t.YNc(22,tr,3,2,"ng-container",9),t.TgZ(23,"div",21)(24,"div")(25,"p"),t._uU(26),t.qZA()(),t.TgZ(27,"div")(28,"p",54),t._uU(29),t.qZA()()(),t.TgZ(30,"p"),t._uU(31),t.qZA()()(),t.TgZ(32,"td",55)(33,"div",64)(34,"p"),t._uU(35),t.qZA()()(),t.TgZ(36,"td",55)(37,"div",64)(38,"p")(39,"input",67),t.NdJ("change",function(n){const a=t.CHM(e).$implicit,u=t.oxw(3);return t.KtG(a.order_quantity=u.getValue(n))}),t.qZA()()()(),t.TgZ(40,"td",55)(41,"div",64)(42,"p"),t._uU(43),t.qZA()()(),t.TgZ(44,"td",55)(45,"div",64)(46,"p"),t._uU(47),t.qZA(),t.TgZ(48,"p"),t._uU(49),t.qZA()()(),t.TgZ(50,"td",55)(51,"div",64)(52,"p"),t._uU(53),t.qZA(),t.TgZ(54,"p"),t._uU(55),t.qZA()()(),t.TgZ(56,"td",55)(57,"div",54)(58,"p"),t._uU(59),t.qZA()()(),t.TgZ(60,"td",55)(61,"div",54)(62,"p"),t._uU(63),t.qZA()()(),t.YNc(64,rr,4,2,"ng-container",9),t.qZA(),t.BQk()}if(2&i){const e=s.$implicit,r=s.index,n=t.oxw(3);t.xp6(1),t.Q6J("ngClass",t.VKq(24,ir,n.editTarget&&n.editTarget.id===e.id)),t.xp6(3),t.Q6J("value",e.id),t.xp6(5),t.Oqu(e.product_id),t.xp6(2),t.hij(" ",e.supplier_product_cd?e.supplier_product_cd:"-"," "),t.xp6(4),t.Oqu(e.ordering_target_barcode),t.xp6(2),t.AsE(" ",e.division_shelf_value,"-",e.division_shelf_col_value," "),t.xp6(3),t.Q6J("ngIf",e.product_name&&!e.product_name_alias),t.xp6(1),t.Q6J("ngIf",e.product_name&&e.product_name_alias),t.xp6(1),t.Q6J("ngIf",!e.product_name&&e.product_name_alias),t.xp6(4),t.hij(" ",e.division_price_tag_value," "),t.xp6(3),t.hij(" ",e.division_seal_print_value," "),t.xp6(2),t.Oqu(e.remarks),t.xp6(4),t.hij(" ",n.sales_detail_lists[r]?n.sales_detail_lists[r].delivery_real_number:""," "),t.xp6(4),t.Q6J("id",e.id)("value",e.order_quantity),t.xp6(4),t.hij(" ",n.product_order_status_list[r]?n.product_order_status_list[r].ordering_unit_name:""," "),t.xp6(4),t.Oqu(e.regulated_stock_num),t.xp6(2),t.Oqu(e.minimum_order_quantity),t.xp6(4),t.hij(" ",n.product_order_status_list[r]?n.product_order_status_list[r].ordering_quantity:0," "),t.xp6(2),t.hij(" ",n.product_order_status_list[r]?n.product_order_status_list[r].ordering_order_all_num:""," "),t.xp6(4),t.hij(" ",e.cost_price?e.cost_price.toLocaleString():""," "),t.xp6(4),t.hij(" ",e.cost_price?(e.cost_price*e.order_quantity).toLocaleString():""," "),t.xp6(1),t.Q6J("ngIf",!n.isSent)}}function or(i,s){if(1&i&&(t.ynx(0),t.YNc(1,nr,65,26,"ng-container",62),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.orders)}}function sr(i,s){1&i&&(t.ynx(0),t._UZ(1,"td",55),t.BQk())}function ar(i,s){1&i&&t.GkF(0)}const ur=function(){return{label:"\u5546\u54c1\u756a\u53f7",required:!0}};function dr(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",78)(2,"app-real-time-suggest-container",90),t.NdJ("selectedData",function(n){t.CHM(e);const o=t.oxw(3);return t.KtG(o.handleSelectedProductData(o.addForm,n))}),t.YNc(3,ar,1,0,"ng-container",80),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw(3),r=t.MAs(22);t.xp6(2),t.Q6J("idCtrl",e.addFormCtrls.product_id)("nameCtrl",e.addFormCtrls.product_id)("apiInput",e.getProductSuggestsId(e.addFormCtrls))("invalid",e.formControlStateManager(e.addFormCtrls.product_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(6,ur))}}function lr(i,s){1&i&&t.GkF(0)}function _r(i,s){if(1&i&&t.GkF(0,94),2&i){const e=t.oxw(4),r=t.MAs(24);t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",e.requiredViolation)}}const cr=function(){return{label:"\u54c1\u540d\u3092\u5546\u54c1\u30de\u30b9\u30bf\u304b\u3089\u9078\u629e",required:!0}};function pr(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",91)(1,"app-real-time-suggest-container",92),t.NdJ("selectedData",function(n){t.CHM(e);const o=t.oxw(3);return t.KtG(o.handleSelectedProductData(o.addForm,n))}),t.YNc(2,lr,1,0,"ng-container",80),t.qZA(),t.YNc(3,_r,1,2,"ng-container",93),t.qZA()}if(2&i){const e=t.oxw(3),r=t.MAs(22);t.xp6(1),t.Q6J("idCtrl",e.addFormCtrls.product_id)("nameCtrl",e.addFormCtrls.product_name)("apiInput",e.getProductSuggestsName(e.addFormCtrls))("invalid",e.formControlStateManager(e.addFormCtrls.product_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(7,cr)),t.xp6(1),t.Q6J("ngIf",null==e.addFormCtrls.product_name.errors?null:e.addFormCtrls.product_name.errors.required)}}function mr(i,s){1&i&&t.GkF(0)}function gr(i,s){1&i&&t.GkF(0,95)}function hr(i,s){1&i&&t.GkF(0)}function fr(i,s){1&i&&t.GkF(0,95)}function vr(i,s){1&i&&t.GkF(0)}const Tr=function(){return{label:"\u5358\u4fa1",required:!1}};function Cr(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",91)(2,"app-text-container",96),t.NdJ("change",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.handleCahgeQuantityCostPrice(n.addForm))}),t.YNc(3,vr,1,0,"ng-container",80),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw(3),r=t.MAs(22);t.xp6(2),t.Q6J("formCtrl",e.getFormControlTypeValue(e.addForm,"cost_price"))("textRight",!0)("invalid",e.formControlStateManager(e.getFormControlTypeValue(e.addForm,"cost_price"))),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(5,Tr))}}const Ar=function(){return{label:"\u6570\u91cf",required:"true"}},At=function(i){return{ctrl:i}},xr=function(){return{label:"\u5546\u54c1\u540d\u3092\u5909\u66f4\u3059\u308b\u5834\u5408\u4e0b\u8a18\u3078\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",required:!1}};function br(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",72)(1,"div",73)(2,"app-button",26),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.setSelectionType())}),t._uU(3),t.qZA()(),t._UZ(4,"hr",74),t.TgZ(5,"form",40),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.handleClickOrderSaveButton())}),t.TgZ(6,"div",75),t._UZ(7,"app-text-container",76),t.YNc(8,dr,4,7,"ng-container",24),t.YNc(9,pr,4,8,"ng-template",null,77,t.W1O),t.TgZ(11,"div",78)(12,"app-text-container",79),t.NdJ("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.handleCahgeQuantityCostPrice(n.addForm))}),t.YNc(13,mr,1,0,"ng-container",80),t.qZA(),t.YNc(14,gr,1,0,"ng-container",81),t.qZA()(),t.TgZ(15,"div",82)(16,"div",83)(17,"app-text-container",84),t.YNc(18,hr,1,0,"ng-container",80),t.YNc(19,fr,1,0,"ng-container",81),t.qZA()(),t.YNc(20,Cr,4,6,"ng-container",9),t.qZA(),t._UZ(21,"hr",74),t.TgZ(22,"div",85)(23,"p"),t._uU(24,"\u5165\u529b\u4e2d\u5546\u54c1\u60c5\u5831"),t.qZA()(),t.TgZ(25,"div",86)(26,"p")(27,"span",87),t._uU(28),t.qZA(),t.TgZ(29,"span",87),t._uU(30),t.qZA(),t.TgZ(31,"span",87),t._uU(32),t.qZA()()(),t.TgZ(33,"div",86)(34,"p")(35,"span",87),t._uU(36),t.qZA(),t.TgZ(37,"span",87),t._uU(38),t.qZA(),t.TgZ(39,"span",87),t._uU(40),t.qZA()()(),t.TgZ(41,"div",88)(42,"div",89)(43,"app-button",42),t._uU(44,"\u8ffd\u52a0"),t.qZA()(),t.TgZ(45,"div",89)(46,"app-button",26),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.addOrderCancel())}),t._uU(47,"\u30ad\u30e3\u30f3\u30bb\u30eb"),t.qZA()()()()()}if(2&i){const e=t.MAs(10),r=t.oxw(2),n=t.MAs(22),o=t.MAs(26);t.xp6(3),t.hij(" ",r.selectionTypeIsProductId?"\u5546\u54c1\u540d\u3067\u6307\u5b9a\u3059\u308b":"\u5546\u54c1\u756a\u53f7\u3067\u6307\u5b9a\u3059\u308b"," "),t.xp6(2),t.Q6J("formGroup",r.addForm),t.xp6(2),t.Q6J("formCtrl",r.addFormCtrls.order_status_division_id)("invalid",r.formControlStateManager(r.addFormCtrls.order_quantity))("hidden",!0),t.xp6(1),t.Q6J("ngIf",r.selectionTypeIsProductId)("ngIfElse",e),t.xp6(4),t.Q6J("formCtrl",r.addFormCtrls.order_quantity)("textRight",!0)("invalid",r.formControlStateManager(r.addFormCtrls.order_quantity)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(28,Ar)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(29,At,r.getFormControlTypeValue(r.addForm,"order_quantity"))),t.xp6(3),t.Q6J("formCtrl",r.getFormControlTypeValue(r.addForm,"product_name_alias"))("invalid",r.formControlStateManager(r.getFormControlTypeValue(r.addForm,"product_name_alias"))),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(31,xr)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(32,At,r.getFormControlTypeValue(r.addForm,"product_name_alias"))),t.xp6(1),t.Q6J("ngIf",r.isDivisionCustom),t.xp6(8),t.hij(" \u4ed5\u5165\u5148\uff1a",r.getFormValue(r.addForm,"supplier_name")," "),t.xp6(2),t.hij(" \u5546\u54c1\u540d\uff1a",r.getFormValue(r.addForm,"product_name")," "),t.xp6(2),t.hij(" \u5546\u54c1\u540d(\u5225\u79f0)\uff1a",r.addForm.controls.product_name_alias.value?r.addForm.controls.product_name_alias.value:""," "),t.xp6(4),t.hij(" \u6570\u91cf\uff1a",r.getFormValue(r.addForm,"order_quantity")," "),t.xp6(2),t.hij(" \u539f\u4fa1\uff1a",r.getFormValue(r.addForm,"cost_price")?r.getFormValue(r.addForm,"cost_price").toLocaleString():0,"\u5186 "),t.xp6(2),t.hij(" \u91d1\u984d\uff1a",r.getFormValue(r.addForm,"total_cost_price").toLocaleString(),"\u5186 "),t.xp6(3),t.Q6J("buttonDisabled",r.addForm.invalid||r.addForm.pristine)}}function Er(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",97)(1,"app-button",26),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.addOrder())}),t._uU(2,"\u5546\u54c1\u8ffd\u52a0"),t.qZA()()}}function Or(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",27)(1,"div",28)(2,"h1",29),t._uU(3,"\u767a\u6ce8\u66f8"),t.qZA(),t.TgZ(4,"div",30)(5,"span",31),t._uU(6),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.qZA()(),t.TgZ(9,"div",32)(10,"span"),t._uU(11),t.qZA()()(),t.TgZ(12,"div",33)(13,"div",34)(14,"p")(15,"span",35),t._uU(16,"\u6ce8\u6587\u5148"),t.qZA(),t.TgZ(17,"span"),t._uU(18),t.qZA()(),t.TgZ(19,"p"),t._uU(20),t.qZA(),t.TgZ(21,"p"),t._uU(22),t.qZA(),t.TgZ(23,"p"),t._uU(24),t.qZA(),t.TgZ(25,"p"),t._uU(26),t.qZA(),t.TgZ(27,"p")(28,"span",35),t._uU(29),t.qZA(),t.TgZ(30,"span"),t._uU(31),t.qZA()()(),t.TgZ(32,"div",34)(33,"div",36)(34,"div")(35,"p"),t._uU(36,"\u767a\u6ce8\u8005"),t.qZA(),t.TgZ(37,"p"),t._uU(38),t.qZA()(),t.TgZ(39,"div")(40,"p"),t._uU(41,"\u62c5\u5f53\u8005"),t.qZA(),t.TgZ(42,"p"),t._uU(43),t.qZA()()(),t.TgZ(44,"p"),t._uU(45),t.qZA(),t.TgZ(46,"p"),t._uU(47),t.qZA(),t.TgZ(48,"p"),t._uU(49,"---"),t.qZA(),t.TgZ(50,"p")(51,"span",35),t._uU(52),t.qZA(),t.TgZ(53,"span"),t._uU(54),t.qZA()()(),t.TgZ(55,"div",34)(56,"div",36)(57,"div")(58,"p"),t._uU(59,"\u5c4a\u3051\u5148"),t.qZA(),t.TgZ(60,"p"),t._uU(61),t.qZA()()(),t.TgZ(62,"p"),t._uU(63),t.qZA(),t.TgZ(64,"p"),t._uU(65),t.qZA(),t.TgZ(66,"p"),t._uU(67),t.qZA(),t.TgZ(68,"p")(69,"span",35),t._uU(70),t.qZA(),t.TgZ(71,"span"),t._uU(72),t.qZA()()()(),t.YNc(73,$e,6,1,"ng-container",9),t.TgZ(74,"div",21)(75,"div",37)(76,"div",38)(77,"app-button",39),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.allSelectItems())}),t._uU(78,"\u5168\u9078\u629e"),t.qZA()(),t._uU(79," \xa0\xa0 "),t.TgZ(80,"div",38)(81,"form",40),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.handleClickAllDelete())}),t._UZ(82,"input",41),t.TgZ(83,"app-button",42),t._uU(84,"\u9078\u629e\u524a\u9664"),t.qZA()()(),t._uU(85," \xa0\xa0 "),t.TgZ(86,"div",38)(87,"app-button",43),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.reset())}),t._uU(88,"\u9078\u629e\u89e3\u9664"),t.qZA()()()(),t.TgZ(89,"table",44)(90,"thead",45)(91,"tr")(92,"th",46),t._uU(93,"ID"),t.qZA(),t.TgZ(94,"th",46)(95,"div")(96,"p"),t._uU(97,"\u81ea\u30b3\u30fc\u30c9"),t.qZA(),t.TgZ(98,"p"),t._uU(99,"\u76f8\u30b3\u30fc\u30c9"),t.qZA()()(),t.TgZ(100,"th",47)(101,"div")(102,"p"),t._uU(103,"JAN"),t.qZA(),t.TgZ(104,"p"),t._uU(105,"\u68da\u756a"),t.qZA()()(),t.TgZ(106,"th",48)(107,"div")(108,"p"),t._uU(109,"\u5546\u54c1\u540d"),t.qZA()()(),t.TgZ(110,"th",46)(111,"div")(112,"p"),t._uU(113,"\u524d\u65e5\u306e\u8ca9\u58f2\u6570"),t.qZA()()(),t.TgZ(114,"th",49)(115,"div")(116,"p"),t._uU(117,"\u6570\u91cf"),t.qZA()()(),t.TgZ(118,"th",49)(119,"div")(120,"p"),t._uU(121,"\u5358\u4f4d"),t.qZA()()(),t.TgZ(122,"th",46)(123,"div")(124,"p"),t._uU(125,"\u898f\u5b9a\u5728\u5eab"),t.qZA(),t.TgZ(126,"p"),t._uU(127,"\u6700\u5c0f\u767a\u6ce8\u6570"),t.qZA()()(),t.TgZ(128,"th",46)(129,"div")(130,"p"),t._uU(131,"\u30b1\u30fc\u30b9\u5165\u6570"),t.qZA(),t.TgZ(132,"p"),t._uU(133,"\u30d0\u30e9\u7dcf\u6570"),t.qZA()()(),t.TgZ(134,"th",50)(135,"div")(136,"p"),t._uU(137,"\u5358\u4fa1"),t.qZA()()(),t.TgZ(138,"th",50)(139,"div")(140,"p"),t._uU(141,"\u91d1\u984d"),t.qZA()()(),t.YNc(142,Xe,5,0,"ng-container",9),t.qZA()(),t.TgZ(143,"tbody",51),t.YNc(144,or,2,1,"ng-container",9),t.TgZ(145,"tr",52)(146,"td",53)(147,"div",54)(148,"p"),t._uU(149,"\u5408\u8a08"),t.qZA()()(),t.TgZ(150,"td",55)(151,"div",54),t._UZ(152,"p"),t.qZA()(),t.TgZ(153,"td",55)(154,"div",54)(155,"p"),t._uU(156),t.qZA()()(),t.YNc(157,sr,2,0,"ng-container",9),t.qZA()()(),t.YNc(158,br,48,34,"div",56),t.TgZ(159,"div",57),t._UZ(160,"app-spinner",51),t.qZA(),t.YNc(161,Er,3,0,"div",58),t.qZA()}if(2&i){const e=t.oxw();t.xp6(6),t.hij("\u767a\u6ce8No\uff1a",e.purchaseOrder.id,""),t.xp6(2),t.AsE("\u767a\u6ce8\u65e5\uff1a",e.dateFormatter(e.purchaseOrder.order_date),"\uff08\u5e0c\u671b\u7d0d\u5165\u65e5\uff1a",e.dateFormatter(e.purchaseOrder.preferred_delivery_date),"\uff09"),t.xp6(3),t.hij("\u30b9\u30c6\u30fc\u30bf\u30b9\uff1a",e.isSent?e.purchaseOrderConst.STATUS.SENT:e.purchaseOrderConst.STATUS.DRAFT,""),t.xp6(7),t.Oqu(e.purchaseOrder.supplier_id),t.xp6(2),t.Oqu(e.purchaseOrder.supplier_name),t.xp6(2),t.hij("\u3012",e.purchaseOrder.supplier_postal_code,""),t.xp6(2),t.lnq(" ",e.purchaseOrder.supplier_province,"",e.purchaseOrder.supplier_locality,"",e.purchaseOrder.supplier_street_address," "),t.xp6(2),t.hij(" ",e.purchaseOrder.supplier_other_address?e.purchaseOrder.supplier_other_address:"---"," "),t.xp6(3),t.hij("TEL\uff1a",e.purchaseOrder.supplier_tel,""),t.xp6(2),t.hij("FAX\uff1a",e.purchaseOrder.supplier_fax,""),t.xp6(7),t.Oqu(e.basicInformation.name),t.xp6(5),t.hij(" ",e.purchaseOrder.employee_order_last_name+" "+e.purchaseOrder.employee_order_first_name," "),t.xp6(2),t.hij("\u3012",e.basicInformation.postal_code,""),t.xp6(2),t.hij(" ",e.basicInformation.province+e.basicInformation.locality+e.basicInformation.street_address," "),t.xp6(5),t.hij("TEL\uff1a",e.basicInformation.tel,""),t.xp6(2),t.hij("FAX\uff1a",e.basicInformation.fax,""),t.xp6(7),t.AsE("",e.basicInformation.name," ",e.purchaseOrder.store_name,""),t.xp6(2),t.hij("\u3012",e.purchaseOrder.store_postal_code,""),t.xp6(2),t.lnq(" ",e.purchaseOrder.store_province,"",e.purchaseOrder.store_locality,"",e.purchaseOrder.store_street_address," "),t.xp6(2),t.hij(" ",e.purchaseOrder.store_other_address?e.purchaseOrder.store_other_address:"---"," "),t.xp6(3),t.hij("TEL\uff1a",e.purchaseOrder.store_tel,""),t.xp6(2),t.hij("FAX\uff1a",e.purchaseOrder.store_fax,""),t.xp6(1),t.Q6J("ngIf",e.purchaseOrder.remarks),t.xp6(8),t.Q6J("formGroup",e.deleteList),t.xp6(2),t.Q6J("buttonDisabled",e.button_status),t.xp6(4),t.Q6J("buttonDisabled",e.button_status),t.xp6(55),t.Q6J("ngIf",!e.isSent),t.xp6(2),t.Q6J("ngIf",e.orders.length>0),t.xp6(12),t.Oqu(e.calculateTotalAmount().toLocaleString()),t.xp6(1),t.Q6J("ngIf",!e.isSent),t.xp6(1),t.Q6J("ngIf",!e.isSent&&e.addFormIsOpen),t.xp6(1),t.ekj("hidden",!e.isUpdatingOrder),t.xp6(2),t.Q6J("ngIf",!e.isSent&&!e.addFormIsOpen&&!e.editFormIsOpen)}}function Dr(i,s){1&i&&(t.TgZ(0,"div",98)(1,"p",99),t._uU(2,"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.qZA()())}function Sr(i,s){1&i&&(t.TgZ(0,"div"),t._UZ(1,"app-icon-container",100),t.qZA())}function Zr(i,s){1&i&&(t.TgZ(0,"div"),t._UZ(1,"app-icon-container",101),t.qZA())}function Ir(i,s){1&i&&(t.TgZ(0,"span",104),t._uU(1,"\u5fc5\u9808"),t.qZA())}function yr(i,s){if(1&i&&(t.TgZ(0,"div",102)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,Ir,2,0,"span",103),t.qZA()),2&i){const e=s.label,r=s.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",r)}}function Fr(i,s){if(1&i&&(t.TgZ(0,"p",105),t._uU(1),t.qZA()),2&i){const e=s.message;t.xp6(1),t.hij(" ",e," ")}}function Ur(i,s){if(1&i&&(t.TgZ(0,"p",107),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function Nr(i,s){if(1&i&&(t.ynx(0),t.YNc(1,Ur,2,1,"p",106),t.BQk()),2&i){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required)}}function qr(i,s){if(1&i&&t.YNc(0,Nr,2,1,"ng-container",9),2&i){const e=s.ctrl,r=t.oxw();t.Q6J("ngIf",r.formControlStateManager(e))}}const Rr=function(i){return{path:i,text:"\u767a\u6ce8\u66f8\u4e00\u89a7"}},Mr=function(){return{text:"\u767a\u6ce8\u66f8\u8a73\u7d30"}},Lr=function(i,s){return[i,s]},Pr=function(i){return{supplierId:i}};let Br=(()=>{class i{constructor(e,r,n,o,a,u,l,m,g,h,c,v,O,C,I){this.poService=e,this.orderService=r,this.productService=n,this.salseDetailService=o,this.biService=a,this.divisionService=u,this.fb=l,this.errorService=m,this.activatedRoute=g,this.modalService=h,this.router=c,this.flashMessageService=v,this.purcharseService=O,this.purchaseDetailService=C,this.common=I,this.errorModalTitle="\u767a\u6ce8\u66f8\u8a73\u7d30\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.errorDownloadPdfModalTitle="\u767a\u6ce8\u66f8PDF\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.errorModalTitleOrderQuantity="\u767a\u6ce8\u6570\u91cf\u66f4\u65b0\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.numericLimitViolation={message:y.c.FORM_ERROR.NUMERIC_LIMIT_VIOLATION},this.exceededCharacterMaxLimit={message:y.c.FORM_ERROR.EXCEEDED_CHARACTER_MAX_LIMIT},this.requiredViolation={message:y.c.FORM_ERROR.REQUIRED_ITEM},this.errorConst=y.c,this.subscription=new U.w0,this.purchaseOrderConst=b,this.pdfFileNamePreFix="\u767a\u6ce8\u66f8",this.isPOPdfCreated=!1,this.listPagePath="/purchase-order",this.addFormIsOpen=!1,this.editFormIsOpen=!1,this.isUpdatingOrder=!1,this.statusDivisionOptions=[{value:"",text:it.s.PLEASE_SELECT}],this.selectionTypeIsProductId=!0,this.product_division=[],this.PRODUCT_DIVISION_CUSTOM_CODE=pt.U.PRODUCT_DIVISION.CODE.CUSTOM,this.isDivisionCustom=!1,this.addForm=this.fb.group({product_id:["",[p.kI.required]],product_name:["",[p.kI.required]],order_quantity:["",[p.kI.required,p.kI.pattern(M.m.NUMERIC_REG_EX)]],cost_price:[p.kI.required,p.kI.pattern(M.m.NUMERIC_REG_EX)],remarks:["",p.kI.maxLength(255)],shelf_value:"",product_data:[""],supplier_name:[""],product_name_alias:[""],total_cost_price:[0,p.kI.pattern(M.m.NUMERIC_REG_EX)],order_status_division_id:[""]}),this.id_list=[],this.deleteList=new p.cw({idlist:new p.NI("",[p.kI.required])}),this.button_status=!0,this.editForm=this.fb.group({order_quantity:["",[p.kI.required]]})}get addFormCtrls(){return this.addForm.controls}get editFormCtrls(){return this.editForm.controls}ngOnInit(){this.button_status=!0;const e=this.activatedRoute.snapshot.params.id;this.isParameterInvalid(e)?this.handleError(400,this.errorModalTitle,"\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u4e00\u89a7\u753b\u9762\u3078\u623b\u308a\u307e\u3059\u3002",this.listPagePath):(this.selectedId=Number(e),this.editPagePath=this.listPagePath+"/edit/"+e,this.pdfFileNamePreFix+="_"+e,this.initialization(Number(e)))}isParameterInvalid(e){return null===e||!!isNaN(Number(e))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getLastdate(){let e=new Date;e.setDate(e.getDate()-1);let r=e.getFullYear(),n=("00"+(e.getMonth()+1)).slice(-2),o=("00"+e.getDate()).slice(-2);return{yyyymm:parseInt(r+n),date:parseInt(o)}}getId(e){this.button_status=!1;let r=e.target.value;e.target.id.split("__"),e.target.checked?this.id_list.push(r):this.id_list=this.id_list.filter(l=>l!==r);let u=Array.from(new Set(this.id_list));return u.sort((l,m)=>Number(l)-Number(m)),this.id_list=u,this.deleteList.get("idlist")?.setValue(this.id_list.join(",")),console.log(this.deleteList.get("idlist")?.value),0===this.id_list.length&&(this.button_status=!0),r}setSelectionType(){this.selectionTypeIsProductId=!this.selectionTypeIsProductId,this.addForm.reset({product_id:"",order_quantity:""})}initialization(e){this.common.loading=!0,this.subscription.add(this.poService.find(e).subscribe(r=>{this.purchaseOrder=r.data[0];const n=this.getPreviousDateFromPurchaseOrder();this.subscription.add((0,Y.D)([(0,T.of)(r),this.orderService.getAll({purchase_order_id:e}),this.biService.find(),this.divisionService.getAll({name:D.z.PURCHASE_ORDER_STATUS}),this.salseDetailService.getAll({sale_month_and_year:n.yyyymm,sale_day:n.date}),this.divisionService.getAll({name:D.z.UNIT}),this.divisionService.getAsSelectOptions({name:D.z.DIVISION_UNIT_CATEGORY}),this.divisionService.getAsSelectOptions({name:D.z.ORDER_STATUS}),this.divisionService.getAsSelectOptions()]).pipe((0,f.K)(o=>(0,T.of)(o)),(0,rt.w)(o=>{if(o instanceof A.UA)return this.common.loading=!1,(0,T.of)(o);const a=o[0].data[0],u=o[1].data,l=o[2].data[0],m=o[3].data,g=o[4].data,h=o[5].data,c=o[6],v=o[7],O=o[8];let C=this.getIdLists(u,"product_id");return this.productService.getAll({id:C}).subscribe(I=>{this.purcharse_min=I.data}),this.productService.getAll({supplier_id:a.supplier_id,id:C}).pipe((0,ft.U)(I=>({purchaseOrder:a,orders:u,basicInformation:l,statusDivisions:m,products:I.data,sales_detail:g,unit_division:h,divisionUnitCategory:c,divisionOrderStatus:v,division:O})),(0,f.K)(I=>(0,T.of)(I)),(0,x.x)(()=>this.common.loading=!1))}),(0,x.x)(()=>this.common.loading=!1)).subscribe(o=>{if(o instanceof A.UA)return void this.handleError(o.status,o.error?o.error.title?o.error.title:"":"\u30a8\u30e9\u30fc",o.error?o.error.message:o.message,this.listPagePath);if(null==o)return void this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR,this.listPagePath);if(Array.isArray(o)&&6!==o.length)return void this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR);this.purchaseOrder=o.purchaseOrder,this.updaterFullName=this.purchaseOrder.employee_updated_last_name+" "+this.purchaseOrder.employee_updated_first_name,null!=this.purchaseOrder.pdf&&""!==this.purchaseOrder.pdf&&"undefined"!==this.purchaseOrder.pdf&&(this.isPOPdfCreated=!0);const a=o.orders;this.products=o.products;const u=this.mergeOrdersAndProducts(this.products,a),l=this.sortByShelfNumber(u);this.orders=l,this.orders.forEach((g,h)=>{let c=g.product_name_alias?g.product_name_alias.trim():"";""===c&&(this.orders[h].product_name_alias=c)}),this.product_order_status=this.orderingTargetData(this.orders),this.unitDivisions=o.unit_division,this.product_order_status_list=l.map((g,h)=>{let c;return this.product_order_status.forEach(v=>{g.product_id==v.product_id&&g.id==v.order_id&&(c=v,c.ordering_unit_name=this.getUnitName(v.ordering_unit_division_id),c.ordering_unit_code_name=this.getUnitName(v.ordering_unit_code),c.ordering_order_all_num=Number(v.ordering_quantity)*Number(g.order_quantity))}),c}),this.basicInformation=o.basicInformation,this.productSuggests=this.products.map(g=>({value:g.id,text:g.name}));const m=o.sales_detail;this.sales_detail_lists=u.map((g,h)=>{let c;return console.log("sales_detail_lists"),m.forEach(v=>{String(v.product_cd)===String(g.product_id)&&(c=v.delivery_real_number)}),void 0===c&&(c=0),{product_id:g.product_id,delivery_real_number:c}}),this.isSent=!1,this.statusDivisions=o.statusDivisions,this.purchaseOrder.purchase_order_status_code===b.STATUS_CODE.SENT&&(this.isSent=!0),this.setUnitCategoryConst(o.divisionUnitCategory[D.z.DIVISION_UNIT_CATEGORY]),this.setOrderStatusConst(o.divisionOrderStatus[D.z.ORDER_STATUS]),this.addFormCtrls.order_status_division_id.setValue(this.ORDER_STATUS_INITIAL_DIVISION_ID),this.product_division=o.division[D.z.PRODUCT],console.log(this.PRODUCT_DIVISION_CUSTOM),this.PRODUCT_DIVISION_CUSTOM=this.product_division.find(g=>g.code===this.PRODUCT_DIVISION_CUSTOM_CODE),console.log(this.PRODUCT_DIVISION_CUSTOM)}))}))}handleSelectedProductData(e,r){if(void 0===r)return;e.controls.product_id.patchValue(r.id),e.controls.product_name.patchValue(r.name),e.controls.order_quantity.patchValue(1),e.controls.cost_price.patchValue(this._getSupplierCostPrice(r));let n=Number(e.controls.cost_price.value)*Number(e.controls.order_quantity.value);e.controls.total_cost_price.patchValue(n),this.isDivisionCustom=r.product_division_id===this.PRODUCT_DIVISION_CUSTOM.value}getIdLists(e,r){let n=[];return e.find(u=>{u&&n.push(u[r])}),n.join(", ")}setOrderStatusConst(e){this.ORDER_STATUS_INITIAL_DIVISION_ID=String(this.getDivisionIdFromCode(e,L_STATUS_CODE_BEFORE_INSPECTION))}setUnitCategoryConst(e){this.DIVISION_UNIT_CATEGORY_SMALL=Number(this.getDivisionIdFromCode(e,b.UNIT_CATEGORY.CODE.SMALL)),this.DIVISION_UNIT_CATEGORY_MEDIUM=Number(this.getDivisionIdFromCode(e,b.UNIT_CATEGORY.CODE.MEDIUM)),this.DIVISION_UNIT_CATEGORY_LARGE=Number(this.getDivisionIdFromCode(e,b.UNIT_CATEGORY.CODE.LARGE))}getDivisionIdFromCode(e,r){return e.find(o=>o.code===r).value}getUnitName(e){let r="";return this.unitDivisions.map((n,o)=>{n.id==e&&(r=n.value)}),r}getCostPrice(){console.log(this.addFormCtrls)}getFormValue(e,r){const n=this.getFormControlTypeValue(e,r);return null===n.value?"":"supplier_name"===r||"product_name"===r?n.value:Number(n.value)}getFormControlTypeValue(e,r){return e.get(r)}orderingTargetData(e){let n,r=[];return e.forEach(o=>{switch(o.ordering_target_barcode){case o.b_barcode:n={order_id:o.id,product_id:o.product_id,ordering_gross_profit_rate:o.b_gross_profit_rate,ordering_barcode:o.b_barcode,ordering_quantity:o.b_quantity,ordering_order_all_num:0,ordering_selling_price:o.b_selling_price,ordering_supplier_cost_price:o.b_supplier_cost_price,ordering_unit_division_id:o.b_unit_division_id,ordering_unit_name:"",ordering_unit_code:this.DIVISION_UNIT_CATEGORY_MEDIUM,ordering_unit_code_name:""};break;case o.c_barcode:n={order_id:o.id,product_id:o.product_id,ordering_gross_profit_rate:o.c_gross_profit_rate,ordering_barcode:o.c_barcode,ordering_quantity:o.c_quantity,ordering_order_all_num:0,ordering_selling_price:o.c_selling_price,ordering_supplier_cost_price:o.c_supplier_cost_price,ordering_unit_division_id:o.c_unit_division_id,ordering_unit_name:"",ordering_unit_code:this.DIVISION_UNIT_CATEGORY_LARGE,ordering_unit_code_name:""};break;default:n={order_id:o.id,product_id:o.product_id,ordering_gross_profit_rate:o.gross_profit_rate,ordering_barcode:o.barcode,ordering_quantity:o.quantity,ordering_order_all_num:0,ordering_selling_price:o.selling_price,ordering_supplier_cost_price:o.supplier_cost_price,ordering_unit_division_id:o.unit_division_id,ordering_unit_name:"",ordering_unit_code:this.DIVISION_UNIT_CATEGORY_SMALL,ordering_unit_code_name:""}}r.push(n)}),r}mergeOrdersAndProducts(e,r){let n=[];return r.forEach(o=>{e.forEach(a=>{o.product_id===a.id&&n.push({...a,...o})})}),n}sortByShelfNumber(e){return e.sort((n,o)=>n.division_shelf_value&&o.division_shelf_col_value&&n.division_shelf_col_value&&o.division_shelf_col_value?n.division_shelf_value+n.division_shelf_col_value>n.division_shelf_value+o.division_shelf_col_value?1:-1:n.product_id>o.product_id?1:-1)}dateFormatter(e){return new Date(e).toLocaleDateString()}getProductSuggestsId(e){return{observable:this.productService.getAll({id:e.product_id.value,supplier_id:this.purchaseOrder.supplier_id}),idField:"id",nameField:"name"}}getProductSuggestsName(e){return{observable:this.productService.getAll({name:e.product_name.value,supplier_id:this.purchaseOrder.supplier_id}),idField:"id",nameField:"name"}}getOrders(e){const r=this.getPreviousDateFromPurchaseOrder();let n={};e&&(n={id:e,supplier_id:this.purchaseOrder.supplier_id}),this.subscription.add((0,Y.D)([this.orderService.getAll({purchase_order_id:this.selectedId}),this.salseDetailService.getAll({sale_month_and_year:r.yyyymm,sale_day:r.date}),this.divisionService.getAll({name:D.z.UNIT}),this.productService.getAll(n)]).pipe((0,x.x)(()=>this.isUpdatingOrder=!1),(0,f.K)(o=>(0,T.of)(o))).subscribe(o=>{if(o instanceof A.UA)return void this.handleError(o.status,o.error.title,o.message);if(null==o)return void this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR);const u=o[1].data,l=o[2].data,m=o[3].data;let g;g=m.length>0?m:this.products;const h=this.mergeOrdersAndProducts(g,o[0].data);this.sales_detail_lists=h.map((v,O)=>{let C;return console.log("sales_detail_lists"),u.forEach(I=>{I.product_cd===v.product_id&&(C=I.delivery_real_number)}),void 0===C&&(C=0),{product_id:v.product_id,delivery_real_number:C}});const c=this.sortByShelfNumber(h);this.orders=c,this.product_order_status=this.orderingTargetData(this.orders),this.unitDivisions=l,this.product_order_status_list=this.orders.map((v,O)=>{let C;return this.product_order_status.forEach(I=>{v.product_id==I.product_id&&v.id==I.order_id&&(C=I,C.ordering_unit_name=this.getUnitName(I.ordering_unit_division_id),C.ordering_unit_code_name=this.getUnitName(I.ordering_unit_code),C.ordering_order_all_num=Number(I.ordering_quantity)*Number(v.order_quantity))}),C})}))}changeStatus(e){const r=this.statusDivisions.find(o=>o.value===e),n={order_date:this.purchaseOrder.order_date,preferred_delivery_date:this.purchaseOrder.preferred_delivery_date,store_id:this.purchaseOrder.store_id,supplier_id:this.purchaseOrder.supplier_id,order_employee_id:this.purchaseOrder.order_employee_id,purchase_order_status_division_id:void 0!==r?r.id:"",remarks:this.purchaseOrder.remarks};this.common.loading=!0,this.subscription.add(this.poService.update(this.selectedId,n).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(o=>(0,T.of)(o))).subscribe(o=>{o instanceof A.UA?this.handleError(o.status,o.error.title,o.message):null!=o?(this.flashMessageService.setFlashMessage(o.message,"success",15e3),r?.value===b.STATUS.DRAFT?(this.isSent=!1,this.purchaseOrder.purchase_order_status_division_id=r.id):r?.value===b.STATUS.SENT&&(this.isSent=!0,this.purchaseOrder.purchase_order_status_division_id=r.id)):this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR)}))}handleClickOrderEditButton(){this.editFormIsOpen=!1,this.orders.map(n=>{n.id===this.editTarget.id&&(n.order_quantity=Number(this.editFormCtrls.order_quantity.value))});const r={purchase_order_id:this.purchaseOrder.id,product_id:this.editTarget.product_id,order_quantity:this.editForm.value.order_quantity};this.isUpdatingOrder=!0,this.common.loading=!0,this.subscription.add(this.orderService.update(this.editTarget.id,r).pipe((0,x.x)(()=>{this.editTarget={},this.common.loading=!1}),(0,f.K)(n=>(0,T.of)(n))).subscribe(n=>{if(n instanceof A.UA)return void this.handleError(n.status,n.error.title,n.message);if(null==n)return void this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR);this.flashMessageService.setFlashMessage(n.message,"success",15e3);let a=this.getIdLists(this.orders,"product_id");this.getOrders(a)}))}getSupplierCostPrice(e){let a,r=Number(e),n=this.products.findIndex(u=>u.id===r),o=this.products[n];switch(o.ordering_target_barcode){case o.b_barcode:a=o.b_supplier_cost_price;break;case o.c_barcode:a=o.c_supplier_cost_price;break;default:a=o.supplier_cost_price}return a}_getSupplierCostPrice(e){let r=0;if(null==e||null==e)return 0;switch(e.ordering_target_barcode){case e.b_barcode:r=e.b_supplier_cost_price;break;case e.c_barcode:r=e.c_supplier_cost_price;break;default:r=e?.supplier_cost_price}return r}handleCahgeQuantityCostPrice(e){e.controls.cost_price.value||e.controls.total_cost_price.patchValue(0);let r=Number(e.controls.cost_price.value)*Number(e.controls.order_quantity.value);e.controls.total_cost_price.patchValue(r)}handleClickOrderSaveButton(){this.addFormIsOpen=!1;const e=this.addForm.value,r={purchase_order_id:this.purchaseOrder.id,product_id:e.product_id,product_name:e.product_name,product_name_alias:e.product_name_alias,order_quantity:e.order_quantity,remarks:e.remarks,order_status_division_id:e.order_status_division_id,cost_price:e.cost_price};let n=this.getIdLists(this.orders,"product_id");n+=", "+String(e.product_id),this.isUpdatingOrder=!0,this.common.loading=!0,this.subscription.add(this.orderService.add(r).pipe((0,f.K)(o=>(0,T.of)(o)),(0,x.x)(()=>this.common.loading=!1)).subscribe(o=>{o instanceof A.UA?this.handleError(o.status,o.error.title,o.message):null!=o?(this.flashMessageService.setFlashMessage(o.message,"success",15e3),this.getOrders(n)):this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR)}))}deleteOrder(e){const r="\u767a\u6ce8"+_.yR.TITLE.DELETE;this.modalService.setModal(r,_.yR.BODY.DELETE,"danger",_.yR.BUTTON_TITLE.DELETE,_.yR.BUTTON_TITLE.CANCEL),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,S.h)(o=>this.modalService.getModalProperties().title===r)).subscribe(o=>{o===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&(this.isUpdatingOrder=!0,this.orderService.remove(e).pipe((0,x.x)(()=>this.isUpdatingOrder=!1),(0,f.K)(a=>(0,T.of)(a))).subscribe(a=>{if(a instanceof A.UA)return void this.handleError(a.status,a.error.title,a.message);this.flashMessageService.setFlashMessage(a.message,"success",15e3);let l=this.getIdLists(this.orders,"product_id");this.getOrders(l)}))}))}editOrder(e){this.editTarget=e,this.editFormCtrls.order_quantity.patchValue(String(e.order_quantity)),this.editFormIsOpen=!0}editOrderCancel(){this.editTarget={},this.editFormIsOpen=!1,this.editForm.reset({order_quantity:""}),this.editForm.markAsUntouched()}addOrder(){this.addFormIsOpen=!0,console.log("\u8ffd\u52a0\u30dc\u30bf\u30f3")}addOrderCancel(){this.addFormIsOpen=!1,this.addForm.reset({product_id:"",order_quantity:""}),this.addForm.markAsUntouched()}toInspectionPage(){console.log("\u691c\u54c1\u30da\u30fc\u30b8\u3078"),this.router.navigate([`${this.listPagePath}/inspection/${this.selectedId}`])}allSelectItems(){this.checkboxes?.forEach(r=>{r.nativeElement.checked=!0,this.id_list.push(r.nativeElement.value)});let e=Array.from(new Set(this.id_list));e.sort((r,n)=>Number(r)-Number(n)),this.id_list=e,this.deleteList.get("idlist")?.setValue(this.id_list.join(",")),this.button_status=!1}handleClickAllDelete(){if(1===this.id_list.length&&this.id_list[0])return void this.deleteOrder(Number(this.id_list[0]));const e="\u767a\u6ce8"+_.yR.TITLE.DELETE;this.modalService.setModal(e,_.yR.BODY.DELETE,"danger",_.yR.BUTTON_TITLE.DELETE,_.yR.BUTTON_TITLE.CANCEL);const n=this.deleteList.get("idlist")?.value;this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,S.h)(o=>this.modalService.getModalProperties().title===e)).subscribe(o=>{o===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&(this.isUpdatingOrder=!0,this.orderService.listremove(n).pipe((0,x.x)(()=>this.isUpdatingOrder=!1),(0,f.K)(a=>(0,T.of)(a))).subscribe(a=>{if(a instanceof A.UA)return void this.handleError(a.status,a.error.title,a.message);this.flashMessageService.setFlashMessage(a.message,"success",15e3);let l=this.getIdLists(this.orders,"product_id");this.getOrders(l),this.reset()}))}))}reset(){this.checkboxes?.forEach(e=>{e.nativeElement.checked=!1,this.id_list.push(e.nativeElement.value)}),this.id_list=[],this.deleteList.get("idlist")?.setValue(""),this.button_status=!1}handleClickDelete(){if(this.isSent)return void this.handleError(422,b.ERROR.CANNOT_BE_DELETED,b.ERROR.ATTEMPTED_TO_MODIFY_SUBMITTED_DATA_CHANGE);const e="\u767a\u6ce8\u66f8"+_.yR.TITLE.DELETE;this.modalService.setModal(e,_.yR.BODY.DELETE,"danger",_.yR.BUTTON_TITLE.DELETE,_.yR.BUTTON_TITLE.CANCEL),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,S.h)(n=>this.modalService.getModalProperties().title===e)).subscribe(n=>{n===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&(this.common.loading=!0,this.poService.remove(this.selectedId).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(o=>(0,T.of)(o))).subscribe(o=>{o instanceof A.UA?this.handleError(o.status,o.error.title,o.message):(this.flashMessageService.setFlashMessage(o.message,"success",15e3),this.router.navigateByUrl(this.listPagePath))}))}))}createPOPdf(){this.common.loading=!0,this.subscription.add(this.poService.createPdf(this.purchaseOrder.id).pipe((0,f.K)(e=>(0,T.of)(e)),(0,x.x)(()=>this.common.loading=!1)).subscribe(e=>{e instanceof A.UA?this.handleError(e.status,e.error?e.error.title:"\u30a8\u30e9\u30fc",e.error?e.error.message:e.message,this.listPagePath):null!=e?this.flashMessageService.setFlashMessage(e.message,"success",15e3):this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR,this.listPagePath)}))}getPdf(){const e=this.purchaseOrder.pdf,r=(0,W.Yc)(this.pdfFileNamePreFix,"pdf"),n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.onload=()=>{if(200===n.status){const o=new Blob([n.response],{type:"application/octet-stream"}),a=URL.createObjectURL(o),u=document.createElement("a");u.href=a,u.download=r,u.style.display="none",document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(a)}else this.handleError(n.status,this.errorDownloadPdfModalTitle,_.yR.BODY.HAS_ERROR)},n.send()}handleError(e,r,n,o){this.errorService.setError({status:e,title:r,message:n,redirectPath:o})}ngOnDestroy(){this.subscription.unsubscribe()}getValue(e){let r=e.target.value,o=e.target.name,a={id:e.target.id,name:o,value:r};return"product_name_alias"===o?this.changeItemName(a):this.changeItemData(a),r}changeItemName(e){this.common.loading=!0;let r=Number(e.id),n=e.value,o=this.orders.findIndex(u=>u.id===r),a=this.orders[o].order_quantity;this.subscription.add(this.orderService.find(r).pipe((0,x.x)(()=>this.common.loading=!0),(0,f.K)(u=>(0,T.of)(u))).subscribe(u=>{if(u instanceof A.UA)return void this.handleError(u.status,this.errorModalTitleOrderQuantity,u.message);let l=u.data[0];this.orderService.update(r,{product_name_alias:n,order_quantity:a,purchase_order_id:l.purchase_order_id,product_id:l.product_id}).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(g=>(0,T.of)(g))).subscribe(g=>{g instanceof A.UA?this.handleError(g.status,this.errorModalTitleOrderQuantity,g.error.message):(this.flashMessageService.setFlashMessage(g.message,"success",15e3),this.product_order_status_list.findIndex(v=>v.order_id===r),this.common.loading=!1)})}))}changeItemData(e){this.common.loading=!0;let r=Number(e.id),n=Number(e.value);this.subscription.add(this.orderService.find(r).pipe((0,x.x)(()=>this.common.loading=!0),(0,f.K)(o=>(0,T.of)(o))).subscribe(o=>{if(o instanceof A.UA)return void this.handleError(o.status,this.errorModalTitleOrderQuantity,o.message);let a=o.data[0];this.orderService.update(r,{order_quantity:n,purchase_order_id:a.purchase_order_id,product_id:a.product_id}).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(l=>(0,T.of)(l))).subscribe(l=>{if(l instanceof A.UA)return void this.handleError(l.status,this.errorModalTitleOrderQuantity,l.error.message);this.flashMessageService.setFlashMessage(l.message,"success",15e3);let g=this.product_order_status_list.findIndex(c=>c.order_id===r),h=Number(this.product_order_status_list[g].ordering_quantity)*Number(n);this.product_order_status_list[g].ordering_order_all_num=h,this.common.loading=!1})}))}calculateTotalAmount(){if(!this.orders)return 0;let e=0;return this.orders.forEach((r,n)=>{this.product_order_status_list[n]&&(e+=Number(r.cost_price)*r.order_quantity)}),e}getPreviousDateFromPurchaseOrder(){if(!this.purchaseOrder||!this.purchaseOrder.order_date)return this.getLastdate();let e=new Date(this.purchaseOrder.order_date);e.setDate(e.getDate()-1);let r=e.getFullYear(),n=("00"+(e.getMonth()+1)).slice(-2),o=("00"+e.getDate()).slice(-2);return{yyyymm:parseInt(r+n),date:parseInt(o)}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(J),t.Y36(lt.p),t.Y36(ut.M),t.Y36(Le.C),t.Y36(vt.h),t.Y36(Q.E),t.Y36(p.qu),t.Y36(P.T),t.Y36(E.gz),t.Y36(F.Z),t.Y36(E.F0),t.Y36(G.P),t.Y36(Tt.B),t.Y36(Ct.p),t.Y36(R.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-detail"]],viewQuery:function(e,r){if(1&e&&t.Gf(Je,5),2&e){let n;t.iGM(n=t.CRH())&&(r.checkboxes=n)}},decls:27,vars:16,consts:[[3,"breadcrumbList"],[1,"mb-8"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"flex","flex-row","items-center","gap-6"],[3,"path"],[3,"path","params"],[1,"cursor-pointer",3,"click"],[1,"width-limit-break","border-t","border-gray-400"],[4,"ngIf"],["class","border border-slate-300 bg-white p-4 mt-6",4,"ngIf"],["class","mt-12 text-center",4,"ngIf"],["inoperableEditIcon",""],["inoperableDeleteIcon",""],["labels",""],["errorMessage",""],["errors",""],["class","mt-6",4,"ngIf","ngIfElse"],["sent",""],[1,"mt-6"],["btnFillColor","bg-primary","btnHoverColor","hover:bg-primary-hover","btnTextColor","text-white","btnLineColor","border-primary","btnLineHoverColor","hover:border-primary-hover",3,"click"],[1,"flex","justify-between"],[1,"bg-warning-dark","hover:bg-warning-dark-hover",3,"click"],[1,"mt-6","flex","items-center","gap-6"],[4,"ngIf","ngIfElse"],["notCreated",""],[3,"click"],[1,"border","border-slate-300","bg-white","p-4","mt-6"],[1,"relative"],[1,"absolute","top-0","right-[600px]","text-2xl"],[1,"absolute","left-0","top-[6px]"],[1,"mr-4"],[1,"absolute","right-0","top-[6px]"],[1,"grid","grid-cols-3","gap-2","mt-[32px]"],[1,"border","border-slate-300","py-1","px-2","min-h-[160px]"],[1,"mr-6"],[1,"flex","flex-row","gap-6"],[1,"flex","w-5/6"],[1,"mt-1","mb-1"],["btnType","button","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"click"],[3,"formGroup","ngSubmit"],["type","text","formControlName","idlist",2,"display","none"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["btnType","button","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled","click"],[1,"mt-2","w-[100%]","table-fixed","border-collapse","border","border-slate-400"],[1,"text-sm"],[1,"border","border-slate-300","w-[80px]"],[1,"border","border-slate-300","w-[108px]"],[1,"border","border-slate-300","w-[400px]"],[1,"border","border-slate-300","w-[54px]"],[1,"border","border-slate-300"],[1,"text-xs"],[1,"font-bold"],["colspan","9",1,"border","border-slate-300","px-1"],[1,"text-right"],[1,"border","border-slate-300","px-1"],["class","mt-6 mx-8 px-4 py-4 bg-slate-100",4,"ngIf"],[1,"py-4"],["class","mt-4 text-right",4,"ngIf"],[1,"border","border-slate-300","bg-white","p-2","mt-2","text-sm"],[1,"mt-1"],[1,"border","border-slate-300","w-[100px]"],[4,"ngFor","ngForOf"],[3,"ngClass"],[1,"text-center"],["type","checkbox","name","orderForm_id",2,"transform","scale(1.5)","margin-left","0.5em",3,"value","click"],["checkboxes",""],["type","text","name","order_quantity",2,"width","95%",3,"id","value","change"],["type","text","name","product_name_alias",2,"width","95%",3,"id","value","change"],[1,"flex","justify-around"],[1,"cursor-pointer"],["icon","delete-bin-line","appendClassForIcon","cursor-pointer fill-danger group-hover:fill-danger-hover",3,"click"],[1,"mt-6","mx-8","px-4","py-4","bg-slate-100"],[1,"ml-4"],[1,"mt-4"],[1,"flex","mx-4","gap-6"],["nameAttrValue","order_status_division_id","idAttrValue","order-status-division-id",3,"formCtrl","invalid","hidden"],["selectionTypeIsProductName",""],[1,"grow"],["nameAttrValue","order_quantity","idAttrValue","order-quantity","inputType","number",3,"formCtrl","textRight","invalid","change"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mx-4","flex","gap-6"],[1,"w-3/5"],["nameAttrValue","product_name_alias","idAttrValue","product_name_alias","inputType","text",3,"formCtrl","invalid"],[1,"mt-4","px-4"],[1,"mt-4","pb-2"],[1,"mx-4","px-4","py-[11px]","bg-slate-50","border","border-slate-300","rounded"],[1,"flex","gap-6","justify-end"],[1,"pt-7"],["nameAttrValue","product_id","idAttrValue","product-id",3,"idCtrl","nameCtrl","apiInput","invalid","selectedData"],[1,"w-2/5"],["nameAttrValue","product_name","idAttrValue","product-name",3,"idCtrl","nameCtrl","apiInput","invalid","selectedData"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["message",""],["nameAttrValue","cost_price","idAttrValue","cost-price","inputType","number",3,"formCtrl","textRight","invalid","change"],[1,"mt-4","text-right"],[1,"mt-12","text-center"],[1,"text-2xl","text-slate-600"],["appendClassForIcon","fill-slate-200","icon","edit-2-line"],["icon","delete-bin-line","appendClassForIcon","fill-slate-200"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[1,"text-sm","text-red"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,r){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main",1)(2,"h1",2),t._uU(3,"\u767a\u6ce8\u66f8\u8a73\u7d30"),t.qZA(),t.TgZ(4,"div",3)(5,"div",4)(6,"app-back-to-link-org",5),t._uU(7,"\u4e00\u89a7\u3078\u623b\u308b"),t.qZA(),t._UZ(8,"app-edit-link-org",6),t.TgZ(9,"div",7),t.NdJ("click",function(){return r.handleClickDelete()}),t._UZ(10,"app-delete-link-org"),t.qZA()(),t.TgZ(11,"app-last-updater-org"),t._uU(12),t.qZA()(),t._UZ(13,"hr",8),t.YNc(14,He,2,1,"ng-container",9),t.YNc(15,Or,162,40,"div",10),t.YNc(16,Dr,3,0,"div",11),t.qZA(),t.YNc(17,Sr,2,0,"ng-template",null,12,t.W1O),t.YNc(19,Zr,2,0,"ng-template",null,13,t.W1O),t.YNc(21,yr,4,2,"ng-template",null,14,t.W1O),t.YNc(23,Fr,2,1,"ng-template",null,15,t.W1O),t.YNc(25,qr,1,1,"ng-template",null,16,t.W1O)),2&e&&(t.Q6J("breadcrumbList",t.WLB(11,Lr,t.VKq(8,Rr,r.listPagePath),t.DdM(10,Mr))),t.xp6(6),t.Q6J("path",r.listPagePath),t.xp6(2),t.Q6J("path",r.editPagePath)("params",t.VKq(14,Pr,r.supplierId)),t.xp6(4),t.hij(" \u6700\u7d42\u66f4\u65b0\u8005\uff1a",r.updaterFullName?r.updaterFullName:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."," "),t.xp6(2),t.Q6J("ngIf",r.purchaseOrder&&r.orders&&!r.common.loading),t.xp6(1),t.Q6J("ngIf",r.purchaseOrder&&r.orders&&r.basicInformation&&!r.common.loading),t.xp6(1),t.Q6J("ngIf",r.common.loading))},dependencies:[Z.mk,Z.sg,Z.O5,Z.tP,V.Z,Pe.i,Be.$,w.R,B.r,p._Y,p.Fj,p.JJ,p.JL,p.sg,p.u,Ye._,gt.O,ke.O,Ve.J,ht.Y]}),i})();var Yr=d(228);function kr(i,s){1&i&&t.GkF(0)}function Vr(i,s){1&i&&t.GkF(0,34)}function Jr(i,s){1&i&&t.GkF(0)}function Gr(i,s){1&i&&t.GkF(0,34)}function Qr(i,s){1&i&&t.GkF(0)}function wr(i,s){1&i&&t.GkF(0,34)}function Kr(i,s){1&i&&t.GkF(0)}function jr(i,s){1&i&&t.GkF(0)}const K=function(i){return{ctrl:i}};function Hr(i,s){if(1&i&&(t.TgZ(0,"div",34),t.YNc(1,jr,1,0,"ng-container",19),t.qZA()),2&i){const e=t.oxw(2),r=t.MAs(16);t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(2,K,e.ctrls.dateGroup.controls.order_date))}}function $r(i,s){1&i&&t.GkF(0)}function Xr(i,s){1&i&&t.GkF(0)}function zr(i,s){if(1&i&&(t.TgZ(0,"div",34),t.YNc(1,Xr,1,0,"ng-container",19),t.qZA()),2&i){const e=t.oxw(2),r=t.MAs(16);t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(2,K,e.ctrls.dateGroup.controls.preferred_delivery_date))}}function Wr(i,s){1&i&&t.GkF(0)}function ti(i,s){1&i&&t.GkF(0)}const ei=function(){return{label:"\u30b9\u30c6\u30fc\u30bf\u30b9",required:"true"}},ri=function(){return{label:"\u5c4a\u3051\u5148\u5e97\u8217",required:"true"}},ii=function(){return{label:"\u767a\u6ce8\u62c5\u5f53\u8005",required:"true"}},ni=function(){return{label:"\u767a\u6ce8\u65e5",required:"true"}},oi=function(){return{label:"\u5e0c\u671b\u7d0d\u5165\u65e5",required:"true"}},si=function(i){return{ctrls:i}},ai=function(){return{label:"\u5099\u8003",required:!1}};function ui(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"form",12),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.handleClickSaveButton())}),t.TgZ(1,"div",13)(2,"h2",14),t._uU(3,"\u767a\u6ce8\u66f8\u60c5\u5831\u5165\u529b"),t.qZA(),t._UZ(4,"hr",15),t.TgZ(5,"div",16)(6,"div",17)(7,"app-select-container",18),t.YNc(8,kr,1,0,"ng-container",19),t.YNc(9,Vr,1,0,"ng-container",20),t.qZA()(),t.TgZ(10,"div",17)(11,"app-select-container",21),t.YNc(12,Jr,1,0,"ng-container",19),t.YNc(13,Gr,1,0,"ng-container",20),t.qZA()(),t.TgZ(14,"div",17)(15,"app-select-suggest-container",22),t.YNc(16,Qr,1,0,"ng-container",19),t.YNc(17,wr,1,0,"ng-container",20),t.qZA()()(),t.TgZ(18,"div",23)(19,"div",24)(20,"div",25)(21,"div",26)(22,"app-date-term",27),t.YNc(23,Kr,1,0,"ng-container",19),t.YNc(24,Hr,2,4,"div",28),t.qZA()(),t.TgZ(25,"div",26)(26,"app-date-term",29),t.YNc(27,$r,1,0,"ng-container",19),t.YNc(28,zr,2,4,"div",28),t.qZA()()(),t.YNc(29,Wr,1,0,"ng-container",19),t.qZA()(),t.TgZ(30,"div",30)(31,"app-textarea-container",31),t.YNc(32,ti,1,0,"ng-container",19),t.qZA()()(),t.TgZ(33,"div",32)(34,"app-button",33),t._uU(35,"\u4fdd\u5b58"),t.qZA()()()}if(2&i){const e=t.oxw(),r=t.MAs(14),n=t.MAs(16),o=t.MAs(18);t.Q6J("formGroup",e.form),t.xp6(7),t.Q6J("formCtrl",e.ctrls.purchase_order_status_division_id)("invalid",e.formControlStateManager(e.ctrls.purchase_order_status_division_id))("options",e.statusDivisionOptions),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(39,ei)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(40,K,e.ctrls.purchase_order_status_division_id)),t.xp6(2),t.Q6J("formCtrl",e.ctrls.store_id)("invalid",e.formControlStateManager(e.ctrls.store_id))("options",e.storeOptions),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(42,ri)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(43,K,e.ctrls.store_id)),t.xp6(2),t.Q6J("formCtrl",e.ctrls.order_employee_id)("suggests",e.employeeSuggests)("invalid",e.formControlStateManager(e.ctrls.order_employee_id)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(45,ii)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(46,K,e.ctrls.order_employee_id)),t.xp6(5),t.Q6J("formCtrl",e.ctrls.dateGroup.controls.order_date)("invalid",e.formControlStateManager(e.ctrls.dateGroup.controls.order_date)||(null==e.ctrls.dateGroup.errors?null:e.ctrls.dateGroup.errors.endingDateIsSmaller)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(48,ni)),t.xp6(1),t.Q6J("ngIf",e.formControlStateManager(e.ctrls.dateGroup.controls.order_date)||(null==e.ctrls.dateGroup.errors?null:e.ctrls.dateGroup.errors.endingDateIsSmaller)),t.xp6(2),t.Q6J("formCtrl",e.ctrls.dateGroup.controls.preferred_delivery_date)("invalid",e.formControlStateManager(e.ctrls.dateGroup.controls.preferred_delivery_date)||(null==e.ctrls.dateGroup.errors?null:e.ctrls.dateGroup.errors.endingDateIsSmaller)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(49,oi)),t.xp6(1),t.Q6J("ngIf",e.formControlStateManager(e.ctrls.dateGroup.controls.preferred_delivery_date)||(null==e.ctrls.dateGroup.errors?null:e.ctrls.dateGroup.errors.endingDateIsSmaller)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(50,si,e.ctrls.dateGroup)),t.xp6(2),t.Q6J("formCtrl",e.ctrls.remarks)("invalid",e.formControlStateManager(e.ctrls.remarks)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.DdM(52,ai)),t.xp6(2),t.Q6J("buttonDisabled",e.form.invalid||e.form.pristine)}}function di(i,s){1&i&&(t.TgZ(0,"div",35)(1,"p",36),t._uU(2,"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.qZA()())}function li(i,s){1&i&&(t.TgZ(0,"span",39),t._uU(1,"\u5fc5\u9808"),t.qZA())}function _i(i,s){if(1&i&&(t.TgZ(0,"div",37)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,li,2,0,"span",38),t.qZA()),2&i){const e=s.label,r=s.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",r)}}function ci(i,s){if(1&i&&(t.TgZ(0,"p",42),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function pi(i,s){if(1&i&&(t.ynx(0),t.YNc(1,ci,2,1,"p",41),t.BQk()),2&i){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required)}}function mi(i,s){if(1&i&&t.YNc(0,pi,2,1,"ng-container",40),2&i){const e=s.ctrl,r=t.oxw();t.Q6J("ngIf",r.formControlStateManager(e))}}function gi(i,s){if(1&i&&(t.ynx(0),t.TgZ(1,"p",42),t._uU(2),t.qZA(),t.BQk()),2&i){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.errorConst.FORM_ERROR.DATE_SPECIFICATION_VIOLATION," ")}}function hi(i,s){if(1&i&&t.YNc(0,gi,3,1,"ng-container",40),2&i){const e=s.ctrls;t.Q6J("ngIf",null==e.errors?null:e.errors.endingDateIsSmaller)}}const fi=function(i){return{path:i,text:"\u767a\u6ce8\u66f8\u4e00\u89a7"}},vi=function(i){return{path:i,text:"\u767a\u6ce8\u66f8\u8a73\u7d30"}},Ti=function(){return{text:"\u767a\u6ce8\u66f8\u7de8\u96c6"}},Ci=function(i,s,e){return[i,s,e]};let Ai=(()=>{class i{constructor(e,r,n,o,a,u,l,m,g,h,c,v,O){this.activatedRoute=e,this.poService=r,this.orderService=n,this.divisionService=o,this.modalService=a,this.flashMessageService=u,this.router=l,this.fb=m,this.authorService=g,this.employeeService=h,this.errorService=c,this.storeService=v,this.common=O,this.subscription=new U.w0,this.listPagePath="/purchase-order",this.cancelModalTitle="\u767a\u6ce8\u66f8\u7de8\u96c6\u30ad\u30e3\u30f3\u30bb\u30eb\uff1a"+_.yR.TITLE.CANCEL,this.errorModalTitle="\u767a\u6ce8\u66f8\u7de8\u96c6\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.errorConst=y.c,this.form=this.fb.group({dateGroup:this.fb.group({order_date:["",[p.kI.required]],preferred_delivery_date:["",[p.kI.required]]},{validators:[H.d.endingDateIsSmaller("order_date","preferred_delivery_date")]}),order_employee_id:["",[p.kI.required]],purchase_order_status_division_id:["",[p.kI.required]],store_id:["",[p.kI.required]],remarks:""})}get ctrls(){return this.form.controls}ngOnInit(){this.authorService.author?this.author=this.authorService.author:this.subscription.add(this.authorService.author$.subscribe(n=>{this.author=n}));const e=this.activatedRoute.snapshot.params.id;this.isParameterInvalid(e)?this.handleError(400,this.errorModalTitle,"\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u4e00\u89a7\u753b\u9762\u3078\u623b\u308a\u307e\u3059\u3002",this.listPagePath):(this.selectedId=Number(e),this.detailPagePath=this.listPagePath+"/detail/"+e,this.subscription.add(this.modalService.closeEventObservable$.pipe((0,S.h)(n=>this.modalService.getModalProperties().title===this.cancelModalTitle)).subscribe(n=>{n===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigate([this.detailPagePath],{})})),this.initialization(Number(e)))}ngOnDestroy(){this.subscription.unsubscribe()}isParameterInvalid(e){return null===e||!!isNaN(Number(e))}initialization(e){this.common.loading=!0,this.subscription.add((0,Y.D)([this.poService.find(e),this.employeeService.getAsSelectOptions(),this.storeService.getAsSelectOptions(),this.divisionService.getAsSelectOptions({name:D.z.PURCHASE_ORDER_STATUS}),this.orderService.getAll({purchase_order_id:e})]).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(r=>(0,T.of)(r))).subscribe(r=>{if(r instanceof A.UA)return void this.handleError(r.status,r.error.title,r.message);if(null==r)return void this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR);if(5!==r.length)return void this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR);if((0,W.bz)(r[0]))return void this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR);this.purchaseOrder=r[0].data[0],this.updaterFullName=this.purchaseOrder.employee_updated_last_name+" "+this.purchaseOrder.employee_updated_first_name,this.employeeSuggests=r[1],this.storeOptions=r[2];const a=r[3][D.z.PURCHASE_ORDER_STATUS];switch(this.purchaseOrder.purchase_order_status_value){case b.STATUS.CANCEL:this.statusDivisionOptions=a.filter(m=>String(m.text)===b.STATUS.CANCEL);break;case b.STATUS.SENT:this.statusDivisionOptions=a.filter(m=>String(m.text)!==b.STATUS.CANCEL);break;case b.STATUS.DRAFT:this.statusDivisionOptions=a;break;default:this.statusDivisionOptions=a.filter(m=>String(m.text)===b.STATUS.DRAFT)}0===r[4].data.length&&this.purchaseOrder.purchase_order_status_value!==b.STATUS.CANCEL&&(this.statusDivisionOptions=a.filter(m=>String(m.text)===b.STATUS.DRAFT));const l={dateGroup:{order_date:this.purchaseOrder.order_date,preferred_delivery_date:this.purchaseOrder.preferred_delivery_date},order_employee_id:String(this.purchaseOrder.order_employee_id),purchase_order_status_division_id:String(this.purchaseOrder.purchase_order_status_division_id),store_id:String(this.purchaseOrder.store_id),remarks:this.purchaseOrder.remarks};this.form.patchValue(l)}))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleClickCancel(){this.form.pristine?this.router.navigate([this.detailPagePath],{}):this.modalService.setModal(this.cancelModalTitle,_.yR.BODY.CANCEL,"warning",_.yR.BUTTON_TITLE.EXECUTION,_.yR.BUTTON_TITLE.CANCEL)}handleClickSaveButton(){this.form.markAsPristine(),this.common.loading=!0;const e=this.form.value;if(!this.employeeSuggests.some(a=>Number(a.value)===Number(e.order_employee_id)))return this.ctrls.order_employee_id.setValue(""),void(this.common.loading=!1);if(!this.storeOptions.some(a=>Number(a.value)===Number(e.store_id)))return this.ctrls.store_id.setValue(""),void(this.common.loading=!1);if(!e.dateGroup?.order_date||!e.dateGroup?.preferred_delivery_date)return this.ctrls.dateGroup.controls.order_date.setValue(""),this.ctrls.dateGroup.controls.preferred_delivery_date.setValue(""),void(this.common.loading=!1);const o={order_date:new Date(e.dateGroup.order_date).toLocaleDateString(),preferred_delivery_date:new Date(e.dateGroup.preferred_delivery_date).toLocaleDateString(),order_employee_id:e.order_employee_id,store_id:e.store_id,supplier_id:this.purchaseOrder.supplier_id,purchase_order_status_division_id:e.purchase_order_status_division_id,remarks:e.remarks};this.subscription.add(this.poService.update(this.selectedId,o).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(a=>(0,T.of)(a))).subscribe(a=>{a instanceof A.UA?this.handleError(a.status,this.errorModalTitle,a.error.message):(this.flashMessageService.setFlashMessage(a.message,"success",15e3),this.router.navigateByUrl(this.detailPagePath))}))}handleError(e,r,n,o=this.detailPagePath){this.errorService.setError({status:e,title:r,message:n,redirectPath:o})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(E.gz),t.Y36(J),t.Y36(lt.p),t.Y36(Q.E),t.Y36(F.Z),t.Y36(G.P),t.Y36(E.F0),t.Y36(p.qu),t.Y36(X.Y),t.Y36($.G),t.Y36(P.T),t.Y36(at.d),t.Y36(R.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-edit"]],decls:19,vars:14,consts:[[3,"breadcrumbList"],[1,"mb-8"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"cursor-pointer",3,"click"],[3,"roleTypeName"],[1,"width-limit-break","border-t","border-gray-400"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","mt-12 text-center",4,"ngIf"],["labels",""],["errors",""],["dateErrors",""],[3,"formGroup","ngSubmit"],[1,"mt-8","mb-24","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"flex","gap-6","mt-6","mb-6"],[1,"w-1/3"],["nameAttrValue","purchase_order_status_division_id","idAttrValue","purchase-order-status-division-id",3,"formCtrl","invalid","options"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngTemplateOutlet","ngTemplateOutletContext"],["nameAttrValue","store_id","idAttrValue","store-id",3,"formCtrl","invalid","options"],["nameAttrValue","order_employee_id","idAttrValue","order-employee-id","placeholder","\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044",3,"formCtrl","suggests","invalid"],[1,"flex","gap-6","mt-6"],[1,"w-2/3"],[1,"flex","gap-6"],[1,"w-1/2"],["nameAttrValue","order_date","idAttrValue","order-date",3,"formCtrl","invalid"],["message","",4,"ngIf"],["nameAttrValue","preferred_delivery_date","idAttrValue","preferred-delivery-date",3,"formCtrl","invalid"],[1,"mt-6","mb-6"],["nameAttrValue","remarks","idAttrValue","remarks",3,"formCtrl","invalid"],[1,"width-limit-break","bg-primary-light","flex","flex-row","justify-center","bottom-[40px]","left-0","right-0","p-2","fixed","gap-8"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["message",""],[1,"mt-12","text-center"],[1,"text-2xl","text-slate-600"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[4,"ngIf"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,r){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main",1)(2,"h1",2),t._uU(3,"\u767a\u6ce8\u66f8\u7de8\u96c6"),t.qZA(),t.TgZ(4,"div",3)(5,"div",4),t.NdJ("click",function(){return r.handleClickCancel()}),t._UZ(6,"app-cancel-link-org"),t.qZA(),t.TgZ(7,"div")(8,"app-last-updater-org",5),t._uU(9),t.qZA()()(),t._UZ(10,"hr",6),t.YNc(11,ui,36,53,"form",7),t.YNc(12,di,3,0,"div",8),t.qZA(),t.YNc(13,_i,4,2,"ng-template",null,9,t.W1O),t.YNc(15,mi,1,1,"ng-template",null,10,t.W1O),t.YNc(17,hi,1,1,"ng-template",null,11,t.W1O)),2&e&&(t.Q6J("breadcrumbList",t.kEZ(10,Ci,t.VKq(5,fi,r.listPagePath),t.VKq(7,vi,r.detailPagePath),t.DdM(9,Ti))),t.xp6(8),t.Q6J("roleTypeName",r.author&&r.author.role_name?r.author.role_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.xp6(1),t.hij(" \u767b\u9332\u8005\uff1a",r.author?r.author.last_name+" "+r.author.first_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."," "),t.xp6(2),t.Q6J("ngIf",!r.common.loading),t.xp6(1),t.Q6J("ngIf",r.common.loading))},dependencies:[Z.O5,Z.tP,V.Z,w.R,mt.d,B.r,z.K,p._Y,p.JL,p.sg,dt.a,Yr.t,ot.X]}),i})();var xi=d(9744),bi=d(5155);function Ei(i,s){if(1&i&&(t.ynx(0),t.TgZ(1,"div",36)(2,"p",29),t._uU(3,"\u767a\u6ce8\u66f8\u5168\u4f53\u5099\u8003"),t.qZA(),t.TgZ(4,"p",37),t._uU(5),t.qZA()(),t.BQk()),2&i){const e=t.oxw(2);t.xp6(5),t.Oqu(e.purchaseOrder.remarks)}}function Oi(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-text",44),t.NdJ("change",function(n){t.CHM(e);const o=t.oxw(2).$implicit,a=t.oxw(3);return t.KtG(a.updateReceivingQuantity(n,o.id))}),t.qZA(),t.BQk()}if(2&i){const e=t.oxw().$implicit,r=t.oxw().$implicit;t.xp6(1),t.Q6J("textRight",!0)("nameAttrValue","insert_receiving_quantity_"+r.id)("idAttrValue","insert_receiving-quantity-"+r.id)("formCtrl",e.controls.insert_receiving_quantity)}}function Di(i,s){if(1&i&&(t.ynx(0),t.YNc(1,Oi,2,4,"ng-container",20),t.BQk()),2&i){const e=s.$implicit,r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",r.id===e.controls.id.value)}}function Si(i,s){if(1&i&&(t.ynx(0),t._UZ(1,"app-text",45),t.BQk()),2&i){const e=t.oxw().$implicit,r=t.oxw().$implicit,n=t.oxw(3);t.xp6(1),t.Q6J("textRight",!0)("nameAttrValue","receiving_quantity_"+r.id)("idAttrValue","receiving-quantity-"+r.id)("formCtrl",e.controls.receiving_quantity)("invalid",n.formControlStateManager(e.controls.receiving_quantity)||(null==e.errors?null:e.errors.receivingQuantityLarge))}}function Zi(i,s){if(1&i&&(t.ynx(0),t.YNc(1,Si,2,5,"ng-container",20),t.BQk()),2&i){const e=s.$implicit,r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",r.id===e.controls.id.value)}}function Ii(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr")(2,"td",32)(3,"div",39)(4,"p"),t._uU(5),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA()()(),t.TgZ(8,"td",32)(9,"div",39)(10,"p"),t._uU(11),t.qZA(),t.TgZ(12,"p"),t._uU(13),t.qZA()()(),t.TgZ(14,"td",32)(15,"div")(16,"p"),t._uU(17),t.qZA(),t.TgZ(18,"div",40)(19,"div")(20,"p"),t._uU(21),t.qZA()(),t.TgZ(22,"div")(23,"p",31),t._uU(24),t.qZA()()(),t.TgZ(25,"p"),t._uU(26),t.qZA()()(),t.TgZ(27,"td",32)(28,"div",39)(29,"input",41),t.NdJ("change",function(n){const a=t.CHM(e).$implicit,u=t.oxw(3);return t.KtG(a.order_quantity=u.getValue(n))}),t.qZA()()(),t.TgZ(30,"td",32)(31,"div",39)(32,"p"),t._uU(33),t.qZA()()(),t.TgZ(34,"td",32)(35,"div",39)(36,"p"),t._uU(37),t.qZA(),t.TgZ(38,"p"),t._uU(39),t.qZA()()(),t.TgZ(40,"td",32)(41,"div",39)(42,"p"),t._uU(43),t.qZA(),t.TgZ(44,"p"),t._uU(45),t.qZA()()(),t.TgZ(46,"td",32)(47,"div",31)(48,"input",42),t.NdJ("change",function(n){const a=t.CHM(e).$implicit,u=t.oxw(3);return t.KtG(a.cost_price=u.getValue(n))}),t.qZA()()(),t.TgZ(49,"td",32)(50,"div",31)(51,"p"),t._uU(52),t.qZA()()(),t.TgZ(53,"td",43)(54,"div",31),t._uU(55),t.qZA()(),t.TgZ(56,"td",43),t.YNc(57,Di,2,1,"ng-container",38),t.qZA(),t.TgZ(58,"td",43)(59,"div",31),t.YNc(60,Zi,2,1,"ng-container",38),t._uU(61),t.qZA()()(),t.BQk()}if(2&i){const e=s.$implicit,r=s.index,n=t.oxw(3);t.xp6(5),t.Oqu(e.product_id),t.xp6(2),t.hij(" ",e.supplier_product_cd?e.supplier_product_cd:"-"," "),t.xp6(4),t.Oqu(e.ordering_target_barcode),t.xp6(2),t.AsE(" ",e.division_shelf_value,"-",e.division_shelf_col_value," "),t.xp6(4),t.Oqu(e.product_name),t.xp6(4),t.hij(" ",e.division_price_tag_value," "),t.xp6(3),t.hij(" ",e.division_seal_print_value," "),t.xp6(2),t.Oqu(e.remarks),t.xp6(3),t.Q6J("id",e.id)("value",e.order_quantity),t.xp6(4),t.hij(" ",n.product_order_status_list[r]?n.product_order_status_list[r].ordering_unit_name:""," "),t.xp6(4),t.Oqu(e.regulated_stock_num),t.xp6(2),t.Oqu(e.minimum_order_quantity),t.xp6(4),t.hij(" ",n.product_order_status_list[r]?n.product_order_status_list[r].ordering_quantity:0," "),t.xp6(2),t.hij(" ",n.product_order_status_list[r]?n.product_order_status_list[r].ordering_order_all_num:""," "),t.xp6(3),t.Q6J("id",e.id)("value",e.cost_price),t.xp6(4),t.hij(" ",e.cost_price?(e.cost_price*e.order_quantity).toLocaleString():0," "),t.xp6(3),t.hij(" ",n.orders_origin_receiving_quantity[r]?n.orders_origin_receiving_quantity[r]:0," "),t.xp6(2),t.Q6J("ngForOf",n.ordersForm.controls.order.controls),t.xp6(3),t.Q6J("ngForOf",n.ordersForm.controls.order.controls),t.xp6(1),t.hij(" ",e.receiving_quantity," ")}}function yi(i,s){if(1&i&&(t.ynx(0),t.YNc(1,Ii,62,23,"ng-container",38),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.orders)}}function Fi(i,s){if(1&i&&(t.ynx(0),t.TgZ(1,"tr")(2,"td",32)(3,"div",39)(4,"p"),t._uU(5),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA()()(),t.TgZ(8,"td",32)(9,"div",39)(10,"p"),t._uU(11),t.qZA(),t.TgZ(12,"p"),t._uU(13),t.qZA()()(),t.TgZ(14,"td",32)(15,"div")(16,"p"),t._uU(17),t.qZA(),t.TgZ(18,"div",40)(19,"div")(20,"p"),t._uU(21),t.qZA()(),t.TgZ(22,"div")(23,"p",31),t._uU(24),t.qZA()()(),t.TgZ(25,"p"),t._uU(26),t.qZA()()(),t.TgZ(27,"td",32)(28,"div",39),t._uU(29),t.qZA()(),t.TgZ(30,"td",32)(31,"div",39)(32,"p"),t._uU(33),t.qZA()()(),t.TgZ(34,"td",32)(35,"div",39)(36,"p"),t._uU(37),t.qZA(),t.TgZ(38,"p"),t._uU(39),t.qZA()()(),t.TgZ(40,"td",32)(41,"div",39)(42,"p"),t._uU(43),t.qZA(),t.TgZ(44,"p"),t._uU(45),t.qZA()()(),t.TgZ(46,"td",32)(47,"div",31),t._uU(48),t.qZA()(),t.TgZ(49,"td",32)(50,"div",31)(51,"p"),t._uU(52),t.qZA()()(),t.TgZ(53,"td",43)(54,"div",31),t._uU(55),t.qZA()()(),t.BQk()),2&i){const e=s.$implicit,r=s.index,n=t.oxw(4);t.xp6(5),t.Oqu(e.product_id),t.xp6(2),t.hij(" ",e.supplier_product_cd?e.supplier_product_cd:"-"," "),t.xp6(4),t.Oqu(e.ordering_target_barcode),t.xp6(2),t.AsE(" ",e.division_shelf_value,"-",e.division_shelf_col_value," "),t.xp6(4),t.Oqu(e.product_name),t.xp6(4),t.hij(" ",e.division_price_tag_value," "),t.xp6(3),t.hij(" ",e.division_seal_print_value," "),t.xp6(2),t.Oqu(e.remarks),t.xp6(3),t.hij(" ",e.order_quantity," "),t.xp6(4),t.hij(" ",n.delivered_order_status_list[r]?n.delivered_order_status_list[r].ordering_unit_name:""," "),t.xp6(4),t.Oqu(e.regulated_stock_num),t.xp6(2),t.Oqu(e.minimum_order_quantity),t.xp6(4),t.hij(" ",n.delivered_order_status_list[r]?n.delivered_order_status_list[r].ordering_quantity:0," "),t.xp6(2),t.hij(" ",n.delivered_order_status_list[r]?n.delivered_order_status_list[r].ordering_order_all_num:""," "),t.xp6(3),t.hij(" ",e.cost_price?e.cost_price.toLocaleString():0," "),t.xp6(4),t.hij(" ",e.cost_price?(e.cost_price*e.order_quantity).toLocaleString():0," "),t.xp6(3),t.hij(" ",e.receiving_quantity," ")}}function Ui(i,s){if(1&i&&(t.ynx(0),t.YNc(1,Fi,56,18,"ng-container",38),t.BQk()),2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.delivered_orders_products)}}function Ni(i,s){if(1&i&&(t.ynx(0),t.TgZ(1,"table",46)(2,"caption"),t._uU(3," \u691c\u54c1\u6e08\u307f "),t.qZA(),t.TgZ(4,"thead",22)(5,"tr")(6,"th",23)(7,"div")(8,"p"),t._uU(9,"\u81ea\u30b3\u30fc\u30c9"),t.qZA(),t.TgZ(10,"p"),t._uU(11,"\u76f8\u30b3\u30fc\u30c9"),t.qZA()()(),t.TgZ(12,"th",24)(13,"div")(14,"p"),t._uU(15,"JAN"),t.qZA(),t.TgZ(16,"p"),t._uU(17,"\u68da\u756a"),t.qZA()()(),t.TgZ(18,"th",25)(19,"div")(20,"p"),t._uU(21,"\u5546\u54c1\u540d"),t.qZA()()(),t.TgZ(22,"th",26)(23,"div")(24,"p"),t._uU(25,"\u6570\u91cf"),t.qZA()()(),t.TgZ(26,"th",26)(27,"div")(28,"p"),t._uU(29,"\u5358\u4f4d"),t.qZA()()(),t.TgZ(30,"th",23)(31,"div")(32,"p"),t._uU(33,"\u898f\u5b9a\u5728\u5eab"),t.qZA(),t.TgZ(34,"p"),t._uU(35,"\u6700\u5c0f\u767a\u6ce8\u6570"),t.qZA()()(),t.TgZ(36,"th",23)(37,"div")(38,"p"),t._uU(39,"\u30b1\u30fc\u30b9\u5165\u6570"),t.qZA(),t.TgZ(40,"p"),t._uU(41,"\u30d0\u30e9\u7dcf\u6570"),t.qZA()()(),t.TgZ(42,"th",27)(43,"div")(44,"p"),t._uU(45,"\u5358\u4fa1"),t.qZA()()(),t.TgZ(46,"th",27)(47,"div")(48,"p"),t._uU(49,"\u91d1\u984d"),t.qZA()()(),t.TgZ(50,"th",27)(51,"div")(52,"p"),t._uU(53,"\u7d0d\u54c1\u6e08\u6570\u91cf"),t.qZA()()()()(),t.TgZ(54,"tbody",47),t.YNc(55,Ui,2,1,"ng-container",20),t.TgZ(56,"tr",29)(57,"td",30)(58,"div",31)(59,"p"),t._uU(60,"\u5408\u8a08"),t.qZA()()(),t.TgZ(61,"td",32)(62,"div",31),t._UZ(63,"p"),t.qZA()(),t.TgZ(64,"td",32)(65,"div",31)(66,"p"),t._uU(67),t.qZA()()(),t._UZ(68,"td",32),t.qZA()()(),t.BQk()),2&i){const e=t.oxw(2);t.xp6(55),t.Q6J("ngIf",e.delivered_orders_products),t.xp6(12),t.Oqu(e.calculateDeliveredTotalAmount().toLocaleString())}}function qi(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",10)(1,"div",11)(2,"h1",12),t._uU(3,"\u691c\u54c1"),t.qZA(),t.TgZ(4,"div",13)(5,"span",14),t._uU(6),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.qZA()(),t.TgZ(9,"div",15)(10,"span"),t._uU(11),t.qZA()()(),t.TgZ(12,"div",16)(13,"div",17)(14,"p")(15,"span",18),t._uU(16,"\u6ce8\u6587\u5148"),t.qZA(),t.TgZ(17,"span"),t._uU(18),t.qZA()(),t.TgZ(19,"p"),t._uU(20),t.qZA(),t.TgZ(21,"p"),t._uU(22),t.qZA(),t.TgZ(23,"p"),t._uU(24),t.qZA(),t.TgZ(25,"p"),t._uU(26),t.qZA(),t.TgZ(27,"p")(28,"span",18),t._uU(29),t.qZA(),t.TgZ(30,"span"),t._uU(31),t.qZA()()(),t.TgZ(32,"div",17)(33,"div",19)(34,"div")(35,"p"),t._uU(36,"\u767a\u6ce8\u8005"),t.qZA(),t.TgZ(37,"p"),t._uU(38),t.qZA()(),t.TgZ(39,"div")(40,"p"),t._uU(41,"\u62c5\u5f53\u8005"),t.qZA(),t.TgZ(42,"p"),t._uU(43),t.qZA()()(),t.TgZ(44,"p"),t._uU(45),t.qZA(),t.TgZ(46,"p"),t._uU(47),t.qZA(),t.TgZ(48,"p"),t._uU(49,"---"),t.qZA(),t.TgZ(50,"p")(51,"span",18),t._uU(52),t.qZA(),t.TgZ(53,"span"),t._uU(54),t.qZA()()(),t.TgZ(55,"div",17)(56,"div",19)(57,"div")(58,"p"),t._uU(59,"\u5c4a\u3051\u5148"),t.qZA(),t.TgZ(60,"p"),t._uU(61),t.qZA()()(),t.TgZ(62,"p"),t._uU(63),t.qZA(),t.TgZ(64,"p"),t._uU(65),t.qZA(),t.TgZ(66,"p"),t._uU(67),t.qZA(),t.TgZ(68,"p")(69,"span",18),t._uU(70),t.qZA(),t.TgZ(71,"span"),t._uU(72),t.qZA()()()(),t.YNc(73,Ei,6,1,"ng-container",20),t.TgZ(74,"table",21)(75,"thead",22)(76,"tr")(77,"th",23)(78,"div")(79,"p"),t._uU(80,"\u81ea\u30b3\u30fc\u30c9"),t.qZA(),t.TgZ(81,"p"),t._uU(82,"\u76f8\u30b3\u30fc\u30c9"),t.qZA()()(),t.TgZ(83,"th",24)(84,"div")(85,"p"),t._uU(86,"JAN"),t.qZA(),t.TgZ(87,"p"),t._uU(88,"\u68da\u756a"),t.qZA()()(),t.TgZ(89,"th",25)(90,"div")(91,"p"),t._uU(92,"\u5546\u54c1\u540d"),t.qZA()()(),t.TgZ(93,"th",26)(94,"div")(95,"p"),t._uU(96,"\u6570\u91cf"),t.qZA()()(),t.TgZ(97,"th",26)(98,"div")(99,"p"),t._uU(100,"\u5358\u4f4d"),t.qZA()()(),t.TgZ(101,"th",23)(102,"div")(103,"p"),t._uU(104,"\u898f\u5b9a\u5728\u5eab"),t.qZA(),t.TgZ(105,"p"),t._uU(106,"\u6700\u5c0f\u767a\u6ce8\u6570"),t.qZA()()(),t.TgZ(107,"th",23)(108,"div")(109,"p"),t._uU(110,"\u30b1\u30fc\u30b9\u5165\u6570"),t.qZA(),t.TgZ(111,"p"),t._uU(112,"\u30d0\u30e9\u7dcf\u6570"),t.qZA()()(),t.TgZ(113,"th",27)(114,"div")(115,"p"),t._uU(116,"\u5358\u4fa1"),t.qZA()()(),t.TgZ(117,"th",27)(118,"div")(119,"p"),t._uU(120,"\u91d1\u984d"),t.qZA()()(),t.TgZ(121,"th",27)(122,"div")(123,"p"),t._uU(124,"\u5165\u5eab\u6e08"),t.qZA()()(),t.TgZ(125,"th",27)(126,"div")(127,"p"),t._uU(128,"\u4eca\u56de\u5165\u5eab"),t.qZA()()(),t.TgZ(129,"th",27)(130,"div")(131,"p"),t._uU(132,"\u5165\u5eab\u5f8c\u7dcf\u6570"),t.qZA()()()()(),t.TgZ(133,"tbody",28),t.YNc(134,yi,2,1,"ng-container",20),t.TgZ(135,"tr",29)(136,"td",30)(137,"div",31)(138,"p"),t._uU(139,"\u5408\u8a08"),t.qZA()()(),t.TgZ(140,"td",32)(141,"div",31),t._UZ(142,"p"),t.qZA()(),t.TgZ(143,"td",32)(144,"div",31)(145,"p"),t._uU(146),t.qZA()()(),t._UZ(147,"td",33),t.qZA()()(),t.TgZ(148,"div",34)(149,"app-button",35),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.bulkUpdate())}),t._uU(150," \u4fdd\u5b58 "),t.qZA()(),t.YNc(151,Ni,69,2,"ng-container",20),t.qZA()}if(2&i){const e=t.oxw();t.xp6(6),t.hij("\u767a\u6ce8No\uff1a",e.purchaseOrder.id,""),t.xp6(2),t.AsE("\u767a\u6ce8\u65e5\uff1a",e.dateFormatter(e.purchaseOrder.order_date),"\uff08\u5e0c\u671b\u7d0d\u5165\u65e5\uff1a",e.dateFormatter(e.purchaseOrder.preferred_delivery_date),"\uff09"),t.xp6(3),t.hij("\u30b9\u30c6\u30fc\u30bf\u30b9\uff1a",e.purchaseOrder.purchase_order_status_value,""),t.xp6(7),t.Oqu(e.purchaseOrder.supplier_id),t.xp6(2),t.Oqu(e.purchaseOrder.supplier_name),t.xp6(2),t.hij("\u3012",e.purchaseOrder.supplier_postal_code,""),t.xp6(2),t.lnq(" ",e.purchaseOrder.supplier_province,"",e.purchaseOrder.supplier_locality,"",e.purchaseOrder.supplier_street_address," "),t.xp6(2),t.hij(" ",e.purchaseOrder.supplier_other_address?e.purchaseOrder.supplier_other_address:"---"," "),t.xp6(3),t.hij("TEL\uff1a",e.purchaseOrder.supplier_tel,""),t.xp6(2),t.hij("FAX\uff1a",e.purchaseOrder.supplier_fax,""),t.xp6(7),t.Oqu(e.basicInformation.name),t.xp6(5),t.hij(" ",e.purchaseOrder.employee_order_last_name+" "+e.purchaseOrder.employee_order_first_name," "),t.xp6(2),t.hij("\u3012",e.basicInformation.postal_code,""),t.xp6(2),t.hij(" ",e.basicInformation.province+e.basicInformation.locality+e.basicInformation.street_address," "),t.xp6(5),t.hij("TEL\uff1a",e.basicInformation.tel,""),t.xp6(2),t.hij("FAX\uff1a",e.basicInformation.fax,""),t.xp6(7),t.AsE("",e.basicInformation.name," ",e.purchaseOrder.store_name,""),t.xp6(2),t.hij("\u3012",e.purchaseOrder.store_postal_code,""),t.xp6(2),t.lnq(" ",e.purchaseOrder.store_province,"",e.purchaseOrder.store_locality,"",e.purchaseOrder.store_street_address," "),t.xp6(2),t.hij(" ",e.purchaseOrder.store_other_address?e.purchaseOrder.store_other_address:"---"," "),t.xp6(3),t.hij("TEL\uff1a",e.purchaseOrder.store_tel,""),t.xp6(2),t.hij("FAX\uff1a",e.purchaseOrder.store_fax,""),t.xp6(1),t.Q6J("ngIf",e.purchaseOrder.remarks),t.xp6(61),t.Q6J("ngIf",e.orders),t.xp6(12),t.Oqu(e.calculateTotalAmount().toLocaleString()),t.xp6(3),t.Q6J("buttonDisabled",e.ordersForm.invalid||!e.is_save_true),t.xp6(2),t.Q6J("ngIf",e.is_delivered)}}function Ri(i,s){1&i&&(t.TgZ(0,"div",48)(1,"p",49),t._uU(2,"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.qZA()())}function Mi(i,s){1&i&&(t.TgZ(0,"span",52),t._uU(1,"\u5fc5\u9808"),t.qZA())}function Li(i,s){if(1&i&&(t.TgZ(0,"div",50)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,Mi,2,0,"span",51),t.qZA()),2&i){const e=s.label,r=s.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",r)}}function Pi(i,s){if(1&i&&(t.TgZ(0,"p",54),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function Bi(i,s){if(1&i&&(t.ynx(0),t.YNc(1,Pi,2,1,"p",53),t.BQk()),2&i){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required)}}function Yi(i,s){if(1&i&&t.YNc(0,Bi,2,1,"ng-container",20),2&i){const e=s.ctrl,r=t.oxw();t.Q6J("ngIf",r.formControlStateManager(e))}}const ki=function(i){return{path:i,text:"\u767a\u6ce8\u66f8\u4e00\u89a7"}},Vi=function(i){return{path:i,text:"\u767a\u6ce8\u66f8\u8a73\u7d30"}},Ji=function(){return{text:"\u767a\u6ce8\u691c\u54c1"}},Gi=function(i,s,e){return[i,s,e]};function wi(i,s){1&i&&t.GkF(0)}function Ki(i,s){1&i&&t.GkF(0)}const xt=function(i){return{ctrl:i}};function ji(i,s){if(1&i&&(t.TgZ(0,"div",25),t.YNc(1,Ki,1,0,"ng-container",17),t.qZA()),2&i){const e=t.oxw(),r=t.MAs(36);t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(2,xt,e.ctrls.dateGroup.controls.from_date_of_sale))}}function Hi(i,s){1&i&&t.GkF(0)}function $i(i,s){1&i&&t.GkF(0)}function Xi(i,s){if(1&i&&(t.TgZ(0,"div",25),t.YNc(1,$i,1,0,"ng-container",17),t.qZA()),2&i){const e=t.oxw(),r=t.MAs(36);t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(2,xt,e.ctrls.dateGroup.controls.to_date_of_sale))}}function zi(i,s){1&i&&t.GkF(0)}function Wi(i,s){1&i&&(t.TgZ(0,"span",28),t._uU(1,"\u5fc5\u9808"),t.qZA())}function tn(i,s){if(1&i&&(t.TgZ(0,"div",26)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,Wi,2,0,"span",27),t.qZA()),2&i){const e=s.label,r=s.required;t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("ngIf",r)}}function en(i,s){if(1&i&&(t.TgZ(0,"p",31),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.errorConst.FORM_ERROR.REQUIRED_ITEM," ")}}function rn(i,s){if(1&i&&(t.ynx(0),t.YNc(1,en,2,1,"p",30),t.BQk()),2&i){const e=t.oxw().ctrl;t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required)}}function nn(i,s){if(1&i&&t.YNc(0,rn,2,1,"ng-container",29),2&i){const e=s.ctrl,r=t.oxw();t.Q6J("ngIf",r.formControlStateManager(e))}}function on(i,s){if(1&i&&(t.ynx(0),t.TgZ(1,"p",31),t._uU(2),t.qZA(),t.BQk()),2&i){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.errorConst.FORM_ERROR.DATE_SPECIFICATION_VIOLATION," ")}}function sn(i,s){if(1&i&&t.YNc(0,on,3,1,"ng-container",29),2&i){const e=s.ctrls;t.Q6J("ngIf",null==e.errors?null:e.errors.endingDateIsSmaller)}}const an=function(i){return{path:i,text:"\u767a\u6ce8\u66f8\u4e00\u89a7"}},un=function(){return{text:"\u767a\u6ce8\u30c7\u30fc\u30bf\u65b0\u898f\u767b\u9332"}},dn=function(i,s){return[i,s]},ln=function(){return{label:"\u58f2\u4e0a\u65e5\uff08\u81ea",required:"true"}},_n=function(){return{label:"\u58f2\u4e0a\u65e5\uff08\u81f3",required:"true"}},cn=function(i){return{ctrls:i}},pn=[{path:"",component:Et,children:[{path:"",component:Vt},{path:"add",component:Me},{path:"detail/:id",component:Br},{path:"edit/:id",component:Ai},{path:"inspection/:id",component:(()=>{class i{constructor(e,r,n,o,a,u,l,m,g,h,c,v,O,C,I,j){this.authorService=e,this.poService=r,this.orderService=n,this.productService=o,this.biService=a,this.divisionService=u,this.fb=l,this.errorService=m,this.activatedRoute=g,this.modalService=h,this.router=c,this.flashMessageService=v,this.common=O,this.purchaseService=C,this.purchaseDetailService=I,this.dIService=j,this.errorModalTitle="\u767a\u6ce8\u66f8\u8a73\u7d30\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.errorConst=y.c,this.errorModalTitleOrderQuantity="\u30aa\u30fc\u30c0\u30fc\u91cf\u66f4\u65b0\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.subscription=new U.w0,this.purchaseOrderConst=b,this.listPagePath="/purchase-order",this.inspectionPath="/purchase-order/inspection",this.cancelModalTitle="\u767a\u6ce8\u691c\u54c1\u30ad\u30e3\u30f3\u30bb\u30eb\uff1a"+_.yR.TITLE.CANCEL,this.statusDivisionOptions=[{value:"",text:it.s.PLEASE_SELECT}],this.orders_origin_receiving_quantity=[],this.delivered_orders_products=[],this.is_delivered=!1,this.is_posted=!1,this.ordersDetail=[],this.purchaseData=[],this.purchaseDetails=[],this.is_save_true=!1}receivingQuantityLarge(){return e=>{const r=e.get("order_quantity")?.value,n=e.get("receiving_quantity")?.value;return r<n?{receivingQuantityLarge:!0}:null}}ngOnInit(){this.authorService.author?this.author=this.authorService.author:this.subscription.add(this.authorService.author$.subscribe(n=>{this.author=n})),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,S.h)(n=>this.modalService.getModalProperties().title===this.errorModalTitle)).subscribe(n=>{n===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.listPagePath)}));const e=this.activatedRoute.snapshot.params.id;this.isParameterInvalid(e)?this.modalService.setModal(this.errorModalTitle,_.yR.BODY.CANCEL,"danger",_.yR.BUTTON_TITLE.CLOSE):(this.selectedId=Number(e),this.detailPagePath=this.listPagePath+"/detail/"+e,this.initialization(Number(e)),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,S.h)(n=>this.modalService.getModalProperties().title===this.cancelModalTitle)).subscribe(n=>{n===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.detailPagePath)})))}isParameterInvalid(e){return null===e||!!isNaN(Number(e))}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}getMonthFirstDate(){let e=new Date;return new Date(e.getFullYear(),e.getMonth(),1).toLocaleDateString()}getMonthLastDate(){let e=new Date;return new Date(e.getFullYear(),e.getMonth()+1,0).toLocaleDateString()}initialization(e){this.common.loading=!0,this.subscription.add((0,Y.D)([this.poService.find(e),this.orderService.getAll({purchase_order_id:e}),this.biService.find(),this.divisionService.getAll(),this.purchaseService.getAll({purchase_order_id:e,from_purchase_date:this.getMonthFirstDate(),to_purchase_date:this.getMonthLastDate()}),this.purchaseDetailService.getAll({purchase_order_id:e,from_receiving_date:this.getMonthFirstDate(),to_receiving_date:this.getMonthLastDate()})]).pipe((0,f.K)(r=>(0,T.of)(r)),(0,rt.w)(r=>{if(r instanceof A.UA)return this.common.loading=!1,(0,T.of)(r);const n=r[0].data[0],o=r[1].data,a=o.map(h=>h.product_id),u=r[2].data[0],l=r[3].data,m=r[4].data,g=r[5].data;return this.productService.getAll({supplier_id:n.supplier_id,id:a.join(", ")}).pipe((0,ft.U)(h=>({purchaseOrder:n,orders:o,basicInformation:u,statusDivisions:l,products:h.data,purchase:m,purchaseDetails:g})),(0,f.K)(h=>(0,T.of)(h)),(0,x.x)(()=>this.common.loading=!1))}),(0,x.x)(()=>this.common.loading=!1)).subscribe(r=>{if(r instanceof A.UA)return void this.handleError(r.status,r.error?r.error.title?r.error.title:"":"\u30a8\u30e9\u30fc",r.error?r.error.message:r.message,this.listPagePath);if(null==r)return void this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR);if(Array.isArray(r)&&5!==r.length)return void this.handleError(400,this.errorModalTitle,_.yR.BODY.HAS_ERROR);r.purchase.length>0&&(this.is_posted=!0,this.purchaseData=r.purchase,this.purchaseDetails=r.purchaseDetails),this.purchaseOrder=r.purchaseOrder,this.isSent=!1,this.purchaseOrderStatusDivisions=r.statusDivisions.filter(c=>c.name===D.z.PURCHASE_ORDER_STATUS),this.orderStatusDivisions=r.statusDivisions.filter(c=>c.name===D.z.ORDER_STATUS),this.purchaseOrder.purchase_order_status_code===b.STATUS_CODE.SENT&&(this.isSent=!0),this.unitDivisions=r.statusDivisions.filter(c=>c.name===D.z.UNIT),this.updaterFullName=this.purchaseOrder.employee_updated_last_name+" "+this.purchaseOrder.employee_updated_first_name,this.basicInformation=r.basicInformation,this.products=r.products;const o=this.mergeOrdersAndProducts(this.products,r.orders),a=[];o.forEach((c,v)=>{const O=this.purchaseDetails.find(j=>j.product_id===c.product_id),C=""===String(c.receiving_quantity)?0:c.receiving_quantity,I=c.receiving_quantity?c.order_quantity-c.receiving_quantity:c.order_quantity;if(c.order_status_division_id!=this.getOrderStatusId(L_STATUS_CODE_INSPECTED)){const j=this.fb.group({id:c.id,purchase_order_id:c.purchase_order_id,purchase_id:O?.purchase_id,product_id:c.product_id,order_quantity:c.order_quantity,cost_price:c.cost_price,receiving_quantity:c.order_quantity,insert_receiving_quantity:I,origin_receiving_quantity:C,receiving_date:c.receiving_date,receiving_employee_id:c.receiving_employee_id,order_status_division_id:c.order_status_division_id,remarks:c.remarks});a.push(j)}}),this.ordersForm=this.fb.group({order:this.fb.array(a)}),this.ordersForm.controls.order.controls.forEach(c=>{c.addValidators(this.receivingQuantityLarge()),c.controls.receiving_quantity.addValidators(p.kI.pattern(M.m.NUMERIC_REG_EX))});let u=[],m=r.statusDivisions.filter(c=>c.name===D.z.ORDER_STATUS).find(c=>c.division_code===L_STATUS_CODE_INSPECTED);for(let c in o)o[c].order_status_division_id===m?.id?(this.delivered_orders_products.push(o[c]),this.is_delivered=!0):u.push(o[c]);const g=this.sortByShelfNumber(u);g.filter(c=>{this.orders_origin_receiving_quantity.push(c.receiving_quantity)}),this.orders=g;for(let c in this.orders)this.orders[c].receiving_quantity=this.orders[c].order_quantity;this.orders.length&&(this.is_save_true=!0),this.product_order_status=this.orderingTargetData(this.orders),this.delivered_order_status=this.orderingTargetData(this.delivered_orders_products),this.product_order_status_list=g.map((c,v)=>{let O;return this.product_order_status.forEach(C=>{c.product_id==C.product_id&&c.id==C.order_id&&(O=C,O.ordering_unit_name=this.getUnitName(C.ordering_unit_division_id),O.ordering_unit_code_name=this.getUnitName(C.ordering_unit_code),O.ordering_order_all_num=Number(C.ordering_quantity)*Number(c.order_quantity))}),O}),this.delivered_order_status_list=this.delivered_orders_products.map((c,v)=>{let O;return this.delivered_order_status.forEach(C=>{c.product_id==C.product_id&&c.id==C.order_id&&(O=C,O.ordering_unit_name=this.getUnitName(C.ordering_unit_division_id),O.ordering_unit_code_name=this.getUnitName(C.ordering_unit_code),O.ordering_order_all_num=Number(C.ordering_quantity)*Number(c.order_quantity))}),O}),this.DIVISION_UNIT_CATEGORY_SMALL=this.dIService.getDivisionid(r.statusDivisions,D.z.DIVISION_UNIT_CATEGORY,b.UNIT_CATEGORY.CODE.SMALL),this.DIVISION_UNIT_CATEGORY_MEDIUM=this.dIService.getDivisionid(r.statusDivisions,D.z.DIVISION_UNIT_CATEGORY,b.UNIT_CATEGORY.CODE.MEDIUM),this.DIVISION_UNIT_CATEGORY_LARGE=this.dIService.getDivisionid(r.statusDivisions,D.z.DIVISION_UNIT_CATEGORY,b.UNIT_CATEGORY.CODE.LARGE)}))}getUnitName(e){let r="";return this.unitDivisions.map((n,o)=>{n.id==e&&(r=n.value)}),r}orderingTargetData(e){let n,r=[];return e.forEach(o=>{switch(o.ordering_target_barcode){case o.b_barcode:n={order_id:o.id,product_id:o.product_id,ordering_gross_profit_rate:o.b_gross_profit_rate,ordering_barcode:o.b_barcode,ordering_quantity:o.b_quantity,ordering_order_all_num:0,ordering_selling_price:o.b_selling_price,ordering_supplier_cost_price:o.b_supplier_cost_price,ordering_unit_division_id:o.b_unit_division_id,ordering_unit_name:"",ordering_unit_code:this.DIVISION_UNIT_CATEGORY_MEDIUM,ordering_unit_code_name:""};break;case o.c_barcode:n={order_id:o.id,product_id:o.product_id,ordering_gross_profit_rate:o.c_gross_profit_rate,ordering_barcode:o.c_barcode,ordering_quantity:o.c_quantity,ordering_order_all_num:0,ordering_selling_price:o.c_selling_price,ordering_supplier_cost_price:o.c_supplier_cost_price,ordering_unit_division_id:o.c_unit_division_id,ordering_unit_name:"",ordering_unit_code:this.DIVISION_UNIT_CATEGORY_LARGE,ordering_unit_code_name:""};break;default:n={order_id:o.id,product_id:o.product_id,ordering_gross_profit_rate:o.gross_profit_rate,ordering_barcode:o.barcode,ordering_quantity:o.quantity,ordering_order_all_num:0,ordering_selling_price:o.selling_price,ordering_supplier_cost_price:o.supplier_cost_price,ordering_unit_division_id:o.unit_division_id,ordering_unit_name:"",ordering_unit_code:this.DIVISION_UNIT_CATEGORY_SMALL,ordering_unit_code_name:""}}r.push(n)}),r}mergeOrdersAndProducts(e,r){let n=[];return r.forEach(o=>{e.forEach(a=>{o.product_id===a.id&&n.push({...a,...o})})}),n}sortByShelfNumber(e){return e.sort((n,o)=>n.division_shelf_value&&o.division_shelf_col_value&&n.division_shelf_col_value&&o.division_shelf_col_value?n.division_shelf_value+n.division_shelf_col_value>n.division_shelf_value+o.division_shelf_col_value?1:-1:n.product_id>o.product_id?1:-1)}dateFormatter(e){return new Date(e).toLocaleDateString()}bulkUpdate(){this.common.loading=!0;const e=[],r=[];let n,o;if(this.ordersForm.controls.order.controls.forEach(u=>{console.log(u),null==u.controls.receiving_quantity.value||""===u.controls.receiving_quantity.value||0===u.controls.receiving_quantity.value||u.controls.order_quantity.value<u.controls.receiving_quantity.value?(n=this.getOrderStatusId(L_STATUS_CODE_BEFORE_INSPECTION),o=0):u.controls.order_quantity.value>u.controls.receiving_quantity.value?(n=this.getOrderStatusId(L_STATUS_CODE_SHORTAGE_OUT_OF_STOCK),o=u.controls.receiving_quantity.value):(n=this.getOrderStatusId(L_STATUS_CODE_INSPECTED),o=u.controls.receiving_quantity.value);const l={id:u.controls.id.value,purchase_order_id:u.controls.purchase_order_id.value,product_id:u.controls.product_id.value,order_quantity:u.controls.order_quantity.value,cost_price:u.controls.cost_price.value,receiving_quantity:o,receiving_date:(new Date).toLocaleString(),receiving_employee_id:this.author.id,order_status_division_id:n,remarks:u.controls.remarks.value};if(e.push(l),n!=this.getOrderStatusId(L_STATUS_CODE_BEFORE_INSPECTION)){const m={purchase_order_id:u.controls.purchase_order_id.value,product_id:u.controls.product_id.value,purchase_id:u.controls.purchase_id.value,order_quantity:u.controls.order_quantity.value,order_price:u.controls.cost_price.value,receiving_quantity:u.controls.insert_receiving_quantity.value,receiving_date:(new Date).toLocaleString(),receiving_employee_id:this.author.id,order_status_division_id:n,remarks:u.controls.remarks.value};r.push(m)}}),!e.length)return void(this.common.loading=!1);const a=(0,W.Nf)(e);this.orderService.bulkAdd(a).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(u=>(0,T.of)(u))).subscribe(u=>{if(u instanceof A.UA)this.handleError(u.status,u.error.title,u.message);else if(!0===this.is_posted){this.common.loading=!0;const l=(0,W.Nf)(r);this.purchaseDetailService.bulkAdd(l).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(m=>(0,T.of)(m))).subscribe(m=>{m instanceof A.UA?this.handleError(m.status,m.error.title,m.message):window.location.reload()})}else{this.common.loading=!0;const{id:l,...m}=Object.assign({},this.purchaseOrder),g=Object.assign(m,{purchase_order_id:this.purchaseOrder.id,purchase_date:(new Date).toLocaleString(),purchase_detail:r});this.purchaseService.add(g).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(h=>(0,T.of)(h))).subscribe(h=>{h instanceof A.UA?this.handleError(h.status,h.error.title,h.message):window.location.reload()})}})}getOrderStatusId(e){const r=this.orderStatusDivisions.find(n=>n.division_code===e);return r?r.id:""}handleClickDelete(){if(this.isSent)return void this.handleError(422,b.ERROR.CANNOT_BE_DELETED,b.ERROR.ATTEMPTED_TO_MODIFY_SUBMITTED_DATA_CHANGE);const e="\u767a\u6ce8\u66f8"+_.yR.TITLE.DELETE;this.modalService.setModal(e,_.yR.BODY.DELETE,"danger",_.yR.BUTTON_TITLE.DELETE,_.yR.BUTTON_TITLE.CANCEL),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,N.q)(1),(0,S.h)(n=>this.modalService.getModalProperties().title===e)).subscribe(n=>{n===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&(this.common.loading=!0,this.poService.remove(this.selectedId).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(o=>(0,T.of)(o))).subscribe(o=>{o instanceof A.UA?this.handleError(o.status,o.error.title,o.message):(this.flashMessageService.setFlashMessage(o.message,"success",15e3),this.router.navigateByUrl(this.listPagePath))}))}))}handleClickCancel(){this.modalService.setModal(this.cancelModalTitle,_.yR.BODY.CANCEL,"warning",_.yR.BUTTON_TITLE.EXECUTION,_.yR.BUTTON_TITLE.CANCEL)}handleError(e,r,n,o){this.errorService.setError({status:e,title:r,message:n,redirectPath:o})}ngOnDestroy(){this.subscription.unsubscribe()}updateReceivingQuantity(e,r){let n=e.target.value,o=this.ordersForm.controls.order.controls.find(l=>l.controls.id.value===r),a=Number(o?.controls.origin_receiving_quantity.value)+Number(n);o?.controls.receiving_quantity.patchValue(Number(a)),this.orders.find((l,m)=>{l.id===r&&(l.receiving_quantity=Number(a))})}getValue(e){let r=e.target.value,o=e.target.name,a={id:e.target.id,name:o,value:r};return"order_quantity"==o?this.changeOrderData(a):"cost_price"==o&&this.changeCostrData(a),r}changeOrderData(e){this.common.loading=!0;let r=Number(e.id),n=Number(e.value);this.subscription.add(this.orderService.find(r).pipe((0,x.x)(()=>this.common.loading=!0),(0,f.K)(o=>(0,T.of)(o))).subscribe(o=>{if(o instanceof A.UA)return void this.handleError(o.status,this.errorModalTitleOrderQuantity,o.message);let a=o.data[0];this.orderService.update(r,{order_quantity:n,purchase_order_id:a.purchase_order_id,product_id:a.product_id}).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(l=>(0,T.of)(l))).subscribe(l=>{l instanceof A.UA?this.handleError(l.status,this.errorModalTitleOrderQuantity,l.error.message):(this.flashMessageService.setFlashMessage(l.message,"success",15e3),this.common.loading=!1)})}))}changeCostrData(e){this.common.loading=!0;let r=Number(e.id),n=Number(e.value);this.subscription.add(this.orderService.find(r).pipe((0,x.x)(()=>this.common.loading=!0),(0,f.K)(o=>(0,T.of)(o))).subscribe(o=>{if(o instanceof A.UA)return void this.handleError(o.status,this.errorModalTitleOrderQuantity,o.message);let a=o.data[0];this.orderService.update(r,{cost_price:n,order_quantity:a.order_quantity,purchase_order_id:a.purchase_order_id,product_id:a.product_id}).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(l=>(0,T.of)(l))).subscribe(l=>{l instanceof A.UA?this.handleError(l.status,this.errorModalTitleOrderQuantity,l.error.message):(this.flashMessageService.setFlashMessage(l.message,"success",15e3),this.common.loading=!1)})}))}calculateTotalAmount(){if(!this.orders||!this.product_order_status_list)return 0;let e=0;return this.orders.forEach((r,n)=>{this.product_order_status_list[n]&&(e+=Number(r.cost_price)*r.order_quantity)}),e}calculateDeliveredTotalAmount(){if(!this.delivered_orders_products||!this.delivered_order_status_list)return 0;let e=0;return this.delivered_orders_products.forEach((r,n)=>{this.delivered_order_status_list[n]&&(e+=Number(r.cost_price)*r.order_quantity)}),e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(X.Y),t.Y36(J),t.Y36(lt.p),t.Y36(ut.M),t.Y36(vt.h),t.Y36(Q.E),t.Y36(p.qu),t.Y36(P.T),t.Y36(E.gz),t.Y36(F.Z),t.Y36(E.F0),t.Y36(G.P),t.Y36(R.v),t.Y36(Tt.B),t.Y36(Ct.p),t.Y36(xi.J))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-inspection"]],decls:16,vars:13,consts:[[3,"breadcrumbList"],[1,"mb-8"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"cursor-pointer",3,"click"],[1,"width-limit-break","border-t","border-gray-400"],["class","border border-slate-300 bg-white p-4 mt-6",4,"ngIf"],["class","mt-12 text-center",4,"ngIf"],["labels",""],["errors",""],[1,"border","border-slate-300","bg-white","p-4","mt-6"],[1,"relative"],[1,"absolute","top-0","right-[600px]","text-2xl"],[1,"absolute","left-0","top-[6px]"],[1,"mr-4"],[1,"absolute","right-0","top-[6px]"],[1,"grid","grid-cols-3","gap-2","mt-[32px]"],[1,"border","border-slate-300","py-1","px-2","min-h-[160px]"],[1,"mr-6"],[1,"flex","flex-row","gap-6"],[4,"ngIf"],[1,"mt-2","w-[100%]","table-fixed","border-collapse","border","border-slate-400"],[1,"text-sm"],[1,"border","border-slate-300","w-[80px]"],[1,"border","border-slate-300","w-[108px]"],[1,"border","border-slate-300","w-[350px]"],[1,"border","border-slate-300","w-[54px]"],[1,"border","border-slate-300"],[1,"text-xs"],[1,"font-bold"],["colspan","7",1,"border","border-slate-300","px-1"],[1,"text-right"],[1,"border","border-slate-300","px-1"],["colspan","3",1,"border","border-slate-300","px-1"],[1,"mt-4","flex","justify-end"],["btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled","click"],[1,"border","border-slate-300","bg-white","p-2","mt-2","text-sm"],[1,"mt-1"],[4,"ngFor","ngForOf"],[1,"text-center"],[1,"flex","justify-between"],["type","text","name","order_quantity",2,"width","95%","text-align","right",3,"id","value","change"],["type","text","name","cost_price",2,"width","95%","text-align","right",3,"id","value","change"],[1,"border","border-slate-300","px-1","py-[2px]"],[3,"textRight","nameAttrValue","idAttrValue","formCtrl","change"],[2,"display","none",3,"textRight","nameAttrValue","idAttrValue","formCtrl","invalid"],[1,"mt-2","w-[100%]","table-fixed","border-collapse","border","border-slate-400","bg-slate-100"],[1,"text-xs","bg-slate-100"],[1,"mt-12","text-center"],[1,"text-2xl","text-slate-600"],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,r){1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main",1)(2,"h1",2),t._uU(3,"\u767a\u6ce8\u691c\u54c1"),t.qZA(),t.TgZ(4,"div",3)(5,"div",4),t.NdJ("click",function(){return r.handleClickCancel()}),t._UZ(6,"app-cancel-link-org"),t.qZA(),t.TgZ(7,"app-last-updater-org"),t._uU(8),t.qZA()(),t._UZ(9,"hr",5),t.YNc(10,qi,152,33,"div",6),t.YNc(11,Ri,3,0,"div",7),t.qZA(),t.YNc(12,Li,4,2,"ng-template",null,8,t.W1O),t.YNc(14,Yi,1,1,"ng-template",null,9,t.W1O)),2&e&&(t.Q6J("breadcrumbList",t.kEZ(9,Gi,t.VKq(4,ki,r.listPagePath),t.VKq(6,Vi,r.detailPagePath),t.DdM(8,Ji))),t.xp6(8),t.hij(" \u6700\u7d42\u66f4\u65b0\u8005\uff1a",r.updaterFullName," "),t.xp6(2),t.Q6J("ngIf",!r.common.loading&&r.purchaseOrder),t.xp6(1),t.Q6J("ngIf",r.common.loading))},dependencies:[Z.sg,Z.O5,V.Z,w.R,B.r,z.K,bi.T]}),i})()},{path:"order-data-creation",component:(()=>{class i{constructor(e,r,n,o,a,u,l,m,g,h,c,v){this.poService=e,this.modalService=r,this.flashMessageService=n,this.router=o,this.fb=a,this.authorService=u,this.supplierService=l,this.employeeService=m,this.errorService=g,this.storeService=h,this.divisionService=c,this.common=v,this.subscription=new U.w0,this.listPagePath="/purchase-order",this.cancelModalTitle="\u767a\u6ce8\u30c7\u30fc\u30bf\u767b\u9332\u30ad\u30e3\u30f3\u30bb\u30eb\uff1a"+_.yR.TITLE.CANCEL,this.errorModalTitle="\u767a\u6ce8\u30c7\u30fc\u30bf\u65b0\u898f\u767b\u9332\u30a8\u30e9\u30fc\uff1a"+_.yR.TITLE.HAS_ERROR,this.errorConst=y.c,this.init_date=this.getInitDate(),this.form=this.fb.group({dateGroup:this.fb.group({from_date_of_sale:["",[p.kI.required]],to_date_of_sale:["",[p.kI.required]]})})}get ctrls(){return this.form.controls}getInitDate(){var e=new Date;return e.setDate(e.getDate()-1),e}ngOnInit(){this.authorService.author?this.author=this.authorService.author:this.subscription.add(this.authorService.author$.subscribe(e=>{this.author=e})),this.subscription.add(this.modalService.closeEventObservable$.pipe((0,S.h)(e=>this.modalService.getModalProperties().title===this.cancelModalTitle)).subscribe(e=>{e===_.yR.BUTTON_CLICK_VALUE.OK_BUTTON_CLICK_VALUE&&this.router.navigateByUrl(this.listPagePath)})),this.setDefaultValue()}setDefaultValue(){this.ctrls.dateGroup.controls.from_date_of_sale.setValue(this.getInitDate()),this.ctrls.dateGroup.controls.to_date_of_sale.setValue(this.getInitDate())}ngOnDestroy(){this.subscription.unsubscribe()}handleClickCancel(){this.form.pristine?this.router.navigateByUrl(this.listPagePath):this.modalService.setModal(this.cancelModalTitle,_.yR.BODY.CANCEL,"warning",_.yR.BUTTON_TITLE.EXECUTION,_.yR.BUTTON_TITLE.CANCEL)}formControlStateManager(e){return(e.touched||e.dirty)&&e.invalid}handleError(e,r,n){this.errorService.setError({status:e,title:r,message:n,redirectPath:this.listPagePath})}handleClickSaveButton(){this.form.markAsPristine(),this.common.loading=!0;const e=this.form.value;if(!e.dateGroup?.from_date_of_sale||!e.dateGroup?.to_date_of_sale)return this.ctrls.dateGroup.controls.from_date_of_sale.setValue(""),this.ctrls.dateGroup.controls.to_date_of_sale.setValue(""),void(this.common.loading=!1);const r={from_date_of_sale:new Date(e.dateGroup.from_date_of_sale).toLocaleDateString(),to_date_of_sale:new Date(e.dateGroup.to_date_of_sale).toLocaleDateString()};this.subscription.add(this.poService.put(r).pipe((0,x.x)(()=>this.common.loading=!1),(0,f.K)(n=>(0,T.of)(n))).subscribe(n=>{n instanceof A.UA?this.handleError(n.status,this.errorModalTitle,n.error.message):(this.flashMessageService.setFlashMessage(n.message,"success",15e3),this.router.navigateByUrl(this.listPagePath))}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(J),t.Y36(F.Z),t.Y36(G.P),t.Y36(E.F0),t.Y36(p.qu),t.Y36(X.Y),t.Y36(nt.p),t.Y36($.G),t.Y36(P.T),t.Y36(at.d),t.Y36(Q.E),t.Y36(R.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-order-data-creation"]],decls:39,vars:27,consts:[[3,"breadcrumbList"],[1,"mb-8"],[1,"mt-8","text-xl"],[1,"mt-6","mb-2","flex","flex-row","items-center","justify-between"],[1,"cursor-pointer",3,"click"],[3,"roleTypeName"],[1,"width-limit-break","border-t","border-gray-400"],[3,"formGroup","ngSubmit"],[1,"mt-8","mb-24","pt-8","pb-8","px-6","bg-white","shadow","border","border-gray-300"],[1,"text-lg"],[1,"border-t-primary-light-hover","border-t-4"],[1,"flex","gap-6","mt-6","mb-6"],[1,"w-2/5"],[1,"w-2/3"],[1,"flex","gap-6"],[1,"w-1/2"],["nameAttrValue","from_date_of_sale","idAttrValue","from-date-of-sale",3,"formCtrl","invalid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["message","",4,"ngIf"],["nameAttrValue","to_date_of_sale","idAttrValue","to-date-of-sale",3,"formCtrl","invalid"],[1,"width-limit-break","bg-primary-light","flex","flex-row","justify-center","bottom-[40px]","left-0","right-0","p-2","fixed","gap-8"],["btnType","submit","btnFillColor","bg-success","btnHoverColor","hover:bg-success-hover","btnTextColor","text-white","btnLineColor","border-success","btnLineHoverColor","hover:border-success-hover",3,"buttonDisabled"],["labels",""],["errors",""],["dateErrors",""],["message",""],[1,"flex","items-center","gap-2"],["class","px-3 py-0.5 text-xs text-white bg-warning-dark rounded-full",4,"ngIf"],[1,"px-3","py-0.5","text-xs","text-white","bg-warning-dark","rounded-full"],[4,"ngIf"],["class","mt-1 pl-1 text-sm text-red",4,"ngIf"],[1,"mt-1","pl-1","text-sm","text-red"]],template:function(e,r){if(1&e&&(t._UZ(0,"app-breadcrumb-org",0),t.TgZ(1,"main",1)(2,"h1",2),t._uU(3,"\u767a\u6ce8\u30c7\u30fc\u30bf\u65b0\u898f\u767b\u9332"),t.qZA(),t.TgZ(4,"div",3)(5,"div",4),t.NdJ("click",function(){return r.handleClickCancel()}),t._UZ(6,"app-cancel-link-org"),t.qZA(),t.TgZ(7,"div")(8,"app-last-updater-org",5),t._uU(9),t.qZA()()(),t._UZ(10,"hr",6),t.TgZ(11,"form",7),t.NdJ("ngSubmit",function(){return r.handleClickSaveButton()}),t.TgZ(12,"div",8)(13,"h2",9),t._uU(14,"\u767a\u6ce8\u30c7\u30fc\u30bf\u65b0\u898f\u767b\u9332"),t.qZA(),t._UZ(15,"hr",10),t.TgZ(16,"div",11),t._UZ(17,"div",12)(18,"div",12),t.qZA(),t.TgZ(19,"div",13)(20,"div",14)(21,"div",15)(22,"app-date-term",16),t.YNc(23,wi,1,0,"ng-container",17),t.YNc(24,ji,2,4,"div",18),t.qZA()(),t.TgZ(25,"div",15)(26,"app-date-term",19),t.YNc(27,Hi,1,0,"ng-container",17),t.YNc(28,Xi,2,4,"div",18),t.qZA()()(),t.YNc(29,zi,1,0,"ng-container",17),t.qZA()(),t.TgZ(30,"div",20)(31,"app-button",21),t._uU(32,"\u767a\u6ce8\u30c7\u30fc\u30bf\u4f5c\u6210"),t.qZA()()()(),t.YNc(33,tn,4,2,"ng-template",null,22,t.W1O),t.YNc(35,nn,1,1,"ng-template",null,23,t.W1O),t.YNc(37,sn,1,1,"ng-template",null,24,t.W1O)),2&e){const n=t.MAs(34),o=t.MAs(38);t.Q6J("breadcrumbList",t.WLB(20,dn,t.VKq(17,an,r.listPagePath),t.DdM(19,un))),t.xp6(8),t.Q6J("roleTypeName",r.author&&r.author.role_name?r.author.role_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."),t.xp6(1),t.hij(" \u767b\u9332\u8005\uff1a",r.author?r.author.last_name+" "+r.author.first_name:"\u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d..."," "),t.xp6(2),t.Q6J("formGroup",r.form),t.xp6(11),t.Q6J("formCtrl",r.ctrls.dateGroup.controls.from_date_of_sale)("invalid",r.formControlStateManager(r.ctrls.dateGroup.controls.from_date_of_sale)||(null==r.ctrls.dateGroup.errors?null:r.ctrls.dateGroup.errors.endingDateIsSmaller)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(23,ln)),t.xp6(1),t.Q6J("ngIf",r.formControlStateManager(r.ctrls.dateGroup.controls.from_date_of_sale)||(null==r.ctrls.dateGroup.errors?null:r.ctrls.dateGroup.errors.endingDateIsSmaller)),t.xp6(2),t.Q6J("formCtrl",r.ctrls.dateGroup.controls.to_date_of_sale)("invalid",r.formControlStateManager(r.ctrls.dateGroup.controls.to_date_of_sale)||(null==r.ctrls.dateGroup.errors?null:r.ctrls.dateGroup.errors.endingDateIsSmaller)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(24,_n)),t.xp6(1),t.Q6J("ngIf",r.formControlStateManager(r.ctrls.dateGroup.controls.to_date_of_sale)||(null==r.ctrls.dateGroup.errors?null:r.ctrls.dateGroup.errors.endingDateIsSmaller)),t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(25,cn,r.ctrls.dateGroup)),t.xp6(2),t.Q6J("buttonDisabled",r.form.invalid||r.form.pristine)}},dependencies:[Z.O5,Z.tP,V.Z,w.R,B.r,z.K,p._Y,p.JL,p.sg,dt.a]}),i})()}]}];let mn=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[E.Bz.forChild(pn),E.Bz]}),i})();var gn=d(9307),hn=d(4933),fn=d(9823),vn=d(7088),Tn=d(3042),Cn=d(2923),An=d(4470),xn=d(9104),bn=d(9434),En=d(3894),On=d(3560),Dn=d(4787),Sn=d(3962),Zn=d(3415),In=d(5274),yn=d(3183),Fn=d(1326),Un=d(973),Nn=d(1819),qn=d(4854),Rn=d(7090),Mn=d(8593);let Ln=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[R.v],imports:[Z.ez,mn,gn.u,hn.M,fn.U,vn.t,Tn.C,Cn.D,An.x,xn.u,bn.H,En.h,On.r,p.UX,Dn.N,Sn.J,Zn.x,In.s,yn.F,Fn.z,Un.Y,Nn.l,qn.C,Rn.G,Mn.n]}),i})()},4870:(tt,q,d)=>{d.d(q,{U:()=>Z});const Z={CHARACTER_LIMITS:{NAME_MAX_LENGTH:"25",NAME_KANA_MAX_LENGTH:"50",STANDARD_MAX_LENGTH:"25",PART_NUMBER_MAX_LENGTH:"25",BARCODE_MAX_LENGTH:"13",B_BARCODE_MAX_LENGTH:"14",C_BARCODE_MAX_LENGTH:"14",QUANTITY_MAX_LENGTH:"7",B_QUANTITY_MAX_LENGTH:"7",C_QUANTITY_MAX_LENGTH:"7",ORDERING_TARGET_BARCODE_MAX_LENGTH:"14",REMARKS_1_MAX_LENGTH:"20",REMARKS_2_MAX_LENGTH:"20",REMARKS_3_MAX_LENGTH:"20",REMARKS_4_MAX_LENGTH:"20",SUPPLIER_NAME:"255",SUPPLIER_PRODUCT_CD:"10"},PRODUCT_DIVISION:{CODE:{STANDARD:0,WASTE_NUMBER:1,CUSTOM:2},VALUE:{STANDARD:"\u5b9a\u756a",WASTE_NUMBER:"\u5ec3\u756a",CUSTOM:"\u7279\u6ce8\u54c1"}}}},9744:(tt,q,d)=>{d.d(q,{J:()=>p});var Z=d(1571);let p=(()=>{class E{getDivisions(N,S){return N[S]}getDivisionid(N,S,y){const _=this.getDivisions(N,S);let t;for(let F in _)if(_[F].code===y){t=_[F].value;break}return t}}return E.\u0275fac=function(N){return new(N||E)},E.\u0275prov=Z.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})()},2e3:(tt,q,d)=>{d.d(q,{d:()=>N});var Z=d(2340),p=d(4004),E=d(1751),U=d(1571);let N=(()=>{class S extends E.O{constructor(){super(...arguments),this.storeEndpoint=Z.pU.storeApi.endpoint}getAll(_={}){return this.httpOptions.params=_,this.http.get(this.storeEndpoint,this.httpOptions)}find(_){return this.http.get(`${this.storeEndpoint}/${_}`)}add(_){const t=this.generateFormData(_);return this.http.post(this.storeEndpoint,t)}update(_,t){const F=this.generateFormData(t);return this.http.patch(`${this.storeEndpoint}/${_}`,F)}remove(_){return this.http.delete(`${this.storeEndpoint}/${_}`)}getAsSelectOptions(){return this.getAll().pipe((0,p.U)(_=>_.data.map(F=>({value:F.id,text:F.name}))))}}return S.\u0275fac=function(){let y;return function(t){return(y||(y=U.n5z(S)))(t||S)}}(),S.\u0275prov=U.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})()}}]);